<?xml version="1.0" encoding="UTF-8"?>
<sqls>
	<querys>
		<query name="ScOftAutoRatingDBDAOSearchScTAWOftAutoratingListRSQL">
			<desc><![CDATA[SearchScTAWOftAutoratingList]]></desc>
			<sql><![CDATA[
/*AUTORATING_20091208-001*/
WITH
BK AS (

/*******************************************************************************************
BOOKING 의 기본 정보를 SELECT 한다.
*******************************************************************************************/

SELECT	BK.BKG_NO					,
				NULL CORR_NO			,
				NVL(@[cmdt_cd], BK.CMDT_CD)	CMDT_CD	,
				( SELECT REP_CMDT_CD FROM MDM_COMMODITY WHERE CMDT_CD = NVL(@[cmdt_cd], BK.CMDT_CD) )	REP_CMDT_CD	,
				DECODE(BK.PRE_RLY_PORT_CD||BK.PST_RLY_PORT_CD,NULL,'Y','N') DIR_CALL_FLG	,
				NVL(TO_DATE(@[rt_aply_dt], 'YYYYMMDD'), BR.RT_APLY_DT)		RT_APLY_DT		,
				BK.SVC_SCP_CD			,
				SUBSTR(BK.SVC_SCP_CD, 3, 1) DIR_CD	,
				'S' CTRT_TP_CD		,
				BK.SC_NO					,
				BK.RFA_NO					,
				BK.TAA_NO					,
				CASE
				WHEN BK.XTER_BKG_RQST_CD = 'EDI' THEN 'E'
				WHEN BK.XTER_BKG_RQST_CD = 'WEB' THEN 'W'
				WHEN BK.XTER_BKG_RQST_CD = 'DSK' THEN 'D'
				ELSE 'E'
				END	ESVC_TP_CD		,
				SS.PROP_NO				,
				SS.AMDT_SEQ				,
				SS.NOTE_HDR_SEQ		,
				CASE
				WHEN L4.CML_ZN_FLG = 'Y' AND L3.RGN_CD IN ( 'UAG', 'UAN', 'UAS' ) THEN 'CZ'
				ELSE 'NN'
				END CML_ZN_CD			,
				CASE
				WHEN	L3.CNT_CD IN ( 'US', 'CA' ) AND BK.POD_CD = BK.DEL_CD AND BK.DE_TERM_CD NOT IN ( 'D', 'H' ) THEN 'PO'
				WHEN	L3.CNT_CD IN ( 'US', 'CA' ) THEN NVL(( SELECT SUBSTR(SVC_MOD_CD, 1, 2) FROM COA_USA_SVC_MOD A WHERE A.ORG_RGN_CD = L3.RGN_CD AND A.DEST_RGN_CD = L4.RGN_CD ), 'OT')
				WHEN	L2.CNT_CD IN ( 'US', 'CA' ) AND BK.POL_CD = BK.POR_CD AND BK.RCV_TERM_CD NOT IN ( 'D', 'H' ) THEN 'PO'
				WHEN	L2.CNT_CD IN ( 'US', 'CA' ) THEN NVL(( SELECT SUBSTR(SVC_MOD_CD, 1, 2) FROM COA_USA_SVC_MOD A WHERE A.ORG_RGN_CD = L2.RGN_CD AND A.DEST_RGN_CD = L1.RGN_CD ), 'OT')
				END		USA_SVC_MOD_CD	,	-- PO, LO, IP, ML, OT
				BK.POR_CD														,
				L1.CNT_CD||L1.STE_CD	POR_STE_CD		,
				L1.RGN_CD							POR_RGN_CD		,
				L1.CNT_CD							POR_CNT_CD		,
				L1.CONTI_CD						POR_CONTI_CD	,
				BK.POL_CD														,
				L2.CNT_CD||L2.STE_CD	POL_STE_CD		,
				L2.RGN_CD							POL_RGN_CD		,
				L2.CNT_CD							POL_CNT_CD		,
				L2.CONTI_CD						POL_CONTI_CD	,
				BK.POD_CD														,
				L3.CNT_CD||L3.STE_CD	POD_STE_CD		,
				L3.RGN_CD							POD_RGN_CD		,
				L3.CNT_CD							POD_CNT_CD		,
				L3.CONTI_CD						POD_CONTI_CD	,
				BK.DEL_CD														,
				L4.CNT_CD||L4.STE_CD	DEL_STE_CD		,
				L4.RGN_CD							DEL_RGN_CD		,
				L4.CNT_CD							DEL_CNT_CD		,
				L4.CONTI_CD						DEL_CONTI_CD	,
				BK.PRE_RLY_PORT_CD									,
				BK.PST_RLY_PORT_CD									,
				BK.POL_NOD_CD												,
				BK.POD_NOD_CD												,
				BK.ORG_TRNS_MOD_CD									,
				BK.DEST_TRNS_MOD_CD									,
				BK.AGMT_ACT_CNT_CD									,
				BK.AGMT_ACT_CUST_SEQ								,
				( SELECT SUM(A.OP_CNTR_QTY) FROM BKG_QTY_DTL A WHERE A.BKG_NO = BK.BKG_NO )	CNTR_QTY	,
				DECODE(BB.MEAS_UT_CD, 'CBF', BB.MEAS_QTY	* 0.0283	, BB.MEAS_QTY	)					MEAS_QTY	,
				DECODE(BB.WGT_UT_CD	, 'LBS', BB.ACT_WGT		* 0.45359	, BB.ACT_WGT	)					ACT_WGT
FROM		BKG_BOOKING		BK	,
				BKG_BL_DOC		BB	,
				BKG_RATE			BR	,
				MDM_LOCATION	L1	,
				MDM_LOCATION	L2	,
				MDM_LOCATION	L3	,
				MDM_LOCATION	L4	,
				PRI_SP_HDR		SH	,
				PRI_SP_MN			SM	,
				PRI_SP_SCP_MN	SS
WHERE		BB.BKG_NO				= BK.BKG_NO
AND			BR.BKG_NO(+)		= BK.BKG_NO
AND			L1.LOC_CD				= BK.POR_CD
AND			L2.LOC_CD				= BK.POL_CD
AND			L3.LOC_CD				= BK.POD_CD
AND			L4.LOC_CD				= BK.DEL_CD
AND			SH.SC_NO				= BK.SC_NO
AND	   	SM.PROP_NO			= SH.PROP_NO
--AND     SM.PROP_STS_CD	= 'F'				-- FILING S/C
AND     DECODE(SH.SC_NO, 'AEN090001', 'F', SM.PROP_STS_CD)	= 'F'
AND			SS.PROP_NO			= SM.PROP_NO
AND			SS.AMDT_SEQ			= SM.AMDT_SEQ
AND			SS.SVC_SCP_CD		= BK.SVC_SCP_CD
AND			NVL(TO_DATE(@[rt_aply_dt], 'YYYYMMDD'), ( SELECT RT_APLY_DT FROM BKG_RATE A WHERE A.BKG_NO = BK.BKG_NO ))	BETWEEN SS.EFF_DT AND SS.EXP_DT
AND			BK.BKG_NO				= @[bkg_no]	-- BKG No
AND			@[ca_flg]				= 'N'

UNION ALL

SELECT	BK.BKG_NO					,
				BK.CORR_NO				,
				NVL(@[cmdt_cd], BK.CMDT_CD)	CMDT_CD	,
				( SELECT REP_CMDT_CD FROM MDM_COMMODITY WHERE CMDT_CD = NVL(@[cmdt_cd], BK.CMDT_CD) )	REP_CMDT_CD	,
				DECODE(BK.PRE_RLY_PORT_CD||BK.PST_RLY_PORT_CD,NULL,'Y','N') DIR_CALL_FLG	,
				NVL(TO_DATE(@[rt_aply_dt], 'YYYYMMDD'), BR.RT_APLY_DT)		RT_APLY_DT		,
				BK.SVC_SCP_CD			,
				SUBSTR(BK.SVC_SCP_CD, 3, 1) DIR_CD	,
				'S' CTRT_TP_CD		,
				BK.SC_NO					,
				BK.RFA_NO					,
				BK.TAA_NO					,
				CASE
				WHEN BK.XTER_BKG_RQST_CD = 'EDI' THEN 'E'
				WHEN BK.XTER_BKG_RQST_CD = 'WEB' THEN 'W'
				WHEN BK.XTER_BKG_RQST_CD = 'DSK' THEN 'D'
				ELSE 'E'
				END	ESVC_TP_CD		,
				SS.PROP_NO				,
				SS.AMDT_SEQ				,
				SS.NOTE_HDR_SEQ		,
				CASE
				WHEN L4.CML_ZN_FLG = 'Y' AND L3.RGN_CD IN ( 'UAG', 'UAN', 'UAS' ) THEN 'CZ'
				ELSE 'NN'
				END CML_ZN_CD			,
				CASE
				WHEN	L3.CNT_CD IN ( 'US', 'CA' ) AND BK.POD_CD = BK.DEL_CD AND BK.DE_TERM_CD NOT IN ( 'D', 'H' ) THEN 'PO'
				WHEN	L3.CNT_CD IN ( 'US', 'CA' ) THEN ( SELECT SUBSTR(SVC_MOD_CD, 1, 2) FROM COA_USA_SVC_MOD A WHERE A.ORG_RGN_CD = L3.RGN_CD AND A.DEST_RGN_CD = L4.RGN_CD )
				WHEN	L2.CNT_CD IN ( 'US', 'CA' ) AND BK.POL_CD = BK.POR_CD AND BK.RCV_TERM_CD NOT IN ( 'D', 'H' ) THEN 'PO'
				WHEN	L2.CNT_CD IN ( 'US', 'CA' ) THEN ( SELECT SUBSTR(SVC_MOD_CD, 1, 2) FROM COA_USA_SVC_MOD A WHERE A.ORG_RGN_CD = L2.RGN_CD AND A.DEST_RGN_CD = L1.RGN_CD )
				END		USA_SVC_MOD_CD	,	-- PO, LO, IP, ML
				BK.POR_CD														,
				L1.CNT_CD||L1.STE_CD	POR_STE_CD		,
				L1.RGN_CD							POR_RGN_CD		,
				L1.CNT_CD							POR_CNT_CD		,
				L1.CONTI_CD						POR_CONTI_CD	,
				BK.POL_CD														,
				L2.CNT_CD||L2.STE_CD	POL_STE_CD		,
				L2.RGN_CD							POL_RGN_CD		,
				L2.CNT_CD							POL_CNT_CD		,
				L2.CONTI_CD						POL_CONTI_CD	,
				BK.POD_CD														,
				L3.CNT_CD||L3.STE_CD	POD_STE_CD		,
				L3.RGN_CD							POD_RGN_CD		,
				L3.CNT_CD							POD_CNT_CD		,
				L3.CONTI_CD						POD_CONTI_CD	,
				BK.DEL_CD														,
				L4.CNT_CD||L4.STE_CD	DEL_STE_CD		,
				L4.RGN_CD							DEL_RGN_CD		,
				L4.CNT_CD							DEL_CNT_CD		,
				L4.CONTI_CD						DEL_CONTI_CD	,
				BK.PRE_RLY_PORT_CD									,
				BK.PST_RLY_PORT_CD									,
				BK.POL_NOD_CD												,
				BK.POD_NOD_CD												,
				BK.ORG_TRNS_MOD_CD									,
				BK.DEST_TRNS_MOD_CD									,
				BK.AGMT_ACT_CNT_CD									,
				BK.AGMT_ACT_CUST_SEQ								,
				( SELECT SUM(A.OP_CNTR_QTY) FROM BKG_QTY_DTL_HIS A WHERE A.BKG_NO = BK.BKG_NO AND A.CORR_NO = BK.CORR_NO )	CNTR_QTY	,
				DECODE(BB.MEAS_UT_CD, 'CBF', BB.MEAS_QTY	* 0.0283	, BB.MEAS_QTY	)		MEAS_QTY	,
				DECODE(BB.WGT_UT_CD	, 'LBS', BB.ACT_WGT		* 0.45359	, BB.ACT_WGT	)		ACT_WGT
FROM		BKG_BKG_HIS				BK	,
				BKG_BL_DOC_HIS		BB	,
				BKG_RT_HIS				BR	,
				MDM_LOCATION			L1	,
				MDM_LOCATION			L2	,
				MDM_LOCATION			L3	,
				MDM_LOCATION			L4	,
				PRI_SP_HDR				SH	,
				PRI_SP_MN					SM	,
				PRI_SP_SCP_MN			SS
WHERE		BB.BKG_NO				= BK.BKG_NO
AND			BB.CORR_NO			= BK.CORR_NO
AND			BR.BKG_NO(+)		= BK.BKG_NO
AND			BR.CORR_NO(+)		= BK.CORR_NO
AND			L1.LOC_CD				= BK.POR_CD
AND			L2.LOC_CD				= BK.POL_CD
AND			L3.LOC_CD				= BK.POD_CD
AND			L4.LOC_CD				= BK.DEL_CD
AND			SH.SC_NO				= BK.SC_NO
AND	   	SM.PROP_NO			= SH.PROP_NO
--AND     SM.PROP_STS_CD	= 'F'				-- FILING S/C
AND     DECODE(SH.SC_NO, 'AEN090001', 'F', SM.PROP_STS_CD)	= 'F'
AND			SS.PROP_NO			= SM.PROP_NO
AND			SS.AMDT_SEQ			= SM.AMDT_SEQ
AND			SS.SVC_SCP_CD		= BK.SVC_SCP_CD
AND			NVL(TO_DATE(@[rt_aply_dt], 'YYYYMMDD'), ( SELECT RT_APLY_DT FROM BKG_RT_HIS A WHERE A.BKG_NO = BK.BKG_NO AND A.CORR_NO = BK.CORR_NO ))	BETWEEN SS.EFF_DT AND SS.EXP_DT
AND			BK.BKG_NO				= @[bkg_no]	-- BKG No
AND			BK.CORR_NO			= 'TPM0000001'	-- CORRECTION 중인 DATA 를 나타내는 고정된 상수값
AND			@[ca_flg]				= 'Y'

)	,
BQ AS (

/*******************************************************************************************
AUTORATING 을 실행할 단위(ROW) 를 SELECT 한다.

IMDG CLASS 을 경우 해당 CNTR TP/SZ 별 MIN 값을 취한다.

현재는 요구사항에 없으나, 향후 실제 TP/SZ 가 필요할때를 대비하여 CNTR_TPSZ_CD 를 가지고 있는다.

POR, POL, POD, DEL, PRE RELAY, POST RELAY 에 대해서는 ROUTE CONVERSION 을 적용한다.

D7/AK 를 D7/DR 운임 적용을 위한 예외 로직도 여기서 적용한다.
*******************************************************************************************/

SELECT	BK.BKG_NO									,
				BK.CORR_NO								,
				ROW_NUMBER() OVER ( ORDER BY BQ.BKG_BQ_SEQ ) BQ_SEQ	,
				BK.CMDT_CD								,
				BK.REP_CMDT_CD						,
				BK.DIR_CALL_FLG						,
				BK.RT_APLY_DT							,
				BK.SVC_SCP_CD							,
				BK.DIR_CD									,
				BK.CTRT_TP_CD							,
				BK.SC_NO									,
				BK.RFA_NO									,
				BK.TAA_NO									,
				BK.ESVC_TP_CD							,
				BK.PROP_NO								,
				BK.AMDT_SEQ								,
				BK.NOTE_HDR_SEQ						,
				BK.CML_ZN_CD							,
				BK.USA_SVC_MOD_CD					,
				RC.POR_CD									,
				RC.POR_STE_CD							,
				RC.POR_RGN_CD							,
				RC.POR_CNT_CD							,
				RC.POR_CONTI_CD						,
				RC.POL_CD									,
				RC.POL_STE_CD							,
				RC.POL_RGN_CD							,
				RC.POL_CNT_CD							,
				RC.POL_CONTI_CD						,
				RC.POD_CD									,
				RC.POD_STE_CD							,
				RC.POD_RGN_CD							,
				RC.POD_CNT_CD							,
				RC.POD_CONTI_CD						,
				RC.DEL_CD									,
				RC.DEL_STE_CD							,
				RC.DEL_RGN_CD							,
				RC.DEL_CNT_CD							,
				RC.DEL_CONTI_CD						,
				RC.PRE_RLY_PORT_CD				,
				RC.PST_RLY_PORT_CD				,
				BK.POL_NOD_CD							,
				BK.POD_NOD_CD							,
				RC.POR_APPL_FLG						,
				RC.POL_APPL_FLG						,
				RC.POD_APPL_FLG						,
				RC.DEL_APPL_FLG						,
				RC.PRE_RLY_PORT_APPL_FLG	,
				RC.PST_RLY_PORT_APPL_FLG	,
        BK.ORG_TRNS_MOD_CD				,
				BK.DEST_TRNS_MOD_CD				,
				BK.AGMT_ACT_CNT_CD				,
				BK.AGMT_ACT_CUST_SEQ			,
				BK.CNTR_QTY								,
				BK.MEAS_QTY								,
				BK.ACT_WGT								,
				BQ.BKG_BQ_SEQ							,
				BQ.CNTR_TPSZ_CD						,
				BQ.CTRT_CNTR_TPSZ_CD			,
				( SELECT A.CNTR_SZ_CD FROM MDM_CNTR_TP_SZ A WHERE A.CNTR_TPSZ_CD = BQ.CTRT_CNTR_TPSZ_CD ) CTRT_CNTR_SZ_CD	,
				BQ.RCV_TERM_CD						,
				BQ.DE_TERM_CD							,
				CASE					/* D7/AK 를 D7/DR 운임 적용을 위한 예외 로직 */
				WHEN BQ.CTRT_CNTR_TPSZ_CD = 'D7' AND BQ.AWK_CGO_FLG = 'Y' THEN 'DR'
				WHEN BQ.DRY_CGO_FLG = 'Y' THEN 'DR'
				END																	DR_TP		,
				DECODE(BQ.DCGO_FLG		, 'Y', 'DG')	DG_TP		,
				DECODE(BQ.RC_FLG			, 'Y', 'RF')	RF_TP		,
				DECODE(BQ.AWK_CGO_FLG	, 'Y', 'AK')	AK_TP		,
				DECODE(BQ.BB_CGO_FLG	, 'Y', 'BB')	BB_TP		,
				BQ.DRY_CGO_FLG						,
				BQ.DCGO_FLG								,
				BQ.RC_FLG									,
				BQ.AWK_CGO_FLG						,
				BQ.BB_CGO_FLG							,
				BQ.SOC_FLG								,
				CASE
				WHEN BQ.DCGO_FLG 		= 'Y' THEN 'DG'
				WHEN BQ.AWK_CGO_FLG	= 'Y' THEN 'AK'
				WHEN BQ.RC_FLG	 		= 'Y' THEN 'RF'
				WHEN BQ.BB_CGO_FLG	= 'Y' THEN 'BB'
				ELSE 'DR'
				END	PRC_CGO_TP_CD					,
				BQ.IMDG_CLSS_CD						,
				BQ.CTRT_CNTR_QTY
FROM		BK	,
				(
				SELECT	ROW_NUMBER() OVER ( ORDER BY QD.CNTR_TPSZ_CD, QD.CTRT_CNTR_TPSZ_CD, QD.RCV_TERM_CD, QD.DE_TERM_CD, QD.DRY_CGO_FLG, QD.AWK_CGO_FLG, QD.DCGO_FLG, QD.RC_FLG, QD.BB_CGO_FLG, QD.SOC_FLG, QD.IMDG_CLSS_CD )	BKG_BQ_SEQ	,
								QD.CNTR_TPSZ_CD						,
								QD.CTRT_CNTR_TPSZ_CD			,
								QD.RCV_TERM_CD						,
								QD.DE_TERM_CD							,
								QD.DRY_CGO_FLG						,
								QD.AWK_CGO_FLG						,
								QD.DCGO_FLG								,
								QD.RC_FLG									,
								QD.BB_CGO_FLG							,
								QD.SOC_FLG								,
								QD.IMDG_CLSS_CD						,
								QD.CTRT_CNTR_QTY
				FROM		(

								SELECT	QD.CNTR_TPSZ_CD						,
												QD.CTRT_CNTR_TPSZ_CD			,
												QD.RCV_TERM_CD						,
												QD.DE_TERM_CD							,
												QD.DRY_CGO_FLG						,
												QD.AWK_CGO_FLG						,
												QD.DCGO_FLG								,
												QD.RC_FLG									,
												QD.BB_CGO_FLG							,
												QD.SOC_FLG								,
												DECODE(QD.DCGO_FLG, 'Y', ( SELECT MIN(IMDG_CLSS_CD) FROM BKG_DG_CGO A WHERE A.BKG_NO = QD.BKG_NO AND A.CNTR_TPSZ_CD = QD.CNTR_TPSZ_CD ))	IMDG_CLSS_CD	,
												QD.CTRT_CNTR_QTY
								FROM		(
												SELECT	QD.BKG_NO										,
																QD.CNTR_TPSZ_CD							,
																NVL(QD.EQ_SUBST_CNTR_TPSZ_CD, QD.CNTR_TPSZ_CD)	CTRT_CNTR_TPSZ_CD	,
																QD.RCV_TERM_CD							,
																QD.DE_TERM_CD								,
																QD.DRY_CGO_FLG							,
																QD.AWK_CGO_FLG							,
																QD.DCGO_FLG									,
																QD.RC_FLG										,
																QD.BB_CGO_FLG								,
																QD.SOC_FLG									,
																SUM(QD.OP_CNTR_QTY) CTRT_CNTR_QTY
												FROM		BK	,
																BKG_QTY_DTL	QD
												WHERE		QD.BKG_NO		= BK.BKG_NO
												GROUP BY
																QD.BKG_NO									,
																QD.CNTR_TPSZ_CD						,
																NVL(QD.EQ_SUBST_CNTR_TPSZ_CD, QD.CNTR_TPSZ_CD)	,
																QD.RCV_TERM_CD						,
																QD.DE_TERM_CD							,
																QD.DRY_CGO_FLG						,
																QD.AWK_CGO_FLG						,
																QD.DCGO_FLG								,
																QD.RC_FLG									,
																QD.BB_CGO_FLG							,
																QD.SOC_FLG
												)	QD
								WHERE		@[ca_flg]		= 'N'
								
								UNION ALL

								SELECT	QD.CNTR_TPSZ_CD						,
												QD.CTRT_CNTR_TPSZ_CD			,
												QD.RCV_TERM_CD						,
												QD.DE_TERM_CD							,
												QD.DRY_CGO_FLG						,
												QD.AWK_CGO_FLG						,
												QD.DCGO_FLG								,
												QD.RC_FLG									,
												QD.BB_CGO_FLG							,
												QD.SOC_FLG								,
												DECODE(QD.DCGO_FLG, 'Y', ( SELECT MIN(IMDG_CLSS_CD) FROM BKG_DG_CGO_HIS A WHERE A.BKG_NO = QD.BKG_NO AND A.CORR_NO = QD.CORR_NO AND A.CNTR_TPSZ_CD = QD.CNTR_TPSZ_CD ))	IMDG_CLSS_CD	,
												QD.CTRT_CNTR_QTY
								FROM		(
												SELECT	QD.BKG_NO										,
																QD.CORR_NO									,
																QD.CNTR_TPSZ_CD							,
																NVL(QD.EQ_SUBST_CNTR_TPSZ_CD, QD.CNTR_TPSZ_CD)	CTRT_CNTR_TPSZ_CD	,
																QD.RCV_TERM_CD							,
																QD.DE_TERM_CD								,
																QD.DRY_CGO_FLG							,
																QD.AWK_CGO_FLG							,
																QD.DCGO_FLG									,
																QD.RC_FLG										,
																QD.BB_CGO_FLG								,
																QD.SOC_FLG									,
																SUM(QD.OP_CNTR_QTY) CTRT_CNTR_QTY
												FROM		BK	,
																BKG_QTY_DTL_HIS	QD
												WHERE		QD.BKG_NO		= BK.BKG_NO
												AND			QD.CORR_NO	= BK.CORR_NO
												GROUP BY
																QD.BKG_NO									,
																QD.CORR_NO								,
																QD.CNTR_TPSZ_CD						,
																NVL(QD.EQ_SUBST_CNTR_TPSZ_CD, QD.CNTR_TPSZ_CD)	,
																QD.RCV_TERM_CD						,
																QD.DE_TERM_CD							,
																QD.DRY_CGO_FLG						,
																QD.AWK_CGO_FLG						,
																QD.DCGO_FLG								,
																QD.RC_FLG									,
																QD.BB_CGO_FLG							,
																QD.SOC_FLG
												)	QD
								WHERE		@[ca_flg]		= 'Y'

								)	QD
				)	BQ	,

/*******************************************************************************************
이 부분은 SURCHARGE 에는 적용하지 않고, OFT 에만 적용한다. ( S/C, RFA 공통 적용 )
*******************************************************************************************/

				(
				SELECT	POR_CD								,
								POR_STE_CD						,
								POR_RGN_CD						,
								POR_CNT_CD						,
								POR_CONTI_CD					,
								POR_APPL_FLG					,
								POL_CD								,
								POL_STE_CD						,
								POL_RGN_CD						,
								POL_CNT_CD						,
								POL_CONTI_CD					,
								POL_APPL_FLG					,
								POD_CD								,
								POD_STE_CD						,
								POD_RGN_CD						,
								POD_CNT_CD						,
								POD_CONTI_CD					,
								POD_APPL_FLG					,
								DEL_CD								,
								DEL_STE_CD						,
								DEL_RGN_CD						,
								DEL_CNT_CD						,
								DEL_CONTI_CD					,
								DEL_APPL_FLG					,
								PRE_RLY_PORT_CD				,
								PRE_RLY_PORT_APPL_FLG	,
								PST_RLY_PORT_CD				,
								PST_RLY_PORT_APPL_FLG
				FROM		(
								SELECT	POR_CD							,
												POR_STE_CD					,
												POR_RGN_CD					,
												POR_CNT_CD					,
												POR_CONTI_CD				,
												'N'	POR_APPL_FLG
								FROM		BK
								UNION ALL
								SELECT	RC.CONV_LOC_CD				POR_CD				,
												ML.CNT_CD||ML.STE_CD	POR_STE_CD		,
												ML.RGN_CD							POR_RGN_CD		,
												ML.CNT_CD							POR_CNT_CD		,
												ML.CONTI_CD						POR_CONTI_CD	,
												RC.POR_APPL_FLG
								FROM		BK	,
												PRI_ROUT_LOC_CONV	RC	,
												MDM_LOCATION	ML
								WHERE		RC.SVC_SCP_CD		= BK.SVC_SCP_CD
								AND			RC.ORG_LOC_CD		= BK.POR_CD
								AND			RC.POR_APPL_FLG	= 'Y'
								AND			ML.LOC_CD				= RC.CONV_LOC_CD
								)	,
								(
								SELECT	POL_CD							,
												POL_STE_CD					,
												POL_RGN_CD					,
												POL_CNT_CD					,
												POL_CONTI_CD				,
												'N'	POL_APPL_FLG
								FROM		BK
								UNION ALL
								SELECT	RC.CONV_LOC_CD				POL_CD				,
												ML.CNT_CD||ML.STE_CD	POL_STE_CD		,
												ML.RGN_CD							POL_RGN_CD		,
												ML.CNT_CD							POL_CNT_CD		,
												ML.CONTI_CD						POL_CONTI_CD	,
												RC.POL_APPL_FLG
								FROM		BK	,
												PRI_ROUT_LOC_CONV	RC	,
												MDM_LOCATION	ML
								WHERE		RC.SVC_SCP_CD		= BK.SVC_SCP_CD
								AND			RC.ORG_LOC_CD		= BK.POL_CD
								AND			RC.POL_APPL_FLG	= 'Y'
								AND			ML.LOC_CD				= RC.CONV_LOC_CD
								)	,
								(
								SELECT	POD_CD							,
												POD_STE_CD					,
												POD_RGN_CD					,
												POD_CNT_CD					,
												POD_CONTI_CD				,
												'N'	POD_APPL_FLG
								FROM		BK
								UNION ALL
								SELECT	RC.CONV_LOC_CD				POD_CD				,
												ML.CNT_CD||ML.STE_CD	POD_STE_CD		,
												ML.RGN_CD							POD_RGN_CD		,
												ML.CNT_CD							POD_CNT_CD		,
												ML.CONTI_CD						POD_CONTI_CD	,
												RC.POD_APPL_FLG
								FROM		BK	,
												PRI_ROUT_LOC_CONV	RC	,
												MDM_LOCATION	ML
								WHERE		RC.SVC_SCP_CD		= BK.SVC_SCP_CD
								AND			RC.ORG_LOC_CD		= BK.POD_CD
								AND			RC.POD_APPL_FLG	= 'Y'
								AND			ML.LOC_CD				= RC.CONV_LOC_CD
								)	,
								(
								SELECT	DEL_CD							,
												DEL_STE_CD					,
												DEL_RGN_CD					,
												DEL_CNT_CD					,
												DEL_CONTI_CD				,
												'N'	DEL_APPL_FLG
								FROM		BK
								UNION ALL
								SELECT	RC.CONV_LOC_CD				DEL_CD				,
												ML.CNT_CD||ML.STE_CD	DEL_STE_CD		,
												ML.RGN_CD							DEL_RGN_CD		,
												ML.CNT_CD							DEL_CNT_CD		,
												ML.CONTI_CD						DEL_CONTI_CD	,
												RC.DEL_APPL_FLG
								FROM		BK	,
												PRI_ROUT_LOC_CONV	RC	,
												MDM_LOCATION	ML
								WHERE		RC.SVC_SCP_CD		= BK.SVC_SCP_CD
								AND			RC.ORG_LOC_CD		= BK.DEL_CD
								AND			RC.DEL_APPL_FLG	= 'Y'
								AND			ML.LOC_CD				= RC.CONV_LOC_CD
								)	,
								(
								SELECT	PRE_RLY_PORT_CD							,
												'N'	PRE_RLY_PORT_APPL_FLG
								FROM		BK
								UNION ALL
								SELECT	CONV_LOC_CD	PRE_RLY_PORT_CD	,
												PRE_RLY_PORT_APPL_FLG
								FROM		BK	,
												PRI_ROUT_LOC_CONV	RC
								WHERE		RC.SVC_SCP_CD		= BK.SVC_SCP_CD
								AND			RC.ORG_LOC_CD		= BK.PRE_RLY_PORT_CD
								AND			RC.PRE_RLY_PORT_APPL_FLG	= 'Y'
								)	,
								(
								SELECT	PST_RLY_PORT_CD							,
												'N'	PST_RLY_PORT_APPL_FLG
								FROM		BK
								UNION ALL
								SELECT	CONV_LOC_CD	PST_RLY_PORT_CD	,
												PST_RLY_PORT_APPL_FLG
								FROM		BK	,
												PRI_ROUT_LOC_CONV	RC
								WHERE		RC.SVC_SCP_CD		= BK.SVC_SCP_CD
								AND			RC.ORG_LOC_CD		= BK.PST_RLY_PORT_CD
								AND			RC.PST_RLY_PORT_APPL_FLG	= 'Y'
								)
				)	RC
)	,
GC AS (

/*******************************************************************************************
GROUP COMMODITY 을 SELECT 한다.
*******************************************************************************************/

SELECT	BK.BKG_NO							,
				G.PRC_GRP_CMDT_CD			,
				D.PRC_CMDT_TP_CD			,
				D.PRC_CMDT_DEF_CD
FROM		BK	,
				PRI_SP_SCP_GRP_CMDT			G	,
				PRI_SP_SCP_GRP_CMDT_DTL	D
WHERE		D.PROP_NO					= G.PROP_NO
AND			D.AMDT_SEQ				= G.AMDT_SEQ
AND			D.SVC_SCP_CD			= G.SVC_SCP_CD
AND			D.GRP_CMDT_SEQ		= G.GRP_CMDT_SEQ
AND			D.SRC_INFO_CD			<> 'AD'
AND			G.PROP_NO					= BK.PROP_NO
AND			G.AMDT_SEQ				= BK.AMDT_SEQ
AND			G.SVC_SCP_CD			= BK.SVC_SCP_CD
)	,
GL AS (

/*******************************************************************************************
GROUP LOCATION 을 SELECT 한다.
NOTE CONVERSION 에서 사용하는 GROUP LOCATION ( 'EAST', 'WEST' ) 는 OFT 에서는 사용하지 않는다.
*******************************************************************************************/

SELECT	BK.BKG_NO					,
				G.PRC_GRP_LOC_CD	,
        D.LOC_CD
FROM 		BK	,
				PRI_SP_SCP_GRP_LOC 			G	,
		 		PRI_SP_SCP_GRP_LOC_DTL	D
WHERE		D.PROP_NO					= G.PROP_NO
AND			D.AMDT_SEQ				= G.AMDT_SEQ
AND			D.SVC_SCP_CD			= G.SVC_SCP_CD
AND			D.GRP_LOC_SEQ			= G.GRP_LOC_SEQ
AND			D.SRC_INFO_CD			<> 'AD'
AND			G.PROP_NO					= BK.PROP_NO
AND			G.AMDT_SEQ				= BK.AMDT_SEQ
AND			G.SVC_SCP_CD			= BK.SVC_SCP_CD
)	,
NC AS (

/*******************************************************************************************
BOOKING 에 해당하는 NOTE CONVERSION 을 SELECT 한다.
BKG_SCG_GRP_CMDT_CD, BKG_MST_HBL_TP_CD 는 SURCHARGE 에서만 사용되는 칼럼이고, RULE CODE 에서는 사용하지 않는다.
*******************************************************************************************/

SELECT	BQ.BQ_SEQ							,
				BQ.BKG_BQ_SEQ					,
				NC.NOTE_CONV_MAPG_ID	,
				NC.NOTE_CONV_SEQ			,
				CASE
				WHEN NC.NOTE_CONV_TP_CD = 'C' THEN CN.GEN_SPCL_RT_TP_CD
				WHEN NC.NOTE_CONV_TP_CD = 'R' THEN RN.GEN_SPCL_RT_TP_CD
				ELSE NC.GEN_SPCL_RT_TP_CD
				END GEN_SPCL_RT_TP_CD				,
				CASE
				WHEN NC.NOTE_CONV_TP_CD = 'C' THEN CN.CMDT_HDR_SEQ
				WHEN NC.NOTE_CONV_TP_CD = 'R' THEN RN.CMDT_HDR_SEQ
				ELSE 0
				END CMDT_HDR_SEQ						,
				CASE
				WHEN NC.NOTE_CONV_TP_CD = 'R' THEN RN.ROUT_SEQ
				ELSE 0
				END ROUT_SEQ								,
				(	SELECT A.PRIO_SEQ FROM PRI_NOTE_CONV_TP A WHERE A.PRC_CTRT_TP_CD = BQ.CTRT_TP_CD AND A.NOTE_CONV_TP_CD = NC.NOTE_CONV_TP_CD ) CONV_TP_PRIO	,
				GREATEST(DECODE(BKG_CMDT_TP_CD, 'C', 600, 'G', 400, 'R', 300, 0), DECODE(BKG_SCG_GRP_CMDT_CD, NULL, 0, 500))
					+ DECODE(BKG_POR_TP_CD, 'L', 600, 'G', 500, 'S', 400, 'R', 300, 'C', 200, 0)
					+ DECODE(BKG_POL_TP_CD, 'L', 600, 'G', 500, 'S', 400, 'R', 300, 'C', 200, 0)
					+ DECODE(BKG_POD_TP_CD, 'L', 600, 'G', 500, 'S', 400, 'R', 300, 'C', 200, 0)
					+ DECODE(BKG_DEL_TP_CD, 'L', 600, 'G', 500, 'S', 400, 'R', 300, 'C', 200, 0)
					+ DECODE(BKG_RAT_UT_CD, '20', 5, '40', 5, 'HC', 5, '45', 5, '53', 5, 'BL', 4, 'BX', 4, NULL, 4, 6)
					+ DECODE(BKG_PRC_CGO_TP_CD		, NULL, 0, 1)
					+ DECODE(BKG_IMDG_CLSS_CD			, NULL, 0, 1)
					+ DECODE(BKG_USA_SVC_MOD_CD		, NULL, 0, 1)
					+ DECODE(BKG_ORG_TRSP_MOD_CD	, NULL, 0, 1)
					+ DECODE(BKG_DEST_TRSP_MOD_CD	, NULL, 0, 1)
					+ DECODE(BKG_RCV_TERM_CD			, NULL, 0, 1)
					+ DECODE(BKG_DE_TERM_CD				, NULL, 0, 1)
					+ DECODE(BKG_SLAN_CD					, NULL, 0, 1)
					+ DECODE(BKG_VSL_CD						, NULL, 0, 1)
					+ DECODE(BKG_SOC_FLG					, NULL, 0, 1)
					+ DECODE(BKG_ACT_CUST_CNT_CD	, NULL, 0, 1)
					+ DECODE(BKG_TS_PORT_DEF_CD		, NULL, 0, 1)
					+ DECODE(BKG_DIR_CALL_FLG			, NULL, 0, 1)	MTCH_PRIO	,	/* MATCHING PRIORITY */
				NC.NOTE_CONV_TP_CD          ,
				NC.CHG_RULE_TP_CD           ,
				NC.NOTE_CONV_CHG_CD         ,
				NC.NOTE_CONV_RULE_CD        ,
				NC.RT_APPL_TP_CD            ,
				NC.RT_OP_CD                 ,
				NC.CURR_CD                  ,
				NC.FRT_RT_AMT               ,
				NC.PAY_TERM_CD              ,
				NC.BKG_RAT_UT_CD						,
				NC.BKG_PRC_CGO_TP_CD				,
				NC.BKG_IMDG_CLSS_CD					,
				NC.BKG_CMDT_DEF_CD          ,
				NC.BKG_SCG_GRP_CMDT_CD      ,
				NC.BKG_USA_SVC_MOD_CD       ,
				NC.BKG_POR_DEF_CD           ,
				NC.BKG_POL_DEF_CD           ,
				NC.BKG_POD_DEF_CD           ,
				NC.BKG_DEL_DEF_CD           ,
				NC.BKG_ORG_TRSP_MOD_CD      ,
				NC.BKG_DEST_TRSP_MOD_CD     ,
				NC.BKG_RCV_TERM_CD          ,
				NC.BKG_DE_TERM_CD           ,
				NC.BKG_SLAN_CD              ,
				NC.BKG_VSL_CD               ,
				NC.BKG_SKD_VOY_NO           ,
				NC.BKG_SKD_DIR_CD           ,
				NC.BKG_SOC_FLG              ,
				NC.BKG_ACT_CUST_CNT_CD      ,
				NC.BKG_ACT_CUST_SEQ         ,
				NC.BKG_TS_PORT_DEF_CD       ,
				NC.BKG_DIR_CALL_FLG         ,
				NVL(NC.CONV_RAT_UT_CD, BQ.CTRT_CNTR_TPSZ_CD)	CONV_RAT_UT_CD						,
				DECODE(NVL(NC.CONV_PRC_CGO_TP_CD, BQ.DR_TP), 'DR', 'DR')	CONV_DR_TP		,
				DECODE(NVL(NC.CONV_PRC_CGO_TP_CD, BQ.DG_TP), 'DG', 'DG')	CONV_DG_TP		,
				DECODE(NVL(NC.CONV_PRC_CGO_TP_CD,	BQ.RF_TP), 'RF', 'RF')	CONV_RF_TP		,
				DECODE(NVL(NC.CONV_PRC_CGO_TP_CD, BQ.AK_TP), 'AK', 'AK')	CONV_AK_TP		,
				DECODE(NVL(NC.CONV_PRC_CGO_TP_CD, BQ.BB_TP), 'BB', 'BB')	CONV_BB_TP		,
				NC.CONV_CMDT_TP_CD          ,
				NC.CONV_CMDT_DEF_CD         ,
				NVL(NC.CONV_ORG_LOC_TP_CD, 'L')								CONV_ORG_LOC_TP_CD        ,
				NVL(NC.CONV_ORG_LOC_DEF_CD, BQ.POR_CD)      	CONV_ORG_LOC_DEF_CD       ,
				NVL(NC.CONV_ORG_VIA_LOC_TP_CD, 'L')						CONV_ORG_VIA_LOC_TP_CD    ,
				NVL(NC.CONV_ORG_VIA_LOC_DEF_CD, BQ.POL_CD)		CONV_ORG_VIA_LOC_DEF_CD   ,
				NVL(NC.CONV_DEST_VIA_LOC_TP_CD, 'L')					CONV_DEST_VIA_LOC_TP_CD   ,
				NVL(NC.CONV_DEST_VIA_LOC_DEF_CD, BQ.POD_CD)		CONV_DEST_VIA_LOC_DEF_CD	,
				NVL(NC.CONV_DEST_LOC_TP_CD, 'L')							CONV_DEST_LOC_TP_CD			  ,
				NVL(NC.CONV_DEST_LOC_DEF_CD, BQ.DEL_CD)     	CONV_DEST_LOC_DEF_CD      ,
				NVL(NC.CONV_PRC_RCV_TERM_CD, BQ.RCV_TERM_CD)	CONV_PRC_RCV_TERM_CD      ,
				NVL(NC.CONV_PRC_DE_TERM_CD, BQ.DE_TERM_CD)		CONV_PRC_DE_TERM_CD				,

				'RAP : '
				||	NVL(NC.BKG_CMDT_DEF_CD, NC.BKG_SCG_GRP_CMDT_CD)
				||	' = '
				||	NC.CONV_CMDT_DEF_CD
				||	' ' || NC.RT_OP_CD || ' ' || TO_CHAR(NC.FRT_RT_AMT, 'FM999999990.000') || ' (' || NC.NOTE_CONV_TP_CD || ')'
				RAP_CONV_CTNT									,

				'RAR : '
				||	NVL(NC.BKG_POR_DEF_CD, 'N/A') || '-' || NVL(NC.BKG_POL_DEF_CD, 'N/A') || '-' || NVL(NC.BKG_POD_DEF_CD, 'N/A') || '-' || NVL(NC.BKG_DEL_DEF_CD, 'N/A')
				||	' = '
				||	NVL(NC.CONV_ORG_LOC_DEF_CD, 'N/A') || '-' || NVL(NC.CONV_ORG_VIA_LOC_DEF_CD, 'N/A') || '-' || NVL(NC.CONV_DEST_VIA_LOC_DEF_CD, 'N/A') || '-' || NVL(NC.CONV_DEST_LOC_DEF_CD, 'N/A')
				||	' ' || NC.RT_OP_CD || ' ' || TO_CHAR(NC.FRT_RT_AMT, 'FM999999990.000') || ' (' || NC.NOTE_CONV_TP_CD || ')'
				RAR_CONV_CTNT									,

				'DOR : '
				||	'RCV:' || NC.BKG_RCV_TERM_CD || '/DEL:' || NC.BKG_DE_TERM_CD
				||	' = '
				||	'RCV:' || NC.CONV_PRC_RCV_TERM_CD || '/DEL:' || NC.CONV_PRC_RCV_TERM_CD
				||	' ' || NC.RT_OP_CD || ' ' || TO_CHAR(NC.FRT_RT_AMT, 'FM999999990.000') || ' (' || NC.NOTE_CONV_TP_CD || ')'
				DOR_CONV_CTNT									,

				'TYP : '
				||	NC.BKG_RAT_UT_CD
				||	' = '
				||	NC.CONV_RAT_UT_CD
				||	' ' || NC.RT_OP_CD || ' ' || TO_CHAR(NC.FRT_RT_AMT, 'FM999999990.000') || ' (' || NC.NOTE_CONV_TP_CD || ')'
				TYP_CONV_CTNT									,

				'RAC : '
				||	NC.BKG_PRC_CGO_TP_CD
				||	' = '
				||	NC.CONV_PRC_CGO_TP_CD
				||	' ' || NC.RT_OP_CD || ' ' || TO_CHAR(NC.FRT_RT_AMT, 'FM999999990.000') || ' (' || NC.NOTE_CONV_TP_CD || ')'
				RAC_CONV_CTNT									,

				'RAS : '
				||	LTRIM(																								NC.BKG_RAT_UT_CD
				||	DECODE(NC.BKG_PRC_CGO_TP_CD			, NULL, NULL, '-') ||	NC.BKG_PRC_CGO_TP_CD
				||	DECODE(NC.BKG_IMDG_CLSS_CD			, NULL, NULL, '-') ||	NC.BKG_IMDG_CLSS_CD
				||	DECODE(NC.BKG_POR_DEF_CD      	, NULL, NULL, '-') || NC.BKG_POR_DEF_CD
				||	DECODE(NC.BKG_POL_DEF_CD      	, NULL, NULL, '-') || NC.BKG_POL_DEF_CD
				||	DECODE(NC.BKG_POD_DEF_CD      	, NULL, NULL, '-') || NC.BKG_POD_DEF_CD
				||	DECODE(NC.BKG_DEL_TP_CD       	, NULL, NULL, '-') || NC.BKG_DEL_TP_CD
				||	DECODE(NC.BKG_CMDT_DEF_CD     	, NULL, NULL, '-') || NC.BKG_CMDT_DEF_CD
				||	DECODE(NC.BKG_SCG_GRP_CMDT_CD 	, NULL, NULL, '-') || NC.BKG_SCG_GRP_CMDT_CD
				||	DECODE(NC.BKG_ORG_TRSP_MOD_CD 	, NULL, NULL, '-') || NC.BKG_ORG_TRSP_MOD_CD
				||	DECODE(NC.BKG_DEST_TRSP_MOD_CD	, NULL, NULL, '-') || NC.BKG_DEST_TRSP_MOD_CD
				||	DECODE(NC.BKG_RCV_TERM_CD     	, NULL, NULL, '-') || NC.BKG_RCV_TERM_CD
				||	DECODE(NC.BKG_DE_TERM_CD      	, NULL, NULL, '-') || NC.BKG_DE_TERM_CD
				||	DECODE(NC.BKG_SLAN_CD         	, NULL, NULL, '-') || NC.BKG_SLAN_CD
				||	DECODE(NC.BKG_DIR_CALL_FLG    	, NULL, NULL, '-') || NC.BKG_DIR_CALL_FLG
				||	DECODE(NC.BKG_TS_PORT_DEF_CD  	, NULL, NULL, '-') || NC.BKG_TS_PORT_DEF_CD
				||	DECODE(NC.BKG_VSL_CD          	, NULL, NULL, '-') || NC.BKG_VSL_CD
				||	DECODE(NC.BKG_SKD_VOY_NO      	, NULL, NULL, '-') || NC.BKG_SKD_VOY_NO
				||	DECODE(NC.BKG_SKD_DIR_CD      	, NULL, NULL, '-') || NC.BKG_SKD_DIR_CD
				||	DECODE(NC.BKG_ACT_CUST_CNT_CD 	, NULL, NULL, '-') || NC.BKG_ACT_CUST_CNT_CD
				||	DECODE(NC.BKG_ACT_CUST_SEQ    	, NULL, NULL, '-') || NC.BKG_ACT_CUST_SEQ
				||	DECODE(NC.BKG_SOC_FLG         	, NULL, NULL, '-') || NC.BKG_SOC_FLG
				||	DECODE(NC.BKG_USA_SVC_MOD_CD  	, NULL, NULL, '-') || NC.BKG_USA_SVC_MOD_CD
						, '-')
				||	' = '
				||	' ' || NC.RT_OP_CD || ' ' || TO_CHAR(NC.FRT_RT_AMT, 'FM999999990.000') || ' (' || NC.NOTE_CONV_TP_CD || ')'
				RAS_CONV_CTNT

FROM		BQ														,
				(
				SELECT	NC.*
				FROM		BK										,
								PRI_SC_NOTE_CONV	NC
				WHERE		NC.PROP_NO		= BK.PROP_NO
				AND			NC.AMDT_SEQ		= BK.AMDT_SEQ
				AND			NC.SVC_SCP_CD	= BK.SVC_SCP_CD
				AND			BK.RT_APLY_DT BETWEEN NC.EFF_DT AND NC.EXP_DT + 0.99999		/* 0.99999 는 23시 59분 59초를 의미 */
				UNION ALL
				SELECT	NC.*
				FROM		BK										,
								PRI_SC_NOTE_CONV	NC
				WHERE		NC.SVC_SCP_CD		= BK.SVC_SCP_CD
				AND			NC.NOTE_HDR_SEQ	= BK.NOTE_HDR_SEQ
				AND			BK.RT_APLY_DT BETWEEN NC.EFF_DT AND NC.EXP_DT + 0.99999		/* 0.99999 는 23시 59분 59초를 의미 */
				)	NC													,
				PRI_SP_SCP_RT_CNOTE				CN	,
				PRI_SP_SCP_RT_CMDT_RNOTE	RN
WHERE		CN.NOTE_CONV_MAPG_ID(+) = NC.NOTE_CONV_MAPG_ID
AND			CN.SRC_INFO_CD(+)				<> 'AD'
AND			RN.NOTE_CONV_MAPG_ID(+) = NC.NOTE_CONV_MAPG_ID
AND			RN.SRC_INFO_CD(+)				<> 'AD'

/*******************************************************************************************
NOT RULE CODE 는 SURCHARGE 에서만 사용된다.
*******************************************************************************************/

AND			NC.CHG_RULE_TP_CD			= 'R'
AND			NC.NOTE_CONV_RULE_CD	<> 'NOT'							/* RULE CODE 'NOT' 은 SURCHARGE 에서만 사용 됨 */
AND			NVL(NC.RULE_APPL_CHG_TP_CD, 'O')	= 'O'			/* OCEAN FREIGHT 를 대상으로 함 */


/*******************************************************************************************
< RATING UNIT >
*******************************************************************************************/
AND			(
								NC.BKG_RAT_UT_CD	IS NULL
						OR	NC.BKG_RAT_UT_CD	= BQ.CTRT_CNTR_TPSZ_CD
						OR	NC.BKG_RAT_UT_CD	IN ( 'BX', 'BL' )
        		OR
 		    		(
     						NC.BKG_RAT_UT_CD	IN ( '20', '40', 'HC', '45', '53' )
   					AND ( SELECT A.CNTR_SZ_CD FROM PRI_RAT_UT A WHERE A.RAT_UT_CD = NC.BKG_RAT_UT_CD )	= BQ.CTRT_CNTR_SZ_CD
   					)
				)


/*******************************************************************************************
< CARGO TYPE >
*******************************************************************************************/
AND			(
						NC.BKG_PRC_CGO_TP_CD	IS NULL
				OR	NC.BKG_PRC_CGO_TP_CD	IN ( BQ.DR_TP, BQ.DG_TP, BQ.RF_TP, BQ.AK_TP, BQ.BB_TP )
				)


/*******************************************************************************************
< IMDG CLASS >
NOTE CONV 의 IMDG CLSS CD 가 BKG 의 IMDG_CLSS_CD 의 일부부이라도 적용가능하다.
*******************************************************************************************/
AND			(
						NC.BKG_IMDG_CLSS_CD	IS NULL
				OR	BQ.IMDG_CLSS_CD			LIKE NC.BKG_IMDG_CLSS_CD||'%'
				)


/*******************************************************************************************
< COMMODITY >
GROUP 은 사용하지 않는다.
*******************************************************************************************/
AND			(
						NC.BKG_CMDT_DEF_CD IS NULL
				OR	NC.BKG_CMDT_DEF_CD = DECODE(NC.BKG_CMDT_TP_CD, 'C', BQ.CMDT_CD, 'R', BQ.REP_CMDT_CD)
				)


/*******************************************************************************************
<  USA SVC MOD >
NOTE CONV 에서는 USA SVC MOD CD 에, COMMERCIAL ZONE 도 같이 합쳐서 사용한다.
따라서 NOTE CONV 의 USA SVC MOD CD 가 'CZ' 이면 BKG 의 COMMERCIAL ZONE CD 와 비교한다.
*******************************************************************************************/
AND			(
						NC.BKG_USA_SVC_MOD_CD IS NULL
				OR	NC.BKG_USA_SVC_MOD_CD = DECODE(NC.BKG_USA_SVC_MOD_CD, 'CZ', BQ.CML_ZN_CD, BQ.USA_SVC_MOD_CD )
				)


/*******************************************************************************************
< ROUTE >
STANDARD NOTE 의 경우는 GROUP 을 사용하지 않으므로,
STANDARD NOTE 를 위한 특별한 고려가 필요하지 않음.
*******************************************************************************************/
/* POR */
AND			(
						NC.BKG_POR_DEF_CD IS NULL
				OR	NC.BKG_POR_DEF_CD = DECODE(NC.BKG_POR_TP_CD, 'L', BQ.POR_CD, 'S', BQ.POR_STE_CD, 'R', BQ.POR_RGN_CD, 'C', BQ.POR_CNT_CD)
				OR	(
								NC.BKG_POR_TP_CD	= 'G'
						AND EXISTS	(
												SELECT	'X'
												FROM 		GL
												WHERE		GL.PRC_GRP_LOC_CD	=	NC.BKG_POR_DEF_CD
												AND			GL.LOC_CD					= BQ.POR_CD
												)
						)
				)
/* POL */
AND			(
						NC.BKG_POL_DEF_CD IS NULL
				OR	NC.BKG_POL_DEF_CD = DECODE(NC.BKG_POL_TP_CD, 'L', BQ.POL_CD, 'S', BQ.POL_STE_CD, 'R', BQ.POL_RGN_CD, 'C', BQ.POL_CNT_CD)
				OR	(
								NC.BKG_POL_TP_CD	= 'G'
						AND EXISTS	(
												SELECT	'X'
												FROM 		GL
												WHERE		GL.PRC_GRP_LOC_CD	=	NC.BKG_POL_DEF_CD
												AND			GL.LOC_CD					= BQ.POL_CD
												)
							)
				)
/* POD */
AND			(
						NC.BKG_POD_DEF_CD IS NULL
				OR	NC.BKG_POD_DEF_CD = DECODE(NC.BKG_POD_TP_CD, 'L', BQ.POD_CD, 'S', BQ.POD_STE_CD, 'R', BQ.POD_RGN_CD, 'C', BQ.POD_CNT_CD)
				OR	(
								NC.BKG_POD_TP_CD	= 'G'
						AND EXISTS	(
												SELECT	'X'
												FROM 		GL
												WHERE		GL.PRC_GRP_LOC_CD	=	NC.BKG_POD_DEF_CD
												AND			GL.LOC_CD					= BQ.POD_CD
												)
						)
				)
/* DEL */
AND			(
						NC.BKG_DEL_DEF_CD IS NULL
				OR	NC.BKG_DEL_DEF_CD = DECODE(NC.BKG_DEL_TP_CD, 'L', BQ.DEL_CD, 'S', BQ.DEL_STE_CD, 'R', BQ.DEL_RGN_CD, 'C', BQ.DEL_CNT_CD)
				OR	(
								NC.BKG_DEL_TP_CD	= 'G'
						AND EXISTS	(
												SELECT	'X'
												FROM 		GL
												WHERE		GL.PRC_GRP_LOC_CD	=	NC.BKG_DEL_DEF_CD
												AND			GL.LOC_CD					= BQ.DEL_CD
												)
							)
				)


/*******************************************************************************************
ORG DEST TRANS MOD
*******************************************************************************************/

AND			(
						NC.BKG_ORG_TRSP_MOD_CD	IS NULL
				OR	BQ.ORG_TRNS_MOD_CD			IS NULL
				OR	NC.BKG_ORG_TRSP_MOD_CD	= BQ.ORG_TRNS_MOD_CD
				)

AND			(
						NC.BKG_DEST_TRSP_MOD_CD	IS NULL
				OR	BQ.DEST_TRNS_MOD_CD			IS NULL
				OR	NC.BKG_DEST_TRSP_MOD_CD	= BQ.DEST_TRNS_MOD_CD
				)


/*******************************************************************************************
RCV DE TERM
*******************************************************************************************/

AND			(
					  NC.BKG_RCV_TERM_CD IS NULL
				OR	NC.BKG_RCV_TERM_CD = BQ.RCV_TERM_CD
				)

AND			(
						NC.BKG_DE_TERM_CD IS NULL
				OR	NC.BKG_DE_TERM_CD = BQ.DE_TERM_CD
				)


/*******************************************************************************************
< LANE & VVD >
TRUNK, T/S 구분없이 LANE 이나 VVD 가 존재하는지 여부로 판단한다.
*******************************************************************************************/
AND			EXISTS	(
								SELECT	'X'
								FROM		BKG_VVD	BV
								WHERE		BV.BKG_NO			=	BQ.BKG_NO
								AND			BV.SLAN_CD		= NVL(NC.BKG_SLAN_CD, BV.SLAN_CD)
								AND			BV.VSL_CD			= NVL(NC.BKG_VSL_CD, BV.VSL_CD)
								AND			BV.SKD_VOY_NO	= NVL(NC.BKG_SKD_VOY_NO, BV.SKD_VOY_NO)
								AND			BV.SKD_DIR_CD	= NVL(NC.BKG_SKD_DIR_CD, BV.SKD_DIR_CD)
								AND			@[ca_flg]			= 'N'

								UNION ALL

								SELECT	'X'
								FROM		BKG_VVD_HIS	BV
								WHERE		BV.BKG_NO			=	BQ.BKG_NO
								AND			BV.CORR_NO		= BQ.CORR_NO
								AND			BV.SLAN_CD		= NVL(NC.BKG_SLAN_CD, BV.SLAN_CD)
								AND			BV.VSL_CD			= NVL(NC.BKG_VSL_CD, BV.VSL_CD)
								AND			BV.SKD_VOY_NO	= NVL(NC.BKG_SKD_VOY_NO, BV.SKD_VOY_NO)
								AND			BV.SKD_DIR_CD	= NVL(NC.BKG_SKD_DIR_CD, BV.SKD_DIR_CD)
								AND			@[ca_flg]			= 'Y'
								)


/*******************************************************************************************
SOC
*******************************************************************************************/

AND			(
						NC.BKG_SOC_FLG	IS NULL
				OR	NC.BKG_SOC_FLG	= BQ.SOC_FLG
				)


/*******************************************************************************************
ACT CUST 
*******************************************************************************************/

AND			(
						(
								NC.BKG_ACT_CUST_CNT_CD	IS NULL
						AND NC.BKG_ACT_CUST_SEQ			IS NULL
						)
						OR
						(
								NC.BKG_ACT_CUST_CNT_CD	= BQ.AGMT_ACT_CNT_CD
						AND NC.BKG_ACT_CUST_SEQ			= BQ.AGMT_ACT_CUST_SEQ
						)
				)


/*******************************************************************************************
< T/S PORT >
T/S 가 발생하는 PORT 를 대상으로 한다.
*******************************************************************************************/
AND			(
						NC.BKG_TS_PORT_DEF_CD IS NULL
				OR	EXISTS	(
										SELECT	'X'
										FROM		BKG_VVD				V1	,
														BKG_VVD 			V2	,
														MDM_LOCATION	LO
										WHERE		V2.BKG_NO			=	V1.BKG_NO
										AND			V2.POL_CD			= V1.POD_CD
										AND			LO.LOC_CD			= V1.POD_CD
										AND			V1.BKG_NO			=	BQ.BKG_NO
										AND			DECODE(NC.BKG_TS_PORT_TP_CD, 'L', LO.LOC_CD, 'S', LO.CNT_CD||LO.STE_CD, 'R', LO.RGN_CD, 'C', LO.CNT_CD) = NC.BKG_TS_PORT_DEF_CD
										AND			@[ca_flg]			= 'N'
										
										UNION ALL

										SELECT	'X'
										FROM		BKG_VVD_HIS		V1	,
														BKG_VVD_HIS 	V2	,
														MDM_LOCATION	LO
										WHERE		V2.BKG_NO			=	V1.BKG_NO
										AND			V2.CORR_NO		= V1.CORR_NO
										AND			V2.POL_CD			= V1.POD_CD
										AND			LO.LOC_CD			= V1.POD_CD
										AND			V1.BKG_NO			=	BQ.BKG_NO
										AND			V1.CORR_NO		= BQ.CORR_NO
										AND			DECODE(NC.BKG_TS_PORT_TP_CD, 'L', LO.LOC_CD, 'S', LO.CNT_CD||LO.STE_CD, 'R', LO.RGN_CD, 'C', LO.CNT_CD) = NC.BKG_TS_PORT_DEF_CD
										AND			@[ca_flg]			= 'Y'
										)
				)
/* DIR CALL */
AND			(
						NC.BKG_DIR_CALL_FLG	IS NULL
				OR	NC.BKG_DIR_CALL_FLG	= BQ.DIR_CALL_FLG
				)

)	,
NC_P AS
(

/*******************************************************************************************
적용될 CONVERSION 이 같은 NOTE_CONV_TP_CD 에서 하나의 NOTE_CONV_RULE_CD 가 되도록 우선순위가 낮은 것을 제거한다.
우선순위가 똑같은 경우에는 NOTE_CONV_MAPG_ID||LPAD(NOTE_CONV_SEQ, 6, '0') 가 적은 것을 우선한다.

'RAP', 'RAR', 'DOR', 'TYP', 'RAC' 5개의 RULE CODE 를 가진 BKG DATA 를 UNION ALL 로 추가한다.
이 부분은 계약과 BKG 를 직접 비교하지 않고, NOTE CONV 와만 비교하도록 하기 위함이다.
*******************************************************************************************/

SELECT	NC.BQ_SEQ										,
				NC.NOTE_CONV_MAPG_ID				,
				NC.NOTE_CONV_SEQ						,
				10 + ROW_NUMBER() OVER ( PARTITION BY NC.BQ_SEQ ORDER BY NC.NOTE_CONV_RULE_CD, NVL(NC.GEN_SPCL_RT_TP_CD,0), NC.CONV_TP_PRIO DESC, NVL(NC.CMDT_HDR_SEQ, 0), NVL(NC.ROUT_SEQ, 0) )	NC_SEQ	,	/* BKG 과 겹치지 않도록 임의의 상수 10 을 더한다. */
				'C'	BKG_CONV_TP_CD					,
				NC.GEN_SPCL_RT_TP_CD				,
				NC.CMDT_HDR_SEQ							,
				NC.ROUT_SEQ									,
				NC.CONV_TP_PRIO							,
				NC.NOTE_CONV_TP_CD					,
				NC.NOTE_CONV_CHG_CD					,
				NC.NOTE_CONV_RULE_CD				,
				NC.CONV_RAT_UT_CD						,
				( SELECT A.CNTR_SZ_CD FROM PRI_RAT_UT A WHERE A.RAT_UT_CD = NC.CONV_RAT_UT_CD ) CONV_RAT_UT_SZ_CD		,
				NC.CONV_DR_TP								,
				NC.CONV_DG_TP								,
				NC.CONV_RF_TP								,
				NC.CONV_AK_TP								,
				NC.CONV_BB_TP								,
				NC.CONV_CMDT_TP_CD					,
				NC.CONV_CMDT_DEF_CD					,
				NC.CONV_ORG_LOC_TP_CD				,
				NC.CONV_ORG_LOC_DEF_CD			,
				NC.CONV_ORG_VIA_LOC_TP_CD		,
				NC.CONV_ORG_VIA_LOC_DEF_CD	,
				NC.CONV_DEST_VIA_LOC_TP_CD	,
				NC.CONV_DEST_VIA_LOC_DEF_CD	,
				NC.CONV_DEST_LOC_TP_CD			,
				NC.CONV_DEST_LOC_DEF_CD			,
				NC.CONV_PRC_RCV_TERM_CD			,
				NC.CONV_PRC_DE_TERM_CD			,
				NC.BKG_RAT_UT_CD						,
				NC.BKG_PRC_CGO_TP_CD				,
				NC.BKG_IMDG_CLSS_CD					,
				NC.RT_APPL_TP_CD						,
				NC.RT_OP_CD									,
				NC.CURR_CD									,
				NC.FRT_RT_AMT								,
				NC.RAP_CONV_CTNT						,
				NC.RAR_CONV_CTNT						,
				NC.DOR_CONV_CTNT						,
				NC.TYP_CONV_CTNT						,
				NC.RAC_CONV_CTNT						,
				NC.RAS_CONV_CTNT
FROM		NC
WHERE		NOT EXISTS	(										/* CHECK CHECK CHECK CHECK CHECK */
										SELECT	'X'
									 	FROM		NC A
									 	WHERE	A.BQ_SEQ						= NC.BQ_SEQ
									 	AND		A.NOTE_CONV_RULE_CD	= NC.NOTE_CONV_RULE_CD
									 	AND		A.NOTE_CONV_TP_CD		= NC.NOTE_CONV_TP_CD
									 	AND		NVL(A.GEN_SPCL_RT_TP_CD,'*') = NVL(NC.GEN_SPCL_RT_TP_CD,'*')
									 	AND		A.CMDT_HDR_SEQ			= NC.CMDT_HDR_SEQ
									 	AND		A.ROUT_SEQ					= NC.ROUT_SEQ
									 	AND		(
									 						A.MTCH_PRIO			> NC.MTCH_PRIO
									 				OR	(
									 								A.MTCH_PRIO			= NC.MTCH_PRIO
									 						AND	A.NOTE_CONV_MAPG_ID||LPAD(A.NOTE_CONV_SEQ, 6, '0')	< NC.NOTE_CONV_MAPG_ID||LPAD(NC.NOTE_CONV_SEQ, 6, '0')
									 						)
									 				)
										)
UNION ALL
SELECT	BQ.BQ_SEQ																				,
				NULL									NOTE_CONV_MAPG_ID					,
				NULL									NOTE_CONV_SEQ							,
				ROW_NUMBER() OVER ( PARTITION BY BQ.BQ_SEQ ORDER BY 1 )	NC_SEQ	,
				'B'										BKG_CONV_TP_CD						,
				NULL									GEN_SPCL_RT_TP_CD					,
				0											CMDT_HDR_SEQ							,
				0											ROUT_SEQ									,
				0											CONV_TP_PRIO							, /* BKG 의 CONV_TP_PRIO 는 0 으로 어떤 CONV 보다 높은 우선 순위를 가지게 한다. */
				NULL									NOTE_CONV_TP_CD						,
				NULL									NOTE_CONV_CHG_CD					,
				RC.NOTE_CONV_RULE_CD	NOTE_CONV_RULE_CD					,
				BQ.CTRT_CNTR_TPSZ_CD	CONV_RAT_UT_CD						,
				( SELECT A.CNTR_SZ_CD FROM PRI_RAT_UT A WHERE A.RAT_UT_CD = BQ.CTRT_CNTR_TPSZ_CD )	CONV_RAT_UT_SZ_CD		,
				BQ.DR_TP							CONV_DR_TP								,
				BQ.DG_TP							CONV_DG_TP								,
				BQ.RF_TP							CONV_RF_TP								,
				BQ.AK_TP							CONV_AK_TP								,
				BQ.BB_TP							CONV_BB_TP								,
				'C'										CONV_CMDT_TP_CD						,
				BQ.CMDT_CD						CONV_CMDT_DEF_CD					,
				'L'										CONV_ORG_LOC_TP_CD				,
				BQ.POR_CD							CONV_ORG_LOC_DEF_CD				,
				'L'										CONV_ORG_VIA_LOC_TP_CD		,
				BQ.POL_CD							CONV_ORG_VIA_LOC_DEF_CD		,
				'L'										CONV_DEST_VIA_LOC_TP_CD		,
				BQ.POD_CD							CONV_DEST_VIA_LOC_DEF_CD	,
				'L'										CONV_DEST_LOC_TP_CD				,
				BQ.DEL_CD							CONV_DEST_LOC_DEF_CD			,
				BQ.RCV_TERM_CD				CONV_PRC_RCV_TERM_CD			,
				BQ.DE_TERM_CD					CONV_PRC_DE_TERM_CD				,
				BQ.CTRT_CNTR_TPSZ_CD	BKG_RAT_UT_CD							,
				BQ.PRC_CGO_TP_CD			BKG_PRC_CGO_TP_CD					,
				BQ.IMDG_CLSS_CD				BKG_IMDG_CLSS_CD					,
				NULL									RT_APPL_TP_CD							,
				NULL									RT_OP_CD									,
				NULL									CURR_CD										,
				NULL									FRT_RT_AMT								,
				NULL									RAP_CONV_CTNT							,
				NULL									RAR_CONV_CTNT							,
				NULL									DOR_CONV_CTNT							,
				NULL									TYP_CONV_CTNT							,
				NULL									RAC_CONV_CTNT							,
				NULL									RAS_CONV_CTNT
FROM		BQ	,
				(
				SELECT	'RAP' NOTE_CONV_RULE_CD FROM DUAL UNION ALL
				SELECT	'RAR' NOTE_CONV_RULE_CD FROM DUAL UNION ALL
				SELECT	'DOR' NOTE_CONV_RULE_CD FROM DUAL UNION ALL
				SELECT	'TYP' NOTE_CONV_RULE_CD FROM DUAL UNION ALL
				SELECT	'RAC' NOTE_CONV_RULE_CD FROM DUAL
				) RC
)	,
APP_N AS
(

/*******************************************************************************************
APP RULE CODE 에 존재하지만, BOOKING 과 MATCHING 되지 않은 것을 SELECT 한다.
*******************************************************************************************/

SELECT	BQ.BQ_SEQ		,
				CASE
				WHEN NC.NOTE_CONV_TP_CD = 'C' THEN CN.GEN_SPCL_RT_TP_CD
				WHEN NC.NOTE_CONV_TP_CD = 'R' THEN RN.GEN_SPCL_RT_TP_CD
				ELSE NC.GEN_SPCL_RT_TP_CD
				END GEN_SPCL_RT_TP_CD				,
				CASE
				WHEN NC.NOTE_CONV_TP_CD = 'C' THEN CN.CMDT_HDR_SEQ
				WHEN NC.NOTE_CONV_TP_CD = 'R' THEN RN.CMDT_HDR_SEQ
				ELSE 0
				END CMDT_HDR_SEQ						,
				CASE
				WHEN NC.NOTE_CONV_TP_CD = 'R' THEN RN.ROUT_SEQ
				ELSE 0
				END ROUT_SEQ								,
				(	SELECT A.PRIO_SEQ FROM PRI_NOTE_CONV_TP A WHERE A.PRC_CTRT_TP_CD = BQ.CTRT_TP_CD AND A.NOTE_CONV_TP_CD = NC.NOTE_CONV_TP_CD ) CONV_TP_PRIO
FROM		BQ														,
				(
				SELECT	NC.*
				FROM		BK										,
								PRI_SC_NOTE_CONV	NC
				WHERE		NC.PROP_NO		= BK.PROP_NO
				AND			NC.AMDT_SEQ		= BK.AMDT_SEQ
				AND			NC.SVC_SCP_CD	= BK.SVC_SCP_CD
				AND			BK.RT_APLY_DT BETWEEN NC.EFF_DT AND NC.EXP_DT + 0.99999		/* 0.99999 는 23시 59분 59초를 의미 */
				UNION ALL
				SELECT	NC.*
				FROM		BK										,
								PRI_SC_NOTE_CONV	NC
				WHERE		NC.SVC_SCP_CD		= BK.SVC_SCP_CD
				AND			NC.NOTE_HDR_SEQ	= BK.NOTE_HDR_SEQ
				AND			BK.RT_APLY_DT BETWEEN NC.EFF_DT AND NC.EXP_DT + 0.99999		/* 0.99999 는 23시 59분 59초를 의미 */
				)	NC													,
				PRI_SP_SCP_RT_CNOTE				CN	,
				PRI_SP_SCP_RT_CMDT_RNOTE	RN
WHERE		CN.NOTE_CONV_MAPG_ID(+) = NC.NOTE_CONV_MAPG_ID
AND			CN.SRC_INFO_CD(+)				<> 'AD'
AND			RN.NOTE_CONV_MAPG_ID(+) = NC.NOTE_CONV_MAPG_ID
AND			RN.SRC_INFO_CD(+)				<> 'AD'
AND			NC.CHG_RULE_TP_CD			= 'R'
AND			NC.NOTE_CONV_RULE_CD	= 'APP'								/* APP 만 SELECT */
AND			(
						NC.RULE_APPL_CHG_TP_CD	IS NULL
				OR	NC.RULE_APPL_CHG_TP_CD	= 'O'						/* OCEAN FREIGHT 를 대상으로 함 */
				)
/* APPLICATION TYPE */
AND			NC.RT_APPL_TP_CD = 'S'	-- Subject
AND			NOT EXISTS	(												/* CHECK CHECK CHECK CHECK CHECK */
										SELECT	'X'
										FROM		NC A
										WHERE		A.BQ_SEQ	= BQ.BQ_SEQ
										AND			A.NOTE_CONV_MAPG_ID	= NC.NOTE_CONV_MAPG_ID
										AND			A.NOTE_CONV_SEQ			= NC.NOTE_CONV_SEQ
										)
) ,
OI AS
(
/*******************************************************************************************
	ORIGIN IHC

COMMODITY, D.CALL, VIA 가 없음.
ZIP CODE 는 추가로 존재함. ( ZIP CODE 는 사용하지 않기로 결정 )
*******************************************************************************************/

SELECT  BQ.BQ_SEQ 							,
				OI.ADD_CHG_SEQ					,
				OI.ROUT_PNT_LOC_TP_CD		,
				OI.ROUT_PNT_LOC_DEF_CD	,
				OI.BSE_PORT_TP_CD				,
				OI.BSE_PORT_DEF_CD			,
				OI.VIA_PORT_TP_CD				,
				OI.VIA_PORT_DEF_CD			,
				OI.DIR_CALL_FLG					,
				OI.RAT_UT_CD						,
				OI.PRC_CGO_TP_CD				,
				OI.PRC_TRSP_MOD_CD			,
				OI.RCV_DE_TERM_CD				,
				OI.PRC_CMDT_TP_CD				,
				OI.PRC_CMDT_DEF_CD			,
				OI.CURR_CD							,
				OI.FNL_FRT_RT_AMT				,

				DECODE(OI.RAT_UT_CD, BQ.CTRT_CNTR_TPSZ_CD, 100, 'BX', 80, 60)
				 	- DECODE(OI.RAT_UT_CD, '20', 10, '40', 10, 'HC', 10, '45', 10, '53', 10, 0)
				 	+ DECODE(OI.PRC_CGO_TP_CD, BQ.DR_TP, 2, BQ.DG_TP, 2, BQ.RF_TP, 2, BQ.AK_TP, 2, BQ.BB_TP, 2, 0)
				 	- DECODE(BQ.CTRT_CNTR_TPSZ_CD||BQ.AK_TP||OI.PRC_CGO_TP_CD, 'D7AKDR', 1, 0)	RAT_UT_MTCH_PRIO
						/* D7/AK 가 D7/DR 과 D7/AK 중에 D7/AK 가 먼저 선택 될 수 있도록 D7/AK 면서 DR 운임적인된 경우 -1 을 해준다. */

FROM    BQ  ,
        PRI_SP_SCP_TRSP_ADD_CHG   OI
WHERE   OI.PROP_NO                = BQ.PROP_NO
AND     OI.AMDT_SEQ               = BQ.AMDT_SEQ
AND     OI.SVC_SCP_CD             = BQ.SVC_SCP_CD
AND     OI.ADD_CHG_TP_CD          = 'I'
AND     OI.ORG_DEST_TP_CD         = 'O'
AND			OI.SRC_INFO_CD						<> 'AD'

/*******************************************************************************************
	1.	 ORIGIN IHC - ROUTE
*******************************************************************************************/

/*******************************************************************************************
< POINT ( POR ) >
*******************************************************************************************/

AND     ( OI.ROUT_PNT_LOC_TP_CD, OI.ROUT_PNT_LOC_DEF_CD ) IN
				(
				SELECT  A.CONV_ORG_LOC_TP_CD, A.CONV_ORG_LOC_DEF_CD
				FROM		NC_P A
				WHERE		A.BQ_SEQ 						= BQ.BQ_SEQ
				AND			A.NOTE_CONV_RULE_CD	= 'RAR'
				UNION ALL
				SELECT  'L', GL.LOC_CD
				FROM		NC_P A	,
								GL
				WHERE		A.BQ_SEQ 							= BQ.BQ_SEQ
				AND			A.NOTE_CONV_RULE_CD		= 'RAR'
				AND			A.CONV_ORG_LOC_TP_CD	= 'G'
				AND		  GL.PRC_GRP_LOC_CD 		= A.CONV_ORG_LOC_DEF_CD
				UNION ALL
				SELECT  'G', GL.PRC_GRP_LOC_CD
				FROM		NC_P A	,
								GL
				WHERE		A.BQ_SEQ 						= BQ.BQ_SEQ
				AND			A.NOTE_CONV_RULE_CD	= 'RAR'
				AND			A.CONV_ORG_LOC_TP_CD	= 'L'
				AND     GL.LOC_CD						= A.CONV_ORG_LOC_DEF_CD
				)


/*******************************************************************************************
< RCV TERM >
*******************************************************************************************/

AND     NVL(OI.RCV_DE_TERM_CD, '*') IN
				(
				SELECT  B.RCV_DE_TERM_CD
				FROM		NC_P A	,
								(
								SELECT 'Y' CONV_PRC_TERM_CD, 'Y' RCV_DE_TERM_CD FROM DUAL UNION ALL
								SELECT 'Y' CONV_PRC_TERM_CD, 'L' RCV_DE_TERM_CD FROM DUAL UNION ALL
								SELECT 'Y' CONV_PRC_TERM_CD, '*' RCV_DE_TERM_CD FROM DUAL UNION ALL
								SELECT 'S' CONV_PRC_TERM_CD, 'S' RCV_DE_TERM_CD FROM DUAL UNION ALL
								SELECT 'S' CONV_PRC_TERM_CD, 'Y' RCV_DE_TERM_CD FROM DUAL UNION ALL
								SELECT 'S' CONV_PRC_TERM_CD, 'T' RCV_DE_TERM_CD FROM DUAL UNION ALL
								SELECT 'S' CONV_PRC_TERM_CD, 'I' RCV_DE_TERM_CD FROM DUAL UNION ALL
								SELECT 'S' CONV_PRC_TERM_CD, 'L' RCV_DE_TERM_CD FROM DUAL UNION ALL
								SELECT 'S' CONV_PRC_TERM_CD, '*' RCV_DE_TERM_CD FROM DUAL UNION ALL
								SELECT 'D' CONV_PRC_TERM_CD, 'D' RCV_DE_TERM_CD FROM DUAL UNION ALL
								SELECT 'T' CONV_PRC_TERM_CD, 'T' RCV_DE_TERM_CD FROM DUAL UNION ALL
								SELECT 'I' CONV_PRC_TERM_CD, 'I' RCV_DE_TERM_CD FROM DUAL
								)	B
				WHERE		A.BQ_SEQ 						= BQ.BQ_SEQ
				AND			A.NOTE_CONV_RULE_CD	= 'DOR'
				AND			B.CONV_PRC_TERM_CD	= A.CONV_PRC_RCV_TERM_CD
				)


/*******************************************************************************************
< ORIGIN TRANS MODE >
*******************************************************************************************/

AND			(
						OI.PRC_TRSP_MOD_CD	IS NULL
				OR	BQ.ORG_TRNS_MOD_CD	IS NULL
				OR	OI.PRC_TRSP_MOD_CD	= BQ.ORG_TRNS_MOD_CD
				OR  (
								OI.PRC_TRSP_MOD_CD	IN ( 'R', 'A' )
						AND	BQ.ORG_TRNS_MOD_CD	= 'R'
						)
				)


/*******************************************************************************************
< BASE PORT ( POL ) >
*******************************************************************************************/

AND     ( OI.BSE_PORT_TP_CD, OI.BSE_PORT_DEF_CD ) IN
				(
				SELECT  A.CONV_ORG_VIA_LOC_TP_CD, A.CONV_ORG_VIA_LOC_DEF_CD
				FROM		NC_P A
				WHERE		A.BQ_SEQ 						= BQ.BQ_SEQ
				AND			A.NOTE_CONV_RULE_CD	= 'RAR'
				UNION ALL
				SELECT  'L', GL.LOC_CD
				FROM		NC_P A	,
								GL
				WHERE		A.BQ_SEQ 									= BQ.BQ_SEQ
				AND			A.NOTE_CONV_RULE_CD				= 'RAR'
				AND			A.CONV_ORG_VIA_LOC_TP_CD	= 'G'
				AND		  GL.PRC_GRP_LOC_CD					= A.CONV_ORG_VIA_LOC_DEF_CD
				UNION ALL
				SELECT  'G', GL.PRC_GRP_LOC_CD
				FROM		NC_P A	,
								GL
				WHERE		A.BQ_SEQ 									= BQ.BQ_SEQ
				AND			A.NOTE_CONV_RULE_CD				= 'RAR'
				AND			A.CONV_ORG_VIA_LOC_TP_CD	= 'L'
				AND     GL.LOC_CD									= A.CONV_ORG_VIA_LOC_DEF_CD
				)


/*******************************************************************************************
	3.	ORIGIN IHC - RATING UNIT
*******************************************************************************************/

/*******************************************************************************************
< ORIGIN IHC RATING UNIT >
*******************************************************************************************/

AND			(
						OI.RAT_UT_CD	IN
						(
						SELECT	'BX'
						FROM		DUAL
						UNION ALL
						SELECT  A.CONV_RAT_UT_CD
						FROM		NC_P A
						WHERE		A.BQ_SEQ 						= BQ.BQ_SEQ
						AND			A.NOTE_CONV_RULE_CD	= 'TYP'
						)
						OR
						(
								OI.RAT_UT_CD  IN ( '20', '40', 'HC', '45', '53' )
            AND ( SELECT A.CNTR_SZ_CD FROM PRI_RAT_UT A WHERE A.RAT_UT_CD = OI.RAT_UT_CD ) IN
            		(
								SELECT  A.CONV_RAT_UT_SZ_CD
								FROM		NC_P A
								WHERE		A.BQ_SEQ 						= BQ.BQ_SEQ
								AND			A.NOTE_CONV_RULE_CD	= 'TYP'
            		)
            )
        )

/*******************************************************************************************
< ORIGIN IHC CARGO TYPE >
*******************************************************************************************/

AND     NVL(OI.PRC_CGO_TP_CD, '*')  IN
				(
				SELECT	'*'
				FROM		DUAL
				UNION ALL
				SELECT  A.CONV_DR_TP
				FROM		NC_P A
				WHERE		A.BQ_SEQ 						= BQ.BQ_SEQ
				AND			A.NOTE_CONV_RULE_CD	= 'RAC'
				UNION ALL
				SELECT  A.CONV_DG_TP
				FROM		NC_P A
				WHERE		A.BQ_SEQ 						= BQ.BQ_SEQ
				AND			A.NOTE_CONV_RULE_CD	= 'RAC'
				UNION ALL
				SELECT  A.CONV_RF_TP
				FROM		NC_P A
				WHERE		A.BQ_SEQ 						= BQ.BQ_SEQ
				AND			A.NOTE_CONV_RULE_CD	= 'RAC'
				UNION ALL
				SELECT  A.CONV_AK_TP
				FROM		NC_P A
				WHERE		A.BQ_SEQ 						= BQ.BQ_SEQ
				AND			A.NOTE_CONV_RULE_CD	= 'RAC'
				UNION ALL
				SELECT  A.CONV_BB_TP
				FROM		NC_P A
				WHERE		A.BQ_SEQ 						= BQ.BQ_SEQ
				AND			A.NOTE_CONV_RULE_CD	= 'RAC'
				)
)	,
OA AS
(

/*******************************************************************************************
	ORIGIN ARB
*******************************************************************************************/

SELECT  BQ.BQ_SEQ								,
				OA.ADD_CHG_SEQ					,
				OA.ROUT_PNT_LOC_TP_CD		,
				OA.ROUT_PNT_LOC_DEF_CD	,
				OA.BSE_PORT_TP_CD				,
				OA.BSE_PORT_DEF_CD			,
				OA.RAT_UT_CD						,
				OA.VIA_PORT_TP_CD				,
				OA.VIA_PORT_DEF_CD			,
				OA.DIR_CALL_FLG					,
				OA.PRC_CGO_TP_CD				,
				OA.PRC_TRSP_MOD_CD			,
				OA.RCV_DE_TERM_CD				,
				OA.PRC_CMDT_TP_CD				,
				OA.PRC_CMDT_DEF_CD			,
				OA.CURR_CD							,
				OA.FNL_FRT_RT_AMT				,

				DECODE(OA.RAT_UT_CD, BQ.CTRT_CNTR_TPSZ_CD, 100, 'BX', 80, 60)
				 	- DECODE(OA.RAT_UT_CD, '20', 10, '40', 10, 'HC', 10, '45', 10, '53', 10, 0)
				 	+ DECODE(OA.PRC_CGO_TP_CD, BQ.DR_TP, 2, BQ.DG_TP, 2, BQ.RF_TP, 2, BQ.AK_TP, 2, BQ.BB_TP, 2, 0)
				 	- DECODE(BQ.CTRT_CNTR_TPSZ_CD||BQ.AK_TP||OA.PRC_CGO_TP_CD, 'D7AKDR', 1, 0)	RAT_UT_MTCH_PRIO	,
						/* D7/AK 가 D7/DR 과 D7/AK 중에 D7/AK 가 먼저 선택 될 수 있도록 D7/AK 면서 DR 운임적인된 경우 -1 을 해준다. */

				CASE
				WHEN	( OA.ROUT_PNT_LOC_TP_CD, OA.ROUT_PNT_LOC_DEF_CD ) IN
							(
							SELECT  A.CONV_ORG_LOC_TP_CD, A.CONV_ORG_LOC_DEF_CD
							FROM		NC_P A
							WHERE		A.BQ_SEQ 						= BQ.BQ_SEQ
							AND			A.NOTE_CONV_RULE_CD	= 'RAR'
							UNION ALL
							SELECT  'L', GL.LOC_CD
							FROM		NC_P A	,
											GL
							WHERE		A.BQ_SEQ 							= BQ.BQ_SEQ
							AND			A.NOTE_CONV_RULE_CD		= 'RAR'
							AND			A.CONV_ORG_LOC_TP_CD	= 'G'
							AND		  GL.PRC_GRP_LOC_CD 		= A.CONV_ORG_LOC_DEF_CD
							UNION ALL
							SELECT  'G', GL.PRC_GRP_LOC_CD
							FROM		NC_P A	,
											GL
							WHERE		A.BQ_SEQ 						= BQ.BQ_SEQ
							AND			A.NOTE_CONV_RULE_CD	= 'RAR'
							AND			A.CONV_ORG_LOC_TP_CD	= 'L'
							AND     GL.LOC_CD						= A.CONV_ORG_LOC_DEF_CD
							)
							THEN 'Y'
				ELSE	'N'
				END	POR_MTCH_FLG

FROM    BQ  ,
        PRI_SP_SCP_TRSP_ADD_CHG   OA
WHERE   OA.PROP_NO                = BQ.PROP_NO
AND     OA.AMDT_SEQ               = BQ.AMDT_SEQ
AND     OA.SVC_SCP_CD             = BQ.SVC_SCP_CD
AND     OA.ADD_CHG_TP_CD          = 'A'
AND     OA.ORG_DEST_TP_CD         = 'O'
AND			OA.SRC_INFO_CD						<> 'AD'

/*******************************************************************************************
	1.	ORIGIN ARB - COMMODITY
*******************************************************************************************/

AND     (
                OA.PRC_CMDT_DEF_CD  IS NULL
            OR	( OA.PRC_CMDT_TP_CD, OA.PRC_CMDT_DEF_CD ) IN
								(
								SELECT  A.CONV_CMDT_TP_CD, A.CONV_CMDT_DEF_CD
								FROM		NC_P A
								WHERE		A.BQ_SEQ 						= BQ.BQ_SEQ
								AND			A.NOTE_CONV_RULE_CD	= 'RAP'
								UNION ALL
								SELECT  'C', GC.PRC_CMDT_DEF_CD
								FROM		NC_P A	,
												GC
								WHERE		A.BQ_SEQ 						= BQ.BQ_SEQ
								AND			A.NOTE_CONV_RULE_CD	= 'RAP'
								AND			A.CONV_CMDT_TP_CD		= 'G'
								AND		  GC.PRC_GRP_CMDT_CD  = A.CONV_CMDT_DEF_CD
								AND     GC.PRC_CMDT_TP_CD   = 'C'
								UNION ALL
								SELECT  'G', GC.PRC_GRP_CMDT_CD
								FROM		NC_P A	,
												GC
								WHERE		A.BQ_SEQ 						= BQ.BQ_SEQ
								AND			A.NOTE_CONV_RULE_CD	= 'RAP'
								AND			A.CONV_CMDT_TP_CD		= 'C'
								AND     GC.PRC_CMDT_TP_CD   = 'C'
								AND     GC.PRC_CMDT_DEF_CD  = A.CONV_CMDT_DEF_CD
								UNION ALL
								/* TAW 일 경우 FAK 고려함 */
								SELECT	'C', CMDT_CD
								FROM		MDM_COMMODITY
								WHERE		REP_CMDT_CD		= '0000'
								UNION ALL
								SELECT	'G', GC.PRC_GRP_CMDT_CD
								FROM		GC
								WHERE		GC.PRC_CMDT_TP_CD		= 'C'
								AND			GC.PRC_CMDT_DEF_CD  IN ( SELECT CMDT_CD FROM MDM_COMMODITY WHERE REP_CMDT_CD = '0000' )
								)
        )


/*******************************************************************************************
	2.	 ORIGIN ARB - ROUTE
*******************************************************************************************/

/*******************************************************************************************
< DIRECT CALL >
BKG 이 DIRECT CALL 이거나,
DIRECT CALL FLAG 가 일치하는 경우
*******************************************************************************************/

AND     DECODE(BQ.DIR_CALL_FLG, 'Y', OA.DIR_CALL_FLG, BQ.DIR_CALL_FLG) = OA.DIR_CALL_FLG


/*******************************************************************************************
< POINT ( POR OR POL ) >
*******************************************************************************************/

AND     ( OA.ROUT_PNT_LOC_TP_CD, OA.ROUT_PNT_LOC_DEF_CD ) IN
				(
				SELECT  A.CONV_ORG_LOC_TP_CD, A.CONV_ORG_LOC_DEF_CD
				FROM		NC_P A
				WHERE		A.BQ_SEQ 						= BQ.BQ_SEQ
				AND			A.NOTE_CONV_RULE_CD	= 'RAR'
				UNION ALL
				SELECT  'L', GL.LOC_CD
				FROM		NC_P A	,
								GL
				WHERE		A.BQ_SEQ 							= BQ.BQ_SEQ
				AND			A.NOTE_CONV_RULE_CD		= 'RAR'
				AND			A.CONV_ORG_LOC_TP_CD	= 'G'
				AND		  GL.PRC_GRP_LOC_CD 		= A.CONV_ORG_LOC_DEF_CD
				UNION ALL
				SELECT  'G', GL.PRC_GRP_LOC_CD
				FROM		NC_P A	,
								GL
				WHERE		A.BQ_SEQ 						= BQ.BQ_SEQ
				AND			A.NOTE_CONV_RULE_CD	= 'RAR'
				AND			A.CONV_ORG_LOC_TP_CD	= 'L'
				AND     GL.LOC_CD						= A.CONV_ORG_LOC_DEF_CD
				UNION ALL
				SELECT  A.CONV_ORG_VIA_LOC_TP_CD, A.CONV_ORG_VIA_LOC_DEF_CD
				FROM		NC_P A
				WHERE		A.BQ_SEQ 						= BQ.BQ_SEQ
				AND			A.NOTE_CONV_RULE_CD	= 'RAR'
				UNION ALL
				SELECT  'L', GL.LOC_CD
				FROM		NC_P A	,
								GL
				WHERE		A.BQ_SEQ 							= BQ.BQ_SEQ
				AND			A.NOTE_CONV_RULE_CD		= 'RAR'
				AND			A.CONV_ORG_VIA_LOC_TP_CD	= 'G'
				AND		  GL.PRC_GRP_LOC_CD 		= A.CONV_ORG_VIA_LOC_DEF_CD
				UNION ALL
				SELECT  'G', GL.PRC_GRP_LOC_CD
				FROM		NC_P A	,
								GL
				WHERE		A.BQ_SEQ 						= BQ.BQ_SEQ
				AND			A.NOTE_CONV_RULE_CD	= 'RAR'
				AND			A.CONV_ORG_VIA_LOC_TP_CD	= 'L'
				AND     GL.LOC_CD						= A.CONV_ORG_VIA_LOC_DEF_CD
				)


/*******************************************************************************************
< ORG VIA PORT ( PRE RELAY ) >
*******************************************************************************************/

AND     (
	     			OA.VIA_PORT_DEF_CD  IS NULL
	     	OR	( OA.VIA_PORT_TP_CD, OA.VIA_PORT_DEF_CD ) IN
						(
						SELECT	'L', BQ.PRE_RLY_PORT_CD
						FROM		DUAL
						UNION ALL
						SELECT  'G', GL.PRC_GRP_LOC_CD
						FROM		GL
						WHERE		GL.LOC_CD						= BQ.PRE_RLY_PORT_CD
						)
        )


/*******************************************************************************************
	3.	ORIGIN ARB - RATING UNIT
*******************************************************************************************/

/*******************************************************************************************
< ORIGIN ARB RATING UNIT >
*******************************************************************************************/

AND			(
						OA.RAT_UT_CD	IN
						(
						SELECT	'BX'
						FROM		DUAL
						UNION ALL
						SELECT  A.CONV_RAT_UT_CD
						FROM		NC_P A
						WHERE		A.BQ_SEQ 						= BQ.BQ_SEQ
						AND			A.NOTE_CONV_RULE_CD	= 'TYP'
						)
						OR
						(
								OA.RAT_UT_CD  IN ( '20', '40', 'HC', '45', '53' )
            AND ( SELECT A.CNTR_SZ_CD FROM PRI_RAT_UT A WHERE A.RAT_UT_CD = OA.RAT_UT_CD ) IN
            		(
								SELECT  A.CONV_RAT_UT_SZ_CD
								FROM		NC_P A
								WHERE		A.BQ_SEQ 						= BQ.BQ_SEQ
								AND			A.NOTE_CONV_RULE_CD	= 'TYP'
            		)
            )
        )

/*******************************************************************************************
< ORIGIN ARB CARGO TYPE >
*******************************************************************************************/

AND     NVL(OA.PRC_CGO_TP_CD, '*')  IN
				(
				SELECT	'*'
				FROM		DUAL
				UNION ALL
				SELECT  A.CONV_DR_TP
				FROM		NC_P A
				WHERE		A.BQ_SEQ 						= BQ.BQ_SEQ
				AND			A.NOTE_CONV_RULE_CD	= 'RAC'
				UNION ALL
				SELECT  A.CONV_DG_TP
				FROM		NC_P A
				WHERE		A.BQ_SEQ 						= BQ.BQ_SEQ
				AND			A.NOTE_CONV_RULE_CD	= 'RAC'
				UNION ALL
				SELECT  A.CONV_RF_TP
				FROM		NC_P A
				WHERE		A.BQ_SEQ 						= BQ.BQ_SEQ
				AND			A.NOTE_CONV_RULE_CD	= 'RAC'
				UNION ALL
				SELECT  A.CONV_AK_TP
				FROM		NC_P A
				WHERE		A.BQ_SEQ 						= BQ.BQ_SEQ
				AND			A.NOTE_CONV_RULE_CD	= 'RAC'
				UNION ALL
				SELECT  A.CONV_BB_TP
				FROM		NC_P A
				WHERE		A.BQ_SEQ 						= BQ.BQ_SEQ
				AND			A.NOTE_CONV_RULE_CD	= 'RAC'
				)

) ,
DI AS
(
/*******************************************************************************************
	DEST IHC

COMMODITY, D.CALL, VIA 가 없음.
ZIP CODE 는 추가로 존재함. ( ZIP CODE 는 사용하지 않기로 결정 )
*******************************************************************************************/

SELECT  BQ.BQ_SEQ 							,
				DI.ADD_CHG_SEQ					,
				DI.ROUT_PNT_LOC_TP_CD		,
				DI.ROUT_PNT_LOC_DEF_CD	,
				DI.BSE_PORT_TP_CD				,
				DI.BSE_PORT_DEF_CD			,
				DI.VIA_PORT_TP_CD				,
				DI.VIA_PORT_DEF_CD			,
				DI.DIR_CALL_FLG					,
				DI.RAT_UT_CD						,
				DI.PRC_CGO_TP_CD				,
				DI.PRC_TRSP_MOD_CD			,
				DI.RCV_DE_TERM_CD				,
				DI.PRC_CMDT_TP_CD				,
				DI.PRC_CMDT_DEF_CD			,
				DI.CURR_CD							,
				DI.FNL_FRT_RT_AMT				,

				DECODE(DI.RAT_UT_CD, BQ.CTRT_CNTR_TPSZ_CD, 100, 'BX', 80, 60)
				 	- DECODE(DI.RAT_UT_CD, '20', 10, '40', 10, 'HC', 10, '45', 10, '53', 10, 0)
				 	+ DECODE(DI.PRC_CGO_TP_CD, BQ.DR_TP, 2, BQ.DG_TP, 2, BQ.RF_TP, 2, BQ.AK_TP, 2, BQ.BB_TP, 2, 0)
				 	- DECODE(BQ.CTRT_CNTR_TPSZ_CD||BQ.AK_TP||DI.PRC_CGO_TP_CD, 'D7AKDR', 1, 0)	RAT_UT_MTCH_PRIO
						/* D7/AK 가 D7/DR 과 D7/AK 중에 D7/AK 가 먼저 선택 될 수 있도록 D7/AK 면서 DR 운임적인된 경우 -1 을 해준다. */

FROM    BQ  ,
        PRI_SP_SCP_TRSP_ADD_CHG   DI
WHERE   DI.PROP_NO                = BQ.PROP_NO
AND     DI.AMDT_SEQ               = BQ.AMDT_SEQ
AND     DI.SVC_SCP_CD             = BQ.SVC_SCP_CD
AND     DI.ADD_CHG_TP_CD          = 'I'
AND     DI.ORG_DEST_TP_CD         = 'D'
AND			DI.SRC_INFO_CD						<> 'AD'

/*******************************************************************************************
	1.	 DEST IHC - ROUTE
*******************************************************************************************/

/*******************************************************************************************
< POINT ( DEL ) >
*******************************************************************************************/

AND     ( DI.ROUT_PNT_LOC_TP_CD, DI.ROUT_PNT_LOC_DEF_CD ) IN
				(
				SELECT  A.CONV_DEST_LOC_TP_CD, A.CONV_DEST_LOC_DEF_CD
				FROM		NC_P A
				WHERE		A.BQ_SEQ 						= BQ.BQ_SEQ
				AND			A.NOTE_CONV_RULE_CD	= 'RAR'
				UNION ALL
				SELECT  'L', GL.LOC_CD
				FROM		NC_P A	,
								GL
				WHERE		A.BQ_SEQ 							= BQ.BQ_SEQ
				AND			A.NOTE_CONV_RULE_CD		= 'RAR'
				AND			A.CONV_DEST_LOC_TP_CD	= 'G'
				AND		  GL.PRC_GRP_LOC_CD 		= A.CONV_DEST_LOC_DEF_CD
				UNION ALL
				SELECT  'G', GL.PRC_GRP_LOC_CD
				FROM		NC_P A	,
								GL
				WHERE		A.BQ_SEQ 						= BQ.BQ_SEQ
				AND			A.NOTE_CONV_RULE_CD	= 'RAR'
				AND			A.CONV_DEST_LOC_TP_CD	= 'L'
				AND     GL.LOC_CD						= A.CONV_DEST_LOC_DEF_CD
				)


/*******************************************************************************************
< DE TERM >
*******************************************************************************************/

AND     NVL(DI.RCV_DE_TERM_CD, '*') IN
				(
				SELECT  B.RCV_DE_TERM_CD
				FROM		NC_P A	,
								(
								SELECT 'Y' CONV_PRC_TERM_CD, 'Y' RCV_DE_TERM_CD FROM DUAL UNION ALL
								SELECT 'Y' CONV_PRC_TERM_CD, 'L' RCV_DE_TERM_CD FROM DUAL UNION ALL
								SELECT 'Y' CONV_PRC_TERM_CD, '*' RCV_DE_TERM_CD FROM DUAL UNION ALL
								SELECT 'S' CONV_PRC_TERM_CD, 'S' RCV_DE_TERM_CD FROM DUAL UNION ALL
								SELECT 'S' CONV_PRC_TERM_CD, 'Y' RCV_DE_TERM_CD FROM DUAL UNION ALL
								SELECT 'S' CONV_PRC_TERM_CD, 'T' RCV_DE_TERM_CD FROM DUAL UNION ALL
								SELECT 'S' CONV_PRC_TERM_CD, 'I' RCV_DE_TERM_CD FROM DUAL UNION ALL
								SELECT 'S' CONV_PRC_TERM_CD, 'L' RCV_DE_TERM_CD FROM DUAL UNION ALL
								SELECT 'S' CONV_PRC_TERM_CD, '*' RCV_DE_TERM_CD FROM DUAL UNION ALL
								SELECT 'D' CONV_PRC_TERM_CD, 'D' RCV_DE_TERM_CD FROM DUAL UNION ALL
								SELECT 'T' CONV_PRC_TERM_CD, 'T' RCV_DE_TERM_CD FROM DUAL UNION ALL
								SELECT 'I' CONV_PRC_TERM_CD, 'I' RCV_DE_TERM_CD FROM DUAL
								)	B
				WHERE		A.BQ_SEQ 						= BQ.BQ_SEQ
				AND			A.NOTE_CONV_RULE_CD	= 'DOR'
				AND			B.CONV_PRC_TERM_CD	= A.CONV_PRC_DE_TERM_CD
				)


/*******************************************************************************************
< DEST TRANS MODE >
*******************************************************************************************/

AND			(
						DI.PRC_TRSP_MOD_CD	IS NULL
				OR	BQ.DEST_TRNS_MOD_CD	IS NULL
				OR	DI.PRC_TRSP_MOD_CD	= BQ.DEST_TRNS_MOD_CD
				OR  (
								DI.PRC_TRSP_MOD_CD	IN ( 'R', 'A' )
						AND	BQ.DEST_TRNS_MOD_CD	= 'R'
						)
				)


/*******************************************************************************************
< BASE PORT ( POD ) >
*******************************************************************************************/

AND     ( DI.BSE_PORT_TP_CD, DI.BSE_PORT_DEF_CD ) IN
				(
				SELECT  A.CONV_DEST_VIA_LOC_TP_CD, A.CONV_DEST_VIA_LOC_DEF_CD
				FROM		NC_P A
				WHERE		A.BQ_SEQ 						= BQ.BQ_SEQ
				AND			A.NOTE_CONV_RULE_CD	= 'RAR'
				UNION ALL
				SELECT  'L', GL.LOC_CD
				FROM		NC_P A	,
								GL
				WHERE		A.BQ_SEQ 									= BQ.BQ_SEQ
				AND			A.NOTE_CONV_RULE_CD				= 'RAR'
				AND			A.CONV_DEST_VIA_LOC_TP_CD	= 'G'
				AND		  GL.PRC_GRP_LOC_CD					= A.CONV_DEST_VIA_LOC_DEF_CD
				UNION ALL
				SELECT  'G', GL.PRC_GRP_LOC_CD
				FROM		NC_P A	,
								GL
				WHERE		A.BQ_SEQ 									= BQ.BQ_SEQ
				AND			A.NOTE_CONV_RULE_CD				= 'RAR'
				AND			A.CONV_DEST_VIA_LOC_TP_CD	= 'L'
				AND     GL.LOC_CD									= A.CONV_DEST_VIA_LOC_DEF_CD
				)


/*******************************************************************************************
	3.	DEST IHC - RATING UNIT
*******************************************************************************************/

/*******************************************************************************************
< DEST IHC RATING UNIT >
*******************************************************************************************/

AND			(
						DI.RAT_UT_CD	IN
						(
						SELECT	'BX'
						FROM		DUAL
						UNION ALL
						SELECT  A.CONV_RAT_UT_CD
						FROM		NC_P A
						WHERE		A.BQ_SEQ 						= BQ.BQ_SEQ
						AND			A.NOTE_CONV_RULE_CD	= 'TYP'
						)
						OR
						(
								DI.RAT_UT_CD  IN ( '20', '40', 'HC', '45', '53' )
            AND ( SELECT A.CNTR_SZ_CD FROM PRI_RAT_UT A WHERE A.RAT_UT_CD = DI.RAT_UT_CD ) IN
            		(
								SELECT  A.CONV_RAT_UT_SZ_CD
								FROM		NC_P A
								WHERE		A.BQ_SEQ 						= BQ.BQ_SEQ
								AND			A.NOTE_CONV_RULE_CD	= 'TYP'
            		)
            )
        )

/*******************************************************************************************
< DEST IHC CARGO TYPE >
*******************************************************************************************/

AND     NVL(DI.PRC_CGO_TP_CD, '*')  IN
				(
				SELECT	'*'
				FROM		DUAL
				UNION ALL
				SELECT  A.CONV_DR_TP
				FROM		NC_P A
				WHERE		A.BQ_SEQ 						= BQ.BQ_SEQ
				AND			A.NOTE_CONV_RULE_CD	= 'RAC'
				UNION ALL
				SELECT  A.CONV_DG_TP
				FROM		NC_P A
				WHERE		A.BQ_SEQ 						= BQ.BQ_SEQ
				AND			A.NOTE_CONV_RULE_CD	= 'RAC'
				UNION ALL
				SELECT  A.CONV_RF_TP
				FROM		NC_P A
				WHERE		A.BQ_SEQ 						= BQ.BQ_SEQ
				AND			A.NOTE_CONV_RULE_CD	= 'RAC'
				UNION ALL
				SELECT  A.CONV_AK_TP
				FROM		NC_P A
				WHERE		A.BQ_SEQ 						= BQ.BQ_SEQ
				AND			A.NOTE_CONV_RULE_CD	= 'RAC'
				UNION ALL
				SELECT  A.CONV_BB_TP
				FROM		NC_P A
				WHERE		A.BQ_SEQ 						= BQ.BQ_SEQ
				AND			A.NOTE_CONV_RULE_CD	= 'RAC'
				)
)	,
DA AS
(

/*******************************************************************************************
	DEST ARB
*******************************************************************************************/

SELECT  BQ.BQ_SEQ 							,
				DA.ADD_CHG_SEQ					,
				DA.ROUT_PNT_LOC_TP_CD		,
				DA.ROUT_PNT_LOC_DEF_CD	,
				DA.BSE_PORT_TP_CD				,
				DA.BSE_PORT_DEF_CD			,
				DA.VIA_PORT_TP_CD				,
				DA.VIA_PORT_DEF_CD			,
				DA.DIR_CALL_FLG					,
				DA.RAT_UT_CD						,
				DA.PRC_CGO_TP_CD				,
				DA.PRC_TRSP_MOD_CD			,
				DA.RCV_DE_TERM_CD				,
				DA.PRC_CMDT_TP_CD				,
				DA.PRC_CMDT_DEF_CD			,
				DA.CURR_CD							,
				DA.FNL_FRT_RT_AMT				,

				DECODE(DA.RAT_UT_CD, BQ.CTRT_CNTR_TPSZ_CD, 100, 'BX', 80, 60)
				 	- DECODE(DA.RAT_UT_CD, '20', 10, '40', 10, 'HC', 10, '45', 10, '53', 10, 0)
				 	+ DECODE(DA.PRC_CGO_TP_CD, BQ.DR_TP, 2, BQ.DG_TP, 2, BQ.RF_TP, 2, BQ.AK_TP, 2, BQ.BB_TP, 2, 0)
				 	- DECODE(BQ.CTRT_CNTR_TPSZ_CD||BQ.AK_TP||DA.PRC_CGO_TP_CD, 'D7AKDR', 1, 0)	RAT_UT_MTCH_PRIO
						/* D7/AK 가 D7/DR 과 D7/AK 중에 D7/AK 가 먼저 선택 될 수 있도록 D7/AK 면서 DR 운임적인된 경우 -1 을 해준다. */

FROM    BQ  ,
        PRI_SP_SCP_TRSP_ADD_CHG   DA
WHERE   DA.PROP_NO                = BQ.PROP_NO
AND     DA.AMDT_SEQ               = BQ.AMDT_SEQ
AND     DA.SVC_SCP_CD             = BQ.SVC_SCP_CD
AND     DA.ADD_CHG_TP_CD          = 'A'
AND     DA.ORG_DEST_TP_CD         = 'D'
AND			DA.SRC_INFO_CD						<> 'AD'

/*******************************************************************************************
	1.	DEST ARB - COMMODITY
*******************************************************************************************/

AND     (
                DA.PRC_CMDT_DEF_CD  IS NULL
            OR	( DA.PRC_CMDT_TP_CD, DA.PRC_CMDT_DEF_CD ) IN
								(
								SELECT  A.CONV_CMDT_TP_CD, A.CONV_CMDT_DEF_CD
								FROM		NC_P A
								WHERE		A.BQ_SEQ 						= BQ.BQ_SEQ
								AND			A.NOTE_CONV_RULE_CD	= 'RAP'
								UNION ALL
								SELECT  'C', GC.PRC_CMDT_DEF_CD
								FROM		NC_P A	,
												GC
								WHERE		A.BQ_SEQ 						= BQ.BQ_SEQ
								AND			A.NOTE_CONV_RULE_CD	= 'RAP'
								AND			A.CONV_CMDT_TP_CD		= 'G'
								AND		  GC.PRC_GRP_CMDT_CD  = A.CONV_CMDT_DEF_CD
								AND     GC.PRC_CMDT_TP_CD   = 'C'
								UNION ALL
								SELECT  'G', GC.PRC_GRP_CMDT_CD
								FROM		NC_P A	,
												GC
								WHERE		A.BQ_SEQ 						= BQ.BQ_SEQ
								AND			A.NOTE_CONV_RULE_CD	= 'RAP'
								AND			A.CONV_CMDT_TP_CD		= 'C'
								AND     GC.PRC_CMDT_TP_CD   = 'C'
								AND     GC.PRC_CMDT_DEF_CD  = A.CONV_CMDT_DEF_CD
								UNION ALL
								/* TAW 일 경우 FAK 고려함 */
								SELECT	'C', CMDT_CD
								FROM		MDM_COMMODITY
								WHERE		REP_CMDT_CD		= '0000'
								UNION ALL
								SELECT	'G', GC.PRC_GRP_CMDT_CD
								FROM		GC
								WHERE		GC.PRC_CMDT_TP_CD		= 'C'
								AND			GC.PRC_CMDT_DEF_CD  IN ( SELECT CMDT_CD FROM MDM_COMMODITY WHERE REP_CMDT_CD = '0000' )
								)
        )

/*******************************************************************************************
	2.	 DEST ARB - ROUTE
*******************************************************************************************/

/*******************************************************************************************
< DIRECT CALL >
BKG 이 DIRECT CALL 이거나,
DIRECT CALL FLAG 가 일치하는 경우
*******************************************************************************************/

AND     DECODE(BQ.DIR_CALL_FLG, 'Y', DA.DIR_CALL_FLG, BQ.DIR_CALL_FLG) = DA.DIR_CALL_FLG


/*******************************************************************************************
< POINT ( DEL ) >
*******************************************************************************************/

AND     ( DA.ROUT_PNT_LOC_TP_CD, DA.ROUT_PNT_LOC_DEF_CD ) IN
				(
				SELECT  A.CONV_DEST_LOC_TP_CD, A.CONV_DEST_LOC_DEF_CD
				FROM		NC_P A
				WHERE		A.BQ_SEQ 						= BQ.BQ_SEQ
				AND			A.NOTE_CONV_RULE_CD	= 'RAR'
				UNION ALL
				SELECT  'L', GL.LOC_CD
				FROM		NC_P A	,
								GL
				WHERE		A.BQ_SEQ 							= BQ.BQ_SEQ
				AND			A.NOTE_CONV_RULE_CD		= 'RAR'
				AND			A.CONV_DEST_LOC_TP_CD	= 'G'
				AND		  GL.PRC_GRP_LOC_CD 		= A.CONV_DEST_LOC_DEF_CD
				UNION ALL
				SELECT  'G', GL.PRC_GRP_LOC_CD
				FROM		NC_P A	,
								GL
				WHERE		A.BQ_SEQ 						= BQ.BQ_SEQ
				AND			A.NOTE_CONV_RULE_CD	= 'RAR'
				AND			A.CONV_DEST_LOC_TP_CD	= 'L'
				AND     GL.LOC_CD						= A.CONV_DEST_LOC_DEF_CD
				)


/*******************************************************************************************
< DEST VIA PORT ( POD ) >
*******************************************************************************************/

AND     (
	     			DA.VIA_PORT_DEF_CD  IS NULL
	      OR	( DA.VIA_PORT_TP_CD, DA.VIA_PORT_DEF_CD ) IN
						(
						SELECT  A.CONV_DEST_VIA_LOC_TP_CD, A.CONV_DEST_VIA_LOC_DEF_CD
						FROM		NC_P A
						WHERE		A.BQ_SEQ 						= BQ.BQ_SEQ
						AND			A.NOTE_CONV_RULE_CD	= 'RAR'
						UNION ALL
						SELECT  'L', GL.LOC_CD
						FROM		NC_P A	,
										GL
						WHERE		A.BQ_SEQ 									= BQ.BQ_SEQ
						AND			A.NOTE_CONV_RULE_CD				= 'RAR'
						AND			A.CONV_DEST_VIA_LOC_TP_CD	= 'G'
						AND		  GL.PRC_GRP_LOC_CD					= A.CONV_DEST_VIA_LOC_DEF_CD
						UNION ALL
						SELECT  'G', GL.PRC_GRP_LOC_CD
						FROM		NC_P A	,
										GL
						WHERE		A.BQ_SEQ 									= BQ.BQ_SEQ
						AND			A.NOTE_CONV_RULE_CD				= 'RAR'
						AND			A.CONV_DEST_VIA_LOC_TP_CD	= 'L'
						AND     GL.LOC_CD									= A.CONV_DEST_VIA_LOC_DEF_CD
						)
        )


/*******************************************************************************************
	3.	DEST ARB - RATING UNIT
*******************************************************************************************/

/*******************************************************************************************
< DEST ARB RATING UNIT >
*******************************************************************************************/

AND			(
						DA.RAT_UT_CD	IN
						(
						SELECT	'BX'
						FROM		DUAL
						UNION ALL
						SELECT  A.CONV_RAT_UT_CD
						FROM		NC_P A
						WHERE		A.BQ_SEQ 						= BQ.BQ_SEQ
						AND			A.NOTE_CONV_RULE_CD	= 'TYP'
						)
						OR
						(
								DA.RAT_UT_CD  IN ( '20', '40', 'HC', '45', '53' )
            AND ( SELECT A.CNTR_SZ_CD FROM PRI_RAT_UT A WHERE A.RAT_UT_CD = DA.RAT_UT_CD ) IN
            		(
								SELECT  A.CONV_RAT_UT_SZ_CD
								FROM		NC_P A
								WHERE		A.BQ_SEQ 						= BQ.BQ_SEQ
								AND			A.NOTE_CONV_RULE_CD	= 'TYP'
            		)
            )
        )

/*******************************************************************************************
< DEST ARB CARGO TYPE >
*******************************************************************************************/

AND     NVL(DA.PRC_CGO_TP_CD, '*')  IN
				(
				SELECT	'*'
				FROM		DUAL
				UNION ALL
				SELECT  A.CONV_DR_TP
				FROM		NC_P A
				WHERE		A.BQ_SEQ 						= BQ.BQ_SEQ
				AND			A.NOTE_CONV_RULE_CD	= 'RAC'
				UNION ALL
				SELECT  A.CONV_DG_TP
				FROM		NC_P A
				WHERE		A.BQ_SEQ 						= BQ.BQ_SEQ
				AND			A.NOTE_CONV_RULE_CD	= 'RAC'
				UNION ALL
				SELECT  A.CONV_RF_TP
				FROM		NC_P A
				WHERE		A.BQ_SEQ 						= BQ.BQ_SEQ
				AND			A.NOTE_CONV_RULE_CD	= 'RAC'
				UNION ALL
				SELECT  A.CONV_AK_TP
				FROM		NC_P A
				WHERE		A.BQ_SEQ 						= BQ.BQ_SEQ
				AND			A.NOTE_CONV_RULE_CD	= 'RAC'
				UNION ALL
				SELECT  A.CONV_BB_TP
				FROM		NC_P A
				WHERE		A.BQ_SEQ 						= BQ.BQ_SEQ
				AND			A.NOTE_CONV_RULE_CD	= 'RAC'
				)
)	,
RT AS
(

/*******************************************************************************************
	RATE
*******************************************************************************************/

SELECT	RT.*	,
				RT_APP.BKG_CONV_TP_CD      		APP_BKG_CONV_TP_CD     	,
				RT_APP.NOTE_CONV_MAPG_ID   		APP_NOTE_CONV_MAPG_ID  	,
				RT_APP.NOTE_CONV_SEQ       		APP_NOTE_CONV_SEQ      	,
				RT_APP.NOTE_CONV_RULE_CD   		APP_NOTE_CONV_RULE_CD  	,
				RT_APP.NOTE_CONV_TP_CD     		APP_NOTE_CONV_TP_CD    	,
				RT_APP.RT_OP_CD            		APP_RT_OP_CD           	,
				RT_APP.CURR_CD             		APP_CURR_CD            	,
				RT_APP.FRT_RT_AMT          		APP_FRT_RT_AMT					,
				RT_RAS.BKG_CONV_TP_CD      		RAS_BKG_CONV_TP_CD     	,
				RT_RAS.NOTE_CONV_MAPG_ID   		RAS_NOTE_CONV_MAPG_ID  	,
				RT_RAS.NOTE_CONV_SEQ       		RAS_NOTE_CONV_SEQ      	,
				RT_RAS.NOTE_CONV_RULE_CD   		RAS_NOTE_CONV_RULE_CD  	,
				RT_RAS.NOTE_CONV_TP_CD     		RAS_NOTE_CONV_TP_CD    	,
				RT_RAS.RT_OP_CD            		RAS_RT_OP_CD           	,
				RT_RAS.CURR_CD             		RAS_CURR_CD            	,
				RT_RAS.FRT_RT_AMT          		RAS_FRT_RT_AMT         	,
				RT_RAS.RAS_CONV_CTNT					RAS_RAS_CONV_CTNT				,
				RT_ARB.BKG_CONV_TP_CD      		ARB_BKG_CONV_TP_CD     	,
				RT_ARB.NOTE_CONV_MAPG_ID   		ARB_NOTE_CONV_MAPG_ID  	,
				RT_ARB.NOTE_CONV_SEQ       		ARB_NOTE_CONV_SEQ      	,
				RT_ARB.NOTE_CONV_RULE_CD   		ARB_NOTE_CONV_RULE_CD  	,
				RT_ARB.NOTE_CONV_TP_CD     		ARB_NOTE_CONV_TP_CD    	,
				RT_ARB.RT_OP_CD            		ARB_RT_OP_CD           	,
				RT_ARB.CURR_CD             		ARB_CURR_CD            	,
				RT_ARB.FRT_RT_AMT          		ARB_FRT_RT_AMT         	,
				RT_ARB.RT_APPL_TP_CD					ARB_RT_APPL_TP_CD				,
				RT_ADD.BKG_CONV_TP_CD      		ADD_BKG_CONV_TP_CD     	,
				RT_ADD.NOTE_CONV_MAPG_ID   		ADD_NOTE_CONV_MAPG_ID  	,
				RT_ADD.NOTE_CONV_SEQ       		ADD_NOTE_CONV_SEQ      	,
				RT_ADD.NOTE_CONV_RULE_CD   		ADD_NOTE_CONV_RULE_CD  	,
				RT_ADD.NOTE_CONV_TP_CD     		ADD_NOTE_CONV_TP_CD    	,
				RT_ADD.RT_OP_CD            		ADD_RT_OP_CD           	,
				RT_ADD.CURR_CD             		ADD_CURR_CD            	,
				RT_ADD.FRT_RT_AMT          		ADD_FRT_RT_AMT					,
				RT_ADD.RT_APPL_TP_CD					ADD_RT_APPL_TP_CD

FROM		(
				SELECT	BQ.BQ_SEQ ,
								CM.PRC_CMDT_TP_CD				CM_PRC_CMDT_TP_CD				,
								CM.PRC_CMDT_DEF_CD			CM_PRC_CMDT_DEF_CD			,
								NVL(RD.DIR_CALL_FLG, 'N')	RD_DIR_CALL_FLG					,

								OV.ROUT_VIA_PORT_TP_CD	OV_ROUT_VIA_PORT_TP_CD	,
								OV.ROUT_VIA_PORT_DEF_CD	OV_ROUT_VIA_PORT_DEF_CD	,
								DV.ROUT_VIA_PORT_TP_CD	DV_ROUT_VIA_PORT_TP_CD	,
								DV.ROUT_VIA_PORT_DEF_CD	DV_ROUT_VIA_PORT_DEF_CD	,

								OP.ROUT_PNT_LOC_TP_CD		OP_ROUT_PNT_LOC_TP_CD 	,
								OP.ROUT_PNT_LOC_DEF_CD	OP_ROUT_PNT_LOC_DEF_CD	,
								OP.RCV_DE_TERM_CD				OP_RCV_DE_TERM_CD				,
								OP.PRC_TRSP_MOD_CD			OP_PRC_TRSP_MOD_CD			,

								DP.ROUT_PNT_LOC_TP_CD		DP_ROUT_PNT_LOC_TP_CD 	,
								DP.ROUT_PNT_LOC_DEF_CD	DP_ROUT_PNT_LOC_DEF_CD	,
								DP.RCV_DE_TERM_CD				DP_RCV_DE_TERM_CD				,
								DP.PRC_TRSP_MOD_CD			DP_PRC_TRSP_MOD_CD			,

								RT.GEN_SPCL_RT_TP_CD														,
								RT.CMDT_HDR_SEQ																	,
								RT.ROUT_SEQ																			,
								RT.RT_SEQ																				,
								RT.RAT_UT_CD																		,
								RT.PRC_CGO_TP_CD																,
								RT.CURR_CD																			,
								RT.FNL_FRT_RT_AMT																,

								CASE
								WHEN	( OP.ROUT_PNT_LOC_TP_CD, OP.ROUT_PNT_LOC_DEF_CD ) IN
											(
											SELECT  A.CONV_ORG_LOC_TP_CD, A.CONV_ORG_LOC_DEF_CD
											FROM		NC_P A
											WHERE		A.BQ_SEQ 						= BQ.BQ_SEQ
											AND			A.NOTE_CONV_RULE_CD	= 'RAR'
											UNION ALL
											SELECT  'L', GL.LOC_CD
											FROM		NC_P A	,
															GL
											WHERE		A.BQ_SEQ 							= BQ.BQ_SEQ
											AND			A.NOTE_CONV_RULE_CD		= 'RAR'
											AND			A.CONV_ORG_LOC_TP_CD	= 'G'
											AND		  GL.PRC_GRP_LOC_CD 		= A.CONV_ORG_LOC_DEF_CD
											UNION ALL
											SELECT  'G', GL.PRC_GRP_LOC_CD
											FROM		NC_P A	,
															GL
											WHERE		A.BQ_SEQ 							= BQ.BQ_SEQ
											AND			A.NOTE_CONV_RULE_CD		= 'RAR'
											AND			A.CONV_ORG_LOC_TP_CD	= 'L'
											AND     GL.LOC_CD							= A.CONV_ORG_LOC_DEF_CD
											)
											THEN 'Y'
								ELSE	'N'
								END	POR_MTCH_FLG	,

								CASE
								WHEN	( DP.ROUT_PNT_LOC_TP_CD, DP.ROUT_PNT_LOC_DEF_CD ) IN
											(
											SELECT  A.CONV_DEST_LOC_TP_CD, A.CONV_DEST_LOC_DEF_CD
											FROM		NC_P A
											WHERE		A.BQ_SEQ 						= BQ.BQ_SEQ
											AND			A.NOTE_CONV_RULE_CD	= 'RAR'
											UNION ALL
											SELECT  'L', GL.LOC_CD
											FROM		NC_P A	,
															GL
											WHERE		A.BQ_SEQ 							= BQ.BQ_SEQ
											AND			A.NOTE_CONV_RULE_CD		= 'RAR'
											AND			A.CONV_DEST_LOC_TP_CD	= 'G'
											AND		  GL.PRC_GRP_LOC_CD 		= A.CONV_DEST_LOC_DEF_CD
											UNION ALL
											SELECT  'G', GL.PRC_GRP_LOC_CD
											FROM		NC_P A	,
															GL
											WHERE		A.BQ_SEQ 							= BQ.BQ_SEQ
											AND			A.NOTE_CONV_RULE_CD		= 'RAR'
											AND			A.CONV_DEST_LOC_TP_CD	= 'L'
											AND     GL.LOC_CD							= A.CONV_DEST_LOC_DEF_CD
											)
											THEN 'Y'
								ELSE	'N'
								END	DEL_MTCH_FLG	,

								(
								SELECT	NVL(MAX(A.NC_SEQ), 0)
								FROM		NC_P	A
								WHERE		A.BQ_SEQ						= BQ.BQ_SEQ
								AND			A.NOTE_CONV_RULE_CD	= 'RAP'
								AND			A.BKG_CONV_TP_CD		= 'C'
								AND			NVL(A.GEN_SPCL_RT_TP_CD, CR.GEN_SPCL_RT_TP_CD)							= CR.GEN_SPCL_RT_TP_CD
								AND			DECODE(A.CMDT_HDR_SEQ, 0, CR.CMDT_HDR_SEQ, A.CMDT_HDR_SEQ)	= CR.CMDT_HDR_SEQ
								AND 		DECODE(A.ROUT_SEQ, 0, CR.ROUT_SEQ, A.ROUT_SEQ)							= CR.ROUT_SEQ
								) RAP_NC_SEQ	,
								(
								SELECT	NVL(MAX(A.NC_SEQ), 0)
								FROM		NC_P	A
								WHERE		A.BQ_SEQ						= BQ.BQ_SEQ
								AND			A.NOTE_CONV_RULE_CD	= 'RAR'
								AND			A.BKG_CONV_TP_CD		= 'C'
								AND			NVL(A.GEN_SPCL_RT_TP_CD, CR.GEN_SPCL_RT_TP_CD)							= CR.GEN_SPCL_RT_TP_CD
								AND			DECODE(A.CMDT_HDR_SEQ, 0, CR.CMDT_HDR_SEQ, A.CMDT_HDR_SEQ)	= CR.CMDT_HDR_SEQ
								AND 		DECODE(A.ROUT_SEQ, 0, CR.ROUT_SEQ, A.ROUT_SEQ)							= CR.ROUT_SEQ
								) RAR_NC_SEQ	,
								(
								SELECT	NVL(MAX(A.NC_SEQ), 0)
								FROM		NC_P	A
								WHERE		A.BQ_SEQ						= BQ.BQ_SEQ
								AND			A.NOTE_CONV_RULE_CD	= 'DOR'
								AND			A.BKG_CONV_TP_CD		= 'C'
								AND			NVL(A.GEN_SPCL_RT_TP_CD, CR.GEN_SPCL_RT_TP_CD)							= CR.GEN_SPCL_RT_TP_CD
								AND			DECODE(A.CMDT_HDR_SEQ, 0, CR.CMDT_HDR_SEQ, A.CMDT_HDR_SEQ)	= CR.CMDT_HDR_SEQ
								AND 		DECODE(A.ROUT_SEQ, 0, CR.ROUT_SEQ, A.ROUT_SEQ)							= CR.ROUT_SEQ
								) DOR_NC_SEQ	,
								(
								SELECT	NVL(MAX(A.NC_SEQ), 0)
								FROM		NC_P	A
								WHERE		A.BQ_SEQ						= BQ.BQ_SEQ
								AND			A.NOTE_CONV_RULE_CD	= 'TYP'
								AND			A.BKG_CONV_TP_CD		= 'C'
								AND			NVL(A.GEN_SPCL_RT_TP_CD, CR.GEN_SPCL_RT_TP_CD)							= CR.GEN_SPCL_RT_TP_CD
								AND			DECODE(A.CMDT_HDR_SEQ, 0, CR.CMDT_HDR_SEQ, A.CMDT_HDR_SEQ)	= CR.CMDT_HDR_SEQ
								AND 		DECODE(A.ROUT_SEQ, 0, CR.ROUT_SEQ, A.ROUT_SEQ)							= CR.ROUT_SEQ
								) TYP_NC_SEQ	,
								(
								SELECT	NVL(MAX(A.NC_SEQ), 0)
								FROM		NC_P	A
								WHERE		A.BQ_SEQ						= BQ.BQ_SEQ
								AND			A.NOTE_CONV_RULE_CD	= 'RAC'
								AND			A.BKG_CONV_TP_CD		= 'C'
								AND			NVL(A.GEN_SPCL_RT_TP_CD, CR.GEN_SPCL_RT_TP_CD)							= CR.GEN_SPCL_RT_TP_CD
								AND			DECODE(A.CMDT_HDR_SEQ, 0, CR.CMDT_HDR_SEQ, A.CMDT_HDR_SEQ)	= CR.CMDT_HDR_SEQ
								AND 		DECODE(A.ROUT_SEQ, 0, CR.ROUT_SEQ, A.ROUT_SEQ)							= CR.ROUT_SEQ
								) RAC_NC_SEQ	,
								(
								SELECT	NVL(MAX(A.NC_SEQ), 0)
								FROM		NC_P	A
								WHERE		A.BQ_SEQ						= BQ.BQ_SEQ
								AND			A.NOTE_CONV_RULE_CD	= 'APP'
								AND			A.BKG_CONV_TP_CD		= 'C'
								AND			NVL(A.GEN_SPCL_RT_TP_CD, CR.GEN_SPCL_RT_TP_CD)							= CR.GEN_SPCL_RT_TP_CD
								AND			DECODE(A.CMDT_HDR_SEQ, 0, CR.CMDT_HDR_SEQ, A.CMDT_HDR_SEQ)	= CR.CMDT_HDR_SEQ
								AND 		DECODE(A.ROUT_SEQ, 0, CR.ROUT_SEQ, A.ROUT_SEQ)							= CR.ROUT_SEQ
								) APP_NC_SEQ	,
								(
								SELECT	NVL(MAX(A.NC_SEQ), 0)
								FROM		NC_P	A
								WHERE		A.BQ_SEQ						= BQ.BQ_SEQ
								AND			A.NOTE_CONV_RULE_CD	= 'RAS'
								AND			A.BKG_CONV_TP_CD		= 'C'
								AND			NVL(A.GEN_SPCL_RT_TP_CD, CR.GEN_SPCL_RT_TP_CD)							= CR.GEN_SPCL_RT_TP_CD
								AND			DECODE(A.CMDT_HDR_SEQ, 0, CR.CMDT_HDR_SEQ, A.CMDT_HDR_SEQ)	= CR.CMDT_HDR_SEQ
								AND 		DECODE(A.ROUT_SEQ, 0, CR.ROUT_SEQ, A.ROUT_SEQ)							= CR.ROUT_SEQ
								) RAS_NC_SEQ	,
								(
								SELECT	NVL(MAX(A.NC_SEQ), 0)
								FROM		NC_P	A
								WHERE		A.BQ_SEQ						= BQ.BQ_SEQ
								AND			A.NOTE_CONV_RULE_CD	= 'ARB'
								AND			A.BKG_CONV_TP_CD		= 'C'
								AND			NVL(A.GEN_SPCL_RT_TP_CD, CR.GEN_SPCL_RT_TP_CD)							= CR.GEN_SPCL_RT_TP_CD
								AND			DECODE(A.CMDT_HDR_SEQ, 0, CR.CMDT_HDR_SEQ, A.CMDT_HDR_SEQ)	= CR.CMDT_HDR_SEQ
								AND 		DECODE(A.ROUT_SEQ, 0, CR.ROUT_SEQ, A.ROUT_SEQ)							= CR.ROUT_SEQ
								) ARB_NC_SEQ	,
								(
								SELECT	NVL(MAX(A.NC_SEQ), 0)
								FROM		NC_P	A
								WHERE		A.BQ_SEQ						= BQ.BQ_SEQ
								AND			A.NOTE_CONV_RULE_CD	= 'ADD'
								AND			A.BKG_CONV_TP_CD		= 'C'
								AND			NVL(A.GEN_SPCL_RT_TP_CD, CR.GEN_SPCL_RT_TP_CD)							= CR.GEN_SPCL_RT_TP_CD
								AND			DECODE(A.CMDT_HDR_SEQ, 0, CR.CMDT_HDR_SEQ, A.CMDT_HDR_SEQ)	= CR.CMDT_HDR_SEQ
								AND 		DECODE(A.ROUT_SEQ, 0, CR.ROUT_SEQ, A.ROUT_SEQ)							= CR.ROUT_SEQ
								) ADD_NC_SEQ	,

								ROW_NUMBER() OVER (	PARTITION BY BQ.BQ_SEQ, RT.GEN_SPCL_RT_TP_CD, RT.CMDT_HDR_SEQ, RT.ROUT_SEQ
																		ORDER BY DECODE(RT.RAT_UT_CD, BQ.CTRT_CNTR_TPSZ_CD, 100, 'BL', 80, 60)
																						 	- DECODE(RT.RAT_UT_CD, '20', 10, '40', 10, 'HC', 10, '45', 10, '53', 10, 0)
																						 	+ DECODE(RT.PRC_CGO_TP_CD, BQ.DR_TP, 2, BQ.DG_TP, 2, BQ.RF_TP, 2, BQ.AK_TP, 2, BQ.BB_TP, 2, 0)
																						 	- DECODE(BQ.CTRT_CNTR_TPSZ_CD||BQ.AK_TP||RT.PRC_CGO_TP_CD, 'D7AKDR', 1, 0)	DESC
																							/* D7/AK 가 D7/DR 과 D7/AK 중에 D7/AK 가 먼저 선택 될 수 있도록 D7/AK 면서 DR 운임적인된 경우 -1 을 해준다. */
																	) ROW_NUMBER

				FROM    BQ  															,
								PRI_SP_SCP_RT_CMDT_HDR    CH			,
								PRI_SP_SCP_RT_CMDT        CM			,
								PRI_SP_SCP_RT_CMDT_ROUT		CR			,
								PRI_SP_SCP_RT_ROUT_DIR		RD			,
								PRI_SP_SCP_RT_ROUT_PNT		OP			,
								PRI_SP_SCP_RT_ROUT_PNT		DP			,
								PRI_SP_SCP_RT_ROUT_VIA		OV			,
								PRI_SP_SCP_RT_ROUT_VIA		DV			,
								PRI_SP_SCP_RT             RT
				WHERE		CH.PROP_NO		= BQ.PROP_NO AND CH.AMDT_SEQ		= BQ.AMDT_SEQ AND CH.SVC_SCP_CD			= BQ.SVC_SCP_CD
				AND			CM.PROP_NO		= CH.PROP_NO AND CM.AMDT_SEQ		= CH.AMDT_SEQ AND	CM.SVC_SCP_CD			= CH.SVC_SCP_CD AND	CM.GEN_SPCL_RT_TP_CD		= CH.GEN_SPCL_RT_TP_CD AND CM.CMDT_HDR_SEQ		= CH.CMDT_HDR_SEQ AND CM.SRC_INFO_CD	<> 'AD'
				AND     CR.PROP_NO		= CH.PROP_NO AND CR.AMDT_SEQ		= CH.AMDT_SEQ AND CR.SVC_SCP_CD			= CH.SVC_SCP_CD AND CR.GEN_SPCL_RT_TP_CD		= CH.GEN_SPCL_RT_TP_CD AND CR.CMDT_HDR_SEQ		= CH.CMDT_HDR_SEQ
				AND     RD.PROP_NO(+)	= CR.PROP_NO AND RD.AMDT_SEQ(+)	= CR.AMDT_SEQ AND RD.SVC_SCP_CD(+)	= CR.SVC_SCP_CD AND RD.GEN_SPCL_RT_TP_CD(+)	= CR.GEN_SPCL_RT_TP_CD AND RD.CMDT_HDR_SEQ(+)	= CR.CMDT_HDR_SEQ AND RD.ROUT_SEQ(+)	= CR.ROUT_SEQ AND RD.SRC_INFO_CD(+)			<> 'AD'
				AND     OP.PROP_NO		= CR.PROP_NO AND OP.AMDT_SEQ		= CR.AMDT_SEQ AND OP.SVC_SCP_CD			= CR.SVC_SCP_CD AND OP.GEN_SPCL_RT_TP_CD		= CR.GEN_SPCL_RT_TP_CD AND OP.CMDT_HDR_SEQ		= CR.CMDT_HDR_SEQ AND OP.ROUT_SEQ			= CR.ROUT_SEQ AND OP.ORG_DEST_TP_CD			= 'O' AND OP.SRC_INFO_CD		<> 'AD'
				AND     DP.PROP_NO		= CR.PROP_NO AND DP.AMDT_SEQ		= CR.AMDT_SEQ AND DP.SVC_SCP_CD			= CR.SVC_SCP_CD AND DP.GEN_SPCL_RT_TP_CD		= CR.GEN_SPCL_RT_TP_CD AND DP.CMDT_HDR_SEQ		= CR.CMDT_HDR_SEQ AND DP.ROUT_SEQ			= CR.ROUT_SEQ AND DP.ORG_DEST_TP_CD			= 'D' AND DP.SRC_INFO_CD		<> 'AD'
				AND     OV.PROP_NO(+)	= CR.PROP_NO AND OV.AMDT_SEQ(+)	= CR.AMDT_SEQ AND OV.SVC_SCP_CD(+)	= CR.SVC_SCP_CD AND OV.GEN_SPCL_RT_TP_CD(+)	= CR.GEN_SPCL_RT_TP_CD AND OV.CMDT_HDR_SEQ(+)	= CR.CMDT_HDR_SEQ AND OV.ROUT_SEQ(+)	= CR.ROUT_SEQ AND OV.ORG_DEST_TP_CD(+)	= 'O' AND OV.SRC_INFO_CD(+)	<> 'AD'
				AND     DV.PROP_NO(+)	= CR.PROP_NO AND DV.AMDT_SEQ(+)	= CR.AMDT_SEQ AND DV.SVC_SCP_CD(+)	= CR.SVC_SCP_CD AND DV.GEN_SPCL_RT_TP_CD(+)	= CR.GEN_SPCL_RT_TP_CD AND DV.CMDT_HDR_SEQ(+)	= CR.CMDT_HDR_SEQ AND DV.ROUT_SEQ(+)	= CR.ROUT_SEQ AND DV.ORG_DEST_TP_CD(+)	= 'D' AND DV.SRC_INFO_CD(+)	<> 'AD'
				AND     RT.PROP_NO		= CR.PROP_NO AND RT.AMDT_SEQ		= CR.AMDT_SEQ AND RT.SVC_SCP_CD			= CR.SVC_SCP_CD AND RT.GEN_SPCL_RT_TP_CD		= CR.GEN_SPCL_RT_TP_CD AND RT.CMDT_HDR_SEQ		= CR.CMDT_HDR_SEQ AND RT.ROUT_SEQ			= CR.ROUT_SEQ AND RT.SRC_INFO_CD	<> 'AD'


				/*******************************************************************************************
					1.	RATE - COMMODITY
				*******************************************************************************************/

				/*******************************************************************************************
				< COMMODITY >
				*******************************************************************************************/

				AND     ( CM.PRC_CMDT_TP_CD, CM.PRC_CMDT_DEF_CD ) IN
								(
								SELECT  A.CONV_CMDT_TP_CD, A.CONV_CMDT_DEF_CD
								FROM		NC_P A
								WHERE		A.BQ_SEQ 						= BQ.BQ_SEQ
								AND			A.NOTE_CONV_RULE_CD	= 'RAP'
								UNION ALL
								SELECT  'C', GC.PRC_CMDT_DEF_CD
								FROM		NC_P A	,
												GC
								WHERE		A.BQ_SEQ 						= BQ.BQ_SEQ
								AND			A.NOTE_CONV_RULE_CD	= 'RAP'
								AND			A.CONV_CMDT_TP_CD		= 'G'
								AND		  GC.PRC_GRP_CMDT_CD  = A.CONV_CMDT_DEF_CD
								AND     GC.PRC_CMDT_TP_CD   = 'C'
								UNION ALL
								SELECT  'G', GC.PRC_GRP_CMDT_CD
								FROM		NC_P A	,
												GC
								WHERE		A.BQ_SEQ 						= BQ.BQ_SEQ
								AND			A.NOTE_CONV_RULE_CD	= 'RAP'
								AND			A.CONV_CMDT_TP_CD		= 'C'
								AND     GC.PRC_CMDT_TP_CD   = 'C'
								AND     GC.PRC_CMDT_DEF_CD  = A.CONV_CMDT_DEF_CD
								UNION ALL
								/* TAW 일 경우 FAK 고려함 */
								SELECT	'C', CMDT_CD
								FROM		MDM_COMMODITY
								WHERE		REP_CMDT_CD		= '0000'
								UNION ALL
								SELECT	'G', GC.PRC_GRP_CMDT_CD
								FROM		GC
								WHERE		GC.PRC_CMDT_TP_CD		= 'C'
								AND			GC.PRC_CMDT_DEF_CD  IN ( SELECT CMDT_CD FROM MDM_COMMODITY WHERE REP_CMDT_CD = '0000' )
								)


				/*******************************************************************************************
				< ACTUAL CUSTOMER >
				CONTRACT 에 ACTUAL CUSTOMER 가 존재하지 않거나,
				BKG 의 ACTUAL CUSTOMER 와 일치하는 경우
				*******************************************************************************************/

				AND			EXISTS	(																	/* CHECK CHECK CHECK CHECK CHECK */
												SELECT	'X'
												FROM		DUAL
												WHERE		NOT EXISTS	(
																						SELECT	'X'
																						FROM		PRI_SP_SCP_RT_ACT_CUST	AC
																						WHERE		AC.PROP_NO						= CH.PROP_NO
																						AND			AC.AMDT_SEQ						= CH.AMDT_SEQ
																						AND			AC.SVC_SCP_CD 				= CH.SVC_SCP_CD
																						AND			AC.GEN_SPCL_RT_TP_CD	= CH.GEN_SPCL_RT_TP_CD
																						AND			AC.CMDT_HDR_SEQ				= CH.CMDT_HDR_SEQ
																						)
												UNION ALL
												SELECT	'X'
												FROM		PRI_SP_SCP_RT_ACT_CUST	AC
												WHERE		AC.PROP_NO						= CH.PROP_NO
												AND			AC.AMDT_SEQ						= CH.AMDT_SEQ
												AND			AC.SVC_SCP_CD 				= CH.SVC_SCP_CD
												AND			AC.GEN_SPCL_RT_TP_CD	= CH.GEN_SPCL_RT_TP_CD
												AND			AC.CMDT_HDR_SEQ				= CH.CMDT_HDR_SEQ
												AND			AC.CUST_CNT_CD				= BQ.AGMT_ACT_CNT_CD
												AND			AC.CUST_SEQ 					= BQ.AGMT_ACT_CUST_SEQ
												)


				/*******************************************************************************************
					2.	RATE - ROUTE
				*******************************************************************************************/

				/*******************************************************************************************
				< ORIGIN ( POR OR POL OR BASE PORT ) >
				*******************************************************************************************/

				AND     ( OP.ROUT_PNT_LOC_TP_CD, OP.ROUT_PNT_LOC_DEF_CD ) IN
								(
								SELECT  A.CONV_ORG_LOC_TP_CD, A.CONV_ORG_LOC_DEF_CD
								FROM		NC_P A
								WHERE		A.BQ_SEQ 						= BQ.BQ_SEQ
								AND			A.NOTE_CONV_RULE_CD	= 'RAR'
								UNION ALL
								SELECT  'L', GL.LOC_CD
								FROM		NC_P A	,
												GL
								WHERE		A.BQ_SEQ 							= BQ.BQ_SEQ
								AND			A.NOTE_CONV_RULE_CD		= 'RAR'
								AND			A.CONV_ORG_LOC_TP_CD	= 'G'
								AND		  GL.PRC_GRP_LOC_CD 		= A.CONV_ORG_LOC_DEF_CD
								UNION ALL
								SELECT  'G', GL.PRC_GRP_LOC_CD
								FROM		NC_P A	,
												GL
								WHERE		A.BQ_SEQ 							= BQ.BQ_SEQ
								AND			A.NOTE_CONV_RULE_CD		= 'RAR'
								AND			A.CONV_ORG_LOC_TP_CD	= 'L'
								AND     GL.LOC_CD							= A.CONV_ORG_LOC_DEF_CD
								UNION ALL
								SELECT  A.CONV_ORG_VIA_LOC_TP_CD, A.CONV_ORG_VIA_LOC_DEF_CD
								FROM		NC_P A
								WHERE		A.BQ_SEQ 						= BQ.BQ_SEQ
								AND			A.NOTE_CONV_RULE_CD	= 'RAR'
								UNION ALL
								SELECT  'L', GL.LOC_CD
								FROM		NC_P A	,
												GL
								WHERE		A.BQ_SEQ 							= BQ.BQ_SEQ
								AND			A.NOTE_CONV_RULE_CD		= 'RAR'
								AND			A.CONV_ORG_VIA_LOC_TP_CD	= 'G'
								AND		  GL.PRC_GRP_LOC_CD 		= A.CONV_ORG_VIA_LOC_DEF_CD
								UNION ALL
								SELECT  'G', GL.PRC_GRP_LOC_CD
								FROM		NC_P A	,
												GL
								WHERE		A.BQ_SEQ 							= BQ.BQ_SEQ
								AND			A.NOTE_CONV_RULE_CD		= 'RAR'
								AND			A.CONV_ORG_VIA_LOC_TP_CD	= 'L'
								AND     GL.LOC_CD							= A.CONV_ORG_VIA_LOC_DEF_CD
								UNION ALL
								SELECT  OA.BSE_PORT_TP_CD, OA.BSE_PORT_DEF_CD
								FROM		OA
								WHERE		OA.BQ_SEQ 						= BQ.BQ_SEQ
								UNION ALL
								SELECT  'L', GL.LOC_CD
								FROM		OA	,
												GL
								WHERE		OA.BQ_SEQ 					= BQ.BQ_SEQ
								AND			OA.BSE_PORT_TP_CD		= 'G'
								AND		  GL.PRC_GRP_LOC_CD 	= OA.BSE_PORT_DEF_CD
								UNION ALL
								SELECT  'G', GL.PRC_GRP_LOC_CD
								FROM		OA	,
												GL
								WHERE		OA.BQ_SEQ 					= BQ.BQ_SEQ
								AND			OA.BSE_PORT_TP_CD		= 'L'
								AND     GL.LOC_CD						= OA.BSE_PORT_DEF_CD
								)


				/*******************************************************************************************
				< ORIGIN VIA ( POL OR PRE RELAY ) >
				*******************************************************************************************/

				AND     (
										OV.ROUT_VIA_PORT_DEF_CD IS NULL
								OR	( OV.ROUT_VIA_PORT_TP_CD, OV.ROUT_VIA_PORT_DEF_CD ) IN
										(
										SELECT  A.CONV_ORG_VIA_LOC_TP_CD, A.CONV_ORG_VIA_LOC_DEF_CD
										FROM		NC_P A
										WHERE		A.BQ_SEQ 						= BQ.BQ_SEQ
										AND			A.NOTE_CONV_RULE_CD	= 'RAR'
										UNION ALL
										SELECT  'L', GL.LOC_CD
										FROM		NC_P A	,
														GL
										WHERE		A.BQ_SEQ 									= BQ.BQ_SEQ
										AND			A.NOTE_CONV_RULE_CD				= 'RAR'
										AND			A.CONV_ORG_VIA_LOC_TP_CD	= 'G'
										AND		  GL.PRC_GRP_LOC_CD 				= A.CONV_ORG_VIA_LOC_DEF_CD
										UNION ALL
										SELECT  'G', GL.PRC_GRP_LOC_CD
										FROM		NC_P A	,
														GL
										WHERE		A.BQ_SEQ 									= BQ.BQ_SEQ
										AND			A.NOTE_CONV_RULE_CD				= 'RAR'
										AND			A.CONV_ORG_VIA_LOC_TP_CD	= 'L'
										AND     GL.LOC_CD									= A.CONV_ORG_VIA_LOC_DEF_CD
										UNION ALL
										SELECT	'L', BQ.PRE_RLY_PORT_CD
										FROM		DUAL
										UNION ALL
										SELECT  'G', GL.PRC_GRP_LOC_CD
										FROM		GL
										WHERE		GL.LOC_CD						= BQ.PRE_RLY_PORT_CD
										)
								)


				/*******************************************************************************************
				< DESTIANTION VIA ( POD ) >
				*******************************************************************************************/

				AND     (
										DV.ROUT_VIA_PORT_DEF_CD IS NULL
								OR	( DV.ROUT_VIA_PORT_TP_CD, DV.ROUT_VIA_PORT_DEF_CD ) IN
										(
										SELECT  A.CONV_DEST_VIA_LOC_TP_CD, A.CONV_DEST_VIA_LOC_DEF_CD
										FROM		NC_P A
										WHERE		A.BQ_SEQ 						= BQ.BQ_SEQ
										AND			A.NOTE_CONV_RULE_CD	= 'RAR'
										UNION ALL
										SELECT  'L', GL.LOC_CD
										FROM		NC_P A	,
														GL
										WHERE		A.BQ_SEQ 									= BQ.BQ_SEQ
										AND			A.NOTE_CONV_RULE_CD				= 'RAR'
										AND			A.CONV_DEST_VIA_LOC_TP_CD	= 'G'
										AND		  GL.PRC_GRP_LOC_CD 				= A.CONV_DEST_VIA_LOC_DEF_CD
										UNION ALL
										SELECT  'G', GL.PRC_GRP_LOC_CD
										FROM		NC_P A	,
														GL
										WHERE		A.BQ_SEQ 									= BQ.BQ_SEQ
										AND			A.NOTE_CONV_RULE_CD				= 'RAR'
										AND			A.CONV_DEST_VIA_LOC_TP_CD	= 'L'
										AND     GL.LOC_CD									= A.CONV_DEST_VIA_LOC_DEF_CD
										)
								)


				/*******************************************************************************************
				< DESTINATION ( DEL OR POD OR BASE PORT ) >
				*******************************************************************************************/

				AND     ( DP.ROUT_PNT_LOC_TP_CD, DP.ROUT_PNT_LOC_DEF_CD ) IN
								(
								SELECT  A.CONV_DEST_LOC_TP_CD, A.CONV_DEST_LOC_DEF_CD
								FROM		NC_P A
								WHERE		A.BQ_SEQ 						= BQ.BQ_SEQ
								AND			A.NOTE_CONV_RULE_CD	= 'RAR'
								UNION ALL
								SELECT  'L', GL.LOC_CD
								FROM		NC_P A	,
												GL
								WHERE		A.BQ_SEQ 							= BQ.BQ_SEQ
								AND			A.NOTE_CONV_RULE_CD		= 'RAR'
								AND			A.CONV_DEST_LOC_TP_CD	= 'G'
								AND		  GL.PRC_GRP_LOC_CD 		= A.CONV_DEST_LOC_DEF_CD
								UNION ALL
								SELECT  'G', GL.PRC_GRP_LOC_CD
								FROM		NC_P A	,
												GL
								WHERE		A.BQ_SEQ 							= BQ.BQ_SEQ
								AND			A.NOTE_CONV_RULE_CD		= 'RAR'
								AND			A.CONV_DEST_LOC_TP_CD	= 'L'
								AND     GL.LOC_CD							= A.CONV_DEST_LOC_DEF_CD
								UNION ALL
								SELECT  A.CONV_DEST_VIA_LOC_TP_CD, A.CONV_DEST_VIA_LOC_DEF_CD
								FROM		NC_P A
								WHERE		A.BQ_SEQ 						= BQ.BQ_SEQ
								AND			A.NOTE_CONV_RULE_CD	= 'RAR'
								UNION ALL
								SELECT  'L', GL.LOC_CD
								FROM		NC_P A	,
												GL
								WHERE		A.BQ_SEQ 							= BQ.BQ_SEQ
								AND			A.NOTE_CONV_RULE_CD		= 'RAR'
								AND			A.CONV_DEST_VIA_LOC_TP_CD	= 'G'
								AND		  GL.PRC_GRP_LOC_CD 		= A.CONV_DEST_VIA_LOC_DEF_CD
								UNION ALL
								SELECT  'G', GL.PRC_GRP_LOC_CD
								FROM		NC_P A	,
												GL
								WHERE		A.BQ_SEQ 							= BQ.BQ_SEQ
								AND			A.NOTE_CONV_RULE_CD		= 'RAR'
								AND			A.CONV_DEST_VIA_LOC_TP_CD	= 'L'
								AND     GL.LOC_CD							= A.CONV_DEST_VIA_LOC_DEF_CD
								UNION ALL
								SELECT  DA.BSE_PORT_TP_CD, DA.BSE_PORT_DEF_CD
								FROM		DA
								WHERE		DA.BQ_SEQ 						= BQ.BQ_SEQ
								UNION ALL
								SELECT  'L', GL.LOC_CD
								FROM		DA	,
												GL
								WHERE		DA.BQ_SEQ 					= BQ.BQ_SEQ
								AND			DA.BSE_PORT_TP_CD		= 'G'
								AND		  GL.PRC_GRP_LOC_CD 	= DA.BSE_PORT_DEF_CD
								UNION ALL
								SELECT  'G', GL.PRC_GRP_LOC_CD
								FROM		DA	,
												GL
								WHERE		DA.BQ_SEQ 					= BQ.BQ_SEQ
								AND			DA.BSE_PORT_TP_CD		= 'L'
								AND     GL.LOC_CD						= DA.BSE_PORT_DEF_CD
								)


				/*******************************************************************************************
					3.	RATE - RATING UNIT
				*******************************************************************************************/

				/*******************************************************************************************
				< RATE RATING UNIT >
				*******************************************************************************************/

				AND			(
										RT.RAT_UT_CD	IN
										(
										SELECT	'BL'
										FROM		DUAL
										UNION ALL
										SELECT  A.CONV_RAT_UT_CD
										FROM		NC_P A
										WHERE		A.BQ_SEQ 						= BQ.BQ_SEQ
										AND			A.NOTE_CONV_RULE_CD	= 'TYP'
										)
										OR
										(
												RT.RAT_UT_CD  IN ( '20', '40', 'HC', '45', '53' )
				            AND ( SELECT A.CNTR_SZ_CD FROM PRI_RAT_UT A WHERE A.RAT_UT_CD = RT.RAT_UT_CD ) IN
				            		(
												SELECT  A.CONV_RAT_UT_SZ_CD
												FROM		NC_P A
												WHERE		A.BQ_SEQ 						= BQ.BQ_SEQ
												AND			A.NOTE_CONV_RULE_CD	= 'TYP'
				            		)
				            )
				        )

				/*******************************************************************************************
				< DEST ARB CARGO TYPE >
				*******************************************************************************************/

				AND     RT.PRC_CGO_TP_CD  IN
								(
								SELECT  A.CONV_DR_TP
								FROM		NC_P A
								WHERE		A.BQ_SEQ 						= BQ.BQ_SEQ
								AND			A.NOTE_CONV_RULE_CD	= 'RAC'
								UNION ALL
								SELECT  A.CONV_DG_TP
								FROM		NC_P A
								WHERE		A.BQ_SEQ 						= BQ.BQ_SEQ
								AND			A.NOTE_CONV_RULE_CD	= 'RAC'
								UNION ALL
								SELECT  A.CONV_RF_TP
								FROM		NC_P A
								WHERE		A.BQ_SEQ 						= BQ.BQ_SEQ
								AND			A.NOTE_CONV_RULE_CD	= 'RAC'
								UNION ALL
								SELECT  A.CONV_AK_TP
								FROM		NC_P A
								WHERE		A.BQ_SEQ 						= BQ.BQ_SEQ
								AND			A.NOTE_CONV_RULE_CD	= 'RAC'
								UNION ALL
								SELECT  A.CONV_BB_TP
								FROM		NC_P A
								WHERE		A.BQ_SEQ 						= BQ.BQ_SEQ
								AND			A.NOTE_CONV_RULE_CD	= 'RAC'
								)
				) RT	,
				NC_P											RT_APP	,
				NC_P											RT_RAS	,
				NC_P											RT_ARB	,
				NC_P											RT_ADD
WHERE		RT_APP.BQ_SEQ(+)	= RT.BQ_SEQ AND RT_APP.NOTE_CONV_RULE_CD(+) = 'APP' AND RT_APP.NC_SEQ(+) = RT.APP_NC_SEQ
AND			RT_RAS.BQ_SEQ(+)	= RT.BQ_SEQ AND RT_RAS.NOTE_CONV_RULE_CD(+) = 'RAS' AND RT_RAS.NC_SEQ(+) = RT.RAS_NC_SEQ
AND			RT_ARB.BQ_SEQ(+)	= RT.BQ_SEQ AND RT_ARB.NOTE_CONV_RULE_CD(+) = 'ARB' AND RT_ARB.NC_SEQ(+) = RT.ARB_NC_SEQ
AND			RT_ADD.BQ_SEQ(+)	= RT.BQ_SEQ AND RT_ADD.NOTE_CONV_RULE_CD(+) = 'ADD' AND RT_ADD.NC_SEQ(+) = RT.ADD_NC_SEQ
AND			RT.ROW_NUMBER	= 1


/*******************************************************************************************
	APP RULE CHECK

	RT_APP.RT_APPL_TP_CD 가 NULL (APP 존재하지 않음) 이거나 'S' 인 경우에만 운임을 사용할 수 있다.
	그리고 추가적으로 APP_N 에 CONV_TP_PRIO 의 값이 더 적은 값이 존재하지 않아야 한다.
	APP_N 에 CONV_TP_PRIO 의 값이 더 적은 값이 존재한다면,
	그것은 BKG 와 다른 조건으로 운임을 사용하도록 APP RULE 이 되어 있다는 것을 의미한다.
*******************************************************************************************/

AND			NVL(RT_APP.RT_APPL_TP_CD, 'S')	= 'S'
AND			NOT EXISTS	(
										SELECT	'X'
										FROM		APP_N	A
										WHERE		A.BQ_SEQ																										= RT.BQ_SEQ
										AND			NVL(A.GEN_SPCL_RT_TP_CD, RT.GEN_SPCL_RT_TP_CD)							= RT.GEN_SPCL_RT_TP_CD
										AND			DECODE(A.CMDT_HDR_SEQ, 0, RT.CMDT_HDR_SEQ, A.CMDT_HDR_SEQ)	= RT.CMDT_HDR_SEQ
										AND			DECODE(A.ROUT_SEQ, 0, RT.ROUT_SEQ, A.ROUT_SEQ)							= RT.ROUT_SEQ
										AND			A.CONV_TP_PRIO																							< NVL(RT_APP.CONV_TP_PRIO, 9)
										)

)	,
RATE AS
(

/*******************************************************************************************
	1. PATTERN #1 ( 0000 )
*******************************************************************************************/

SELECT	'0000'												PRC_RT_MTCH_PATT_CD				,
				BQ.SC_NO											CTRT_NO										,
				BQ.PROP_NO										PROP_NO										,
				BQ.AMDT_SEQ										AMDT_SEQ									,
				BQ.SVC_SCP_CD									SVC_SCP_CD								,
				BQ.BQ_SEQ											BQ_SEQ										,
				BQ.BKG_BQ_SEQ									BKG_BQ_SEQ								,
				BQ.CNTR_TPSZ_CD								BQ_CNTR_TPSZ_CD						,
				BQ.CTRT_CNTR_TPSZ_CD					BQ_CTRT_CNTR_TPSZ_CD			,
				BQ.RCV_TERM_CD								BQ_RCV_TERM_CD						,
				BQ.DE_TERM_CD									BQ_DE_TERM_CD							,
				BQ.DRY_CGO_FLG								BQ_DRY_CGO_FLG						,
				BQ.DCGO_FLG										BQ_DCGO_FLG								,
				BQ.RC_FLG											BQ_RC_FLG									,
				BQ.AWK_CGO_FLG								BQ_AWK_CGO_FLG						,
				BQ.BB_CGO_FLG									BQ_BB_CGO_FLG							,
				BQ.SOC_FLG										BQ_SOC_FLG								,
				BQ.PRC_CGO_TP_CD							BQ_PRC_CGO_TP_CD					,
				BQ.IMDG_CLSS_CD								BQ_IMDG_CLSS_CD						,
				BQ.CTRT_CNTR_QTY							BQ_CTRT_CNTR_QTY					,
				BQ.POR_APPL_FLG								BQ_POR_APPL_FLG						,
				BQ.POL_APPL_FLG								BQ_POL_APPL_FLG						,
				BQ.POD_APPL_FLG								BQ_POD_APPL_FLG						,
				BQ.DEL_APPL_FLG								BQ_DEL_APPL_FLG						,
				BQ.PRE_RLY_PORT_APPL_FLG			BQ_POR_RLY_PORT_APPL_FLG	,
				BQ.PST_RLY_PORT_APPL_FLG			BQ_PST_RLY_PORT_APPL_FLG	,

				RT.CMDT_HDR_SEQ								RT_CMDT_HDR_SEQ						,
				RT.ROUT_SEQ										RT_ROUT_SEQ								,
				RT.RT_SEQ											RT_RT_SEQ									,
				0															OI_ADD_CHG_SEQ						,
				0															OA_ADD_CHG_SEQ						,
				0															DA_ADD_CHG_SEQ						,
				0															DI_ADD_CHG_SEQ						,

				RT.GEN_SPCL_RT_TP_CD					RT_GEN_SPCL_RT_TP_CD			,
				RT.CM_PRC_CMDT_TP_CD																		,
				RT.CM_PRC_CMDT_DEF_CD																		,
				RT.OP_ROUT_PNT_LOC_DEF_CD			POR_CD										,
				RT.OV_ROUT_VIA_PORT_DEF_CD		POL_CD										,
				RT.DV_ROUT_VIA_PORT_DEF_CD		POD_CD										,
				RT.DP_ROUT_PNT_LOC_DEF_CD			DEL_CD										,
				RT.RD_DIR_CALL_FLG						DIR_CALL_FLG							,
				RT.OP_RCV_DE_TERM_CD					RCV_TERM_CD								,
				RT.DP_RCV_DE_TERM_CD					DE_TERM_CD								,
				RT.RAT_UT_CD									RAT_UT_CD									,
				RT.PRC_CGO_TP_CD							PRC_CGO_TP_CD							,
				RT.CURR_CD										CURR_CD										,
				RT.OP_PRC_TRSP_MOD_CD					ORG_TRSP_MOD_CD						,
				RT.DP_PRC_TRSP_MOD_CD					DEST_TRSP_MOD_CD					,

				RT.OP_ROUT_PNT_LOC_DEF_CD			OP_ROUT_PNT_LOC_DEF_CD		,
				RT.OV_ROUT_VIA_PORT_DEF_CD		OV_ROUT_VIA_PORT_DEF_CD		,
				RT.DV_ROUT_VIA_PORT_DEF_CD		DV_ROUT_VIA_PORT_DEF_CD		,
				RT.DP_ROUT_PNT_LOC_DEF_CD			DP_ROUT_PNT_LOC_DEF_CD		,
				RT.RD_DIR_CALL_FLG						RD_DIR_CALL_FLG						,
				RT.RAT_UT_CD									RT_RAT_UT_CD							,
				RT.PRC_CGO_TP_CD							RT_PRC_CGO_TP_CD					,
				RT.OP_PRC_TRSP_MOD_CD					OP_PRC_TRSP_MOD_CD				,
				RT.DP_PRC_TRSP_MOD_CD					DP_PRC_TRSP_MOD_CD				,
				RT.CURR_CD										RT_CURR_CD								,
				RT.FNL_FRT_RT_AMT							RT_FNL_FRT_RT_AMT					,

				NULL													OI_ROUT_PNT_LOC_DEF_CD		,
				NULL													OI_BSE_PORT_DEF_CD				,
				NULL													OI_VIA_PORT_DEF_CD				,
				NULL													OI_DIR_CALL_FLG						,
				NULL													OI_RAT_UT_CD							,
				NULL													OI_PRC_CGO_TP_CD					,
				NULL													OI_PRC_TRSP_MOD_CD				,
				NULL													OI_RCV_DE_TERM_CD					,
				NULL													OI_PRC_CMDT_DEF_CD				,
				NULL													OI_CURR_CD								,
				NULL													OI_FNL_FRT_RT_AMT					,
				NULL													OI_RAT_UT_MTCH_PRIO				,

				NULL													OA_ROUT_PNT_LOC_DEF_CD		,
				NULL													OA_BSE_PORT_DEF_CD				,
				NULL													OA_VIA_PORT_DEF_CD				,
				NULL													OA_DIR_CALL_FLG						,
				NULL													OA_RAT_UT_CD							,
				NULL													OA_PRC_CGO_TP_CD					,
				NULL													OA_PRC_TRSP_MOD_CD				,
				NULL													OA_RCV_DE_TERM_CD					,
				NULL													OA_PRC_CMDT_DEF_CD				,
				NULL													OA_CURR_CD								,
				NULL													OA_FNL_FRT_RT_AMT					,
				NULL													OA_RAT_UT_MTCH_PRIO				,

				NULL													DA_ROUT_PNT_LOC_DEF_CD		,
				NULL													DA_BSE_PORT_DEF_CD				,
				NULL													DA_VIA_PORT_DEF_CD				,
				NULL													DA_DIR_CALL_FLG						,
				NULL													DA_RAT_UT_CD							,
				NULL													DA_PRC_CGO_TP_CD					,
				NULL													DA_PRC_TRSP_MOD_CD				,
				NULL													DA_RCV_DE_TERM_CD					,
				NULL													DA_PRC_CMDT_DEF_CD				,
				NULL													DA_CURR_CD								,
				NULL													DA_FNL_FRT_RT_AMT					,
				NULL													DA_RAT_UT_MTCH_PRIO				,

				NULL													DI_ROUT_PNT_LOC_DEF_CD		,
				NULL													DI_BSE_PORT_DEF_CD				,
				NULL													DI_VIA_PORT_DEF_CD				,
				NULL													DI_DIR_CALL_FLG						,
				NULL													DI_RAT_UT_CD							,
				NULL													DI_PRC_CGO_TP_CD					,
				NULL													DI_PRC_TRSP_MOD_CD				,
				NULL													DI_RCV_DE_TERM_CD					,
				NULL													DI_PRC_CMDT_DEF_CD				,
				NULL													DI_CURR_CD								,
				NULL													DI_FNL_FRT_RT_AMT					,
				NULL													DI_RAT_UT_MTCH_PRIO				,

				RT_RAP.BKG_CONV_TP_CD      		RT_RAP_BKG_CONV_TP_CD			,
				RT_RAP.NOTE_CONV_MAPG_ID   		RT_RAP_NOTE_CONV_MAPG_ID  ,
				RT_RAP.NOTE_CONV_SEQ       		RT_RAP_NOTE_CONV_SEQ      ,
				RT_RAP.NOTE_CONV_RULE_CD   		RT_RAP_NOTE_CONV_RULE_CD  ,
				RT_RAP.NOTE_CONV_TP_CD     		RT_RAP_NOTE_CONV_TP_CD    ,
				RT_RAP.RT_OP_CD            		RT_RAP_RT_OP_CD           ,
				RT_RAP.CURR_CD             		RT_RAP_CURR_CD            ,
				RT_RAP.FRT_RT_AMT          		RT_RAP_FRT_RT_AMT         ,
				RT_RAP.RAP_CONV_CTNT					RT_RAP_CONV_CTNT					,

				RT_RAR.BKG_CONV_TP_CD      		RT_RAR_BKG_CONV_TP_CD     ,
				RT_RAR.NOTE_CONV_MAPG_ID   		RT_RAR_NOTE_CONV_MAPG_ID  ,
				RT_RAR.NOTE_CONV_SEQ       		RT_RAR_NOTE_CONV_SEQ      ,
				RT_RAR.NOTE_CONV_RULE_CD   		RT_RAR_NOTE_CONV_RULE_CD  ,
				RT_RAR.NOTE_CONV_TP_CD     		RT_RAR_NOTE_CONV_TP_CD    ,
				RT_RAR.RT_OP_CD            		RT_RAR_RT_OP_CD           ,
				RT_RAR.CURR_CD             		RT_RAR_CURR_CD            ,
				RT_RAR.FRT_RT_AMT          		RT_RAR_FRT_RT_AMT         ,
				RT_RAR.RAR_CONV_CTNT					RT_RAR_CONV_CTNT					,

				RT_DOR.BKG_CONV_TP_CD      		RT_DOR_BKG_CONV_TP_CD     ,
				RT_DOR.NOTE_CONV_MAPG_ID   		RT_DOR_NOTE_CONV_MAPG_ID  ,
				RT_DOR.NOTE_CONV_SEQ       		RT_DOR_NOTE_CONV_SEQ      ,
				RT_DOR.NOTE_CONV_RULE_CD   		RT_DOR_NOTE_CONV_RULE_CD  ,
				RT_DOR.NOTE_CONV_TP_CD     		RT_DOR_NOTE_CONV_TP_CD    ,
				RT_DOR.RT_OP_CD            		RT_DOR_RT_OP_CD           ,
				RT_DOR.CURR_CD             		RT_DOR_CURR_CD            ,
				RT_DOR.FRT_RT_AMT          		RT_DOR_FRT_RT_AMT         ,
				RT_DOR.DOR_CONV_CTNT					RT_DOR_CONV_CTNT					,

				RT_TYP.BKG_CONV_TP_CD      		RT_TYP_BKG_CONV_TP_CD     ,
				RT_TYP.NOTE_CONV_MAPG_ID   		RT_TYP_NOTE_CONV_MAPG_ID  ,
				RT_TYP.NOTE_CONV_SEQ       		RT_TYP_NOTE_CONV_SEQ      ,
				RT_TYP.NOTE_CONV_RULE_CD   		RT_TYP_NOTE_CONV_RULE_CD  ,
				RT_TYP.NOTE_CONV_TP_CD     		RT_TYP_NOTE_CONV_TP_CD    ,
				RT_TYP.RT_OP_CD            		RT_TYP_RT_OP_CD           ,
				RT_TYP.CURR_CD             		RT_TYP_CURR_CD            ,
				RT_TYP.FRT_RT_AMT          		RT_TYP_FRT_RT_AMT         ,
				RT_TYP.TYP_CONV_CTNT					RT_TYP_CONV_CTNT					,

				RT_RAC.BKG_CONV_TP_CD      		RT_RAC_BKG_CONV_TP_CD     ,
				RT_RAC.NOTE_CONV_MAPG_ID   		RT_RAC_NOTE_CONV_MAPG_ID  ,
				RT_RAC.NOTE_CONV_SEQ       		RT_RAC_NOTE_CONV_SEQ      ,
				RT_RAC.NOTE_CONV_RULE_CD   		RT_RAC_NOTE_CONV_RULE_CD  ,
				RT_RAC.NOTE_CONV_TP_CD     		RT_RAC_NOTE_CONV_TP_CD    ,
				RT_RAC.RT_OP_CD            		RT_RAC_RT_OP_CD           ,
				RT_RAC.CURR_CD             		RT_RAC_CURR_CD            ,
				RT_RAC.FRT_RT_AMT          		RT_RAC_FRT_RT_AMT         ,
				RT_RAC.RAC_CONV_CTNT					RT_RAC_CONV_CTNT					,

				RT.APP_BKG_CONV_TP_CD      		RT_APP_BKG_CONV_TP_CD     ,
				RT.APP_NOTE_CONV_MAPG_ID   		RT_APP_NOTE_CONV_MAPG_ID  ,
				RT.APP_NOTE_CONV_SEQ       		RT_APP_NOTE_CONV_SEQ      ,
				RT.APP_NOTE_CONV_RULE_CD   		RT_APP_NOTE_CONV_RULE_CD  ,
				RT.APP_NOTE_CONV_TP_CD     		RT_APP_NOTE_CONV_TP_CD    ,
				RT.APP_RT_OP_CD            		RT_APP_RT_OP_CD           ,
				RT.APP_CURR_CD             		RT_APP_CURR_CD            ,
				RT.APP_FRT_RT_AMT          		RT_APP_FRT_RT_AMT         ,

				RT.RAS_BKG_CONV_TP_CD      		RT_RAS_BKG_CONV_TP_CD     ,
				RT.RAS_NOTE_CONV_MAPG_ID   		RT_RAS_NOTE_CONV_MAPG_ID  ,
				RT.RAS_NOTE_CONV_SEQ       		RT_RAS_NOTE_CONV_SEQ      ,
				RT.RAS_NOTE_CONV_RULE_CD   		RT_RAS_NOTE_CONV_RULE_CD  ,
				RT.RAS_NOTE_CONV_TP_CD     		RT_RAS_NOTE_CONV_TP_CD    ,
				RT.RAS_RT_OP_CD            		RT_RAS_RT_OP_CD           ,
				RT.RAS_CURR_CD             		RT_RAS_CURR_CD            ,
				RT.RAS_FRT_RT_AMT          		RT_RAS_FRT_RT_AMT         ,
				RT.RAS_RAS_CONV_CTNT					RT_RAS_CONV_CTNT					,

				NULL										  		RT_ARB_BKG_CONV_TP_CD     ,
				NULL										  		RT_ARB_NOTE_CONV_MAPG_ID  ,
				NULL										  		RT_ARB_NOTE_CONV_SEQ      ,
				NULL										  		RT_ARB_NOTE_CONV_RULE_CD  ,
				NULL										  		RT_ARB_NOTE_CONV_TP_CD    ,
				NULL										  		RT_ARB_RT_OP_CD           ,
				NULL										  		RT_ARB_CURR_CD            ,
				NULL										  		RT_ARB_FRT_RT_AMT         ,

				NULL										  		RT_ADD_BKG_CONV_TP_CD     ,
				NULL										  		RT_ADD_NOTE_CONV_MAPG_ID  ,
				NULL										  		RT_ADD_NOTE_CONV_SEQ      ,
				NULL										  		RT_ADD_NOTE_CONV_RULE_CD  ,
				NULL										  		RT_ADD_NOTE_CONV_TP_CD    ,
				NULL										  		RT_ADD_RT_OP_CD           ,
				NULL										  		RT_ADD_CURR_CD            ,
				NULL										  		RT_ADD_FRT_RT_AMT         ,

				NULL										  		OA_TYP_BKG_CONV_TP_CD     ,
				NULL										  		OA_TYP_NOTE_CONV_MAPG_ID  ,
				NULL										  		OA_TYP_NOTE_CONV_SEQ      ,
				NULL										  		OA_TYP_NOTE_CONV_RULE_CD  ,
				NULL										  		OA_TYP_NOTE_CONV_TP_CD    ,
				NULL										  		OA_TYP_RT_OP_CD           ,
				NULL										  		OA_TYP_CURR_CD            ,
				NULL										  		OA_TYP_FRT_RT_AMT         ,
				NULL													OA_TYP_CONV_CTNT					,

				NULL										  		OA_RAC_BKG_CONV_TP_CD     ,
				NULL										  		OA_RAC_NOTE_CONV_MAPG_ID  ,
				NULL										  		OA_RAC_NOTE_CONV_SEQ      ,
				NULL										  		OA_RAC_NOTE_CONV_RULE_CD  ,
				NULL										  		OA_RAC_NOTE_CONV_TP_CD    ,
				NULL										  		OA_RAC_RT_OP_CD           ,
				NULL										  		OA_RAC_CURR_CD            ,
				NULL										  		OA_RAC_FRT_RT_AMT         ,
				NULL													OA_RAC_CONV_CTNT					,

				NULL										  		DA_TYP_BKG_CONV_TP_CD     ,
				NULL										  		DA_TYP_NOTE_CONV_MAPG_ID  ,
				NULL										  		DA_TYP_NOTE_CONV_SEQ      ,
				NULL										  		DA_TYP_NOTE_CONV_RULE_CD  ,
				NULL										  		DA_TYP_NOTE_CONV_TP_CD    ,
				NULL										  		DA_TYP_DA_OP_CD           ,
				NULL										  		DA_TYP_CURR_CD            ,
				NULL										  		DA_TYP_FRT_RT_AMT					,
				NULL													DA_TYP_CONV_CTNT					,

				NULL										  		DA_RAC_BKG_CONV_TP_CD     ,
				NULL										  		DA_RAC_NOTE_CONV_MAPG_ID  ,
				NULL										  		DA_RAC_NOTE_CONV_SEQ      ,
				NULL										  		DA_RAC_NOTE_CONV_RULE_CD  ,
				NULL										  		DA_RAC_NOTE_CONV_TP_CD    ,
				NULL										  		DA_RAC_DA_OP_CD           ,
				NULL										  		DA_RAC_CURR_CD            ,
				NULL										  		DA_RAC_FRT_RT_AMT					,
				NULL													DA_RAC_CONV_CTNT					,

				RT.POR_MTCH_FLG								POR_MTCH_FLG							,
				RT.DEL_MTCH_FLG								DEL_MTCH_FLG

FROM
/*******************************************************************************************
JOIN TABLE
1.1 BQ, RT
1.2 RT RULE					: RAP, RAR, DOR, TYP, RAC, APP, RAS
2.1 OA							: X
2.2 OA RULE					: X
3.1 DA							: X
3.2 DA RULE					: X
*******************************************************************************************/
				BQ	,
				RT	,
				NC_P											RT_RAP	,			/* COMMODITY CONVERSION */
				NC_P											RT_RAR	,			/* ROUTE CONVERSION */
				NC_P											RT_DOR	,			/* R/D TERM CONVERSION */
				NC_P											RT_TYP	,			/* RATING UNIT CONVERSION */
				NC_P											RT_RAC				/* CARGO TYPE CONVERSION */
WHERE		RT.BQ_SEQ		=	BQ.BQ_SEQ
AND			RT_RAP.BQ_SEQ	= RT.BQ_SEQ AND RT_RAP.NOTE_CONV_RULE_CD = 'RAP' AND ( RT_RAP.BKG_CONV_TP_CD = 'B' OR RT_RAP.NC_SEQ = RT.RAP_NC_SEQ )
AND			RT_RAR.BQ_SEQ	= RT.BQ_SEQ AND RT_RAR.NOTE_CONV_RULE_CD = 'RAR' AND ( RT_RAR.BKG_CONV_TP_CD = 'B' OR RT_RAR.NC_SEQ = RT.RAR_NC_SEQ )
AND			RT_DOR.BQ_SEQ	= RT.BQ_SEQ AND RT_DOR.NOTE_CONV_RULE_CD = 'DOR' AND ( RT_DOR.BKG_CONV_TP_CD = 'B' OR RT_DOR.NC_SEQ = RT.DOR_NC_SEQ )
AND			RT_TYP.BQ_SEQ	= RT.BQ_SEQ AND RT_TYP.NOTE_CONV_RULE_CD = 'TYP' AND ( RT_TYP.BKG_CONV_TP_CD = 'B' OR RT_TYP.NC_SEQ = RT.TYP_NC_SEQ )
AND			RT_RAC.BQ_SEQ	= RT.BQ_SEQ AND RT_RAC.NOTE_CONV_RULE_CD = 'RAC' AND ( RT_RAC.BKG_CONV_TP_CD = 'B' OR RT_RAC.NC_SEQ = RT.RAC_NC_SEQ )


/*******************************************************************************************
	1.1 RATE
*******************************************************************************************/

/*******************************************************************************************
	1.1.1 RATE - COMMODITY
	(주의)
	COMMODITY 나 RATING UNIT 등의 조건이 위의 OA, DA, RT 와 중복조건으로 보일 수 있으나,
	OA, DA, RT 는 CONVERSION 이 정확하게 적용한 것이 아니므로, 다시한번 정확하게 조건을 연결해야 한다.
*******************************************************************************************/

/*******************************************************************************************
< COMMODITY >
그룹, 개별간으로 일치하는 경우
*******************************************************************************************/
AND			( RT.CM_PRC_CMDT_TP_CD, RT.CM_PRC_CMDT_DEF_CD ) IN
				(
				SELECT	RT_RAP.CONV_CMDT_TP_CD, RT_RAP.CONV_CMDT_DEF_CD
				FROM		DUAL
				UNION ALL
				SELECT  'C', GC.PRC_CMDT_DEF_CD
				FROM		GC
				WHERE		RT_RAP.CONV_CMDT_TP_CD	= 'G'
				AND     GC.PRC_CMDT_TP_CD   		= 'C'
				AND			GC.PRC_GRP_CMDT_CD  		= RT_RAP.CONV_CMDT_DEF_CD
				UNION ALL
				SELECT  'G', GC.PRC_GRP_CMDT_CD
				FROM		GC
				WHERE		RT_RAP.CONV_CMDT_TP_CD	= 'C'
				AND     GC.PRC_CMDT_TP_CD   		= 'C'
				AND     GC.PRC_CMDT_DEF_CD  		= RT_RAP.CONV_CMDT_DEF_CD
				UNION ALL
				/* TAW 일 경우 FAK 고려함 */
				SELECT	'C', CMDT_CD
				FROM		MDM_COMMODITY
				WHERE		REP_CMDT_CD		= '0000'
				UNION ALL
				SELECT	'G', GC.PRC_GRP_CMDT_CD
				FROM		GC
				WHERE		GC.PRC_CMDT_TP_CD		= 'C'
				AND			GC.PRC_CMDT_DEF_CD  IN ( SELECT CMDT_CD FROM MDM_COMMODITY WHERE REP_CMDT_CD = '0000' )
				)


/*******************************************************************************************
	1.1.2 RATE - ROUTE
*******************************************************************************************/

/*******************************************************************************************
< DIRECT CALL >
BKG 이 DIRECT CALL 이거나,
DIRECT CALL FLAG 가 일치하는 경우
*******************************************************************************************/
AND			DECODE(BQ.DIR_CALL_FLG, 'Y', RT.RD_DIR_CALL_FLG, BQ.DIR_CALL_FLG) = RT.RD_DIR_CALL_FLG


/*******************************************************************************************
< ORIGIN ( POR OR POL ) >
*******************************************************************************************/

AND     ( RT.OP_ROUT_PNT_LOC_TP_CD, RT.OP_ROUT_PNT_LOC_DEF_CD ) IN
				(
				SELECT	RT_RAR.CONV_ORG_LOC_TP_CD,	RT_RAR.CONV_ORG_LOC_DEF_CD
				FROM		DUAL
				UNION ALL
				SELECT  'L', GL.LOC_CD
				FROM		GL
				WHERE		RT_RAR.CONV_ORG_LOC_TP_CD	= 'G'
				AND		  GL.PRC_GRP_LOC_CD 				= RT_RAR.CONV_ORG_LOC_DEF_CD
				UNION ALL
				SELECT  'G', GL.PRC_GRP_LOC_CD
				FROM		GL
				WHERE		RT_RAR.CONV_ORG_LOC_TP_CD	= 'L'
				AND     GL.LOC_CD									= RT_RAR.CONV_ORG_LOC_DEF_CD
				UNION ALL
				SELECT	RT_RAR.CONV_ORG_VIA_LOC_TP_CD,	RT_RAR.CONV_ORG_VIA_LOC_DEF_CD
				FROM		DUAL
				UNION ALL
				SELECT  'L', GL.LOC_CD
				FROM		GL
				WHERE		RT_RAR.CONV_ORG_VIA_LOC_TP_CD	= 'G'
				AND		  GL.PRC_GRP_LOC_CD 				= RT_RAR.CONV_ORG_VIA_LOC_DEF_CD
				UNION ALL
				SELECT  'G', GL.PRC_GRP_LOC_CD
				FROM		GL
				WHERE		RT_RAR.CONV_ORG_VIA_LOC_TP_CD	= 'L'
				AND     GL.LOC_CD									= RT_RAR.CONV_ORG_VIA_LOC_DEF_CD
				)


/*******************************************************************************************
< RCV TERM >
*******************************************************************************************/

AND     (
						(
								RT.POR_MTCH_FLG			= 'Y'
						AND	NVL(RT.OP_RCV_DE_TERM_CD, '*') IN
								(
								SELECT  B.RCV_DE_TERM_CD
								FROM		(
												SELECT 'Y' CONV_PRC_TERM_CD, 'Y' RCV_DE_TERM_CD FROM DUAL UNION ALL
												SELECT 'Y' CONV_PRC_TERM_CD, 'L' RCV_DE_TERM_CD FROM DUAL UNION ALL
												SELECT 'Y' CONV_PRC_TERM_CD, '*' RCV_DE_TERM_CD FROM DUAL UNION ALL
												SELECT 'S' CONV_PRC_TERM_CD, 'S' RCV_DE_TERM_CD FROM DUAL UNION ALL
												SELECT 'D' CONV_PRC_TERM_CD, 'D' RCV_DE_TERM_CD FROM DUAL UNION ALL
												SELECT 'T' CONV_PRC_TERM_CD, 'T' RCV_DE_TERM_CD FROM DUAL UNION ALL
												SELECT 'I' CONV_PRC_TERM_CD, 'I' RCV_DE_TERM_CD FROM DUAL
												)	B
								WHERE		B.CONV_PRC_TERM_CD	= RT_DOR.CONV_PRC_RCV_TERM_CD
								)
						)
				OR	(
								BQ.POR_CD										= BQ.POL_CD
						AND	NVL(RT.OP_RCV_DE_TERM_CD, '*') IN
								(
								SELECT  B.RCV_DE_TERM_CD
								FROM		(
												SELECT 'Y' CONV_PRC_TERM_CD, 'Y' RCV_DE_TERM_CD FROM DUAL UNION ALL
												SELECT 'Y' CONV_PRC_TERM_CD, 'L' RCV_DE_TERM_CD FROM DUAL UNION ALL
												SELECT 'Y' CONV_PRC_TERM_CD, '*' RCV_DE_TERM_CD FROM DUAL UNION ALL
												SELECT 'S' CONV_PRC_TERM_CD, 'S' RCV_DE_TERM_CD FROM DUAL UNION ALL
												SELECT 'D' CONV_PRC_TERM_CD, 'D' RCV_DE_TERM_CD FROM DUAL UNION ALL
												SELECT 'D' CONV_PRC_TERM_CD, 'Y' RCV_DE_TERM_CD FROM DUAL UNION ALL	-- 예외 적용
												SELECT 'T' CONV_PRC_TERM_CD, 'T' RCV_DE_TERM_CD FROM DUAL UNION ALL
												SELECT 'I' CONV_PRC_TERM_CD, 'I' RCV_DE_TERM_CD FROM DUAL
												)	B
								WHERE		B.CONV_PRC_TERM_CD	= RT_DOR.CONV_PRC_RCV_TERM_CD
								)
						)
				OR	(
								RT.POR_MTCH_FLG 								= 'N'
						AND	NVL(RT.OP_RCV_DE_TERM_CD, '*')	IN ( 'Y', '*' )
						)
				)


/*******************************************************************************************
< ORIGIN TRANS MODE >
*******************************************************************************************/

AND			(
					  RT.POR_MTCH_FLG = 'N'
				OR	(
								RT.OP_PRC_TRSP_MOD_CD	IS NULL
						OR	BQ.ORG_TRNS_MOD_CD		IS NULL
						OR	RT.OP_PRC_TRSP_MOD_CD	= BQ.ORG_TRNS_MOD_CD
						OR  (
										RT.OP_PRC_TRSP_MOD_CD	IN ( 'R', 'A' )
								AND	BQ.ORG_TRNS_MOD_CD		= 'R'
								)
						)
				)


/*******************************************************************************************
< ORIGIN VIA ( POL OR PRE RELAY ) >
*******************************************************************************************/

AND     (
						RT.OV_ROUT_VIA_PORT_DEF_CD IS NULL
				OR	( RT.OV_ROUT_VIA_PORT_TP_CD, RT.OV_ROUT_VIA_PORT_DEF_CD ) IN
						(
						SELECT	RT_RAR.CONV_ORG_VIA_LOC_TP_CD,	RT_RAR.CONV_ORG_VIA_LOC_DEF_CD
						FROM		DUAL
						UNION ALL
						SELECT  'L', GL.LOC_CD
						FROM		GL
						WHERE		RT_RAR.CONV_ORG_VIA_LOC_TP_CD	= 'G'
						AND		  GL.PRC_GRP_LOC_CD 						= RT_RAR.CONV_ORG_VIA_LOC_DEF_CD
						UNION ALL
						SELECT  'G', GL.PRC_GRP_LOC_CD
						FROM		GL
						WHERE		RT_RAR.CONV_ORG_VIA_LOC_TP_CD	= 'L'
						AND     GL.LOC_CD											= RT_RAR.CONV_ORG_VIA_LOC_DEF_CD
						UNION ALL
						SELECT	'L', BQ.PRE_RLY_PORT_CD
						FROM		DUAL
						UNION ALL
						SELECT  'G', GL.PRC_GRP_LOC_CD
						FROM		GL
						WHERE		GL.LOC_CD						= BQ.PRE_RLY_PORT_CD
						)
				)


/*******************************************************************************************
< DESTINATION VIA ( POD ) >
*******************************************************************************************/

AND     (
						RT.DV_ROUT_VIA_PORT_DEF_CD IS NULL
				OR	( RT.DV_ROUT_VIA_PORT_TP_CD, RT.DV_ROUT_VIA_PORT_DEF_CD ) IN
						(
						SELECT	RT_RAR.CONV_DEST_VIA_LOC_TP_CD,	RT_RAR.CONV_DEST_VIA_LOC_DEF_CD
						FROM		DUAL
						UNION ALL
						SELECT  'L', GL.LOC_CD
						FROM		GL
						WHERE		RT_RAR.CONV_DEST_VIA_LOC_TP_CD	= 'G'
						AND		  GL.PRC_GRP_LOC_CD 						= RT_RAR.CONV_DEST_VIA_LOC_DEF_CD
						UNION ALL
						SELECT  'G', GL.PRC_GRP_LOC_CD
						FROM		GL
						WHERE		RT_RAR.CONV_DEST_VIA_LOC_TP_CD	= 'L'
						AND     GL.LOC_CD											= RT_RAR.CONV_DEST_VIA_LOC_DEF_CD
						)
				)


/*******************************************************************************************
< DESTINATION (DEL OR POD ) >
*******************************************************************************************/

AND     ( RT.DP_ROUT_PNT_LOC_TP_CD, RT.DP_ROUT_PNT_LOC_DEF_CD ) IN
				(
				SELECT	RT_RAR.CONV_DEST_LOC_TP_CD,	RT_RAR.CONV_DEST_LOC_DEF_CD
				FROM		DUAL
				UNION ALL
				SELECT  'L', GL.LOC_CD
				FROM		GL
				WHERE		RT_RAR.CONV_DEST_LOC_TP_CD	= 'G'
				AND		  GL.PRC_GRP_LOC_CD 				= RT_RAR.CONV_DEST_LOC_DEF_CD
				UNION ALL
				SELECT  'G', GL.PRC_GRP_LOC_CD
				FROM		GL
				WHERE		RT_RAR.CONV_DEST_LOC_TP_CD	= 'L'
				AND     GL.LOC_CD									= RT_RAR.CONV_DEST_LOC_DEF_CD
				UNION ALL
				SELECT	RT_RAR.CONV_DEST_VIA_LOC_TP_CD,	RT_RAR.CONV_DEST_VIA_LOC_DEF_CD
				FROM		DUAL
				UNION ALL
				SELECT  'L', GL.LOC_CD
				FROM		GL
				WHERE		RT_RAR.CONV_DEST_VIA_LOC_TP_CD	= 'G'
				AND		  GL.PRC_GRP_LOC_CD 				= RT_RAR.CONV_DEST_VIA_LOC_DEF_CD
				UNION ALL
				SELECT  'G', GL.PRC_GRP_LOC_CD
				FROM		GL
				WHERE		RT_RAR.CONV_DEST_VIA_LOC_TP_CD	= 'L'
				AND     GL.LOC_CD									= RT_RAR.CONV_DEST_VIA_LOC_DEF_CD
				)


/*******************************************************************************************
< DE TERM >
*******************************************************************************************/

AND     (
						(
								RT.DEL_MTCH_FLG			= 'Y'
						AND	NVL(RT.DP_RCV_DE_TERM_CD, '*') IN
								(
								SELECT  B.RCV_DE_TERM_CD
								FROM		(
												SELECT 'Y' CONV_PRC_TERM_CD, 'Y' RCV_DE_TERM_CD FROM DUAL UNION ALL
												SELECT 'Y' CONV_PRC_TERM_CD, 'L' RCV_DE_TERM_CD FROM DUAL UNION ALL
												SELECT 'Y' CONV_PRC_TERM_CD, '*' RCV_DE_TERM_CD FROM DUAL UNION ALL
												SELECT 'S' CONV_PRC_TERM_CD, 'S' RCV_DE_TERM_CD FROM DUAL UNION ALL
												SELECT 'S' CONV_PRC_TERM_CD, 'Y' RCV_DE_TERM_CD FROM DUAL UNION ALL
												SELECT 'S' CONV_PRC_TERM_CD, 'T' RCV_DE_TERM_CD FROM DUAL UNION ALL
												SELECT 'S' CONV_PRC_TERM_CD, 'I' RCV_DE_TERM_CD FROM DUAL UNION ALL
												SELECT 'S' CONV_PRC_TERM_CD, 'L' RCV_DE_TERM_CD FROM DUAL UNION ALL
												SELECT 'S' CONV_PRC_TERM_CD, '*' RCV_DE_TERM_CD FROM DUAL UNION ALL
												SELECT 'D' CONV_PRC_TERM_CD, 'D' RCV_DE_TERM_CD FROM DUAL UNION ALL
												SELECT 'T' CONV_PRC_TERM_CD, 'T' RCV_DE_TERM_CD FROM DUAL UNION ALL
												SELECT 'I' CONV_PRC_TERM_CD, 'I' RCV_DE_TERM_CD FROM DUAL
												)	B
								WHERE		B.CONV_PRC_TERM_CD	= RT_DOR.CONV_PRC_DE_TERM_CD
								)
						)
				OR	(
								BQ.DEL_CD										= BQ.POD_CD
						AND	NVL(RT.DP_RCV_DE_TERM_CD, '*') IN
								(
								SELECT  B.RCV_DE_TERM_CD
								FROM		(
												SELECT 'Y' CONV_PRC_TERM_CD, 'Y' RCV_DE_TERM_CD FROM DUAL UNION ALL
												SELECT 'Y' CONV_PRC_TERM_CD, 'L' RCV_DE_TERM_CD FROM DUAL UNION ALL
												SELECT 'Y' CONV_PRC_TERM_CD, '*' RCV_DE_TERM_CD FROM DUAL UNION ALL
												SELECT 'S' CONV_PRC_TERM_CD, 'S' RCV_DE_TERM_CD FROM DUAL UNION ALL
												SELECT 'S' CONV_PRC_TERM_CD, 'Y' RCV_DE_TERM_CD FROM DUAL UNION ALL
												SELECT 'S' CONV_PRC_TERM_CD, 'T' RCV_DE_TERM_CD FROM DUAL UNION ALL
												SELECT 'S' CONV_PRC_TERM_CD, 'I' RCV_DE_TERM_CD FROM DUAL UNION ALL
												SELECT 'S' CONV_PRC_TERM_CD, 'L' RCV_DE_TERM_CD FROM DUAL UNION ALL
												SELECT 'S' CONV_PRC_TERM_CD, '*' RCV_DE_TERM_CD FROM DUAL UNION ALL
												SELECT 'D' CONV_PRC_TERM_CD, 'D' RCV_DE_TERM_CD FROM DUAL UNION ALL
												SELECT 'D' CONV_PRC_TERM_CD, 'Y' RCV_DE_TERM_CD FROM DUAL UNION ALL	-- 예외 적용
												SELECT 'T' CONV_PRC_TERM_CD, 'T' RCV_DE_TERM_CD FROM DUAL UNION ALL
												SELECT 'I' CONV_PRC_TERM_CD, 'I' RCV_DE_TERM_CD FROM DUAL
												)	B
								WHERE		B.CONV_PRC_TERM_CD	= RT_DOR.CONV_PRC_DE_TERM_CD
								)
						)
				OR	(
								RT.DEL_MTCH_FLG 								= 'N'
						AND	NVL(RT.DP_RCV_DE_TERM_CD, '*')	IN ( 'Y', '*' )
						)
				)


/*******************************************************************************************
< DEST TRANS MODE >
*******************************************************************************************/

AND			(
					  RT.DEL_MTCH_FLG = 'N'
				OR	(
								RT.DP_PRC_TRSP_MOD_CD	IS NULL
						OR	BQ.DEST_TRNS_MOD_CD		IS NULL
						OR	RT.DP_PRC_TRSP_MOD_CD	= BQ.DEST_TRNS_MOD_CD
						OR  (
										RT.DP_PRC_TRSP_MOD_CD	IN ( 'R', 'A' )
								AND	BQ.DEST_TRNS_MOD_CD		= 'R'
								)
						)
				)


/*******************************************************************************************
	1.1.3 RATE - RATING UNIT
*******************************************************************************************/

AND     (
								RT.RAT_UT_CD	= RT_TYP.CONV_RAT_UT_CD
		        OR	RT.RAT_UT_CD	= 'BL'	-- PATTERN #1 에서면 적용한다.
		        OR
    		    (
        				RT.RAT_UT_CD	IN ( '20', '40', 'HC', '45', '53' )
       			AND ( SELECT A.CNTR_SZ_CD FROM PRI_RAT_UT A WHERE A.RAT_UT_CD = RT.RAT_UT_CD )	= RT_TYP.CONV_RAT_UT_SZ_CD
        		)
				)

AND			RT.PRC_CGO_TP_CD	IN ( RT_RAC.CONV_DR_TP, RT_RAC.CONV_DG_TP, RT_RAC.CONV_RF_TP, RT_RAC.CONV_AK_TP, RT_RAC.CONV_BB_TP )


UNION ALL

/*******************************************************************************************
	2. PATTERN #2 ( 0100 )
*******************************************************************************************/

SELECT	'0100'												PRC_RT_MTCH_PATT_CD				,
				BQ.SC_NO											CTRT_NO										,
				BQ.PROP_NO										PROP_NO										,
				BQ.AMDT_SEQ										AMDT_SEQ									,
				BQ.SVC_SCP_CD									SVC_SCP_CD								,
				BQ.BQ_SEQ											BQ_SEQ										,
				BQ.BKG_BQ_SEQ									BKG_BQ_SEQ								,
				BQ.CNTR_TPSZ_CD								BQ_CNTR_TPSZ_CD						,
				BQ.CTRT_CNTR_TPSZ_CD					BQ_CTRT_CNTR_TPSZ_CD			,
				BQ.RCV_TERM_CD								BQ_RCV_TERM_CD						,
				BQ.DE_TERM_CD									BQ_DE_TERM_CD							,
				BQ.DRY_CGO_FLG								BQ_DRY_CGO_FLG						,
				BQ.DCGO_FLG										BQ_DCGO_FLG								,
				BQ.RC_FLG											BQ_RC_FLG									,
				BQ.AWK_CGO_FLG								BQ_AWK_CGO_FLG						,
				BQ.BB_CGO_FLG									BQ_BB_CGO_FLG							,
				BQ.SOC_FLG										BQ_SOC_FLG								,
				BQ.PRC_CGO_TP_CD							BQ_PRC_CGO_TP_CD					,
				BQ.IMDG_CLSS_CD								BQ_IMDG_CLSS_CD						,
				BQ.CTRT_CNTR_QTY							BQ_CTRT_CNTR_QTY					,
				BQ.POR_APPL_FLG								BQ_POR_APPL_FLG						,
				BQ.POL_APPL_FLG								BQ_POL_APPL_FLG						,
				BQ.POD_APPL_FLG								BQ_POD_APPL_FLG						,
				BQ.DEL_APPL_FLG								BQ_DEL_APPL_FLG						,
				BQ.PRE_RLY_PORT_APPL_FLG			BQ_POR_RLY_PORT_APPL_FLG	,
				BQ.PST_RLY_PORT_APPL_FLG			BQ_PST_RLY_PORT_APPL_FLG	,

				RT.CMDT_HDR_SEQ								RT_CMDT_HDR_SEQ						,
				RT.ROUT_SEQ										RT_ROUT_SEQ								,
				RT.RT_SEQ											RT_RT_SEQ									,
				0															OI_ADD_CHG_SEQ						,
				OA.ADD_CHG_SEQ								OA_ADD_CHG_SEQ						,
				0															DA_ADD_CHG_SEQ						,
				0															DI_ADD_CHG_SEQ						,

				RT.GEN_SPCL_RT_TP_CD					RT_GEN_SPCL_RT_TP_CD			,
				RT.CM_PRC_CMDT_TP_CD					CM_PRC_CMDT_TP_CD					,
				RT.CM_PRC_CMDT_DEF_CD					CM_PRC_CMDT_DEF_CD				,
				OA.ROUT_PNT_LOC_DEF_CD				POR_CD										,
				OA.BSE_PORT_DEF_CD						POL_CD										,
				RT.DV_ROUT_VIA_PORT_DEF_CD		POD_CD										,
				RT.DP_ROUT_PNT_LOC_DEF_CD			DEL_CD										,
				OA.DIR_CALL_FLG								DIR_CALL_FLG							,
				OA.RCV_DE_TERM_CD							RCV_TERM_CD								,
				RT.DP_RCV_DE_TERM_CD					DE_TERM_CD								,
				RT.RAT_UT_CD									RAT_UT_CD									,
				RT.PRC_CGO_TP_CD							PRC_CGO_TP_CD							,
				RT.CURR_CD										CURR_CD										,
				OA.PRC_TRSP_MOD_CD						ORG_TRSP_MOD_CD						,
				RT.DP_PRC_TRSP_MOD_CD					DEST_TRSP_MOD_CD					,

				RT.OP_ROUT_PNT_LOC_DEF_CD			OP_ROUT_PNT_LOC_DEF_CD		,
				RT.OV_ROUT_VIA_PORT_DEF_CD		OV_ROUT_VIA_PORT_DEF_CD		,
				RT.DV_ROUT_VIA_PORT_DEF_CD		DV_ROUT_VIA_PORT_DEF_CD		,
				RT.DP_ROUT_PNT_LOC_DEF_CD			DP_ROUT_PNT_LOC_DEF_CD		,
				RT.RD_DIR_CALL_FLG						RD_DIR_CALL_FLG						,
				RT.RAT_UT_CD									RT_RAT_UT_CD							,
				RT.PRC_CGO_TP_CD							RT_PRC_CGO_TP_CD					,
				RT.OP_PRC_TRSP_MOD_CD					OP_PRC_TRSP_MOD_CD				,
				RT.DP_PRC_TRSP_MOD_CD					DP_PRC_TRSP_MOD_CD				,
				RT.CURR_CD										RT_CURR_CD								,
				RT.FNL_FRT_RT_AMT							RT_FNL_FRT_RT_AMT					,

				NULL													OI_ROUT_PNT_LOC_DEF_CD		,
				NULL													OI_BSE_PORT_DEF_CD				,
				NULL													OI_VIA_PORT_DEF_CD				,
				NULL													OI_DIR_CALL_FLG						,
				NULL													OI_RAT_UT_CD							,
				NULL													OI_PRC_CGO_TP_CD					,
				NULL													OI_PRC_TRSP_MOD_CD				,
				NULL													OI_RCV_DE_TERM_CD					,
				NULL													OI_PRC_CMDT_DEF_CD				,
				NULL													OI_CURR_CD								,
				NULL													OI_FNL_FRT_RT_AMT					,
				NULL													OI_RAT_UT_MTCH_PRIO				,


				OA.ROUT_PNT_LOC_DEF_CD				OA_ROUT_PNT_LOC_DEF_CD		,
				OA.BSE_PORT_DEF_CD						OA_BSE_PORT_DEF_CD				,
				OA.VIA_PORT_DEF_CD						OA_VIA_PORT_DEF_CD				,
				OA.DIR_CALL_FLG								OA_DIR_CALL_FLG						,
				OA.RAT_UT_CD									OA_RAT_UT_CD							,
				OA.PRC_CGO_TP_CD							OA_PRC_CGO_TP_CD					,
				OA.PRC_TRSP_MOD_CD						OA_PRC_TRSP_MOD_CD				,
				OA.RCV_DE_TERM_CD							OA_RCV_DE_TERM_CD					,
				OA.PRC_CMDT_DEF_CD						OA_PRC_CMDT_DEF_CD				,
				OA.CURR_CD										OA_CURR_CD								,
				OA.FNL_FRT_RT_AMT							OA_FNL_FRT_RT_AMT					,
				OA.RAT_UT_MTCH_PRIO						OA_RAT_UT_MTCH_PRIO				,

				NULL													DA_ROUT_PNT_LOC_DEF_CD		,
				NULL													DA_BSE_PORT_DEF_CD				,
				NULL													DA_VIA_PORT_DEF_CD				,
				NULL													DA_DIR_CALL_FLG						,
				NULL													DA_RAT_UT_CD							,
				NULL													DA_PRC_CGO_TP_CD					,
				NULL													DA_PRC_TRSP_MOD_CD				,
				NULL													DA_RCV_DE_TERM_CD					,
				NULL													DA_PRC_CMDT_DEF_CD				,
				NULL													DA_CURR_CD								,
				NULL													DA_FNL_FRT_RT_AMT					,
				NULL													DA_RAT_UT_MTCH_PRIO				,

				NULL													DI_ROUT_PNT_LOC_DEF_CD		,
				NULL													DI_BSE_PORT_DEF_CD				,
				NULL													DI_VIA_PORT_DEF_CD				,
				NULL													DI_DIR_CALL_FLG						,
				NULL													DI_RAT_UT_CD							,
				NULL													DI_PRC_CGO_TP_CD					,
				NULL													DI_PRC_TRSP_MOD_CD				,
				NULL													DI_RCV_DE_TERM_CD					,
				NULL													DI_PRC_CMDT_DEF_CD				,
				NULL													DI_CURR_CD								,
				NULL													DI_FNL_FRT_RT_AMT					,
				NULL													DI_RAT_UT_MTCH_PRIO				,

				RT_RAP.BKG_CONV_TP_CD      		RT_RAP_BKG_CONV_TP_CD			,
				RT_RAP.NOTE_CONV_MAPG_ID   		RT_RAP_NOTE_CONV_MAPG_ID  ,
				RT_RAP.NOTE_CONV_SEQ       		RT_RAP_NOTE_CONV_SEQ      ,
				RT_RAP.NOTE_CONV_RULE_CD   		RT_RAP_NOTE_CONV_RULE_CD  ,
				RT_RAP.NOTE_CONV_TP_CD     		RT_RAP_NOTE_CONV_TP_CD    ,
				RT_RAP.RT_OP_CD            		RT_RAP_RT_OP_CD           ,
				RT_RAP.CURR_CD             		RT_RAP_CURR_CD            ,
				RT_RAP.FRT_RT_AMT          		RT_RAP_FRT_RT_AMT         ,
				RT_RAP.RAP_CONV_CTNT					RT_RAP_CONV_CTNT					,

				RT_RAR.BKG_CONV_TP_CD      		RT_RAR_BKG_CONV_TP_CD     ,
				RT_RAR.NOTE_CONV_MAPG_ID   		RT_RAR_NOTE_CONV_MAPG_ID  ,
				RT_RAR.NOTE_CONV_SEQ       		RT_RAR_NOTE_CONV_SEQ      ,
				RT_RAR.NOTE_CONV_RULE_CD   		RT_RAR_NOTE_CONV_RULE_CD  ,
				RT_RAR.NOTE_CONV_TP_CD     		RT_RAR_NOTE_CONV_TP_CD    ,
				RT_RAR.RT_OP_CD            		RT_RAR_RT_OP_CD           ,
				RT_RAR.CURR_CD             		RT_RAR_CURR_CD            ,
				RT_RAR.FRT_RT_AMT          		RT_RAR_FRT_RT_AMT         ,
				RT_RAR.RAR_CONV_CTNT					RT_RAR_CONV_CTNT					,

				RT_DOR.BKG_CONV_TP_CD      		RT_DOR_BKG_CONV_TP_CD     ,
				RT_DOR.NOTE_CONV_MAPG_ID   		RT_DOR_NOTE_CONV_MAPG_ID  ,
				RT_DOR.NOTE_CONV_SEQ       		RT_DOR_NOTE_CONV_SEQ      ,
				RT_DOR.NOTE_CONV_RULE_CD   		RT_DOR_NOTE_CONV_RULE_CD  ,
				RT_DOR.NOTE_CONV_TP_CD     		RT_DOR_NOTE_CONV_TP_CD    ,
				RT_DOR.RT_OP_CD            		RT_DOR_RT_OP_CD           ,
				RT_DOR.CURR_CD             		RT_DOR_CURR_CD            ,
				RT_DOR.FRT_RT_AMT          		RT_DOR_FRT_RT_AMT         ,
				RT_DOR.DOR_CONV_CTNT					RT_DOR_CONV_CTNT					,

				RT_TYP.BKG_CONV_TP_CD      		RT_TYP_BKG_CONV_TP_CD     ,
				RT_TYP.NOTE_CONV_MAPG_ID   		RT_TYP_NOTE_CONV_MAPG_ID  ,
				RT_TYP.NOTE_CONV_SEQ       		RT_TYP_NOTE_CONV_SEQ      ,
				RT_TYP.NOTE_CONV_RULE_CD   		RT_TYP_NOTE_CONV_RULE_CD  ,
				RT_TYP.NOTE_CONV_TP_CD     		RT_TYP_NOTE_CONV_TP_CD    ,
				RT_TYP.RT_OP_CD            		RT_TYP_RT_OP_CD           ,
				RT_TYP.CURR_CD             		RT_TYP_CURR_CD            ,
				RT_TYP.FRT_RT_AMT          		RT_TYP_FRT_RT_AMT         ,
				RT_TYP.TYP_CONV_CTNT					RT_TYP_CONV_CTNT					,

				RT_RAC.BKG_CONV_TP_CD      		RT_RAC_BKG_CONV_TP_CD     ,
				RT_RAC.NOTE_CONV_MAPG_ID   		RT_RAC_NOTE_CONV_MAPG_ID  ,
				RT_RAC.NOTE_CONV_SEQ       		RT_RAC_NOTE_CONV_SEQ      ,
				RT_RAC.NOTE_CONV_RULE_CD   		RT_RAC_NOTE_CONV_RULE_CD  ,
				RT_RAC.NOTE_CONV_TP_CD     		RT_RAC_NOTE_CONV_TP_CD    ,
				RT_RAC.RT_OP_CD            		RT_RAC_RT_OP_CD           ,
				RT_RAC.CURR_CD             		RT_RAC_CURR_CD            ,
				RT_RAC.FRT_RT_AMT          		RT_RAC_FRT_RT_AMT         ,
				RT_RAC.RAC_CONV_CTNT					RT_RAC_CONV_CTNT					,

				RT.APP_BKG_CONV_TP_CD      		RT_APP_BKG_CONV_TP_CD     ,
				RT.APP_NOTE_CONV_MAPG_ID   		RT_APP_NOTE_CONV_MAPG_ID  ,
				RT.APP_NOTE_CONV_SEQ       		RT_APP_NOTE_CONV_SEQ      ,
				RT.APP_NOTE_CONV_RULE_CD   		RT_APP_NOTE_CONV_RULE_CD  ,
				RT.APP_NOTE_CONV_TP_CD     		RT_APP_NOTE_CONV_TP_CD    ,
				RT.APP_RT_OP_CD            		RT_APP_RT_OP_CD           ,
				RT.APP_CURR_CD             		RT_APP_CURR_CD            ,
				RT.APP_FRT_RT_AMT          		RT_APP_FRT_RT_AMT         ,

				RT.RAS_BKG_CONV_TP_CD      		RT_RAS_BKG_CONV_TP_CD     ,
				RT.RAS_NOTE_CONV_MAPG_ID   		RT_RAS_NOTE_CONV_MAPG_ID  ,
				RT.RAS_NOTE_CONV_SEQ       		RT_RAS_NOTE_CONV_SEQ      ,
				RT.RAS_NOTE_CONV_RULE_CD   		RT_RAS_NOTE_CONV_RULE_CD  ,
				RT.RAS_NOTE_CONV_TP_CD     		RT_RAS_NOTE_CONV_TP_CD    ,
				RT.RAS_RT_OP_CD            		RT_RAS_RT_OP_CD           ,
				RT.RAS_CURR_CD             		RT_RAS_CURR_CD            ,
				RT.RAS_FRT_RT_AMT          		RT_RAS_FRT_RT_AMT         ,
				RT.RAS_RAS_CONV_CTNT					RT_RAS_CONV_CTNT					,

				RT.ARB_BKG_CONV_TP_CD      		RT_ARB_BKG_CONV_TP_CD     ,
				RT.ARB_NOTE_CONV_MAPG_ID   		RT_ARB_NOTE_CONV_MAPG_ID  ,
				RT.ARB_NOTE_CONV_SEQ       		RT_ARB_NOTE_CONV_SEQ      ,
				RT.ARB_NOTE_CONV_RULE_CD   		RT_ARB_NOTE_CONV_RULE_CD  ,
				RT.ARB_NOTE_CONV_TP_CD     		RT_ARB_NOTE_CONV_TP_CD    ,
				RT.ARB_RT_OP_CD            		RT_ARB_RT_OP_CD           ,
				RT.ARB_CURR_CD             		RT_ARB_CURR_CD            ,
				RT.ARB_FRT_RT_AMT          		RT_ARB_FRT_RT_AMT         ,

				NULL													RT_ADD_BKG_CONV_TP_CD     ,
				NULL													RT_ADD_NOTE_CONV_MAPG_ID  ,
				NULL													RT_ADD_NOTE_CONV_SEQ      ,
				NULL													RT_ADD_NOTE_CONV_RULE_CD  ,
				NULL													RT_ADD_NOTE_CONV_TP_CD    ,
				NULL													RT_ADD_RT_OP_CD           ,
				NULL													RT_ADD_CURR_CD            ,
				NULL													RT_ADD_FRT_RT_AMT         ,

				OA_TYP.BKG_CONV_TP_CD      		OA_TYP_BKG_CONV_TP_CD     ,
				OA_TYP.NOTE_CONV_MAPG_ID   		OA_TYP_NOTE_CONV_MAPG_ID  ,
				OA_TYP.NOTE_CONV_SEQ       		OA_TYP_NOTE_CONV_SEQ      ,
				OA_TYP.NOTE_CONV_RULE_CD   		OA_TYP_NOTE_CONV_RULE_CD  ,
				OA_TYP.NOTE_CONV_TP_CD     		OA_TYP_NOTE_CONV_TP_CD    ,
				OA_TYP.RT_OP_CD            		OA_TYP_RT_OP_CD           ,
				OA_TYP.CURR_CD             		OA_TYP_CURR_CD            ,
				OA_TYP.FRT_RT_AMT          		OA_TYP_FRT_RT_AMT         ,
				OA_TYP.TYP_CONV_CTNT       		OA_TYP_CONV_CTNT         	,

				OA_RAC.BKG_CONV_TP_CD      		OA_RAC_BKG_CONV_TP_CD     ,
				OA_RAC.NOTE_CONV_MAPG_ID   		OA_RAC_NOTE_CONV_MAPG_ID  ,
				OA_RAC.NOTE_CONV_SEQ       		OA_RAC_NOTE_CONV_SEQ      ,
				OA_RAC.NOTE_CONV_RULE_CD   		OA_RAC_NOTE_CONV_RULE_CD  ,
				OA_RAC.NOTE_CONV_TP_CD     		OA_RAC_NOTE_CONV_TP_CD    ,
				OA_RAC.RT_OP_CD            		OA_RAC_RT_OP_CD           ,
				OA_RAC.CURR_CD             		OA_RAC_CURR_CD            ,
				OA_RAC.FRT_RT_AMT          		OA_RAC_FRT_RT_AMT         ,
				OA_RAC.RAC_CONV_CTNT       		OA_RAC_CONV_CTNT         	,

				NULL													DA_TYP_BKG_CONV_TP_CD     ,
				NULL													DA_TYP_NOTE_CONV_MAPG_ID  ,
				NULL													DA_TYP_NOTE_CONV_SEQ      ,
				NULL													DA_TYP_NOTE_CONV_RULE_CD  ,
				NULL													DA_TYP_NOTE_CONV_TP_CD    ,
				NULL													DA_TYP_DA_OP_CD           ,
				NULL													DA_TYP_CURR_CD            ,
				NULL													DA_TYP_FRT_RT_AMT					,
				NULL													DA_TYP_CONV_CTNT					,

				NULL													DA_RAC_BKG_CONV_TP_CD     ,
				NULL													DA_RAC_NOTE_CONV_MAPG_ID  ,
				NULL													DA_RAC_NOTE_CONV_SEQ      ,
				NULL													DA_RAC_NOTE_CONV_RULE_CD  ,
				NULL													DA_RAC_NOTE_CONV_TP_CD    ,
				NULL													DA_RAC_DA_OP_CD           ,
				NULL													DA_RAC_CURR_CD            ,
				NULL													DA_RAC_FRT_RT_AMT					,
				NULL													DA_RAC_CONV_CTNT					,

				OA.POR_MTCH_FLG								POR_MTCH_FLG							,
				RT.DEL_MTCH_FLG								DEL_MTCH_FLG

FROM
/*******************************************************************************************
JOIN TABLE
1.1 BQ, CH, CM, CR, RD, OP, DV, DP, RT
1.2 RT RULE					: RAP, RAR, DOR, TYP, RAC, APP, RAS, ARB
2.1 OA							: O
2.2 OA RULE					: TYP, RAC ( RAP, RAR, DOR 는 RT 와 동일하게 적용 )
3.1 DA							: X
3.2 DA RULE					: X
*******************************************************************************************/
				BQ	,
				OA	,
				RT	,
				NC_P											RT_RAP	,			/* COMMODITY CONVERSION */
				NC_P											RT_RAR	,			/* ROUTE CONVERSION */
				NC_P											RT_DOR	,			/* R/D TERM CONVERSION */
				NC_P											RT_TYP	,			/* RATING UNIT CONVERSION */
				NC_P											RT_RAC	,			/* CARGO TYPE CONVERSION */
				NC_P											OA_TYP	,			/* RATING UNIT CONVERSION */
				NC_P											OA_RAC				/* CARGO TYPE CONVERSION */

WHERE		RT.BQ_SEQ		=	BQ.BQ_SEQ
AND			OA.BQ_SEQ		= BQ.BQ_SEQ
AND			RT_RAP.BQ_SEQ	= RT.BQ_SEQ AND RT_RAP.NOTE_CONV_RULE_CD = 'RAP' AND ( RT_RAP.BKG_CONV_TP_CD = 'B' OR RT_RAP.NC_SEQ = RT.RAP_NC_SEQ )
AND			RT_RAR.BQ_SEQ	= RT.BQ_SEQ AND RT_RAR.NOTE_CONV_RULE_CD = 'RAR' AND ( RT_RAR.BKG_CONV_TP_CD = 'B' OR RT_RAR.NC_SEQ = RT.RAR_NC_SEQ )
AND			RT_DOR.BQ_SEQ	= RT.BQ_SEQ AND RT_DOR.NOTE_CONV_RULE_CD = 'DOR' AND ( RT_DOR.BKG_CONV_TP_CD = 'B' OR RT_DOR.NC_SEQ = RT.DOR_NC_SEQ )
AND			RT_TYP.BQ_SEQ	= RT.BQ_SEQ AND RT_TYP.NOTE_CONV_RULE_CD = 'TYP' AND ( RT_TYP.BKG_CONV_TP_CD = 'B' OR RT_TYP.NC_SEQ = RT.TYP_NC_SEQ )
AND			RT_RAC.BQ_SEQ	= RT.BQ_SEQ AND RT_RAC.NOTE_CONV_RULE_CD = 'RAC' AND ( RT_RAC.BKG_CONV_TP_CD = 'B' OR RT_RAC.NC_SEQ = RT.RAC_NC_SEQ )
AND			OA_TYP.BQ_SEQ	= RT.BQ_SEQ AND OA_TYP.NOTE_CONV_RULE_CD = 'TYP' AND ( OA_TYP.BKG_CONV_TP_CD = 'B' OR OA_TYP.NC_SEQ = RT.TYP_NC_SEQ )
AND			OA_RAC.BQ_SEQ	= RT.BQ_SEQ AND OA_RAC.NOTE_CONV_RULE_CD = 'RAC' AND ( OA_RAC.BKG_CONV_TP_CD = 'B' OR OA_RAC.NC_SEQ = RT.RAC_NC_SEQ )


/*******************************************************************************************
	2.1 RATE
*******************************************************************************************/

/*******************************************************************************************
	2.1.1 RATE - COMMODITY
*******************************************************************************************/

/*******************************************************************************************
< COMMODITY >
그룹, 개별간으로 일치하는 경우
*******************************************************************************************/

AND			( RT.CM_PRC_CMDT_TP_CD, RT.CM_PRC_CMDT_DEF_CD ) IN
				(
				SELECT	RT_RAP.CONV_CMDT_TP_CD, RT_RAP.CONV_CMDT_DEF_CD
				FROM		DUAL
				UNION ALL
				SELECT  'C', GC.PRC_CMDT_DEF_CD
				FROM		GC
				WHERE		RT_RAP.CONV_CMDT_TP_CD	= 'G'
				AND     GC.PRC_CMDT_TP_CD   		= 'C'
				AND			GC.PRC_GRP_CMDT_CD  		= RT_RAP.CONV_CMDT_DEF_CD
				UNION ALL
				SELECT  'G', GC.PRC_GRP_CMDT_CD
				FROM		GC
				WHERE		RT_RAP.CONV_CMDT_TP_CD	= 'C'
				AND     GC.PRC_CMDT_TP_CD   		= 'C'
				AND     GC.PRC_CMDT_DEF_CD  		= RT_RAP.CONV_CMDT_DEF_CD
				UNION ALL
				/* TAW 일 경우 FAK 고려함 */
				SELECT	'C', CMDT_CD
				FROM		MDM_COMMODITY
				WHERE		REP_CMDT_CD		= '0000'
				UNION ALL
				SELECT	'G', GC.PRC_GRP_CMDT_CD
				FROM		GC
				WHERE		GC.PRC_CMDT_TP_CD		= 'C'
				AND			GC.PRC_CMDT_DEF_CD  IN ( SELECT CMDT_CD FROM MDM_COMMODITY WHERE REP_CMDT_CD = '0000' )
				)


/*******************************************************************************************
	2.1.2 RATE - ROUTE
*******************************************************************************************/

/*******************************************************************************************
< ORIGIN ( PRE RELAY ) >
*******************************************************************************************/

AND     ( RT.OP_ROUT_PNT_LOC_TP_CD, RT.OP_ROUT_PNT_LOC_DEF_CD ) IN
				(
				SELECT	'L', BQ.PRE_RLY_PORT_CD
				FROM		DUAL
				UNION ALL
				SELECT  'G', GL.PRC_GRP_LOC_CD
				FROM		GL
				WHERE		GL.LOC_CD						= BQ.PRE_RLY_PORT_CD
				)


/*******************************************************************************************
< ORIGIN VIA ( PRE RELAY ) >
*******************************************************************************************/

AND     (
						RT.OV_ROUT_VIA_PORT_DEF_CD IS NULL
				OR	( RT.OV_ROUT_VIA_PORT_TP_CD, RT.OV_ROUT_VIA_PORT_DEF_CD ) IN
						(
						SELECT	'L', BQ.PRE_RLY_PORT_CD
						FROM		DUAL
						UNION ALL
						SELECT  'G', GL.PRC_GRP_LOC_CD
						FROM		GL
						WHERE		GL.LOC_CD						= BQ.PRE_RLY_PORT_CD
						)
				)


/*******************************************************************************************
< DESTINATION VIA ( POD ) >
*******************************************************************************************/

AND     (
						RT.DV_ROUT_VIA_PORT_DEF_CD IS NULL
				OR	( RT.DV_ROUT_VIA_PORT_TP_CD, RT.DV_ROUT_VIA_PORT_DEF_CD ) IN
						(
						SELECT	RT_RAR.CONV_DEST_VIA_LOC_TP_CD,	RT_RAR.CONV_DEST_VIA_LOC_DEF_CD
						FROM		DUAL
						UNION ALL
						SELECT  'L', GL.LOC_CD
						FROM		GL
						WHERE		RT_RAR.CONV_DEST_VIA_LOC_TP_CD	= 'G'
						AND		  GL.PRC_GRP_LOC_CD 						= RT_RAR.CONV_DEST_VIA_LOC_DEF_CD
						UNION ALL
						SELECT  'G', GL.PRC_GRP_LOC_CD
						FROM		GL
						WHERE		RT_RAR.CONV_DEST_VIA_LOC_TP_CD	= 'L'
						AND     GL.LOC_CD											= RT_RAR.CONV_DEST_VIA_LOC_DEF_CD
						)
				)


/*******************************************************************************************
< DESTINATION ( DEL OR POD ) >
*******************************************************************************************/

AND     ( RT.DP_ROUT_PNT_LOC_TP_CD, RT.DP_ROUT_PNT_LOC_DEF_CD ) IN
				(
				SELECT	RT_RAR.CONV_DEST_LOC_TP_CD,	RT_RAR.CONV_DEST_LOC_DEF_CD
				FROM		DUAL
				UNION ALL
				SELECT  'L', GL.LOC_CD
				FROM		GL
				WHERE		RT_RAR.CONV_DEST_LOC_TP_CD	= 'G'
				AND		  GL.PRC_GRP_LOC_CD 				= RT_RAR.CONV_DEST_LOC_DEF_CD
				UNION ALL
				SELECT  'G', GL.PRC_GRP_LOC_CD
				FROM		GL
				WHERE		RT_RAR.CONV_DEST_LOC_TP_CD	= 'L'
				AND     GL.LOC_CD									= RT_RAR.CONV_DEST_LOC_DEF_CD
				UNION ALL
				SELECT	RT_RAR.CONV_DEST_VIA_LOC_TP_CD,	RT_RAR.CONV_DEST_VIA_LOC_DEF_CD
				FROM		DUAL
				UNION ALL
				SELECT  'L', GL.LOC_CD
				FROM		GL
				WHERE		RT_RAR.CONV_DEST_VIA_LOC_TP_CD	= 'G'
				AND		  GL.PRC_GRP_LOC_CD 				= RT_RAR.CONV_DEST_VIA_LOC_DEF_CD
				UNION ALL
				SELECT  'G', GL.PRC_GRP_LOC_CD
				FROM		GL
				WHERE		RT_RAR.CONV_DEST_VIA_LOC_TP_CD	= 'L'
				AND     GL.LOC_CD									= RT_RAR.CONV_DEST_VIA_LOC_DEF_CD
				)


/*******************************************************************************************
< DE TERM >
*******************************************************************************************/

AND     (
						(
								RT.DEL_MTCH_FLG			= 'Y'
						AND	NVL(RT.DP_RCV_DE_TERM_CD, '*') IN
								(
								SELECT  B.RCV_DE_TERM_CD
								FROM		(
												SELECT 'Y' CONV_PRC_TERM_CD, 'Y' RCV_DE_TERM_CD FROM DUAL UNION ALL
												SELECT 'Y' CONV_PRC_TERM_CD, 'L' RCV_DE_TERM_CD FROM DUAL UNION ALL
												SELECT 'Y' CONV_PRC_TERM_CD, '*' RCV_DE_TERM_CD FROM DUAL UNION ALL
												SELECT 'S' CONV_PRC_TERM_CD, 'S' RCV_DE_TERM_CD FROM DUAL UNION ALL
												SELECT 'S' CONV_PRC_TERM_CD, 'Y' RCV_DE_TERM_CD FROM DUAL UNION ALL
												SELECT 'S' CONV_PRC_TERM_CD, 'T' RCV_DE_TERM_CD FROM DUAL UNION ALL
												SELECT 'S' CONV_PRC_TERM_CD, 'I' RCV_DE_TERM_CD FROM DUAL UNION ALL
												SELECT 'S' CONV_PRC_TERM_CD, 'L' RCV_DE_TERM_CD FROM DUAL UNION ALL
												SELECT 'S' CONV_PRC_TERM_CD, '*' RCV_DE_TERM_CD FROM DUAL UNION ALL
												SELECT 'D' CONV_PRC_TERM_CD, 'D' RCV_DE_TERM_CD FROM DUAL UNION ALL
												SELECT 'T' CONV_PRC_TERM_CD, 'T' RCV_DE_TERM_CD FROM DUAL UNION ALL
												SELECT 'I' CONV_PRC_TERM_CD, 'I' RCV_DE_TERM_CD FROM DUAL
												)	B
								WHERE		B.CONV_PRC_TERM_CD	= RT_DOR.CONV_PRC_DE_TERM_CD
								)
						)
				OR	(
								BQ.DEL_CD										= BQ.POD_CD
						AND	NVL(RT.DP_RCV_DE_TERM_CD, '*') IN
								(
								SELECT  B.RCV_DE_TERM_CD
								FROM		(
												SELECT 'Y' CONV_PRC_TERM_CD, 'Y' RCV_DE_TERM_CD FROM DUAL UNION ALL
												SELECT 'Y' CONV_PRC_TERM_CD, 'L' RCV_DE_TERM_CD FROM DUAL UNION ALL
												SELECT 'Y' CONV_PRC_TERM_CD, '*' RCV_DE_TERM_CD FROM DUAL UNION ALL
												SELECT 'S' CONV_PRC_TERM_CD, 'S' RCV_DE_TERM_CD FROM DUAL UNION ALL
												SELECT 'S' CONV_PRC_TERM_CD, 'Y' RCV_DE_TERM_CD FROM DUAL UNION ALL
												SELECT 'S' CONV_PRC_TERM_CD, 'T' RCV_DE_TERM_CD FROM DUAL UNION ALL
												SELECT 'S' CONV_PRC_TERM_CD, 'I' RCV_DE_TERM_CD FROM DUAL UNION ALL
												SELECT 'S' CONV_PRC_TERM_CD, 'L' RCV_DE_TERM_CD FROM DUAL UNION ALL
												SELECT 'S' CONV_PRC_TERM_CD, '*' RCV_DE_TERM_CD FROM DUAL UNION ALL
												SELECT 'D' CONV_PRC_TERM_CD, 'D' RCV_DE_TERM_CD FROM DUAL UNION ALL
												SELECT 'D' CONV_PRC_TERM_CD, 'Y' RCV_DE_TERM_CD FROM DUAL UNION ALL	-- 예외 적용
												SELECT 'T' CONV_PRC_TERM_CD, 'T' RCV_DE_TERM_CD FROM DUAL UNION ALL
												SELECT 'I' CONV_PRC_TERM_CD, 'I' RCV_DE_TERM_CD FROM DUAL
												)	B
								WHERE		B.CONV_PRC_TERM_CD	= RT_DOR.CONV_PRC_DE_TERM_CD
								)
						)
				OR	(
								RT.DEL_MTCH_FLG 								= 'N'
						AND	NVL(RT.DP_RCV_DE_TERM_CD, '*')	IN ( 'Y', '*' )
						)
				)


/*******************************************************************************************
< DEST TRANS MODE >
*******************************************************************************************/

AND			(
					  RT.DEL_MTCH_FLG = 'N'
				OR	(
								RT.DP_PRC_TRSP_MOD_CD	IS NULL
						OR	BQ.DEST_TRNS_MOD_CD		IS NULL
						OR	RT.DP_PRC_TRSP_MOD_CD	= BQ.DEST_TRNS_MOD_CD
						OR  (
										RT.DP_PRC_TRSP_MOD_CD	IN ( 'R', 'A' )
								AND	BQ.DEST_TRNS_MOD_CD		= 'R'
								)
						)
				)


/*******************************************************************************************
	2.1.3 RATE - RATING UNIT
*******************************************************************************************/

AND     (
								RT.RAT_UT_CD	= RT_TYP.CONV_RAT_UT_CD
		        OR
    		    (
        				RT.RAT_UT_CD	IN ( '20', '40', 'HC', '45', '53' )
       			AND ( SELECT A.CNTR_SZ_CD FROM PRI_RAT_UT A WHERE A.RAT_UT_CD = RT.RAT_UT_CD )	= RT_TYP.CONV_RAT_UT_SZ_CD
        		)
				)

AND			RT.PRC_CGO_TP_CD	IN ( RT_RAC.CONV_DR_TP, RT_RAC.CONV_DG_TP, RT_RAC.CONV_RF_TP, RT_RAC.CONV_AK_TP, RT_RAC.CONV_BB_TP )


/*******************************************************************************************
	2.2 ORIGIN ARB
*******************************************************************************************/

/*******************************************************************************************
	2.2.1 ORIGIN ARB - COMMODITY
*******************************************************************************************/

AND			(
						OA.PRC_CMDT_DEF_CD	IS NULL
				OR	( OA.PRC_CMDT_TP_CD, OA.PRC_CMDT_DEF_CD ) IN
						(
						SELECT	RT_RAP.CONV_CMDT_TP_CD, RT_RAP.CONV_CMDT_DEF_CD
						FROM		DUAL
						UNION ALL
						SELECT  'C', GC.PRC_CMDT_DEF_CD
						FROM		GC
						WHERE		RT_RAP.CONV_CMDT_TP_CD	= 'G'
						AND     GC.PRC_CMDT_TP_CD   		= 'C'
						AND			GC.PRC_GRP_CMDT_CD  		= RT_RAP.CONV_CMDT_DEF_CD
						UNION ALL
						SELECT  'G', GC.PRC_GRP_CMDT_CD
						FROM		GC
						WHERE		RT_RAP.CONV_CMDT_TP_CD	= 'C'
						AND     GC.PRC_CMDT_TP_CD   		= 'C'
						AND     GC.PRC_CMDT_DEF_CD  		= RT_RAP.CONV_CMDT_DEF_CD
						UNION ALL
						/* TAW 일 경우 FAK 고려함 */
						SELECT	'C', CMDT_CD
						FROM		MDM_COMMODITY
						WHERE		REP_CMDT_CD		= '0000'
						UNION ALL
						SELECT	'G', GC.PRC_GRP_CMDT_CD
						FROM		GC
						WHERE		GC.PRC_CMDT_TP_CD		= 'C'
						AND			GC.PRC_CMDT_DEF_CD  IN ( SELECT CMDT_CD FROM MDM_COMMODITY WHERE REP_CMDT_CD = '0000' )
						)
				)


/*******************************************************************************************
	2.2.2 ORIGIN ARB - ROUTE
*******************************************************************************************/

/*******************************************************************************************
< POINT ( POR OR POL ) >
*******************************************************************************************/

AND     ( OA.ROUT_PNT_LOC_TP_CD, OA.ROUT_PNT_LOC_DEF_CD ) IN
				(
				SELECT  RT_RAR.CONV_ORG_LOC_TP_CD, RT_RAR.CONV_ORG_LOC_DEF_CD
				FROM		DUAL
				UNION ALL
				SELECT  'L', GL.LOC_CD
				FROM		GL
				WHERE		RT_RAR.CONV_ORG_LOC_TP_CD	= 'G'
				AND		  GL.PRC_GRP_LOC_CD 				= RT_RAR.CONV_ORG_LOC_DEF_CD
				UNION ALL
				SELECT  'G', GL.PRC_GRP_LOC_CD
				FROM		GL
				WHERE		RT_RAR.CONV_ORG_LOC_TP_CD	= 'L'
				AND     GL.LOC_CD									= RT_RAR.CONV_ORG_LOC_DEF_CD
				UNION ALL
				SELECT	RT_RAR.CONV_ORG_VIA_LOC_TP_CD,	RT_RAR.CONV_ORG_VIA_LOC_DEF_CD
				FROM		DUAL
				UNION ALL
				SELECT  'L', GL.LOC_CD
				FROM		GL
				WHERE		RT_RAR.CONV_ORG_VIA_LOC_TP_CD	= 'G'
				AND		  GL.PRC_GRP_LOC_CD 				= RT_RAR.CONV_ORG_VIA_LOC_DEF_CD
				UNION ALL
				SELECT  'G', GL.PRC_GRP_LOC_CD
				FROM		GL
				WHERE		RT_RAR.CONV_ORG_VIA_LOC_TP_CD	= 'L'
				AND     GL.LOC_CD									= RT_RAR.CONV_ORG_VIA_LOC_DEF_CD
				)


/*******************************************************************************************
< RCV TERM >
*******************************************************************************************/

AND     (
						(
								OA.POR_MTCH_FLG			= 'Y'
						AND	NVL(OA.RCV_DE_TERM_CD, '*') IN
								(
								SELECT  B.RCV_DE_TERM_CD
								FROM		(
												SELECT 'Y' CONV_PRC_TERM_CD, 'Y' RCV_DE_TERM_CD FROM DUAL UNION ALL
												SELECT 'Y' CONV_PRC_TERM_CD, 'L' RCV_DE_TERM_CD FROM DUAL UNION ALL
												SELECT 'Y' CONV_PRC_TERM_CD, '*' RCV_DE_TERM_CD FROM DUAL UNION ALL
												SELECT 'S' CONV_PRC_TERM_CD, 'S' RCV_DE_TERM_CD FROM DUAL UNION ALL
												SELECT 'D' CONV_PRC_TERM_CD, 'D' RCV_DE_TERM_CD FROM DUAL UNION ALL
												SELECT 'T' CONV_PRC_TERM_CD, 'T' RCV_DE_TERM_CD FROM DUAL UNION ALL
												SELECT 'I' CONV_PRC_TERM_CD, 'I' RCV_DE_TERM_CD FROM DUAL
												)	B
								WHERE		B.CONV_PRC_TERM_CD	= RT_DOR.CONV_PRC_RCV_TERM_CD
								)
						)
				OR	(
								BQ.POR_CD										= BQ.POL_CD
						AND	NVL(OA.RCV_DE_TERM_CD, '*') IN
								(
								SELECT  B.RCV_DE_TERM_CD
								FROM		(
												SELECT 'Y' CONV_PRC_TERM_CD, 'Y' RCV_DE_TERM_CD FROM DUAL UNION ALL
												SELECT 'Y' CONV_PRC_TERM_CD, 'L' RCV_DE_TERM_CD FROM DUAL UNION ALL
												SELECT 'Y' CONV_PRC_TERM_CD, '*' RCV_DE_TERM_CD FROM DUAL UNION ALL
												SELECT 'S' CONV_PRC_TERM_CD, 'S' RCV_DE_TERM_CD FROM DUAL UNION ALL
												SELECT 'D' CONV_PRC_TERM_CD, 'D' RCV_DE_TERM_CD FROM DUAL UNION ALL
												SELECT 'D' CONV_PRC_TERM_CD, 'Y' RCV_DE_TERM_CD FROM DUAL UNION ALL	-- 예외 적용
												SELECT 'T' CONV_PRC_TERM_CD, 'T' RCV_DE_TERM_CD FROM DUAL UNION ALL
												SELECT 'I' CONV_PRC_TERM_CD, 'I' RCV_DE_TERM_CD FROM DUAL
												)	B
								WHERE		B.CONV_PRC_TERM_CD	= RT_DOR.CONV_PRC_RCV_TERM_CD
								)
						)
				OR	(
								OA.POR_MTCH_FLG 								= 'N'
						AND	NVL(OA.RCV_DE_TERM_CD, '*')	IN ( 'Y', '*' )
						)
				)


/*******************************************************************************************
< ORIGIN TRANS MODE >
*******************************************************************************************/

AND     (
            OA.POR_MTCH_FLG = 'N'
        OR  (
								OA.PRC_TRSP_MOD_CD		IS NULL
						OR	BQ.ORG_TRNS_MOD_CD		IS NULL
						OR	OA.PRC_TRSP_MOD_CD		= BQ.ORG_TRNS_MOD_CD
						OR  (
										OA.PRC_TRSP_MOD_CD		IN ( 'R', 'A' )
								AND	BQ.ORG_TRNS_MOD_CD		= 'R'
								)
						)
        )


/*******************************************************************************************
< VIA PORT ( PRE RELAY ) >
*******************************************************************************************/

AND     (
                OA.VIA_PORT_DEF_CD  IS NULL
            OR	( OA.VIA_PORT_TP_CD, OA.VIA_PORT_DEF_CD ) IN
								(
								SELECT	'L', BQ.PRE_RLY_PORT_CD
								FROM		DUAL
								UNION ALL
								SELECT  'G', GL.PRC_GRP_LOC_CD
								FROM		GL
								WHERE		GL.LOC_CD						= BQ.PRE_RLY_PORT_CD
								)
        )


/*******************************************************************************************
	2.2.3 ORIGIN ARB - RATING UNIT
*******************************************************************************************/

/* ORIGIN ARB RATING UNIT */
AND     (
								OA.RAT_UT_CD	= OA_TYP.CONV_RAT_UT_CD
		        OR	OA.RAT_UT_CD	= 'BX'
		        OR
    		    (
        				OA.RAT_UT_CD	IN ( '20', '40', 'HC', '45', '53' )
       			AND ( SELECT A.CNTR_SZ_CD FROM PRI_RAT_UT A WHERE A.RAT_UT_CD = OA.RAT_UT_CD )	= OA_TYP.CONV_RAT_UT_SZ_CD
        		)
				)

/* ORIGIN ARB CARGO TYPE */
AND			NVL(OA.PRC_CGO_TP_CD, '*')	IN ('*', OA_RAC.CONV_DR_TP, OA_RAC.CONV_DG_TP, OA_RAC.CONV_RF_TP, OA_RAC.CONV_AK_TP, OA_RAC.CONV_BB_TP )


/*******************************************************************************************
	2.2.4 ORIGIN ARB - JOIN
*******************************************************************************************/

/* ORIGIN ARB JOIN ( ARB CONV RULE ) */
AND			DECODE(RT.ARB_RT_APPL_TP_CD, NULL, DECODE(RT.GEN_SPCL_RT_TP_CD, 'S', 'N', 'Y'), 'N', 'N', 'Y') = 'Y'

/* ORIGIN ARB JOIN ( OARB.BPORT = RATE.ORIGIN ) */
AND			NVL(RT.OP_RCV_DE_TERM_CD, '*' )	NOT IN ( 'D', 'S' )

AND			( RT.OP_ROUT_PNT_LOC_TP_CD, RT.OP_ROUT_PNT_LOC_DEF_CD ) IN
				(
				SELECT	OA.BSE_PORT_TP_CD, OA.BSE_PORT_DEF_CD
				FROM		DUAL
				UNION ALL
				SELECT	'L', GL.LOC_CD
				FROM		GL
				WHERE		OA.BSE_PORT_TP_CD	= 'G'
				AND		  GL.PRC_GRP_LOC_CD	= OA.BSE_PORT_DEF_CD
				UNION ALL
				SELECT	'G', GL.PRC_GRP_LOC_CD
				FROM		GL
				WHERE		OA.BSE_PORT_TP_CD	= 'L'
				AND			GL.LOC_CD					= OA.BSE_PORT_DEF_CD
				)

UNION ALL

/*******************************************************************************************
	3. PATTERN #3 ( 0010 )
*******************************************************************************************/

SELECT	'0010'												PRC_RT_MTCH_PATT_CD				,
				BQ.SC_NO											CTRT_NO										,
				BQ.PROP_NO										PROP_NO										,
				BQ.AMDT_SEQ										AMDT_SEQ									,
				BQ.SVC_SCP_CD									SVC_SCP_CD								,
				BQ.BQ_SEQ											BQ_SEQ										,
				BQ.BKG_BQ_SEQ									BKG_BQ_SEQ								,
				BQ.CNTR_TPSZ_CD								BQ_CNTR_TPSZ_CD						,
				BQ.CTRT_CNTR_TPSZ_CD					BQ_CTRT_CNTR_TPSZ_CD			,
				BQ.RCV_TERM_CD								BQ_RCV_TERM_CD						,
				BQ.DE_TERM_CD									BQ_DE_TERM_CD							,
				BQ.DRY_CGO_FLG								BQ_DRY_CGO_FLG						,
				BQ.DCGO_FLG										BQ_DCGO_FLG								,
				BQ.RC_FLG											BQ_RC_FLG									,
				BQ.AWK_CGO_FLG								BQ_AWK_CGO_FLG						,
				BQ.BB_CGO_FLG									BQ_BB_CGO_FLG							,
				BQ.SOC_FLG										BQ_SOC_FLG								,
				BQ.PRC_CGO_TP_CD							BQ_PRC_CGO_TP_CD					,
				BQ.IMDG_CLSS_CD								BQ_IMDG_CLSS_CD						,
				BQ.CTRT_CNTR_QTY							BQ_CTRT_CNTR_QTY					,
				BQ.POR_APPL_FLG								BQ_POR_APPL_FLG						,
				BQ.POL_APPL_FLG								BQ_POL_APPL_FLG						,
				BQ.POD_APPL_FLG								BQ_POD_APPL_FLG						,
				BQ.DEL_APPL_FLG								BQ_DEL_APPL_FLG						,
				BQ.PRE_RLY_PORT_APPL_FLG			BQ_POR_RLY_PORT_APPL_FLG	,
				BQ.PST_RLY_PORT_APPL_FLG			BQ_PST_RLY_PORT_APPL_FLG	,

				RT.CMDT_HDR_SEQ								RT_CMDT_HDR_SEQ						,
				RT.ROUT_SEQ										RT_ROUT_SEQ								,
				RT.RT_SEQ											RT_RT_SEQ									,
				0															OI_ADD_CHG_SEQ						,
				0															OA_ADD_CHG_SEQ						,
				DA.ADD_CHG_SEQ								DA_ADD_CHG_SEQ						,
				0															DI_ADD_CHG_SEQ						,

				RT.GEN_SPCL_RT_TP_CD					RT_GEN_SPCL_RT_TP_CD			,
				RT.CM_PRC_CMDT_TP_CD					CM_PRC_CMDT_TP_CD					,
				RT.CM_PRC_CMDT_DEF_CD					CM_PRC_CMDT_DEF_CD				,
				RT.OP_ROUT_PNT_LOC_DEF_CD			POR_CD										,
				RT.OV_ROUT_VIA_PORT_DEF_CD		POL_CD										,
				RT.DV_ROUT_VIA_PORT_DEF_CD		POD_CD										,
				DA.ROUT_PNT_LOC_DEF_CD				DEL_CD										,
				DA.DIR_CALL_FLG								DIR_CALL_FLG							,
				RT.OP_RCV_DE_TERM_CD					RCV_TERM_CD								,
				DA.RCV_DE_TERM_CD							DE_TERM_CD								,
				RT.RAT_UT_CD									RAT_UT_CD									,
				RT.PRC_CGO_TP_CD							PRC_CGO_TP_CD							,
				RT.CURR_CD										CURR_CD										,
				RT.OP_PRC_TRSP_MOD_CD					ORG_TRSP_MOD_CD						,
				DA.PRC_TRSP_MOD_CD						DEST_TRSP_MOD_CD					,

				RT.OP_ROUT_PNT_LOC_DEF_CD			OP_ROUT_PNT_LOC_DEF_CD		,
				RT.OV_ROUT_VIA_PORT_DEF_CD		OV_ROUT_VIA_PORT_DEF_CD		,
				RT.DV_ROUT_VIA_PORT_DEF_CD		DV_ROUT_VIA_PORT_DEF_CD		,
				RT.DP_ROUT_PNT_LOC_DEF_CD			DP_ROUT_PNT_LOC_DEF_CD		,
				RT.RD_DIR_CALL_FLG						RD_DIR_CALL_FLG						,
				RT.RAT_UT_CD									RT_RAT_UT_CD							,
				RT.PRC_CGO_TP_CD							RT_PRC_CGO_TP_CD					,
				RT.OP_PRC_TRSP_MOD_CD					OP_PRC_TRSP_MOD_CD				,
				RT.DP_PRC_TRSP_MOD_CD					DP_PRC_TRSP_MOD_CD				,
				RT.CURR_CD										RT_CURR_CD								,
				RT.FNL_FRT_RT_AMT							RT_FNL_FRT_RT_AMT					,

				NULL													OI_ROUT_PNT_LOC_DEF_CD		,
				NULL													OI_BSE_PORT_DEF_CD				,
				NULL													OI_VIA_PORT_DEF_CD				,
				NULL													OI_DIR_CALL_FLG						,
				NULL													OI_RAT_UT_CD							,
				NULL													OI_PRC_CGO_TP_CD					,
				NULL													OI_PRC_TRSP_MOD_CD				,
				NULL													OI_RCV_DE_TERM_CD					,
				NULL													OI_PRC_CMDT_DEF_CD				,
				NULL													OI_CURR_CD								,
				NULL													OI_FNL_FRT_RT_AMT					,
				NULL													OI_RAT_UT_MTCH_PRIO				,

				NULL													OA_ROUT_PNT_LOC_DEF_CD		,
				NULL													OA_BSE_PORT_DEF_CD				,
				NULL													OA_VIA_PORT_DEF_CD				,
				NULL													OA_DIR_CALL_FLG						,
				NULL													OA_RAT_UT_CD							,
				NULL													OA_PRC_CGO_TP_CD					,
				NULL													OA_PRC_TRSP_MOD_CD				,
				NULL													OA_RCV_DE_TERM_CD					,
				NULL													OA_PRC_CMDT_DEF_CD				,
				NULL													OA_CURR_CD								,
				NULL													OA_FNL_FRT_RT_AMT					,
				NULL													OA_RAT_UT_MTCH_PRIO				,

				DA.ROUT_PNT_LOC_DEF_CD				DA_ROUT_PNT_LOC_DEF_CD		,
				DA.BSE_PORT_DEF_CD						DA_BSE_PORT_DEF_CD				,
				DA.VIA_PORT_DEF_CD						DA_VIA_PORT_DEF_CD				,
				DA.DIR_CALL_FLG								DA_DIR_CALL_FLG						,
				DA.RAT_UT_CD									DA_RAT_UT_CD							,
				DA.PRC_CGO_TP_CD							DA_PRC_CGO_TP_CD					,
				DA.PRC_TRSP_MOD_CD						DA_PRC_TRSP_MOD_CD				,
				DA.RCV_DE_TERM_CD							DA_RCV_DE_TERM_CD					,
				DA.PRC_CMDT_DEF_CD						DA_PRC_CMDT_DEF_CD				,
				DA.CURR_CD										DA_CURR_CD								,
				DA.FNL_FRT_RT_AMT							DA_FNL_FRT_RT_AMT					,
				DA.RAT_UT_MTCH_PRIO						DA_RAT_UT_MTCH_PRIO				,

				NULL													DI_ROUT_PNT_LOC_DEF_CD		,
				NULL													DI_BSE_PORT_DEF_CD				,
				NULL													DI_VIA_PORT_DEF_CD				,
				NULL													DI_DIR_CALL_FLG						,
				NULL													DI_RAT_UT_CD							,
				NULL													DI_PRC_CGO_TP_CD					,
				NULL													DI_PRC_TRSP_MOD_CD				,
				NULL													DI_RCV_DE_TERM_CD					,
				NULL													DI_PRC_CMDT_DEF_CD				,
				NULL													DI_CURR_CD								,
				NULL													DI_FNL_FRT_RT_AMT					,
				NULL													DI_RAT_UT_MTCH_PRIO				,

				RT_RAP.BKG_CONV_TP_CD      		RT_RAP_BKG_CONV_TP_CD			,
				RT_RAP.NOTE_CONV_MAPG_ID   		RT_RAP_NOTE_CONV_MAPG_ID  ,
				RT_RAP.NOTE_CONV_SEQ       		RT_RAP_NOTE_CONV_SEQ      ,
				RT_RAP.NOTE_CONV_RULE_CD   		RT_RAP_NOTE_CONV_RULE_CD  ,
				RT_RAP.NOTE_CONV_TP_CD     		RT_RAP_NOTE_CONV_TP_CD    ,
				RT_RAP.RT_OP_CD            		RT_RAP_RT_OP_CD           ,
				RT_RAP.CURR_CD             		RT_RAP_CURR_CD            ,
				RT_RAP.FRT_RT_AMT          		RT_RAP_FRT_RT_AMT         ,
				RT_RAP.RAP_CONV_CTNT					RT_RAP_CONV_CTNT					,

				RT_RAR.BKG_CONV_TP_CD      		RT_RAR_BKG_CONV_TP_CD     ,
				RT_RAR.NOTE_CONV_MAPG_ID   		RT_RAR_NOTE_CONV_MAPG_ID  ,
				RT_RAR.NOTE_CONV_SEQ       		RT_RAR_NOTE_CONV_SEQ      ,
				RT_RAR.NOTE_CONV_RULE_CD   		RT_RAR_NOTE_CONV_RULE_CD  ,
				RT_RAR.NOTE_CONV_TP_CD     		RT_RAR_NOTE_CONV_TP_CD    ,
				RT_RAR.RT_OP_CD            		RT_RAR_RT_OP_CD           ,
				RT_RAR.CURR_CD             		RT_RAR_CURR_CD            ,
				RT_RAR.FRT_RT_AMT          		RT_RAR_FRT_RT_AMT         ,
				RT_RAR.RAR_CONV_CTNT					RT_RAR_CONV_CTNT					,

				RT_DOR.BKG_CONV_TP_CD      		RT_DOR_BKG_CONV_TP_CD     ,
				RT_DOR.NOTE_CONV_MAPG_ID   		RT_DOR_NOTE_CONV_MAPG_ID  ,
				RT_DOR.NOTE_CONV_SEQ       		RT_DOR_NOTE_CONV_SEQ      ,
				RT_DOR.NOTE_CONV_RULE_CD   		RT_DOR_NOTE_CONV_RULE_CD  ,
				RT_DOR.NOTE_CONV_TP_CD     		RT_DOR_NOTE_CONV_TP_CD    ,
				RT_DOR.RT_OP_CD            		RT_DOR_RT_OP_CD           ,
				RT_DOR.CURR_CD             		RT_DOR_CURR_CD            ,
				RT_DOR.FRT_RT_AMT          		RT_DOR_FRT_RT_AMT         ,
				RT_DOR.DOR_CONV_CTNT					RT_DOR_CONV_CTNT					,

				RT_TYP.BKG_CONV_TP_CD      		RT_TYP_BKG_CONV_TP_CD     ,
				RT_TYP.NOTE_CONV_MAPG_ID   		RT_TYP_NOTE_CONV_MAPG_ID  ,
				RT_TYP.NOTE_CONV_SEQ       		RT_TYP_NOTE_CONV_SEQ      ,
				RT_TYP.NOTE_CONV_RULE_CD   		RT_TYP_NOTE_CONV_RULE_CD  ,
				RT_TYP.NOTE_CONV_TP_CD     		RT_TYP_NOTE_CONV_TP_CD    ,
				RT_TYP.RT_OP_CD            		RT_TYP_RT_OP_CD           ,
				RT_TYP.CURR_CD             		RT_TYP_CURR_CD            ,
				RT_TYP.FRT_RT_AMT          		RT_TYP_FRT_RT_AMT         ,
				RT_TYP.TYP_CONV_CTNT					RT_TYP_CONV_CTNT					,

				RT_RAC.BKG_CONV_TP_CD      		RT_RAC_BKG_CONV_TP_CD     ,
				RT_RAC.NOTE_CONV_MAPG_ID   		RT_RAC_NOTE_CONV_MAPG_ID  ,
				RT_RAC.NOTE_CONV_SEQ       		RT_RAC_NOTE_CONV_SEQ      ,
				RT_RAC.NOTE_CONV_RULE_CD   		RT_RAC_NOTE_CONV_RULE_CD  ,
				RT_RAC.NOTE_CONV_TP_CD     		RT_RAC_NOTE_CONV_TP_CD    ,
				RT_RAC.RT_OP_CD            		RT_RAC_RT_OP_CD           ,
				RT_RAC.CURR_CD             		RT_RAC_CURR_CD            ,
				RT_RAC.FRT_RT_AMT          		RT_RAC_FRT_RT_AMT         ,
				RT_RAC.RAC_CONV_CTNT					RT_RAC_CONV_CTNT					,

				RT.APP_BKG_CONV_TP_CD      		RT_APP_BKG_CONV_TP_CD     ,
				RT.APP_NOTE_CONV_MAPG_ID   		RT_APP_NOTE_CONV_MAPG_ID  ,
				RT.APP_NOTE_CONV_SEQ       		RT_APP_NOTE_CONV_SEQ      ,
				RT.APP_NOTE_CONV_RULE_CD   		RT_APP_NOTE_CONV_RULE_CD  ,
				RT.APP_NOTE_CONV_TP_CD     		RT_APP_NOTE_CONV_TP_CD    ,
				RT.APP_RT_OP_CD            		RT_APP_RT_OP_CD           ,
				RT.APP_CURR_CD             		RT_APP_CURR_CD            ,
				RT.APP_FRT_RT_AMT          		RT_APP_FRT_RT_AMT         ,

				RT.RAS_BKG_CONV_TP_CD      		RT_RAS_BKG_CONV_TP_CD     ,
				RT.RAS_NOTE_CONV_MAPG_ID   		RT_RAS_NOTE_CONV_MAPG_ID  ,
				RT.RAS_NOTE_CONV_SEQ       		RT_RAS_NOTE_CONV_SEQ      ,
				RT.RAS_NOTE_CONV_RULE_CD   		RT_RAS_NOTE_CONV_RULE_CD  ,
				RT.RAS_NOTE_CONV_TP_CD     		RT_RAS_NOTE_CONV_TP_CD    ,
				RT.RAS_RT_OP_CD            		RT_RAS_RT_OP_CD           ,
				RT.RAS_CURR_CD             		RT_RAS_CURR_CD            ,
				RT.RAS_FRT_RT_AMT          		RT_RAS_FRT_RT_AMT         ,
				RT.RAS_RAS_CONV_CTNT					RT_RAS_CONV_CTNT					,

				NULL													RT_ARB_BKG_CONV_TP_CD     ,
				NULL													RT_ARB_NOTE_CONV_MAPG_ID  ,
				NULL													RT_ARB_NOTE_CONV_SEQ      ,
				NULL													RT_ARB_NOTE_CONV_RULE_CD  ,
				NULL													RT_ARB_NOTE_CONV_TP_CD    ,
				NULL													RT_ARB_RT_OP_CD           ,
				NULL													RT_ARB_CURR_CD            ,
				NULL													RT_ARB_FRT_RT_AMT         ,

				RT.ADD_BKG_CONV_TP_CD      		RT_ADD_BKG_CONV_TP_CD     ,
				RT.ADD_NOTE_CONV_MAPG_ID   		RT_ADD_NOTE_CONV_MAPG_ID  ,
				RT.ADD_NOTE_CONV_SEQ       		RT_ADD_NOTE_CONV_SEQ      ,
				RT.ADD_NOTE_CONV_RULE_CD   		RT_ADD_NOTE_CONV_RULE_CD  ,
				RT.ADD_NOTE_CONV_TP_CD     		RT_ADD_NOTE_CONV_TP_CD    ,
				RT.ADD_RT_OP_CD            		RT_ADD_RT_OP_CD           ,
				RT.ADD_CURR_CD             		RT_ADD_CURR_CD            ,
				RT.ADD_FRT_RT_AMT          		RT_ADD_FRT_RT_AMT         ,

				NULL													OA_TYP_BKG_CONV_TP_CD     ,
				NULL													OA_TYP_NOTE_CONV_MAPG_ID  ,
				NULL													OA_TYP_NOTE_CONV_SEQ      ,
				NULL													OA_TYP_NOTE_CONV_RULE_CD  ,
				NULL													OA_TYP_NOTE_CONV_TP_CD    ,
				NULL													OA_TYP_RT_OP_CD           ,
				NULL													OA_TYP_CURR_CD            ,
				NULL													OA_TYP_FRT_RT_AMT         ,
				NULL													OA_TYP_CONV_CTNT					,

				NULL													OA_RAC_BKG_CONV_TP_CD     ,
				NULL													OA_RAC_NOTE_CONV_MAPG_ID  ,
				NULL													OA_RAC_NOTE_CONV_SEQ      ,
				NULL													OA_RAC_NOTE_CONV_RULE_CD  ,
				NULL													OA_RAC_NOTE_CONV_TP_CD    ,
				NULL													OA_RAC_RT_OP_CD           ,
				NULL													OA_RAC_CURR_CD            ,
				NULL													OA_RAC_FRT_RT_AMT         ,
				NULL													OA_RAC_CONV_CTNT					,

				DA_TYP.BKG_CONV_TP_CD      		DA_TYP_BKG_CONV_TP_CD     ,
				DA_TYP.NOTE_CONV_MAPG_ID   		DA_TYP_NOTE_CONV_MAPG_ID  ,
				DA_TYP.NOTE_CONV_SEQ       		DA_TYP_NOTE_CONV_SEQ      ,
				DA_TYP.NOTE_CONV_RULE_CD   		DA_TYP_NOTE_CONV_RULE_CD  ,
				DA_TYP.NOTE_CONV_TP_CD     		DA_TYP_NOTE_CONV_TP_CD    ,
				DA_TYP.RT_OP_CD            		DA_TYP_DA_OP_CD           ,
				DA_TYP.CURR_CD             		DA_TYP_CURR_CD            ,
				DA_TYP.FRT_RT_AMT          		DA_TYP_FRT_RT_AMT					,
				DA_TYP.TYP_CONV_CTNT       		DA_TYP_CONV_CTNT         	,

				DA_RAC.BKG_CONV_TP_CD      		DA_RAC_BKG_CONV_TP_CD     ,
				DA_RAC.NOTE_CONV_MAPG_ID   		DA_RAC_NOTE_CONV_MAPG_ID  ,
				DA_RAC.NOTE_CONV_SEQ       		DA_RAC_NOTE_CONV_SEQ      ,
				DA_RAC.NOTE_CONV_RULE_CD   		DA_RAC_NOTE_CONV_RULE_CD  ,
				DA_RAC.NOTE_CONV_TP_CD     		DA_RAC_NOTE_CONV_TP_CD    ,
				DA_RAC.RT_OP_CD            		DA_RAC_DA_OP_CD           ,
				DA_RAC.CURR_CD             		DA_RAC_CURR_CD            ,
				DA_RAC.FRT_RT_AMT          		DA_RAC_FRT_RT_AMT					,
				DA_RAC.RAC_CONV_CTNT       		DA_RAC_CONV_CTNT         	,

				RT.POR_MTCH_FLG								POR_MTCH_FLG							,
				'Y'														DEL_MTCH_FLG

FROM
/*******************************************************************************************
JOIN TABLE
1.1 BQ, CH, CM, CR, RD, OP, DV, DP, RT
1.2 RT RULE					: RAP, RAR, DOR, TYP, RAC, APP, RAS, ADD
2.1 OA							: X
2.2 OA RULE					: X
3.1 DA							: O
3.2 DA RULE					: TYP, RAC ( RAP, RAR, DOR 는 RT 와 동일하게 적용 )
*******************************************************************************************/
				BQ	,
				DA	,
				RT	,
				NC_P											RT_RAP	,			/* COMMODITY CONVERSION */
				NC_P											RT_RAR	,			/* ROUTE CONVERSION */
				NC_P											RT_DOR	,			/* R/D TERM CONVERSION */
				NC_P											RT_TYP	,			/* RATING UNIT CONVERSION */
				NC_P											RT_RAC	,			/* CARGO TYPE CONVERSION */
				NC_P											DA_TYP	,			/* RATING UNIT CONVERSION */
				NC_P											DA_RAC				/* CARGO TYPE CONVERSION */

WHERE		RT.BQ_SEQ		=	BQ.BQ_SEQ
AND			DA.BQ_SEQ		= BQ.BQ_SEQ
AND			RT_RAP.BQ_SEQ	= RT.BQ_SEQ AND RT_RAP.NOTE_CONV_RULE_CD = 'RAP' AND ( RT_RAP.BKG_CONV_TP_CD = 'B' OR RT_RAP.NC_SEQ = RT.RAP_NC_SEQ )
AND			RT_RAR.BQ_SEQ	= RT.BQ_SEQ AND RT_RAR.NOTE_CONV_RULE_CD = 'RAR' AND ( RT_RAR.BKG_CONV_TP_CD = 'B' OR RT_RAR.NC_SEQ = RT.RAR_NC_SEQ )
AND			RT_DOR.BQ_SEQ	= RT.BQ_SEQ AND RT_DOR.NOTE_CONV_RULE_CD = 'DOR' AND ( RT_DOR.BKG_CONV_TP_CD = 'B' OR RT_DOR.NC_SEQ = RT.DOR_NC_SEQ )
AND			RT_TYP.BQ_SEQ	= RT.BQ_SEQ AND RT_TYP.NOTE_CONV_RULE_CD = 'TYP' AND ( RT_TYP.BKG_CONV_TP_CD = 'B' OR RT_TYP.NC_SEQ = RT.TYP_NC_SEQ )
AND			RT_RAC.BQ_SEQ	= RT.BQ_SEQ AND RT_RAC.NOTE_CONV_RULE_CD = 'RAC' AND ( RT_RAC.BKG_CONV_TP_CD = 'B' OR RT_RAC.NC_SEQ = RT.RAC_NC_SEQ )
AND			DA_TYP.BQ_SEQ	= RT.BQ_SEQ AND DA_TYP.NOTE_CONV_RULE_CD = 'TYP' AND ( DA_TYP.BKG_CONV_TP_CD = 'B' OR DA_TYP.NC_SEQ = RT.TYP_NC_SEQ )
AND			DA_RAC.BQ_SEQ	= RT.BQ_SEQ AND DA_RAC.NOTE_CONV_RULE_CD = 'RAC' AND ( DA_RAC.BKG_CONV_TP_CD = 'B' OR DA_RAC.NC_SEQ = RT.RAC_NC_SEQ )


/*******************************************************************************************
	3.1 RATE
*******************************************************************************************/

/*******************************************************************************************
	3.1.1 RATE - COMMODITY
*******************************************************************************************/

/*******************************************************************************************
< COMMODITY >
그룹, 개별간으로 일치하는 경우
*******************************************************************************************/

AND			( RT.CM_PRC_CMDT_TP_CD, RT.CM_PRC_CMDT_DEF_CD ) IN
				(
				SELECT	RT_RAP.CONV_CMDT_TP_CD, RT_RAP.CONV_CMDT_DEF_CD
				FROM		DUAL
				UNION ALL
				SELECT  'C', GC.PRC_CMDT_DEF_CD
				FROM		GC
				WHERE		RT_RAP.CONV_CMDT_TP_CD	= 'G'
				AND     GC.PRC_CMDT_TP_CD   		= 'C'
				AND			GC.PRC_GRP_CMDT_CD  		= RT_RAP.CONV_CMDT_DEF_CD
				UNION ALL
				SELECT  'G', GC.PRC_GRP_CMDT_CD
				FROM		GC
				WHERE		RT_RAP.CONV_CMDT_TP_CD	= 'C'
				AND     GC.PRC_CMDT_TP_CD   		= 'C'
				AND     GC.PRC_CMDT_DEF_CD  		= RT_RAP.CONV_CMDT_DEF_CD
				UNION ALL
				/* TAW 일 경우 FAK 고려함 */
				SELECT	'C', CMDT_CD
				FROM		MDM_COMMODITY
				WHERE		REP_CMDT_CD		= '0000'
				UNION ALL
				SELECT	'G', GC.PRC_GRP_CMDT_CD
				FROM		GC
				WHERE		GC.PRC_CMDT_TP_CD		= 'C'
				AND			GC.PRC_CMDT_DEF_CD  IN ( SELECT CMDT_CD FROM MDM_COMMODITY WHERE REP_CMDT_CD = '0000' )
				)


/*******************************************************************************************
	3.1.2 RATE - ROUTE
*******************************************************************************************/

/*******************************************************************************************
< ORIGIN ( POR OR POL ) >
*******************************************************************************************/

AND     ( RT.OP_ROUT_PNT_LOC_TP_CD, RT.OP_ROUT_PNT_LOC_DEF_CD ) IN
				(
				SELECT	RT_RAR.CONV_ORG_LOC_TP_CD,	RT_RAR.CONV_ORG_LOC_DEF_CD
				FROM		DUAL
				UNION ALL
				SELECT  'L', GL.LOC_CD
				FROM		GL
				WHERE		RT_RAR.CONV_ORG_LOC_TP_CD	= 'G'
				AND		  GL.PRC_GRP_LOC_CD 				= RT_RAR.CONV_ORG_LOC_DEF_CD
				UNION ALL
				SELECT  'G', GL.PRC_GRP_LOC_CD
				FROM		GL
				WHERE		RT_RAR.CONV_ORG_LOC_TP_CD	= 'L'
				AND     GL.LOC_CD									= RT_RAR.CONV_ORG_LOC_DEF_CD
				UNION ALL
				SELECT	RT_RAR.CONV_ORG_VIA_LOC_TP_CD,	RT_RAR.CONV_ORG_VIA_LOC_DEF_CD
				FROM		DUAL
				UNION ALL
				SELECT  'L', GL.LOC_CD
				FROM		GL
				WHERE		RT_RAR.CONV_ORG_VIA_LOC_TP_CD	= 'G'
				AND		  GL.PRC_GRP_LOC_CD 						= RT_RAR.CONV_ORG_VIA_LOC_DEF_CD
				UNION ALL
				SELECT  'G', GL.PRC_GRP_LOC_CD
				FROM		GL
				WHERE		RT_RAR.CONV_ORG_VIA_LOC_TP_CD	= 'L'
				AND     GL.LOC_CD											= RT_RAR.CONV_ORG_VIA_LOC_DEF_CD
				)


/*******************************************************************************************
< RCV TERM >
*******************************************************************************************/

AND     (
						(
								RT.POR_MTCH_FLG			= 'Y'
						AND	NVL(RT.OP_RCV_DE_TERM_CD, '*') IN
								(
								SELECT  B.RCV_DE_TERM_CD
								FROM		(
												SELECT 'Y' CONV_PRC_TERM_CD, 'Y' RCV_DE_TERM_CD FROM DUAL UNION ALL
												SELECT 'Y' CONV_PRC_TERM_CD, 'L' RCV_DE_TERM_CD FROM DUAL UNION ALL
												SELECT 'Y' CONV_PRC_TERM_CD, '*' RCV_DE_TERM_CD FROM DUAL UNION ALL
												SELECT 'S' CONV_PRC_TERM_CD, 'S' RCV_DE_TERM_CD FROM DUAL UNION ALL
												SELECT 'D' CONV_PRC_TERM_CD, 'D' RCV_DE_TERM_CD FROM DUAL UNION ALL
												SELECT 'T' CONV_PRC_TERM_CD, 'T' RCV_DE_TERM_CD FROM DUAL UNION ALL
												SELECT 'I' CONV_PRC_TERM_CD, 'I' RCV_DE_TERM_CD FROM DUAL
												)	B
								WHERE		B.CONV_PRC_TERM_CD	= RT_DOR.CONV_PRC_RCV_TERM_CD
								)
						)
				OR	(
								BQ.POR_CD										= BQ.POL_CD
						AND	NVL(RT.OP_RCV_DE_TERM_CD, '*') IN
								(
								SELECT  B.RCV_DE_TERM_CD
								FROM		(
												SELECT 'Y' CONV_PRC_TERM_CD, 'Y' RCV_DE_TERM_CD FROM DUAL UNION ALL
												SELECT 'Y' CONV_PRC_TERM_CD, 'L' RCV_DE_TERM_CD FROM DUAL UNION ALL
												SELECT 'Y' CONV_PRC_TERM_CD, '*' RCV_DE_TERM_CD FROM DUAL UNION ALL
												SELECT 'S' CONV_PRC_TERM_CD, 'S' RCV_DE_TERM_CD FROM DUAL UNION ALL
												SELECT 'D' CONV_PRC_TERM_CD, 'D' RCV_DE_TERM_CD FROM DUAL UNION ALL
												SELECT 'D' CONV_PRC_TERM_CD, 'Y' RCV_DE_TERM_CD FROM DUAL UNION ALL	-- 예외 적용
												SELECT 'T' CONV_PRC_TERM_CD, 'T' RCV_DE_TERM_CD FROM DUAL UNION ALL
												SELECT 'I' CONV_PRC_TERM_CD, 'I' RCV_DE_TERM_CD FROM DUAL
												)	B
								WHERE		B.CONV_PRC_TERM_CD	= RT_DOR.CONV_PRC_RCV_TERM_CD
								)
						)
				OR	(
								RT.POR_MTCH_FLG 								= 'N'
						AND	NVL(RT.OP_RCV_DE_TERM_CD, '*')	IN ( 'Y', '*' )
						)
				)


/*******************************************************************************************
< ORIGIN TRANS MODE >
*******************************************************************************************/

AND			(
					  RT.POR_MTCH_FLG = 'N'
				OR	(
								RT.OP_PRC_TRSP_MOD_CD	IS NULL
						OR	BQ.ORG_TRNS_MOD_CD		IS NULL
						OR	RT.OP_PRC_TRSP_MOD_CD	= BQ.ORG_TRNS_MOD_CD
						OR  (
										RT.OP_PRC_TRSP_MOD_CD	IN ( 'R', 'A' )
								AND	BQ.ORG_TRNS_MOD_CD		= 'R'
								)
						)
				)


/*******************************************************************************************
< ORIGIN VIA ( POL OR PRE RELAY ) >
*******************************************************************************************/

AND     (
						RT.OV_ROUT_VIA_PORT_DEF_CD IS NULL
				OR	( RT.OV_ROUT_VIA_PORT_TP_CD, RT.OV_ROUT_VIA_PORT_DEF_CD ) IN
						(
						SELECT	RT_RAR.CONV_ORG_VIA_LOC_TP_CD,	RT_RAR.CONV_ORG_VIA_LOC_DEF_CD
						FROM		DUAL
						UNION ALL
						SELECT  'L', GL.LOC_CD
						FROM		GL
						WHERE		RT_RAR.CONV_ORG_VIA_LOC_TP_CD	= 'G'
						AND		  GL.PRC_GRP_LOC_CD 						= RT_RAR.CONV_ORG_VIA_LOC_DEF_CD
						UNION ALL
						SELECT  'G', GL.PRC_GRP_LOC_CD
						FROM		GL
						WHERE		RT_RAR.CONV_ORG_VIA_LOC_TP_CD	= 'L'
						AND     GL.LOC_CD											= RT_RAR.CONV_ORG_VIA_LOC_DEF_CD
						UNION ALL
						SELECT	'L', BQ.PRE_RLY_PORT_CD
						FROM		DUAL
						UNION ALL
						SELECT  'G', GL.PRC_GRP_LOC_CD
						FROM		GL
						WHERE		GL.LOC_CD						= BQ.PRE_RLY_PORT_CD
						)
				)


/*******************************************************************************************
< DESTINATION VIA ( POD ) >
*******************************************************************************************/

AND     (
						RT.DV_ROUT_VIA_PORT_DEF_CD IS NULL
				OR	( RT.DV_ROUT_VIA_PORT_TP_CD, RT.DV_ROUT_VIA_PORT_DEF_CD ) IN
						(
						SELECT	RT_RAR.CONV_DEST_VIA_LOC_TP_CD,	RT_RAR.CONV_DEST_VIA_LOC_DEF_CD
						FROM		DUAL
						UNION ALL
						SELECT  'L', GL.LOC_CD
						FROM		GL
						WHERE		RT_RAR.CONV_DEST_VIA_LOC_TP_CD	= 'G'
						AND		  GL.PRC_GRP_LOC_CD 						= RT_RAR.CONV_DEST_VIA_LOC_DEF_CD
						UNION ALL
						SELECT  'G', GL.PRC_GRP_LOC_CD
						FROM		GL
						WHERE		RT_RAR.CONV_DEST_VIA_LOC_TP_CD	= 'L'
						AND     GL.LOC_CD											= RT_RAR.CONV_DEST_VIA_LOC_DEF_CD
						)
				)


/*******************************************************************************************
< DESTINATION ( POD ) >
*******************************************************************************************/

AND     ( RT.DP_ROUT_PNT_LOC_TP_CD, RT.DP_ROUT_PNT_LOC_DEF_CD ) IN
				(
				SELECT	RT_RAR.CONV_DEST_VIA_LOC_TP_CD,	RT_RAR.CONV_DEST_VIA_LOC_DEF_CD
				FROM		DUAL
				UNION ALL
				SELECT  'L', GL.LOC_CD
				FROM		GL
				WHERE		RT_RAR.CONV_DEST_VIA_LOC_TP_CD	= 'G'
				AND		  GL.PRC_GRP_LOC_CD 						= RT_RAR.CONV_DEST_VIA_LOC_DEF_CD
				UNION ALL
				SELECT  'G', GL.PRC_GRP_LOC_CD
				FROM		GL
				WHERE		RT_RAR.CONV_DEST_VIA_LOC_TP_CD	= 'L'
				AND     GL.LOC_CD											= RT_RAR.CONV_DEST_VIA_LOC_DEF_CD
				)


/*******************************************************************************************
	3.1.3 RATE - RATING UNIT
*******************************************************************************************/

AND     (
								RT.RAT_UT_CD	= RT_TYP.CONV_RAT_UT_CD
		        OR
    		    (
        				RT.RAT_UT_CD	IN ( '20', '40', 'HC', '45', '53' )
       			AND ( SELECT A.CNTR_SZ_CD FROM PRI_RAT_UT A WHERE A.RAT_UT_CD = RT.RAT_UT_CD )	= RT_TYP.CONV_RAT_UT_SZ_CD
        		)
				)

AND			RT.PRC_CGO_TP_CD	IN ( RT_RAC.CONV_DR_TP, RT_RAC.CONV_DG_TP, RT_RAC.CONV_RF_TP, RT_RAC.CONV_AK_TP, RT_RAC.CONV_BB_TP )


/*******************************************************************************************
	3.2 DEST ARB
*******************************************************************************************/

/*******************************************************************************************
	3.2.1 DEST ARB - COMMODITY
*******************************************************************************************/

AND			(
						DA.PRC_CMDT_DEF_CD	IS NULL
				OR	( DA.PRC_CMDT_TP_CD, DA.PRC_CMDT_DEF_CD ) IN
						(
						SELECT	RT_RAP.CONV_CMDT_TP_CD, RT_RAP.CONV_CMDT_DEF_CD
						FROM		DUAL
						UNION ALL
						SELECT  'C', GC.PRC_CMDT_DEF_CD
						FROM		GC
						WHERE		RT_RAP.CONV_CMDT_TP_CD	= 'G'
						AND     GC.PRC_CMDT_TP_CD   		= 'C'
						AND			GC.PRC_GRP_CMDT_CD  		= RT_RAP.CONV_CMDT_DEF_CD
						UNION ALL
						SELECT  'G', GC.PRC_GRP_CMDT_CD
						FROM		GC
						WHERE		RT_RAP.CONV_CMDT_TP_CD	= 'C'
						AND     GC.PRC_CMDT_TP_CD   		= 'C'
						AND     GC.PRC_CMDT_DEF_CD  		= RT_RAP.CONV_CMDT_DEF_CD
						UNION ALL
						/* TAW 일 경우 FAK 고려함 */
						SELECT	'C', CMDT_CD
						FROM		MDM_COMMODITY
						WHERE		REP_CMDT_CD		= '0000'
						UNION ALL
						SELECT	'G', GC.PRC_GRP_CMDT_CD
						FROM		GC
						WHERE		GC.PRC_CMDT_TP_CD		= 'C'
						AND			GC.PRC_CMDT_DEF_CD  IN ( SELECT CMDT_CD FROM MDM_COMMODITY WHERE REP_CMDT_CD = '0000' )
						)
				)


/*******************************************************************************************
	3.2.2 DEST ARB - ROUTE
*******************************************************************************************/

/*******************************************************************************************
< VIA PORT ( POD ) >
*******************************************************************************************/

AND     (
                DA.VIA_PORT_DEF_CD  IS NULL
            OR	( DA.VIA_PORT_TP_CD, DA.VIA_PORT_DEF_CD ) IN
								(
								SELECT  RT_RAR.CONV_DEST_VIA_LOC_TP_CD, RT_RAR.CONV_DEST_VIA_LOC_DEF_CD
								FROM		DUAL
								UNION ALL
								SELECT  'L', GL.LOC_CD
								FROM		GL
								WHERE		RT_RAR.CONV_DEST_VIA_LOC_TP_CD	= 'G'
								AND		  GL.PRC_GRP_LOC_CD 				= RT_RAR.CONV_DEST_VIA_LOC_DEF_CD
								UNION ALL
								SELECT  'G', GL.PRC_GRP_LOC_CD
								FROM		GL
								WHERE		RT_RAR.CONV_DEST_VIA_LOC_TP_CD	= 'L'
								AND     GL.LOC_CD									= RT_RAR.CONV_DEST_VIA_LOC_DEF_CD
								)
        )


/*******************************************************************************************
< POINT ( DEL ) >
*******************************************************************************************/

AND     ( DA.ROUT_PNT_LOC_TP_CD, DA.ROUT_PNT_LOC_DEF_CD ) IN
				(
				SELECT  RT_RAR.CONV_DEST_LOC_TP_CD, RT_RAR.CONV_DEST_LOC_DEF_CD
				FROM		DUAL
				UNION ALL
				SELECT  'L', GL.LOC_CD
				FROM		GL
				WHERE		RT_RAR.CONV_DEST_LOC_TP_CD	= 'G'
				AND		  GL.PRC_GRP_LOC_CD 				= RT_RAR.CONV_DEST_LOC_DEF_CD
				UNION ALL
				SELECT  'G', GL.PRC_GRP_LOC_CD
				FROM		GL
				WHERE		RT_RAR.CONV_DEST_LOC_TP_CD	= 'L'
				AND     GL.LOC_CD									= RT_RAR.CONV_DEST_LOC_DEF_CD
				)


/*******************************************************************************************
< DE TERM >
*******************************************************************************************/

AND			NVL(DA.RCV_DE_TERM_CD, '*') IN
				(
				SELECT  B.RCV_DE_TERM_CD
				FROM		(
								SELECT 'Y' CONV_PRC_TERM_CD, 'Y' RCV_DE_TERM_CD FROM DUAL UNION ALL
								SELECT 'Y' CONV_PRC_TERM_CD, 'L' RCV_DE_TERM_CD FROM DUAL UNION ALL
								SELECT 'Y' CONV_PRC_TERM_CD, '*' RCV_DE_TERM_CD FROM DUAL UNION ALL
								SELECT 'S' CONV_PRC_TERM_CD, 'S' RCV_DE_TERM_CD FROM DUAL UNION ALL
								SELECT 'S' CONV_PRC_TERM_CD, 'Y' RCV_DE_TERM_CD FROM DUAL UNION ALL
								SELECT 'S' CONV_PRC_TERM_CD, 'T' RCV_DE_TERM_CD FROM DUAL UNION ALL
								SELECT 'S' CONV_PRC_TERM_CD, 'I' RCV_DE_TERM_CD FROM DUAL UNION ALL
								SELECT 'S' CONV_PRC_TERM_CD, 'L' RCV_DE_TERM_CD FROM DUAL UNION ALL
								SELECT 'S' CONV_PRC_TERM_CD, '*' RCV_DE_TERM_CD FROM DUAL UNION ALL
								SELECT 'D' CONV_PRC_TERM_CD, 'D' RCV_DE_TERM_CD FROM DUAL UNION ALL
								SELECT 'T' CONV_PRC_TERM_CD, 'T' RCV_DE_TERM_CD FROM DUAL UNION ALL
								SELECT 'I' CONV_PRC_TERM_CD, 'I' RCV_DE_TERM_CD FROM DUAL
								)	B
				WHERE		B.CONV_PRC_TERM_CD	= RT_DOR.CONV_PRC_DE_TERM_CD
				)


/*******************************************************************************************
< DEST TRANS MODE >
*******************************************************************************************/

AND			(
						DA.PRC_TRSP_MOD_CD		IS NULL
				OR	BQ.DEST_TRNS_MOD_CD		IS NULL
				OR	DA.PRC_TRSP_MOD_CD		= BQ.DEST_TRNS_MOD_CD
				OR  (
								DA.PRC_TRSP_MOD_CD		IN ( 'R', 'A' )
						AND	BQ.DEST_TRNS_MOD_CD		= 'R'
						)
				)


/*******************************************************************************************
	3.2.3 DEST ARB - RATING UNIT
*******************************************************************************************/

/* DEST ARB RATING UNIT */
AND     (
								DA.RAT_UT_CD	= DA_TYP.CONV_RAT_UT_CD
		        OR	DA.RAT_UT_CD	= 'BX'
		        OR
    		    (
        				DA.RAT_UT_CD	IN ( '20', '40', 'HC', '45', '53' )
       			AND ( SELECT A.CNTR_SZ_CD FROM PRI_RAT_UT A WHERE A.RAT_UT_CD = DA.RAT_UT_CD )	= DA_TYP.CONV_RAT_UT_SZ_CD
        		)
				)


/* DEST ARB CARGO TYPE */
AND			NVL(DA.PRC_CGO_TP_CD, '*')	IN ( '*', DA_RAC.CONV_DR_TP, DA_RAC.CONV_DG_TP, DA_RAC.CONV_RF_TP, DA_RAC.CONV_AK_TP, DA_RAC.CONV_BB_TP )


/*******************************************************************************************
	3.2.4 DEST ARB - JOIN
*******************************************************************************************/

/* DEST ARB JOIN ( ADD CONV RULE ) */
AND			DECODE(RT.ADD_RT_APPL_TP_CD, NULL, DECODE(RT.GEN_SPCL_RT_TP_CD, 'S', 'N', 'Y'), 'N', 'N', 'Y') = 'Y'

/* DEST ARB JOIN ( DARB.BPORT = RATE.DEST ) */
AND			NVL(RT.DP_RCV_DE_TERM_CD, '*' )	NOT IN ( 'D', 'S' )

AND			( RT.DP_ROUT_PNT_LOC_TP_CD, RT.DP_ROUT_PNT_LOC_DEF_CD ) IN
				(
				SELECT	DA.BSE_PORT_TP_CD, DA.BSE_PORT_DEF_CD
				FROM		DUAL
				UNION ALL
				SELECT	'L', GL.LOC_CD
				FROM		GL
				WHERE		DA.BSE_PORT_TP_CD	= 'G'
				AND		  GL.PRC_GRP_LOC_CD	= DA.BSE_PORT_DEF_CD
				UNION ALL
				SELECT	'G', GL.PRC_GRP_LOC_CD
				FROM		GL
				WHERE		DA.BSE_PORT_TP_CD	= 'L'
				AND			GL.LOC_CD					= DA.BSE_PORT_DEF_CD
				)

UNION ALL

/*******************************************************************************************
	4. PATTERN #4 ( 0110 )
*******************************************************************************************/

SELECT	'0110'												PRC_RT_MTCH_PATT_CD				,
				BQ.SC_NO											CTRT_NO										,
				BQ.PROP_NO										PROP_NO										,
				BQ.AMDT_SEQ										AMDT_SEQ									,
				BQ.SVC_SCP_CD									SVC_SCP_CD								,
				BQ.BQ_SEQ											BQ_SEQ										,
				BQ.BKG_BQ_SEQ									BKG_BQ_SEQ								,
				BQ.CNTR_TPSZ_CD								BQ_CNTR_TPSZ_CD						,
				BQ.CTRT_CNTR_TPSZ_CD					BQ_CTRT_CNTR_TPSZ_CD			,
				BQ.RCV_TERM_CD								BQ_RCV_TERM_CD						,
				BQ.DE_TERM_CD									BQ_DE_TERM_CD							,
				BQ.DRY_CGO_FLG								BQ_DRY_CGO_FLG						,
				BQ.DCGO_FLG										BQ_DCGO_FLG								,
				BQ.RC_FLG											BQ_RC_FLG									,
				BQ.AWK_CGO_FLG								BQ_AWK_CGO_FLG						,
				BQ.BB_CGO_FLG									BQ_BB_CGO_FLG							,
				BQ.SOC_FLG										BQ_SOC_FLG								,
				BQ.PRC_CGO_TP_CD							BQ_PRC_CGO_TP_CD					,
				BQ.IMDG_CLSS_CD								BQ_IMDG_CLSS_CD						,
				BQ.CTRT_CNTR_QTY							BQ_CTRT_CNTR_QTY					,
				BQ.POR_APPL_FLG								BQ_POR_APPL_FLG						,
				BQ.POL_APPL_FLG								BQ_POL_APPL_FLG						,
				BQ.POD_APPL_FLG								BQ_POD_APPL_FLG						,
				BQ.DEL_APPL_FLG								BQ_DEL_APPL_FLG						,
				BQ.PRE_RLY_PORT_APPL_FLG			BQ_POR_RLY_PORT_APPL_FLG	,
				BQ.PST_RLY_PORT_APPL_FLG			BQ_PST_RLY_PORT_APPL_FLG	,

				RT.CMDT_HDR_SEQ								RT_CMDT_HDR_SEQ						,
				RT.ROUT_SEQ										RT_ROUT_SEQ								,
				RT.RT_SEQ											RT_RT_SEQ									,
				0															OI_ADD_CHG_SEQ						,
				OA.ADD_CHG_SEQ								OA_ADD_CHG_SEQ						,
				DA.ADD_CHG_SEQ								DA_ADD_CHG_SEQ						,
				0															DI_ADD_CHG_SEQ						,

				RT.GEN_SPCL_RT_TP_CD					RT_GEN_SPCL_RT_TP_CD			,
				RT.CM_PRC_CMDT_TP_CD					CM_PRC_CMDT_TP_CD					,
				RT.CM_PRC_CMDT_DEF_CD					CM_PRC_CMDT_DEF_CD				,
				OA.ROUT_PNT_LOC_DEF_CD				POR_CD										,
				'N/A'													POL_CD										,
				RT.DV_ROUT_VIA_PORT_DEF_CD		POD_CD										,
				DA.ROUT_PNT_LOC_DEF_CD				DEL_CD										,
				DECODE(OA.DIR_CALL_FLG, 'Y', 'Y', DECODE(DA.DIR_CALL_FLG, 'Y', 'Y', 'N'))	DIR_CALL_FLG		,
				OA.RCV_DE_TERM_CD							RCV_TERM_CD								,
				DA.RCV_DE_TERM_CD							DE_TERM_CD								,
				RT.RAT_UT_CD									RAT_UT_CD									,
				RT.PRC_CGO_TP_CD							PRC_CGO_TP_CD							,
				RT.CURR_CD										CURR_CD										,
				OA.PRC_TRSP_MOD_CD						ORG_TRSP_MOD_CD						,
				DA.PRC_TRSP_MOD_CD						DEST_TRSP_MOD_CD					,

				RT.OP_ROUT_PNT_LOC_DEF_CD			OP_ROUT_PNT_LOC_DEF_CD		,
				RT.OV_ROUT_VIA_PORT_DEF_CD		OV_ROUT_VIA_PORT_DEF_CD		,
				RT.DV_ROUT_VIA_PORT_DEF_CD		DV_ROUT_VIA_PORT_DEF_CD		,
				RT.DP_ROUT_PNT_LOC_DEF_CD			DP_ROUT_PNT_LOC_DEF_CD		,
				RT.RD_DIR_CALL_FLG						RD_DIR_CALL_FLG						,
				RT.RAT_UT_CD									RT_RAT_UT_CD							,
				RT.PRC_CGO_TP_CD							RT_PRC_CGO_TP_CD					,
				RT.OP_PRC_TRSP_MOD_CD					OP_PRC_TRSP_MOD_CD				,
				RT.DP_PRC_TRSP_MOD_CD					DP_PRC_TRSP_MOD_CD				,
				RT.CURR_CD										RT_CURR_CD								,
				RT.FNL_FRT_RT_AMT							RT_FNL_FRT_RT_AMT					,

				NULL													OI_ROUT_PNT_LOC_DEF_CD		,
				NULL													OI_BSE_PORT_DEF_CD				,
				NULL													OI_VIA_PORT_DEF_CD				,
				NULL													OI_DIR_CALL_FLG						,
				NULL													OI_RAT_UT_CD							,
				NULL													OI_PRC_CGO_TP_CD					,
				NULL													OI_PRC_TRSP_MOD_CD				,
				NULL													OI_RCV_DE_TERM_CD					,
				NULL													OI_PRC_CMDT_DEF_CD				,
				NULL													OI_CURR_CD								,
				NULL													OI_FNL_FRT_RT_AMT					,
				NULL													OI_RAT_UT_MTCH_PRIO				,

				OA.ROUT_PNT_LOC_DEF_CD				OA_ROUT_PNT_LOC_DEF_CD		,
				OA.BSE_PORT_DEF_CD						OA_BSE_PORT_DEF_CD				,
				OA.VIA_PORT_DEF_CD						OA_VIA_PORT_DEF_CD				,
				OA.DIR_CALL_FLG								OA_DIR_CALL_FLG						,
				OA.RAT_UT_CD									OA_RAT_UT_CD							,
				OA.PRC_CGO_TP_CD							OA_PRC_CGO_TP_CD					,
				OA.PRC_TRSP_MOD_CD						OA_PRC_TRSP_MOD_CD				,
				OA.RCV_DE_TERM_CD							OA_RCV_DE_TERM_CD					,
				OA.PRC_CMDT_DEF_CD						OA_PRC_CMDT_DEF_CD				,
				OA.CURR_CD										OA_CURR_CD								,
				OA.FNL_FRT_RT_AMT							OA_FNL_FRT_RT_AMT					,
				OA.RAT_UT_MTCH_PRIO						OA_RAT_UT_MTCH_PRIO				,

				DA.ROUT_PNT_LOC_DEF_CD				DA_ROUT_PNT_LOC_DEF_CD		,
				DA.BSE_PORT_DEF_CD						DA_BSE_PORT_DEF_CD				,
				DA.VIA_PORT_DEF_CD						DA_VIA_PORT_DEF_CD				,
				DA.DIR_CALL_FLG								DA_DIR_CALL_FLG						,
				DA.RAT_UT_CD									DA_RAT_UT_CD							,
				DA.PRC_CGO_TP_CD							DA_PRC_CGO_TP_CD					,
				DA.PRC_TRSP_MOD_CD						DA_PRC_TRSP_MOD_CD				,
				DA.RCV_DE_TERM_CD							DA_RCV_DE_TERM_CD					,
				DA.PRC_CMDT_DEF_CD						DA_PRC_CMDT_DEF_CD				,
				DA.CURR_CD										DA_CURR_CD								,
				DA.FNL_FRT_RT_AMT							DA_FNL_FRT_RT_AMT					,
				DA.RAT_UT_MTCH_PRIO						DA_RAT_UT_MTCH_PRIO				,

				NULL													DI_ROUT_PNT_LOC_DEF_CD		,
				NULL													DI_BSE_PORT_DEF_CD				,
				NULL													DI_VIA_PORT_DEF_CD				,
				NULL													DI_DIR_CALL_FLG						,
				NULL													DI_RAT_UT_CD							,
				NULL													DI_PRC_CGO_TP_CD					,
				NULL													DI_PRC_TRSP_MOD_CD				,
				NULL													DI_RCV_DE_TERM_CD					,
				NULL													DI_PRC_CMDT_DEF_CD				,
				NULL													DI_CURR_CD								,
				NULL													DI_FNL_FRT_RT_AMT					,
				NULL													DI_RAT_UT_MTCH_PRIO				,

				RT_RAP.BKG_CONV_TP_CD      		RT_RAP_BKG_CONV_TP_CD			,
				RT_RAP.NOTE_CONV_MAPG_ID   		RT_RAP_NOTE_CONV_MAPG_ID  ,
				RT_RAP.NOTE_CONV_SEQ       		RT_RAP_NOTE_CONV_SEQ      ,
				RT_RAP.NOTE_CONV_RULE_CD   		RT_RAP_NOTE_CONV_RULE_CD  ,
				RT_RAP.NOTE_CONV_TP_CD     		RT_RAP_NOTE_CONV_TP_CD    ,
				RT_RAP.RT_OP_CD            		RT_RAP_RT_OP_CD           ,
				RT_RAP.CURR_CD             		RT_RAP_CURR_CD            ,
				RT_RAP.FRT_RT_AMT          		RT_RAP_FRT_RT_AMT         ,
				RT_RAP.RAP_CONV_CTNT					RT_RAP_CONV_CTNT					,

				RT_RAR.BKG_CONV_TP_CD      		RT_RAR_BKG_CONV_TP_CD     ,
				RT_RAR.NOTE_CONV_MAPG_ID   		RT_RAR_NOTE_CONV_MAPG_ID  ,
				RT_RAR.NOTE_CONV_SEQ       		RT_RAR_NOTE_CONV_SEQ      ,
				RT_RAR.NOTE_CONV_RULE_CD   		RT_RAR_NOTE_CONV_RULE_CD  ,
				RT_RAR.NOTE_CONV_TP_CD     		RT_RAR_NOTE_CONV_TP_CD    ,
				RT_RAR.RT_OP_CD            		RT_RAR_RT_OP_CD           ,
				RT_RAR.CURR_CD             		RT_RAR_CURR_CD            ,
				RT_RAR.FRT_RT_AMT          		RT_RAR_FRT_RT_AMT         ,
				RT_RAR.RAR_CONV_CTNT					RT_RAR_CONV_CTNT					,

				RT_DOR.BKG_CONV_TP_CD      		RT_DOR_BKG_CONV_TP_CD     ,
				RT_DOR.NOTE_CONV_MAPG_ID   		RT_DOR_NOTE_CONV_MAPG_ID  ,
				RT_DOR.NOTE_CONV_SEQ       		RT_DOR_NOTE_CONV_SEQ      ,
				RT_DOR.NOTE_CONV_RULE_CD   		RT_DOR_NOTE_CONV_RULE_CD  ,
				RT_DOR.NOTE_CONV_TP_CD     		RT_DOR_NOTE_CONV_TP_CD    ,
				RT_DOR.RT_OP_CD            		RT_DOR_RT_OP_CD           ,
				RT_DOR.CURR_CD             		RT_DOR_CURR_CD            ,
				RT_DOR.FRT_RT_AMT          		RT_DOR_FRT_RT_AMT         ,
				RT_DOR.DOR_CONV_CTNT					RT_DOR_CONV_CTNT					,

				RT_TYP.BKG_CONV_TP_CD      		RT_TYP_BKG_CONV_TP_CD     ,
				RT_TYP.NOTE_CONV_MAPG_ID   		RT_TYP_NOTE_CONV_MAPG_ID  ,
				RT_TYP.NOTE_CONV_SEQ       		RT_TYP_NOTE_CONV_SEQ      ,
				RT_TYP.NOTE_CONV_RULE_CD   		RT_TYP_NOTE_CONV_RULE_CD  ,
				RT_TYP.NOTE_CONV_TP_CD     		RT_TYP_NOTE_CONV_TP_CD    ,
				RT_TYP.RT_OP_CD            		RT_TYP_RT_OP_CD           ,
				RT_TYP.CURR_CD             		RT_TYP_CURR_CD            ,
				RT_TYP.FRT_RT_AMT          		RT_TYP_FRT_RT_AMT         ,
				RT_TYP.TYP_CONV_CTNT					RT_TYP_CONV_CTNT					,

				RT_RAC.BKG_CONV_TP_CD      		RT_RAC_BKG_CONV_TP_CD     ,
				RT_RAC.NOTE_CONV_MAPG_ID   		RT_RAC_NOTE_CONV_MAPG_ID  ,
				RT_RAC.NOTE_CONV_SEQ       		RT_RAC_NOTE_CONV_SEQ      ,
				RT_RAC.NOTE_CONV_RULE_CD   		RT_RAC_NOTE_CONV_RULE_CD  ,
				RT_RAC.NOTE_CONV_TP_CD     		RT_RAC_NOTE_CONV_TP_CD    ,
				RT_RAC.RT_OP_CD            		RT_RAC_RT_OP_CD           ,
				RT_RAC.CURR_CD             		RT_RAC_CURR_CD            ,
				RT_RAC.FRT_RT_AMT          		RT_RAC_FRT_RT_AMT         ,
				RT_RAC.RAC_CONV_CTNT					RT_RAC_CONV_CTNT					,

				RT.APP_BKG_CONV_TP_CD      		RT_APP_BKG_CONV_TP_CD     ,
				RT.APP_NOTE_CONV_MAPG_ID   		RT_APP_NOTE_CONV_MAPG_ID  ,
				RT.APP_NOTE_CONV_SEQ       		RT_APP_NOTE_CONV_SEQ      ,
				RT.APP_NOTE_CONV_RULE_CD   		RT_APP_NOTE_CONV_RULE_CD  ,
				RT.APP_NOTE_CONV_TP_CD     		RT_APP_NOTE_CONV_TP_CD    ,
				RT.APP_RT_OP_CD            		RT_APP_RT_OP_CD           ,
				RT.APP_CURR_CD             		RT_APP_CURR_CD            ,
				RT.APP_FRT_RT_AMT          		RT_APP_FRT_RT_AMT         ,

				RT.RAS_BKG_CONV_TP_CD      		RT_RAS_BKG_CONV_TP_CD     ,
				RT.RAS_NOTE_CONV_MAPG_ID   		RT_RAS_NOTE_CONV_MAPG_ID  ,
				RT.RAS_NOTE_CONV_SEQ       		RT_RAS_NOTE_CONV_SEQ      ,
				RT.RAS_NOTE_CONV_RULE_CD   		RT_RAS_NOTE_CONV_RULE_CD  ,
				RT.RAS_NOTE_CONV_TP_CD     		RT_RAS_NOTE_CONV_TP_CD    ,
				RT.RAS_RT_OP_CD            		RT_RAS_RT_OP_CD           ,
				RT.RAS_CURR_CD             		RT_RAS_CURR_CD            ,
				RT.RAS_FRT_RT_AMT          		RT_RAS_FRT_RT_AMT         ,
				RT.RAS_RAS_CONV_CTNT					RT_RAS_CONV_CTNT					,


				RT.ARB_BKG_CONV_TP_CD      		RT_ARB_BKG_CONV_TP_CD     ,
				RT.ARB_NOTE_CONV_MAPG_ID   		RT_ARB_NOTE_CONV_MAPG_ID  ,
				RT.ARB_NOTE_CONV_SEQ       		RT_ARB_NOTE_CONV_SEQ      ,
				RT.ARB_NOTE_CONV_RULE_CD   		RT_ARB_NOTE_CONV_RULE_CD  ,
				RT.ARB_NOTE_CONV_TP_CD     		RT_ARB_NOTE_CONV_TP_CD    ,
				RT.ARB_RT_OP_CD            		RT_ARB_RT_OP_CD           ,
				RT.ARB_CURR_CD             		RT_ARB_CURR_CD            ,
				RT.ARB_FRT_RT_AMT          		RT_ARB_FRT_RT_AMT         ,

				RT.ADD_BKG_CONV_TP_CD      		RT_ADD_BKG_CONV_TP_CD     ,
				RT.ADD_NOTE_CONV_MAPG_ID   		RT_ADD_NOTE_CONV_MAPG_ID  ,
				RT.ADD_NOTE_CONV_SEQ       		RT_ADD_NOTE_CONV_SEQ      ,
				RT.ADD_NOTE_CONV_RULE_CD   		RT_ADD_NOTE_CONV_RULE_CD  ,
				RT.ADD_NOTE_CONV_TP_CD     		RT_ADD_NOTE_CONV_TP_CD    ,
				RT.ADD_RT_OP_CD            		RT_ADD_RT_OP_CD           ,
				RT.ADD_CURR_CD             		RT_ADD_CURR_CD            ,
				RT.ADD_FRT_RT_AMT          		RT_ADD_FRT_RT_AMT         ,

				OA_TYP.BKG_CONV_TP_CD      		OA_TYP_BKG_CONV_TP_CD     ,
				OA_TYP.NOTE_CONV_MAPG_ID   		OA_TYP_NOTE_CONV_MAPG_ID  ,
				OA_TYP.NOTE_CONV_SEQ       		OA_TYP_NOTE_CONV_SEQ      ,
				OA_TYP.NOTE_CONV_RULE_CD   		OA_TYP_NOTE_CONV_RULE_CD  ,
				OA_TYP.NOTE_CONV_TP_CD     		OA_TYP_NOTE_CONV_TP_CD    ,
				OA_TYP.RT_OP_CD            		OA_TYP_RT_OP_CD           ,
				OA_TYP.CURR_CD             		OA_TYP_CURR_CD            ,
				OA_TYP.FRT_RT_AMT          		OA_TYP_FRT_RT_AMT         ,
				OA_TYP.TYP_CONV_CTNT       		OA_TYP_CONV_CTNT         	,

				OA_RAC.BKG_CONV_TP_CD      		OA_RAC_BKG_CONV_TP_CD     ,
				OA_RAC.NOTE_CONV_MAPG_ID   		OA_RAC_NOTE_CONV_MAPG_ID  ,
				OA_RAC.NOTE_CONV_SEQ       		OA_RAC_NOTE_CONV_SEQ      ,
				OA_RAC.NOTE_CONV_RULE_CD   		OA_RAC_NOTE_CONV_RULE_CD  ,
				OA_RAC.NOTE_CONV_TP_CD     		OA_RAC_NOTE_CONV_TP_CD    ,
				OA_RAC.RT_OP_CD            		OA_RAC_RT_OP_CD           ,
				OA_RAC.CURR_CD             		OA_RAC_CURR_CD            ,
				OA_RAC.FRT_RT_AMT          		OA_RAC_FRT_RT_AMT         ,
				OA_RAC.RAC_CONV_CTNT       		OA_RAC_CONV_CTNT         	,

				DA_TYP.BKG_CONV_TP_CD      		DA_TYP_BKG_CONV_TP_CD     ,
				DA_TYP.NOTE_CONV_MAPG_ID   		DA_TYP_NOTE_CONV_MAPG_ID  ,
				DA_TYP.NOTE_CONV_SEQ       		DA_TYP_NOTE_CONV_SEQ      ,
				DA_TYP.NOTE_CONV_RULE_CD   		DA_TYP_NOTE_CONV_RULE_CD  ,
				DA_TYP.NOTE_CONV_TP_CD     		DA_TYP_NOTE_CONV_TP_CD    ,
				DA_TYP.RT_OP_CD            		DA_TYP_DA_OP_CD           ,
				DA_TYP.CURR_CD             		DA_TYP_CURR_CD            ,
				DA_TYP.FRT_RT_AMT          		DA_TYP_FRT_RT_AMT					,
				DA_TYP.TYP_CONV_CTNT       		DA_TYP_CONV_CTNT         	,

				DA_RAC.BKG_CONV_TP_CD      		DA_RAC_BKG_CONV_TP_CD     ,
				DA_RAC.NOTE_CONV_MAPG_ID   		DA_RAC_NOTE_CONV_MAPG_ID  ,
				DA_RAC.NOTE_CONV_SEQ       		DA_RAC_NOTE_CONV_SEQ      ,
				DA_RAC.NOTE_CONV_RULE_CD   		DA_RAC_NOTE_CONV_RULE_CD  ,
				DA_RAC.NOTE_CONV_TP_CD     		DA_RAC_NOTE_CONV_TP_CD    ,
				DA_RAC.RT_OP_CD            		DA_RAC_DA_OP_CD           ,
				DA_RAC.CURR_CD             		DA_RAC_CURR_CD            ,
				DA_RAC.FRT_RT_AMT          		DA_RAC_FRT_RT_AMT					,
				DA_RAC.RAC_CONV_CTNT       		DA_RAC_CONV_CTNT         	,

				OA.POR_MTCH_FLG								POR_MTCH_FLG							,
				'Y'														DEL_MTCH_FLG

FROM
/*******************************************************************************************
JOIN TABLE
1.1 BQ, CH, CM, CR, RD, OP, DV, DP, RT
1.2 RT RULE					: RAP, RAR, TYP, RAC, APP, RAS, ARB, ADD
2.1 OA							: O
2.2 OA RULE					: TYP, RAC ( RAP, RAR, DOR 는 RT 와 동일하게 적용 )
3.1 DA							: O
3.2 DA RULE					: TYP, RAC ( RAP, RAR, DOR 는 RT 와 동일하게 적용 )
*******************************************************************************************/
				BQ	,
				OA	,
				DA	,
				RT	,
				NC_P											RT_RAP	,			/* COMMODITY CONVERSION */
				NC_P											RT_RAR	,			/* ROUTE CONVERSION */
				NC_P											RT_DOR	,			/* R/D TERM CONVERSION */
				NC_P											RT_TYP	,			/* RATING UNIT CONVERSION */
				NC_P											RT_RAC	,			/* CARGO TYPE CONVERSION */
				NC_P											OA_TYP	,			/* RATING UNIT CONVERSION */
				NC_P											OA_RAC	,			/* CARGO TYPE CONVERSION */
				NC_P											DA_TYP	,			/* RATING UNIT CONVERSION */
				NC_P											DA_RAC				/* CARGO TYPE CONVERSION */

WHERE		RT.BQ_SEQ		=	BQ.BQ_SEQ
AND			OA.BQ_SEQ		= BQ.BQ_SEQ
AND			DA.BQ_SEQ		= BQ.BQ_SEQ
AND			RT_RAP.BQ_SEQ	= RT.BQ_SEQ AND RT_RAP.NOTE_CONV_RULE_CD = 'RAP' AND ( RT_RAP.BKG_CONV_TP_CD = 'B' OR RT_RAP.NC_SEQ = RT.RAP_NC_SEQ )
AND			RT_RAR.BQ_SEQ	= RT.BQ_SEQ AND RT_RAR.NOTE_CONV_RULE_CD = 'RAR' AND ( RT_RAR.BKG_CONV_TP_CD = 'B' OR RT_RAR.NC_SEQ = RT.RAR_NC_SEQ )
AND			RT_DOR.BQ_SEQ	= RT.BQ_SEQ AND RT_DOR.NOTE_CONV_RULE_CD = 'DOR' AND ( RT_DOR.BKG_CONV_TP_CD = 'B' OR RT_DOR.NC_SEQ = RT.DOR_NC_SEQ )
AND			RT_TYP.BQ_SEQ	= RT.BQ_SEQ AND RT_TYP.NOTE_CONV_RULE_CD = 'TYP' AND ( RT_TYP.BKG_CONV_TP_CD = 'B' OR RT_TYP.NC_SEQ = RT.TYP_NC_SEQ )
AND			RT_RAC.BQ_SEQ	= RT.BQ_SEQ AND RT_RAC.NOTE_CONV_RULE_CD = 'RAC' AND ( RT_RAC.BKG_CONV_TP_CD = 'B' OR RT_RAC.NC_SEQ = RT.RAC_NC_SEQ )
AND			OA_TYP.BQ_SEQ	= RT.BQ_SEQ AND OA_TYP.NOTE_CONV_RULE_CD = 'TYP' AND ( OA_TYP.BKG_CONV_TP_CD = 'B' OR OA_TYP.NC_SEQ = RT.TYP_NC_SEQ )
AND			OA_RAC.BQ_SEQ	= RT.BQ_SEQ AND OA_RAC.NOTE_CONV_RULE_CD = 'RAC' AND ( OA_RAC.BKG_CONV_TP_CD = 'B' OR OA_RAC.NC_SEQ = RT.RAC_NC_SEQ )
AND			DA_TYP.BQ_SEQ	= RT.BQ_SEQ AND DA_TYP.NOTE_CONV_RULE_CD = 'TYP' AND ( DA_TYP.BKG_CONV_TP_CD = 'B' OR DA_TYP.NC_SEQ = RT.TYP_NC_SEQ )
AND			DA_RAC.BQ_SEQ	= RT.BQ_SEQ AND DA_RAC.NOTE_CONV_RULE_CD = 'RAC' AND ( DA_RAC.BKG_CONV_TP_CD = 'B' OR DA_RAC.NC_SEQ = RT.RAC_NC_SEQ )


/*******************************************************************************************
	4.1 RATE
*******************************************************************************************/

/*******************************************************************************************
	4.1.1 RATE - COMMODITY
*******************************************************************************************/

/*******************************************************************************************
< COMMODITY >
그룹, 개별간으로 일치하는 경우
*******************************************************************************************/

AND			( RT.CM_PRC_CMDT_TP_CD, RT.CM_PRC_CMDT_DEF_CD ) IN
				(
				SELECT	RT_RAP.CONV_CMDT_TP_CD, RT_RAP.CONV_CMDT_DEF_CD
				FROM		DUAL
				UNION ALL
				SELECT  'C', GC.PRC_CMDT_DEF_CD
				FROM		GC
				WHERE		RT_RAP.CONV_CMDT_TP_CD	= 'G'
				AND     GC.PRC_CMDT_TP_CD   		= 'C'
				AND			GC.PRC_GRP_CMDT_CD  		= RT_RAP.CONV_CMDT_DEF_CD
				UNION ALL
				SELECT  'G', GC.PRC_GRP_CMDT_CD
				FROM		GC
				WHERE		RT_RAP.CONV_CMDT_TP_CD	= 'C'
				AND     GC.PRC_CMDT_TP_CD   		= 'C'
				AND     GC.PRC_CMDT_DEF_CD  		= RT_RAP.CONV_CMDT_DEF_CD
				UNION ALL
				/* TAW 일 경우 FAK 고려함 */
				SELECT	'C', CMDT_CD
				FROM		MDM_COMMODITY
				WHERE		REP_CMDT_CD		= '0000'
				UNION ALL
				SELECT	'G', GC.PRC_GRP_CMDT_CD
				FROM		GC
				WHERE		GC.PRC_CMDT_TP_CD		= 'C'
				AND			GC.PRC_CMDT_DEF_CD  IN ( SELECT CMDT_CD FROM MDM_COMMODITY WHERE REP_CMDT_CD = '0000' )
				)


/*******************************************************************************************
	4.1.2 RATE - ROUTE
*******************************************************************************************/

/*******************************************************************************************
< ORIGIN ( PRE RELAY ) >
*******************************************************************************************/

AND     ( RT.OP_ROUT_PNT_LOC_TP_CD, RT.OP_ROUT_PNT_LOC_DEF_CD ) IN
				(
				SELECT	'L', BQ.PRE_RLY_PORT_CD
				FROM		DUAL
				UNION ALL
				SELECT  'G', GL.PRC_GRP_LOC_CD
				FROM		GL
				WHERE		GL.LOC_CD						= BQ.PRE_RLY_PORT_CD
				)


/*******************************************************************************************
< ORIGIN VIA ( PRE RELAY ) >
*******************************************************************************************/

AND     (
						RT.OV_ROUT_VIA_PORT_DEF_CD IS NULL
				OR	( RT.OV_ROUT_VIA_PORT_TP_CD, RT.OV_ROUT_VIA_PORT_DEF_CD ) IN
						(
						SELECT	'L', BQ.PRE_RLY_PORT_CD
						FROM		DUAL
						UNION ALL
						SELECT  'G', GL.PRC_GRP_LOC_CD
						FROM		GL
						WHERE		GL.LOC_CD						= BQ.PRE_RLY_PORT_CD
						)
				)


/*******************************************************************************************
< DESTINATION VIA ( POD ) >
*******************************************************************************************/

AND     (
						RT.DV_ROUT_VIA_PORT_DEF_CD IS NULL
				OR	( RT.DV_ROUT_VIA_PORT_TP_CD, RT.DV_ROUT_VIA_PORT_DEF_CD ) IN
						(
						SELECT  RT_RAR.CONV_DEST_VIA_LOC_TP_CD, RT_RAR.CONV_DEST_VIA_LOC_DEF_CD
						FROM		DUAL
						UNION ALL
						SELECT  'L', GL.LOC_CD
						FROM		GL
						WHERE		RT_RAR.CONV_DEST_VIA_LOC_TP_CD	= 'G'
						AND		  GL.PRC_GRP_LOC_CD 				= RT_RAR.CONV_DEST_VIA_LOC_DEF_CD
						UNION ALL
						SELECT  'G', GL.PRC_GRP_LOC_CD
						FROM		GL
						WHERE		RT_RAR.CONV_DEST_VIA_LOC_TP_CD	= 'L'
						AND     GL.LOC_CD									= RT_RAR.CONV_DEST_VIA_LOC_DEF_CD
						)
				)


/*******************************************************************************************
< DESTINATION ( POD ) >
*******************************************************************************************/

AND			( RT.DP_ROUT_PNT_LOC_TP_CD, RT.DP_ROUT_PNT_LOC_DEF_CD ) IN
				(
				SELECT  RT_RAR.CONV_DEST_VIA_LOC_TP_CD, RT_RAR.CONV_DEST_VIA_LOC_DEF_CD
				FROM		DUAL
				UNION ALL
				SELECT  'L', GL.LOC_CD
				FROM		GL
				WHERE		RT_RAR.CONV_DEST_VIA_LOC_TP_CD	= 'G'
				AND		  GL.PRC_GRP_LOC_CD 				= RT_RAR.CONV_DEST_VIA_LOC_DEF_CD
				UNION ALL
				SELECT  'G', GL.PRC_GRP_LOC_CD
				FROM		GL
				WHERE		RT_RAR.CONV_DEST_VIA_LOC_TP_CD	= 'L'
				AND     GL.LOC_CD									= RT_RAR.CONV_DEST_VIA_LOC_DEF_CD
				)


/*******************************************************************************************
	4.1.3 RATE - RATING UNIT
*******************************************************************************************/

AND     (
								RT.RAT_UT_CD	= RT_TYP.CONV_RAT_UT_CD
		        OR
    		    (
        				RT.RAT_UT_CD	IN ( '20', '40', 'HC', '45', '53' )
       			AND ( SELECT A.CNTR_SZ_CD FROM PRI_RAT_UT A WHERE A.RAT_UT_CD = RT.RAT_UT_CD )	= RT_TYP.CONV_RAT_UT_SZ_CD
        		)
				)

AND			RT.PRC_CGO_TP_CD	IN ( RT_RAC.CONV_DR_TP, RT_RAC.CONV_DG_TP, RT_RAC.CONV_RF_TP, RT_RAC.CONV_AK_TP, RT_RAC.CONV_BB_TP )


/*******************************************************************************************
	4.2 ORIGIN ARB
*******************************************************************************************/

/*******************************************************************************************
	4.2.1 ORIGIN ARB - COMMODITY
*******************************************************************************************/

AND			(
						OA.PRC_CMDT_DEF_CD	IS NULL
				OR	( OA.PRC_CMDT_TP_CD, OA.PRC_CMDT_DEF_CD ) IN
						(
						SELECT	RT_RAP.CONV_CMDT_TP_CD, RT_RAP.CONV_CMDT_DEF_CD
						FROM		DUAL
						UNION ALL
						SELECT  'C', GC.PRC_CMDT_DEF_CD
						FROM		GC
						WHERE		RT_RAP.CONV_CMDT_TP_CD	= 'G'
						AND     GC.PRC_CMDT_TP_CD   		= 'C'
						AND			GC.PRC_GRP_CMDT_CD  		= RT_RAP.CONV_CMDT_DEF_CD
						UNION ALL
						SELECT  'G', GC.PRC_GRP_CMDT_CD
						FROM		GC
						WHERE		RT_RAP.CONV_CMDT_TP_CD	= 'C'
						AND     GC.PRC_CMDT_TP_CD   		= 'C'
						AND     GC.PRC_CMDT_DEF_CD  		= RT_RAP.CONV_CMDT_DEF_CD
						UNION ALL
						/* TAW 일 경우 FAK 고려함 */
						SELECT	'C', CMDT_CD
						FROM		MDM_COMMODITY
						WHERE		REP_CMDT_CD		= '0000'
						UNION ALL
						SELECT	'G', GC.PRC_GRP_CMDT_CD
						FROM		GC
						WHERE		GC.PRC_CMDT_TP_CD		= 'C'
						AND			GC.PRC_CMDT_DEF_CD  IN ( SELECT CMDT_CD FROM MDM_COMMODITY WHERE REP_CMDT_CD = '0000' )
						)
				)


/*******************************************************************************************
	4.2.2 ORIGIN ARB - ROUTE
*******************************************************************************************/

/*******************************************************************************************
< POINT ( POR OR POL ) >
*******************************************************************************************/

AND     ( OA.ROUT_PNT_LOC_TP_CD, OA.ROUT_PNT_LOC_DEF_CD ) IN
				(
				SELECT  RT_RAR.CONV_ORG_LOC_TP_CD, RT_RAR.CONV_ORG_LOC_DEF_CD
				FROM		DUAL
				UNION ALL
				SELECT  'L', GL.LOC_CD
				FROM		GL
				WHERE		RT_RAR.CONV_ORG_LOC_TP_CD	= 'G'
				AND		  GL.PRC_GRP_LOC_CD 				= RT_RAR.CONV_ORG_LOC_DEF_CD
				UNION ALL
				SELECT  'G', GL.PRC_GRP_LOC_CD
				FROM		GL
				WHERE		RT_RAR.CONV_ORG_LOC_TP_CD	= 'L'
				AND     GL.LOC_CD									= RT_RAR.CONV_ORG_LOC_DEF_CD
				UNION ALL
				SELECT	RT_RAR.CONV_ORG_VIA_LOC_TP_CD,	RT_RAR.CONV_ORG_VIA_LOC_DEF_CD
				FROM		DUAL
				UNION ALL
				SELECT  'L', GL.LOC_CD
				FROM		GL
				WHERE		RT_RAR.CONV_ORG_VIA_LOC_TP_CD	= 'G'
				AND		  GL.PRC_GRP_LOC_CD 				= RT_RAR.CONV_ORG_VIA_LOC_DEF_CD
				UNION ALL
				SELECT  'G', GL.PRC_GRP_LOC_CD
				FROM		GL
				WHERE		RT_RAR.CONV_ORG_VIA_LOC_TP_CD	= 'L'
				AND     GL.LOC_CD									= RT_RAR.CONV_ORG_VIA_LOC_DEF_CD
				)


/*******************************************************************************************
< RCV TERM >
*******************************************************************************************/

AND     (
						(
								OA.POR_MTCH_FLG			= 'Y'
						AND	NVL(OA.RCV_DE_TERM_CD, '*') IN
								(
								SELECT  B.RCV_DE_TERM_CD
								FROM		(
												SELECT 'Y' CONV_PRC_TERM_CD, 'Y' RCV_DE_TERM_CD FROM DUAL UNION ALL
												SELECT 'Y' CONV_PRC_TERM_CD, 'L' RCV_DE_TERM_CD FROM DUAL UNION ALL
												SELECT 'Y' CONV_PRC_TERM_CD, '*' RCV_DE_TERM_CD FROM DUAL UNION ALL
												SELECT 'S' CONV_PRC_TERM_CD, 'S' RCV_DE_TERM_CD FROM DUAL UNION ALL
												SELECT 'D' CONV_PRC_TERM_CD, 'D' RCV_DE_TERM_CD FROM DUAL UNION ALL
												SELECT 'T' CONV_PRC_TERM_CD, 'T' RCV_DE_TERM_CD FROM DUAL UNION ALL
												SELECT 'I' CONV_PRC_TERM_CD, 'I' RCV_DE_TERM_CD FROM DUAL
												)	B
								WHERE		B.CONV_PRC_TERM_CD	= RT_DOR.CONV_PRC_RCV_TERM_CD
								)
						)
				OR	(
								BQ.POR_CD										= BQ.POL_CD
						AND	NVL(OA.RCV_DE_TERM_CD, '*') IN
								(
								SELECT  B.RCV_DE_TERM_CD
								FROM		(
												SELECT 'Y' CONV_PRC_TERM_CD, 'Y' RCV_DE_TERM_CD FROM DUAL UNION ALL
												SELECT 'Y' CONV_PRC_TERM_CD, 'L' RCV_DE_TERM_CD FROM DUAL UNION ALL
												SELECT 'Y' CONV_PRC_TERM_CD, '*' RCV_DE_TERM_CD FROM DUAL UNION ALL
												SELECT 'S' CONV_PRC_TERM_CD, 'S' RCV_DE_TERM_CD FROM DUAL UNION ALL
												SELECT 'D' CONV_PRC_TERM_CD, 'D' RCV_DE_TERM_CD FROM DUAL UNION ALL
												SELECT 'D' CONV_PRC_TERM_CD, 'Y' RCV_DE_TERM_CD FROM DUAL UNION ALL	-- 예외 적용
												SELECT 'T' CONV_PRC_TERM_CD, 'T' RCV_DE_TERM_CD FROM DUAL UNION ALL
												SELECT 'I' CONV_PRC_TERM_CD, 'I' RCV_DE_TERM_CD FROM DUAL
												)	B
								WHERE		B.CONV_PRC_TERM_CD	= RT_DOR.CONV_PRC_RCV_TERM_CD
								)
						)
				OR	(
								OA.POR_MTCH_FLG 								= 'N'
						AND	NVL(OA.RCV_DE_TERM_CD, '*')	IN ( 'Y', '*' )
						)
				)


/*******************************************************************************************
< ORIGIN TRANS MODE >
*******************************************************************************************/

AND			(
					  OA.POR_MTCH_FLG = 'N'
				OR	(
								OA.PRC_TRSP_MOD_CD		IS NULL
						OR	BQ.ORG_TRNS_MOD_CD		IS NULL
						OR	OA.PRC_TRSP_MOD_CD		= BQ.ORG_TRNS_MOD_CD
						OR  (
										OA.PRC_TRSP_MOD_CD		IN ( 'R', 'A' )
								AND	BQ.ORG_TRNS_MOD_CD		= 'R'
								)
						)
				)


/*******************************************************************************************
< VIA PORT ( PRE RELAY ) >
*******************************************************************************************/

AND     (
                OA.VIA_PORT_DEF_CD  IS NULL
            OR	( OA.VIA_PORT_TP_CD, OA.VIA_PORT_DEF_CD ) IN
								(
								SELECT	'L', BQ.PRE_RLY_PORT_CD
								FROM		DUAL
								UNION ALL
								SELECT  'G', GL.PRC_GRP_LOC_CD
								FROM		GL
								WHERE		GL.LOC_CD						= BQ.PRE_RLY_PORT_CD
								)
        )


/*******************************************************************************************
	2.2.3 ORIGIN ARB - RATING UNIT
*******************************************************************************************/

/* ORIGIN ARB RATING UNIT */
AND     (
								OA.RAT_UT_CD	= OA_TYP.CONV_RAT_UT_CD
		        OR	OA.RAT_UT_CD	= 'BX'
		        OR
    		    (
        				OA.RAT_UT_CD	IN ( '20', '40', 'HC', '45', '53' )
       			AND ( SELECT A.CNTR_SZ_CD FROM PRI_RAT_UT A WHERE A.RAT_UT_CD = OA.RAT_UT_CD )	= OA_TYP.CONV_RAT_UT_SZ_CD
        		)
				)

/* ORIGIN ARB CARGO TYPE */
AND			NVL(OA.PRC_CGO_TP_CD, '*')	IN ('*', OA_RAC.CONV_DR_TP, OA_RAC.CONV_DG_TP, OA_RAC.CONV_RF_TP, OA_RAC.CONV_AK_TP, OA_RAC.CONV_BB_TP )


/*******************************************************************************************
	2.2.4 ORIGIN ARB - JOIN
*******************************************************************************************/

/* ORIGIN ARB JOIN ( ARB CONV RULE ) */
AND			DECODE(RT.ARB_RT_APPL_TP_CD, NULL, DECODE(RT.GEN_SPCL_RT_TP_CD, 'S', 'N', 'Y'), 'N', 'N', 'Y') = 'Y'

/* ORIGIN ARB JOIN ( OARB.BPORT = RATE.ORIGIN ) */
AND			NVL(RT.OP_RCV_DE_TERM_CD, '*' )	NOT IN ( 'D', 'S' )

AND			( RT.OP_ROUT_PNT_LOC_TP_CD, RT.OP_ROUT_PNT_LOC_DEF_CD ) IN
				(
				SELECT	OA.BSE_PORT_TP_CD, OA.BSE_PORT_DEF_CD
				FROM		DUAL
				UNION ALL
				SELECT	'L', GL.LOC_CD
				FROM		GL
				WHERE		OA.BSE_PORT_TP_CD	= 'G'
				AND		  GL.PRC_GRP_LOC_CD	= OA.BSE_PORT_DEF_CD
				UNION ALL
				SELECT	'G', GL.PRC_GRP_LOC_CD
				FROM		GL
				WHERE		OA.BSE_PORT_TP_CD	= 'L'
				AND			GL.LOC_CD					= OA.BSE_PORT_DEF_CD
				)


/*******************************************************************************************
	4.3 DEST ARB
*******************************************************************************************/

/*******************************************************************************************
	4.3.1 DEST ARB - COMMODITY
*******************************************************************************************/

AND			(
						DA.PRC_CMDT_DEF_CD	IS NULL
				OR	( DA.PRC_CMDT_TP_CD, DA.PRC_CMDT_DEF_CD ) IN
						(
						SELECT	RT_RAP.CONV_CMDT_TP_CD, RT_RAP.CONV_CMDT_DEF_CD
						FROM		DUAL
						UNION ALL
						SELECT  'C', GC.PRC_CMDT_DEF_CD
						FROM		GC
						WHERE		RT_RAP.CONV_CMDT_TP_CD	= 'G'
						AND     GC.PRC_CMDT_TP_CD   		= 'C'
						AND			GC.PRC_GRP_CMDT_CD  		= RT_RAP.CONV_CMDT_DEF_CD
						UNION ALL
						SELECT  'G', GC.PRC_GRP_CMDT_CD
						FROM		GC
						WHERE		RT_RAP.CONV_CMDT_TP_CD	= 'C'
						AND     GC.PRC_CMDT_TP_CD   		= 'C'
						AND     GC.PRC_CMDT_DEF_CD  		= RT_RAP.CONV_CMDT_DEF_CD
						UNION ALL
						/* TAW 일 경우 FAK 고려함 */
						SELECT	'C', CMDT_CD
						FROM		MDM_COMMODITY
						WHERE		REP_CMDT_CD		= '0000'
						UNION ALL
						SELECT	'G', GC.PRC_GRP_CMDT_CD
						FROM		GC
						WHERE		GC.PRC_CMDT_TP_CD		= 'C'
						AND			GC.PRC_CMDT_DEF_CD  IN ( SELECT CMDT_CD FROM MDM_COMMODITY WHERE REP_CMDT_CD = '0000' )
						)
				)


/*******************************************************************************************
	4.3.2 DEST ARB - ROUTE
*******************************************************************************************/

/*******************************************************************************************
< VIA PORT ( POD ) >
*******************************************************************************************/

AND     (
                DA.VIA_PORT_DEF_CD  IS NULL
            OR	( DA.VIA_PORT_TP_CD, DA.VIA_PORT_DEF_CD ) IN
								(
								SELECT  RT_RAR.CONV_DEST_VIA_LOC_TP_CD, RT_RAR.CONV_DEST_VIA_LOC_DEF_CD
								FROM		DUAL
								UNION ALL
								SELECT  'L', GL.LOC_CD
								FROM		GL
								WHERE		RT_RAR.CONV_DEST_VIA_LOC_TP_CD	= 'G'
								AND		  GL.PRC_GRP_LOC_CD 				= RT_RAR.CONV_DEST_VIA_LOC_DEF_CD
								UNION ALL
								SELECT  'G', GL.PRC_GRP_LOC_CD
								FROM		GL
								WHERE		RT_RAR.CONV_DEST_VIA_LOC_TP_CD	= 'L'
								AND     GL.LOC_CD									= RT_RAR.CONV_DEST_VIA_LOC_DEF_CD
								)
        )


/*******************************************************************************************
< POINT ( DEL ) >
*******************************************************************************************/

AND     ( DA.ROUT_PNT_LOC_TP_CD, DA.ROUT_PNT_LOC_DEF_CD ) IN
				(
				SELECT  RT_RAR.CONV_DEST_LOC_TP_CD, RT_RAR.CONV_DEST_LOC_DEF_CD
				FROM		DUAL
				UNION ALL
				SELECT  'L', GL.LOC_CD
				FROM		GL
				WHERE		RT_RAR.CONV_DEST_LOC_TP_CD	= 'G'
				AND		  GL.PRC_GRP_LOC_CD 				= RT_RAR.CONV_DEST_LOC_DEF_CD
				UNION ALL
				SELECT  'G', GL.PRC_GRP_LOC_CD
				FROM		GL
				WHERE		RT_RAR.CONV_DEST_LOC_TP_CD	= 'L'
				AND     GL.LOC_CD									= RT_RAR.CONV_DEST_LOC_DEF_CD
				)


/*******************************************************************************************
< DE TERM >
*******************************************************************************************/

AND			NVL(DA.RCV_DE_TERM_CD, '*') IN
				(
				SELECT  B.RCV_DE_TERM_CD
				FROM		(
								SELECT 'Y' CONV_PRC_TERM_CD, 'Y' RCV_DE_TERM_CD FROM DUAL UNION ALL
								SELECT 'Y' CONV_PRC_TERM_CD, 'L' RCV_DE_TERM_CD FROM DUAL UNION ALL
								SELECT 'Y' CONV_PRC_TERM_CD, '*' RCV_DE_TERM_CD FROM DUAL UNION ALL
								SELECT 'S' CONV_PRC_TERM_CD, 'S' RCV_DE_TERM_CD FROM DUAL UNION ALL
								SELECT 'S' CONV_PRC_TERM_CD, 'Y' RCV_DE_TERM_CD FROM DUAL UNION ALL
								SELECT 'S' CONV_PRC_TERM_CD, 'T' RCV_DE_TERM_CD FROM DUAL UNION ALL
								SELECT 'S' CONV_PRC_TERM_CD, 'I' RCV_DE_TERM_CD FROM DUAL UNION ALL
								SELECT 'S' CONV_PRC_TERM_CD, 'L' RCV_DE_TERM_CD FROM DUAL UNION ALL
								SELECT 'S' CONV_PRC_TERM_CD, '*' RCV_DE_TERM_CD FROM DUAL UNION ALL
								SELECT 'D' CONV_PRC_TERM_CD, 'D' RCV_DE_TERM_CD FROM DUAL UNION ALL
								SELECT 'T' CONV_PRC_TERM_CD, 'T' RCV_DE_TERM_CD FROM DUAL UNION ALL
								SELECT 'I' CONV_PRC_TERM_CD, 'I' RCV_DE_TERM_CD FROM DUAL
								)	B
				WHERE		B.CONV_PRC_TERM_CD	= RT_DOR.CONV_PRC_DE_TERM_CD
				)


/*******************************************************************************************
< DEST TRANS MODE >
*******************************************************************************************/

AND			(
						DA.PRC_TRSP_MOD_CD		IS NULL
				OR	BQ.DEST_TRNS_MOD_CD		IS NULL
				OR	DA.PRC_TRSP_MOD_CD		= BQ.DEST_TRNS_MOD_CD
				OR  (
								DA.PRC_TRSP_MOD_CD		IN ( 'R', 'A' )
						AND	BQ.DEST_TRNS_MOD_CD		= 'R'
						)
				)


/*******************************************************************************************
	4.2.3 DEST ARB - RATING UNIT
*******************************************************************************************/

/* DEST ARB RATING UNIT */
AND     (
								DA.RAT_UT_CD	= DA_TYP.CONV_RAT_UT_CD
		        OR	DA.RAT_UT_CD	= 'BX'
		        OR
    		    (
        				DA.RAT_UT_CD	IN ( '20', '40', 'HC', '45', '53' )
       			AND ( SELECT A.CNTR_SZ_CD FROM PRI_RAT_UT A WHERE A.RAT_UT_CD = DA.RAT_UT_CD )	= DA_TYP.CONV_RAT_UT_SZ_CD
        		)
				)


/* DEST ARB CARGO TYPE */
AND			NVL(DA.PRC_CGO_TP_CD, '*')	IN ( '*', DA_RAC.CONV_DR_TP, DA_RAC.CONV_DG_TP, DA_RAC.CONV_RF_TP, DA_RAC.CONV_AK_TP, DA_RAC.CONV_BB_TP )


/*******************************************************************************************
	4.2.4 DEST ARB - JOIN
*******************************************************************************************/

/* DEST ARB JOIN ( ADD CONV RULE ) */
AND			DECODE(RT.ADD_RT_APPL_TP_CD, NULL, DECODE(RT.GEN_SPCL_RT_TP_CD, 'S', 'N', 'Y'), 'N', 'N', 'Y') = 'Y'

/* DEST ARB JOIN ( DARB.BPORT = RATE.DEST ) */
AND			NVL(RT.DP_RCV_DE_TERM_CD, '*' )	NOT IN ( 'D', 'S' )

AND			( RT.DP_ROUT_PNT_LOC_TP_CD, RT.DP_ROUT_PNT_LOC_DEF_CD ) IN
				(
				SELECT	DA.BSE_PORT_TP_CD, DA.BSE_PORT_DEF_CD
				FROM		DUAL
				UNION ALL
				SELECT	'L', GL.LOC_CD
				FROM		GL
				WHERE		DA.BSE_PORT_TP_CD	= 'G'
				AND		  GL.PRC_GRP_LOC_CD	= DA.BSE_PORT_DEF_CD
				UNION ALL
				SELECT	'G', GL.PRC_GRP_LOC_CD
				FROM		GL
				WHERE		DA.BSE_PORT_TP_CD	= 'L'
				AND			GL.LOC_CD					= DA.BSE_PORT_DEF_CD
				)


UNION ALL


/*******************************************************************************************
	5. PATTERN #5 ( 1000 )
*******************************************************************************************/

SELECT	'1000'												PRC_RT_MTCH_PATT_CD				,
				BQ.SC_NO											CTRT_NO										,
				BQ.PROP_NO										PROP_NO										,
				BQ.AMDT_SEQ										AMDT_SEQ									,
				BQ.SVC_SCP_CD									SVC_SCP_CD								,
				BQ.BQ_SEQ											BQ_SEQ										,
				BQ.BKG_BQ_SEQ									BKG_BQ_SEQ								,
				BQ.CNTR_TPSZ_CD								BQ_CNTR_TPSZ_CD						,
				BQ.CTRT_CNTR_TPSZ_CD					BQ_CTRT_CNTR_TPSZ_CD			,
				BQ.RCV_TERM_CD								BQ_RCV_TERM_CD						,
				BQ.DE_TERM_CD									BQ_DE_TERM_CD							,
				BQ.DRY_CGO_FLG								BQ_DRY_CGO_FLG						,
				BQ.DCGO_FLG										BQ_DCGO_FLG								,
				BQ.RC_FLG											BQ_RC_FLG									,
				BQ.AWK_CGO_FLG								BQ_AWK_CGO_FLG						,
				BQ.BB_CGO_FLG									BQ_BB_CGO_FLG							,
				BQ.SOC_FLG										BQ_SOC_FLG								,
				BQ.PRC_CGO_TP_CD							BQ_PRC_CGO_TP_CD					,
				BQ.IMDG_CLSS_CD								BQ_IMDG_CLSS_CD						,
				BQ.CTRT_CNTR_QTY							BQ_CTRT_CNTR_QTY					,
				BQ.POR_APPL_FLG								BQ_POR_APPL_FLG						,
				BQ.POL_APPL_FLG								BQ_POL_APPL_FLG						,
				BQ.POD_APPL_FLG								BQ_POD_APPL_FLG						,
				BQ.DEL_APPL_FLG								BQ_DEL_APPL_FLG						,
				BQ.PRE_RLY_PORT_APPL_FLG			BQ_POR_RLY_PORT_APPL_FLG	,
				BQ.PST_RLY_PORT_APPL_FLG			BQ_PST_RLY_PORT_APPL_FLG	,

				RT.CMDT_HDR_SEQ								RT_CMDT_HDR_SEQ						,
				RT.ROUT_SEQ										RT_ROUT_SEQ								,
				RT.RT_SEQ											RT_RT_SEQ									,
				OI.ADD_CHG_SEQ								OI_ADD_CHG_SEQ						,
				0															OA_ADD_CHG_SEQ						,
				0															DA_ADD_CHG_SEQ						,
				0															DI_ADD_CHG_SEQ						,

				RT.GEN_SPCL_RT_TP_CD					RT_GEN_SPCL_RT_TP_CD			,
				RT.CM_PRC_CMDT_TP_CD					CM_PRC_CMDT_TP_CD					,
				RT.CM_PRC_CMDT_DEF_CD					CM_PRC_CMDT_DEF_CD				,
				OI.ROUT_PNT_LOC_DEF_CD				POR_CD										,
				RT.OP_ROUT_PNT_LOC_DEF_CD			POL_CD										,
				RT.DV_ROUT_VIA_PORT_DEF_CD		POD_CD										,
				RT.DP_ROUT_PNT_LOC_DEF_CD			DEL_CD										,
				NULL													DIR_CALL_FLG							,
				OI.RCV_DE_TERM_CD							RCV_TERM_CD								,
				RT.DP_RCV_DE_TERM_CD					DE_TERM_CD								,
				RT.RAT_UT_CD									RAT_UT_CD									,
				RT.PRC_CGO_TP_CD							PRC_CGO_TP_CD							,
				RT.CURR_CD										CURR_CD										,
				OI.PRC_TRSP_MOD_CD						ORG_TRSP_MOD_CD						,
				RT.DP_PRC_TRSP_MOD_CD					DEST_TRSP_MOD_CD					,

				RT.OP_ROUT_PNT_LOC_DEF_CD			OP_ROUT_PNT_LOC_DEF_CD		,
				RT.OV_ROUT_VIA_PORT_DEF_CD		OV_ROUT_VIA_PORT_DEF_CD		,
				RT.DV_ROUT_VIA_PORT_DEF_CD		DV_ROUT_VIA_PORT_DEF_CD		,
				RT.DP_ROUT_PNT_LOC_DEF_CD			DP_ROUT_PNT_LOC_DEF_CD		,
				RT.RD_DIR_CALL_FLG						RD_DIR_CALL_FLG						,
				RT.RAT_UT_CD									RT_RAT_UT_CD							,
				RT.PRC_CGO_TP_CD							RT_PRC_CGO_TP_CD					,
				RT.OP_PRC_TRSP_MOD_CD					OP_PRC_TRSP_MOD_CD				,
				RT.DP_PRC_TRSP_MOD_CD					DP_PRC_TRSP_MOD_CD				,
				RT.CURR_CD										RT_CURR_CD								,
				RT.FNL_FRT_RT_AMT							RT_FNL_FRT_RT_AMT					,

				OI.ROUT_PNT_LOC_DEF_CD				OI_ROUT_PNT_LOC_DEF_CD		,
				OI.BSE_PORT_DEF_CD						OI_BSE_PORT_DEF_CD				,
				OI.VIA_PORT_DEF_CD						OI_VIA_PORT_DEF_CD				,
				OI.DIR_CALL_FLG								OI_DIR_CALL_FLG						,
				OI.RAT_UT_CD									OI_RAT_UT_CD							,
				OI.PRC_CGO_TP_CD							OI_PRC_CGO_TP_CD					,
				OI.PRC_TRSP_MOD_CD						OI_PRC_TRSP_MOD_CD				,
				OI.RCV_DE_TERM_CD							OI_RCV_DE_TERM_CD					,
				OI.PRC_CMDT_DEF_CD						OI_PRC_CMDT_DEF_CD				,
				OI.CURR_CD										OI_CURR_CD								,
				OI.FNL_FRT_RT_AMT							OI_FNL_FRT_RT_AMT					,
				OI.RAT_UT_MTCH_PRIO						OI_RAT_UT_MTCH_PRIO				,

				NULL													OA_ROUT_PNT_LOC_DEF_CD		,
				NULL													OA_BSE_PORT_DEF_CD				,
				NULL													OA_VIA_PORT_DEF_CD				,
				NULL													OA_DIR_CALL_FLG						,
				NULL													OA_RAT_UT_CD							,
				NULL													OA_PRC_CGO_TP_CD					,
				NULL													OA_PRC_TRSP_MOD_CD				,
				NULL													OA_RCV_DE_TERM_CD					,
				NULL													OA_PRC_CMDT_DEF_CD				,
				NULL													OA_CURR_CD								,
				NULL													OA_FNL_FRT_RT_AMT					,
				NULL													OA_RAT_UT_MTCH_PRIO				,

				NULL													DA_ROUT_PNT_LOC_DEF_CD		,
				NULL													DA_BSE_PORT_DEF_CD				,
				NULL													DA_VIA_PORT_DEF_CD				,
				NULL													DA_DIR_CALL_FLG						,
				NULL													DA_RAT_UT_CD							,
				NULL													DA_PRC_CGO_TP_CD					,
				NULL													DA_PRC_TRSP_MOD_CD				,
				NULL													DA_RCV_DE_TERM_CD					,
				NULL													DA_PRC_CMDT_DEF_CD				,
				NULL													DA_CURR_CD								,
				NULL													DA_FNL_FRT_RT_AMT					,
				NULL													DA_RAT_UT_MTCH_PRIO				,

				NULL													DI_ROUT_PNT_LOC_DEF_CD		,
				NULL													DI_BSE_PORT_DEF_CD				,
				NULL													DI_VIA_PORT_DEF_CD				,
				NULL													DI_DIR_CALL_FLG						,
				NULL													DI_RAT_UT_CD							,
				NULL													DI_PRC_CGO_TP_CD					,
				NULL													DI_PRC_TRSP_MOD_CD				,
				NULL													DI_RCV_DE_TERM_CD					,
				NULL													DI_PRC_CMDT_DEF_CD				,
				NULL													DI_CURR_CD								,
				NULL													DI_FNL_FRT_RT_AMT					,
				NULL													DI_RAT_UT_MTCH_PRIO				,

				RT_RAP.BKG_CONV_TP_CD      		RT_RAP_BKG_CONV_TP_CD			,
				RT_RAP.NOTE_CONV_MAPG_ID   		RT_RAP_NOTE_CONV_MAPG_ID  ,
				RT_RAP.NOTE_CONV_SEQ       		RT_RAP_NOTE_CONV_SEQ      ,
				RT_RAP.NOTE_CONV_RULE_CD   		RT_RAP_NOTE_CONV_RULE_CD  ,
				RT_RAP.NOTE_CONV_TP_CD     		RT_RAP_NOTE_CONV_TP_CD    ,
				RT_RAP.RT_OP_CD            		RT_RAP_RT_OP_CD           ,
				RT_RAP.CURR_CD             		RT_RAP_CURR_CD            ,
				RT_RAP.FRT_RT_AMT          		RT_RAP_FRT_RT_AMT         ,
				RT_RAP.RAP_CONV_CTNT					RT_RAP_CONV_CTNT					,

				RT_RAR.BKG_CONV_TP_CD      		RT_RAR_BKG_CONV_TP_CD     ,
				RT_RAR.NOTE_CONV_MAPG_ID   		RT_RAR_NOTE_CONV_MAPG_ID  ,
				RT_RAR.NOTE_CONV_SEQ       		RT_RAR_NOTE_CONV_SEQ      ,
				RT_RAR.NOTE_CONV_RULE_CD   		RT_RAR_NOTE_CONV_RULE_CD  ,
				RT_RAR.NOTE_CONV_TP_CD     		RT_RAR_NOTE_CONV_TP_CD    ,
				RT_RAR.RT_OP_CD            		RT_RAR_RT_OP_CD           ,
				RT_RAR.CURR_CD             		RT_RAR_CURR_CD            ,
				RT_RAR.FRT_RT_AMT          		RT_RAR_FRT_RT_AMT         ,
				RT_RAR.RAR_CONV_CTNT					RT_RAR_CONV_CTNT					,

				RT_DOR.BKG_CONV_TP_CD      		RT_DOR_BKG_CONV_TP_CD     ,
				RT_DOR.NOTE_CONV_MAPG_ID   		RT_DOR_NOTE_CONV_MAPG_ID  ,
				RT_DOR.NOTE_CONV_SEQ       		RT_DOR_NOTE_CONV_SEQ      ,
				RT_DOR.NOTE_CONV_RULE_CD   		RT_DOR_NOTE_CONV_RULE_CD  ,
				RT_DOR.NOTE_CONV_TP_CD     		RT_DOR_NOTE_CONV_TP_CD    ,
				RT_DOR.RT_OP_CD            		RT_DOR_RT_OP_CD           ,
				RT_DOR.CURR_CD             		RT_DOR_CURR_CD            ,
				RT_DOR.FRT_RT_AMT          		RT_DOR_FRT_RT_AMT         ,
				RT_DOR.DOR_CONV_CTNT					RT_DOR_CONV_CTNT					,

				RT_TYP.BKG_CONV_TP_CD      		RT_TYP_BKG_CONV_TP_CD     ,
				RT_TYP.NOTE_CONV_MAPG_ID   		RT_TYP_NOTE_CONV_MAPG_ID  ,
				RT_TYP.NOTE_CONV_SEQ       		RT_TYP_NOTE_CONV_SEQ      ,
				RT_TYP.NOTE_CONV_RULE_CD   		RT_TYP_NOTE_CONV_RULE_CD  ,
				RT_TYP.NOTE_CONV_TP_CD     		RT_TYP_NOTE_CONV_TP_CD    ,
				RT_TYP.RT_OP_CD            		RT_TYP_RT_OP_CD           ,
				RT_TYP.CURR_CD             		RT_TYP_CURR_CD            ,
				RT_TYP.FRT_RT_AMT          		RT_TYP_FRT_RT_AMT         ,
				RT_TYP.TYP_CONV_CTNT					RT_TYP_CONV_CTNT					,

				RT_RAC.BKG_CONV_TP_CD      		RT_RAC_BKG_CONV_TP_CD     ,
				RT_RAC.NOTE_CONV_MAPG_ID   		RT_RAC_NOTE_CONV_MAPG_ID  ,
				RT_RAC.NOTE_CONV_SEQ       		RT_RAC_NOTE_CONV_SEQ      ,
				RT_RAC.NOTE_CONV_RULE_CD   		RT_RAC_NOTE_CONV_RULE_CD  ,
				RT_RAC.NOTE_CONV_TP_CD     		RT_RAC_NOTE_CONV_TP_CD    ,
				RT_RAC.RT_OP_CD            		RT_RAC_RT_OP_CD           ,
				RT_RAC.CURR_CD             		RT_RAC_CURR_CD            ,
				RT_RAC.FRT_RT_AMT          		RT_RAC_FRT_RT_AMT         ,
				RT_RAC.RAC_CONV_CTNT					RT_RAC_CONV_CTNT					,

				RT.APP_BKG_CONV_TP_CD      		RT_APP_BKG_CONV_TP_CD     ,
				RT.APP_NOTE_CONV_MAPG_ID   		RT_APP_NOTE_CONV_MAPG_ID  ,
				RT.APP_NOTE_CONV_SEQ       		RT_APP_NOTE_CONV_SEQ      ,
				RT.APP_NOTE_CONV_RULE_CD   		RT_APP_NOTE_CONV_RULE_CD  ,
				RT.APP_NOTE_CONV_TP_CD     		RT_APP_NOTE_CONV_TP_CD    ,
				RT.APP_RT_OP_CD            		RT_APP_RT_OP_CD           ,
				RT.APP_CURR_CD             		RT_APP_CURR_CD            ,
				RT.APP_FRT_RT_AMT          		RT_APP_FRT_RT_AMT         ,

				RT.RAS_BKG_CONV_TP_CD      		RT_RAS_BKG_CONV_TP_CD     ,
				RT.RAS_NOTE_CONV_MAPG_ID   		RT_RAS_NOTE_CONV_MAPG_ID  ,
				RT.RAS_NOTE_CONV_SEQ       		RT_RAS_NOTE_CONV_SEQ      ,
				RT.RAS_NOTE_CONV_RULE_CD   		RT_RAS_NOTE_CONV_RULE_CD  ,
				RT.RAS_NOTE_CONV_TP_CD     		RT_RAS_NOTE_CONV_TP_CD    ,
				RT.RAS_RT_OP_CD            		RT_RAS_RT_OP_CD           ,
				RT.RAS_CURR_CD             		RT_RAS_CURR_CD            ,
				RT.RAS_FRT_RT_AMT          		RT_RAS_FRT_RT_AMT         ,
				RT.RAS_RAS_CONV_CTNT					RT_RAS_CONV_CTNT					,

				RT.ARB_BKG_CONV_TP_CD      		RT_ARB_BKG_CONV_TP_CD     ,
				RT.ARB_NOTE_CONV_MAPG_ID   		RT_ARB_NOTE_CONV_MAPG_ID  ,
				RT.ARB_NOTE_CONV_SEQ       		RT_ARB_NOTE_CONV_SEQ      ,
				RT.ARB_NOTE_CONV_RULE_CD   		RT_ARB_NOTE_CONV_RULE_CD  ,
				RT.ARB_NOTE_CONV_TP_CD     		RT_ARB_NOTE_CONV_TP_CD    ,
				RT.ARB_RT_OP_CD            		RT_ARB_RT_OP_CD           ,
				RT.ARB_CURR_CD             		RT_ARB_CURR_CD            ,
				RT.ARB_FRT_RT_AMT          		RT_ARB_FRT_RT_AMT         ,

				NULL										  		RT_ADD_BKG_CONV_TP_CD     ,
				NULL										  		RT_ADD_NOTE_CONV_MAPG_ID  ,
				NULL										  		RT_ADD_NOTE_CONV_SEQ      ,
				NULL										  		RT_ADD_NOTE_CONV_RULE_CD  ,
				NULL										  		RT_ADD_NOTE_CONV_TP_CD    ,
				NULL										  		RT_ADD_RT_OP_CD           ,
				NULL										  		RT_ADD_CURR_CD            ,
				NULL										  		RT_ADD_FRT_RT_AMT         ,

				OA_TYP.BKG_CONV_TP_CD      		OA_TYP_BKG_CONV_TP_CD     ,
				OA_TYP.NOTE_CONV_MAPG_ID   		OA_TYP_NOTE_CONV_MAPG_ID  ,
				OA_TYP.NOTE_CONV_SEQ       		OA_TYP_NOTE_CONV_SEQ      ,
				OA_TYP.NOTE_CONV_RULE_CD   		OA_TYP_NOTE_CONV_RULE_CD  ,
				OA_TYP.NOTE_CONV_TP_CD     		OA_TYP_NOTE_CONV_TP_CD    ,
				OA_TYP.RT_OP_CD            		OA_TYP_RT_OP_CD           ,
				OA_TYP.CURR_CD             		OA_TYP_CURR_CD            ,
				OA_TYP.FRT_RT_AMT          		OA_TYP_FRT_RT_AMT         ,
				OA_TYP.TYP_CONV_CTNT       		OA_TYP_CONV_CTNT         	,

				OA_RAC.BKG_CONV_TP_CD      		OA_RAC_BKG_CONV_TP_CD     ,
				OA_RAC.NOTE_CONV_MAPG_ID   		OA_RAC_NOTE_CONV_MAPG_ID  ,
				OA_RAC.NOTE_CONV_SEQ       		OA_RAC_NOTE_CONV_SEQ      ,
				OA_RAC.NOTE_CONV_RULE_CD   		OA_RAC_NOTE_CONV_RULE_CD  ,
				OA_RAC.NOTE_CONV_TP_CD     		OA_RAC_NOTE_CONV_TP_CD    ,
				OA_RAC.RT_OP_CD            		OA_RAC_RT_OP_CD           ,
				OA_RAC.CURR_CD             		OA_RAC_CURR_CD            ,
				OA_RAC.FRT_RT_AMT          		OA_RAC_FRT_RT_AMT         ,
				OA_RAC.RAC_CONV_CTNT       		OA_RAC_CONV_CTNT         	,

				NULL													DA_TYP_BKG_CONV_TP_CD     ,
				NULL													DA_TYP_NOTE_CONV_MAPG_ID  ,
				NULL													DA_TYP_NOTE_CONV_SEQ      ,
				NULL													DA_TYP_NOTE_CONV_RULE_CD  ,
				NULL													DA_TYP_NOTE_CONV_TP_CD    ,
				NULL													DA_TYP_DA_OP_CD           ,
				NULL													DA_TYP_CURR_CD            ,
				NULL													DA_TYP_FRT_RT_AMT					,
				NULL													DA_TYP_CONV_CTNT					,

				NULL													DA_RAC_BKG_CONV_TP_CD     ,
				NULL													DA_RAC_NOTE_CONV_MAPG_ID  ,
				NULL													DA_RAC_NOTE_CONV_SEQ      ,
				NULL													DA_RAC_NOTE_CONV_RULE_CD  ,
				NULL													DA_RAC_NOTE_CONV_TP_CD    ,
				NULL													DA_RAC_DA_OP_CD           ,
				NULL													DA_RAC_CURR_CD            ,
				NULL													DA_RAC_FRT_RT_AMT					,
				NULL													DA_RAC_CONV_CTNT					,

				'Y'														POR_MTCH_FLG							,
				RT.DEL_MTCH_FLG								DEL_MTCH_FLG

FROM
/*******************************************************************************************
JOIN TABLE
1.1 BQ, CH, CM, CR, RD, OP, DV, DP, RT
1.2 RT RULE					: RAP, RAR, DOR, TYP, RAC, APP, RAS, ADD
2.1 OA							: O
2.2 OA RULE					: TYP, RAC ( RAP, RAR, DOR 는 RT 와 동일하게 적용 )
3.1 DA							: X
3.2 DA RULE					: X
*******************************************************************************************/
				BQ	,
				OI	,
				RT	,
				NC_P											RT_RAP	,			/* COMMODITY CONVERSION */
				NC_P											RT_RAR	,			/* ROUTE CONVERSION */
				NC_P											RT_DOR	,			/* R/D TERM CONVERSION */
				NC_P											RT_TYP	,			/* RATING UNIT CONVERSION */
				NC_P											RT_RAC	,			/* CARGO TYPE CONVERSION */
				NC_P											OA_TYP	,			/* RATING UNIT CONVERSION */
				NC_P											OA_RAC				/* CARGO TYPE CONVERSION */

WHERE		RT.BQ_SEQ		=	BQ.BQ_SEQ
AND			OI.BQ_SEQ		= BQ.BQ_SEQ
AND			RT_RAP.BQ_SEQ	= RT.BQ_SEQ AND RT_RAP.NOTE_CONV_RULE_CD = 'RAP' AND ( RT_RAP.BKG_CONV_TP_CD = 'B' OR RT_RAP.NC_SEQ = RT.RAP_NC_SEQ )
AND			RT_RAR.BQ_SEQ	= RT.BQ_SEQ AND RT_RAR.NOTE_CONV_RULE_CD = 'RAR' AND ( RT_RAR.BKG_CONV_TP_CD = 'B' OR RT_RAR.NC_SEQ = RT.RAR_NC_SEQ )
AND			RT_DOR.BQ_SEQ	= RT.BQ_SEQ AND RT_DOR.NOTE_CONV_RULE_CD = 'DOR' AND ( RT_DOR.BKG_CONV_TP_CD = 'B' OR RT_DOR.NC_SEQ = RT.DOR_NC_SEQ )
AND			RT_TYP.BQ_SEQ	= RT.BQ_SEQ AND RT_TYP.NOTE_CONV_RULE_CD = 'TYP' AND ( RT_TYP.BKG_CONV_TP_CD = 'B' OR RT_TYP.NC_SEQ = RT.TYP_NC_SEQ )
AND			RT_RAC.BQ_SEQ	= RT.BQ_SEQ AND RT_RAC.NOTE_CONV_RULE_CD = 'RAC' AND ( RT_RAC.BKG_CONV_TP_CD = 'B' OR RT_RAC.NC_SEQ = RT.RAC_NC_SEQ )
AND			OA_TYP.BQ_SEQ	= RT.BQ_SEQ AND OA_TYP.NOTE_CONV_RULE_CD = 'TYP' AND ( OA_TYP.BKG_CONV_TP_CD = 'B' OR OA_TYP.NC_SEQ = RT.TYP_NC_SEQ )
AND			OA_RAC.BQ_SEQ	= RT.BQ_SEQ AND OA_RAC.NOTE_CONV_RULE_CD = 'RAC' AND ( OA_RAC.BKG_CONV_TP_CD = 'B' OR OA_RAC.NC_SEQ = RT.RAC_NC_SEQ )


/*******************************************************************************************
	5.1 RATE
*******************************************************************************************/

/*******************************************************************************************
	5.1.1 RATE - COMMODITY
	(주의)
	COMMODITY 나 RATING UNIT 등의 조건이 위의 OA, DA, RT 와 중복조건으로 보일 수 있으나,
	OA, DA, RT 는 CONVERSION 이 정확하게 적용한 것이 아니므로, 다시한번 정확하게 조건을 연결해야 한다.
*******************************************************************************************/

/*******************************************************************************************
< COMMODITY >
그룹, 개별간으로 일치하는 경우
*******************************************************************************************/
AND			( RT.CM_PRC_CMDT_TP_CD, RT.CM_PRC_CMDT_DEF_CD ) IN
				(
				SELECT	RT_RAP.CONV_CMDT_TP_CD, RT_RAP.CONV_CMDT_DEF_CD
				FROM		DUAL
				UNION ALL
				SELECT  'C', GC.PRC_CMDT_DEF_CD
				FROM		GC
				WHERE		RT_RAP.CONV_CMDT_TP_CD	= 'G'
				AND     GC.PRC_CMDT_TP_CD   		= 'C'
				AND			GC.PRC_GRP_CMDT_CD  		= RT_RAP.CONV_CMDT_DEF_CD
				UNION ALL
				SELECT  'G', GC.PRC_GRP_CMDT_CD
				FROM		GC
				WHERE		RT_RAP.CONV_CMDT_TP_CD	= 'C'
				AND     GC.PRC_CMDT_TP_CD   		= 'C'
				AND     GC.PRC_CMDT_DEF_CD  		= RT_RAP.CONV_CMDT_DEF_CD
				UNION ALL
				/* TAW 일 경우 FAK 고려함 */
				SELECT	'C', CMDT_CD
				FROM		MDM_COMMODITY
				WHERE		REP_CMDT_CD		= '0000'
				UNION ALL
				SELECT	'G', GC.PRC_GRP_CMDT_CD
				FROM		GC
				WHERE		GC.PRC_CMDT_TP_CD		= 'C'
				AND			GC.PRC_CMDT_DEF_CD  IN ( SELECT CMDT_CD FROM MDM_COMMODITY WHERE REP_CMDT_CD = '0000' )
				)


/*******************************************************************************************
	5.1.2 RATE - ROUTE
*******************************************************************************************/

/*******************************************************************************************
< ORIGIN ( POL ) >
*******************************************************************************************/

AND     ( RT.OP_ROUT_PNT_LOC_TP_CD, RT.OP_ROUT_PNT_LOC_DEF_CD ) IN
				(
				SELECT	RT_RAR.CONV_ORG_VIA_LOC_TP_CD,	RT_RAR.CONV_ORG_VIA_LOC_DEF_CD
				FROM		DUAL
				UNION ALL
				SELECT  'L', GL.LOC_CD
				FROM		GL
				WHERE		RT_RAR.CONV_ORG_VIA_LOC_TP_CD	= 'G'
				AND		  GL.PRC_GRP_LOC_CD 				= RT_RAR.CONV_ORG_VIA_LOC_DEF_CD
				UNION ALL
				SELECT  'G', GL.PRC_GRP_LOC_CD
				FROM		GL
				WHERE		RT_RAR.CONV_ORG_VIA_LOC_TP_CD	= 'L'
				AND     GL.LOC_CD									= RT_RAR.CONV_ORG_VIA_LOC_DEF_CD
				)


/*******************************************************************************************
< ORIGIN VIA ( POL ) >
*******************************************************************************************/

AND     (
						RT.OV_ROUT_VIA_PORT_DEF_CD IS NULL
				OR	( RT.OV_ROUT_VIA_PORT_TP_CD, RT.OV_ROUT_VIA_PORT_DEF_CD ) IN
						(
						SELECT	RT_RAR.CONV_ORG_VIA_LOC_TP_CD,	RT_RAR.CONV_ORG_VIA_LOC_DEF_CD
						FROM		DUAL
						UNION ALL
						SELECT  'L', GL.LOC_CD
						FROM		GL
						WHERE		RT_RAR.CONV_ORG_VIA_LOC_TP_CD	= 'G'
						AND		  GL.PRC_GRP_LOC_CD 						= RT_RAR.CONV_ORG_VIA_LOC_DEF_CD
						UNION ALL
						SELECT  'G', GL.PRC_GRP_LOC_CD
						FROM		GL
						WHERE		RT_RAR.CONV_ORG_VIA_LOC_TP_CD	= 'L'
						AND     GL.LOC_CD											= RT_RAR.CONV_ORG_VIA_LOC_DEF_CD
						)
				)


/*******************************************************************************************
< DESTINATION VIA ( POD ) >
*******************************************************************************************/

AND     (
						RT.DV_ROUT_VIA_PORT_DEF_CD IS NULL
				OR	( RT.DV_ROUT_VIA_PORT_TP_CD, RT.DV_ROUT_VIA_PORT_DEF_CD ) IN
						(
						SELECT	RT_RAR.CONV_DEST_VIA_LOC_TP_CD,	RT_RAR.CONV_DEST_VIA_LOC_DEF_CD
						FROM		DUAL
						UNION ALL
						SELECT  'L', GL.LOC_CD
						FROM		GL
						WHERE		RT_RAR.CONV_DEST_VIA_LOC_TP_CD	= 'G'
						AND		  GL.PRC_GRP_LOC_CD 						= RT_RAR.CONV_DEST_VIA_LOC_DEF_CD
						UNION ALL
						SELECT  'G', GL.PRC_GRP_LOC_CD
						FROM		GL
						WHERE		RT_RAR.CONV_DEST_VIA_LOC_TP_CD	= 'L'
						AND     GL.LOC_CD											= RT_RAR.CONV_DEST_VIA_LOC_DEF_CD
						)
				)


/*******************************************************************************************
< DESTINATION (DEL OR POD ) >
*******************************************************************************************/

AND     ( RT.DP_ROUT_PNT_LOC_TP_CD, RT.DP_ROUT_PNT_LOC_DEF_CD ) IN
				(
				SELECT	RT_RAR.CONV_DEST_LOC_TP_CD,	RT_RAR.CONV_DEST_LOC_DEF_CD
				FROM		DUAL
				UNION ALL
				SELECT  'L', GL.LOC_CD
				FROM		GL
				WHERE		RT_RAR.CONV_DEST_LOC_TP_CD	= 'G'
				AND		  GL.PRC_GRP_LOC_CD 				= RT_RAR.CONV_DEST_LOC_DEF_CD
				UNION ALL
				SELECT  'G', GL.PRC_GRP_LOC_CD
				FROM		GL
				WHERE		RT_RAR.CONV_DEST_LOC_TP_CD	= 'L'
				AND     GL.LOC_CD									= RT_RAR.CONV_DEST_LOC_DEF_CD
				UNION ALL
				SELECT	RT_RAR.CONV_DEST_VIA_LOC_TP_CD,	RT_RAR.CONV_DEST_VIA_LOC_DEF_CD
				FROM		DUAL
				UNION ALL
				SELECT  'L', GL.LOC_CD
				FROM		GL
				WHERE		RT_RAR.CONV_DEST_VIA_LOC_TP_CD	= 'G'
				AND		  GL.PRC_GRP_LOC_CD 				= RT_RAR.CONV_DEST_VIA_LOC_DEF_CD
				UNION ALL
				SELECT  'G', GL.PRC_GRP_LOC_CD
				FROM		GL
				WHERE		RT_RAR.CONV_DEST_VIA_LOC_TP_CD	= 'L'
				AND     GL.LOC_CD									= RT_RAR.CONV_DEST_VIA_LOC_DEF_CD
				)


/*******************************************************************************************
< DE TERM >
*******************************************************************************************/

AND     (
						(
								RT.DEL_MTCH_FLG			= 'Y'
						AND	NVL(RT.DP_RCV_DE_TERM_CD, '*') IN
								(
								SELECT  B.RCV_DE_TERM_CD
								FROM		(
												SELECT 'Y' CONV_PRC_TERM_CD, 'Y' RCV_DE_TERM_CD FROM DUAL UNION ALL
												SELECT 'Y' CONV_PRC_TERM_CD, 'L' RCV_DE_TERM_CD FROM DUAL UNION ALL
												SELECT 'Y' CONV_PRC_TERM_CD, '*' RCV_DE_TERM_CD FROM DUAL UNION ALL
												SELECT 'S' CONV_PRC_TERM_CD, 'S' RCV_DE_TERM_CD FROM DUAL UNION ALL
												SELECT 'S' CONV_PRC_TERM_CD, 'Y' RCV_DE_TERM_CD FROM DUAL UNION ALL
												SELECT 'S' CONV_PRC_TERM_CD, 'T' RCV_DE_TERM_CD FROM DUAL UNION ALL
												SELECT 'S' CONV_PRC_TERM_CD, 'I' RCV_DE_TERM_CD FROM DUAL UNION ALL
												SELECT 'S' CONV_PRC_TERM_CD, 'L' RCV_DE_TERM_CD FROM DUAL UNION ALL
												SELECT 'S' CONV_PRC_TERM_CD, '*' RCV_DE_TERM_CD FROM DUAL UNION ALL
												SELECT 'D' CONV_PRC_TERM_CD, 'D' RCV_DE_TERM_CD FROM DUAL UNION ALL
												SELECT 'T' CONV_PRC_TERM_CD, 'T' RCV_DE_TERM_CD FROM DUAL UNION ALL
												SELECT 'I' CONV_PRC_TERM_CD, 'I' RCV_DE_TERM_CD FROM DUAL
												)	B
								WHERE		B.CONV_PRC_TERM_CD	= RT_DOR.CONV_PRC_DE_TERM_CD
								)
						)
				OR	(
								BQ.DEL_CD										= BQ.POD_CD
						AND	NVL(RT.DP_RCV_DE_TERM_CD, '*') IN
								(
								SELECT  B.RCV_DE_TERM_CD
								FROM		(
												SELECT 'Y' CONV_PRC_TERM_CD, 'Y' RCV_DE_TERM_CD FROM DUAL UNION ALL
												SELECT 'Y' CONV_PRC_TERM_CD, 'L' RCV_DE_TERM_CD FROM DUAL UNION ALL
												SELECT 'Y' CONV_PRC_TERM_CD, '*' RCV_DE_TERM_CD FROM DUAL UNION ALL
												SELECT 'S' CONV_PRC_TERM_CD, 'S' RCV_DE_TERM_CD FROM DUAL UNION ALL
												SELECT 'S' CONV_PRC_TERM_CD, 'Y' RCV_DE_TERM_CD FROM DUAL UNION ALL
												SELECT 'S' CONV_PRC_TERM_CD, 'T' RCV_DE_TERM_CD FROM DUAL UNION ALL
												SELECT 'S' CONV_PRC_TERM_CD, 'I' RCV_DE_TERM_CD FROM DUAL UNION ALL
												SELECT 'S' CONV_PRC_TERM_CD, 'L' RCV_DE_TERM_CD FROM DUAL UNION ALL
												SELECT 'S' CONV_PRC_TERM_CD, '*' RCV_DE_TERM_CD FROM DUAL UNION ALL
												SELECT 'D' CONV_PRC_TERM_CD, 'D' RCV_DE_TERM_CD FROM DUAL UNION ALL
												SELECT 'D' CONV_PRC_TERM_CD, 'Y' RCV_DE_TERM_CD FROM DUAL UNION ALL	-- 예외 적용
												SELECT 'T' CONV_PRC_TERM_CD, 'T' RCV_DE_TERM_CD FROM DUAL UNION ALL
												SELECT 'I' CONV_PRC_TERM_CD, 'I' RCV_DE_TERM_CD FROM DUAL
												)	B
								WHERE		B.CONV_PRC_TERM_CD	= RT_DOR.CONV_PRC_DE_TERM_CD
								)
						)
				OR	(
								RT.DEL_MTCH_FLG 								= 'N'
						AND	NVL(RT.DP_RCV_DE_TERM_CD, '*')	IN ( 'Y', '*' )
						)
				)


/*******************************************************************************************
< DEST TRANS MODE >
*******************************************************************************************/

AND			(
					  RT.DEL_MTCH_FLG = 'N'
				OR	(
								RT.DP_PRC_TRSP_MOD_CD	IS NULL
						OR	BQ.DEST_TRNS_MOD_CD		IS NULL
						OR	RT.DP_PRC_TRSP_MOD_CD	= BQ.DEST_TRNS_MOD_CD
						OR  (
										RT.DP_PRC_TRSP_MOD_CD	IN ( 'R', 'A' )
								AND	BQ.DEST_TRNS_MOD_CD		= 'R'
								)
						)
				)


/*******************************************************************************************
	5.1.3 RATE - RATING UNIT
*******************************************************************************************/

AND     (
								RT.RAT_UT_CD	= RT_TYP.CONV_RAT_UT_CD
		        OR
    		    (
        				RT.RAT_UT_CD	IN ( '20', '40', 'HC', '45', '53' )
       			AND ( SELECT A.CNTR_SZ_CD FROM PRI_RAT_UT A WHERE A.RAT_UT_CD = RT.RAT_UT_CD )	= RT_TYP.CONV_RAT_UT_SZ_CD
        		)
				)

AND			RT.PRC_CGO_TP_CD	IN ( RT_RAC.CONV_DR_TP, RT_RAC.CONV_DG_TP, RT_RAC.CONV_RF_TP, RT_RAC.CONV_AK_TP, RT_RAC.CONV_BB_TP )


/*******************************************************************************************
	5.2 ORIGIN IHC
*******************************************************************************************/

/*******************************************************************************************
	5.2.2 ORIGIN IHC - ROUTE
*******************************************************************************************/

/*******************************************************************************************
< POINT ( POR ) >
*******************************************************************************************/

AND     ( OI.ROUT_PNT_LOC_TP_CD, OI.ROUT_PNT_LOC_DEF_CD ) IN
				(
				SELECT  RT_RAR.CONV_ORG_LOC_TP_CD, RT_RAR.CONV_ORG_LOC_DEF_CD
				FROM		DUAL
				UNION ALL
				SELECT  'L', GL.LOC_CD
				FROM		GL
				WHERE		RT_RAR.CONV_ORG_LOC_TP_CD	= 'G'
				AND		  GL.PRC_GRP_LOC_CD 				= RT_RAR.CONV_ORG_LOC_DEF_CD
				UNION ALL
				SELECT  'G', GL.PRC_GRP_LOC_CD
				FROM		GL
				WHERE		RT_RAR.CONV_ORG_LOC_TP_CD	= 'L'
				AND     GL.LOC_CD									= RT_RAR.CONV_ORG_LOC_DEF_CD
				)


/*******************************************************************************************
< RCV TERM >
*******************************************************************************************/

AND     NVL(OI.RCV_DE_TERM_CD, '*') IN
				(
				SELECT  B.RCV_DE_TERM_CD
				FROM		(
								SELECT 'Y' CONV_PRC_TERM_CD, 'Y' RCV_DE_TERM_CD FROM DUAL UNION ALL
								SELECT 'Y' CONV_PRC_TERM_CD, 'L' RCV_DE_TERM_CD FROM DUAL UNION ALL
								SELECT 'Y' CONV_PRC_TERM_CD, '*' RCV_DE_TERM_CD FROM DUAL UNION ALL
								SELECT 'S' CONV_PRC_TERM_CD, 'S' RCV_DE_TERM_CD FROM DUAL UNION ALL
								SELECT 'D' CONV_PRC_TERM_CD, 'D' RCV_DE_TERM_CD FROM DUAL UNION ALL
								SELECT 'T' CONV_PRC_TERM_CD, 'T' RCV_DE_TERM_CD FROM DUAL UNION ALL
								SELECT 'I' CONV_PRC_TERM_CD, 'I' RCV_DE_TERM_CD FROM DUAL
								)	B
				WHERE		B.CONV_PRC_TERM_CD	= RT_DOR.CONV_PRC_RCV_TERM_CD
				)


/*******************************************************************************************
< BASE PORT ( POL ) >
*******************************************************************************************/

AND     ( OI.BSE_PORT_TP_CD, OI.BSE_PORT_DEF_CD ) IN
				(
				SELECT  RT_RAR.CONV_ORG_VIA_LOC_TP_CD, RT_RAR.CONV_ORG_VIA_LOC_DEF_CD
				FROM		DUAL
				UNION ALL
				SELECT  'L', GL.LOC_CD
				FROM		GL
				WHERE		RT_RAR.CONV_ORG_VIA_LOC_TP_CD	= 'G'
				AND		  GL.PRC_GRP_LOC_CD 				= RT_RAR.CONV_ORG_VIA_LOC_DEF_CD
				UNION ALL
				SELECT  'G', GL.PRC_GRP_LOC_CD
				FROM		GL
				WHERE		RT_RAR.CONV_ORG_VIA_LOC_TP_CD	= 'L'
				AND     GL.LOC_CD									= RT_RAR.CONV_ORG_VIA_LOC_DEF_CD
				)


/*******************************************************************************************
	5.2.3 ORIGIN IHC - RATING UNIT
*******************************************************************************************/

/* ORIGIN ARB RATING UNIT */
AND     (
								OI.RAT_UT_CD	= OA_TYP.CONV_RAT_UT_CD
		        OR	OI.RAT_UT_CD	= 'BX'
		        OR
    		    (
        				OI.RAT_UT_CD	IN ( '20', '40', 'HC', '45', '53' )
       			AND ( SELECT A.CNTR_SZ_CD FROM PRI_RAT_UT A WHERE A.RAT_UT_CD = OI.RAT_UT_CD )	= OA_TYP.CONV_RAT_UT_SZ_CD
        		)
				)


/* ORIGIN ARB CARGO TYPE */
AND			NVL(OI.PRC_CGO_TP_CD, '*')	IN ( '*', OA_RAC.CONV_DR_TP, OA_RAC.CONV_DG_TP, OA_RAC.CONV_RF_TP, OA_RAC.CONV_AK_TP, OA_RAC.CONV_BB_TP )


/*******************************************************************************************
	5.2.4 ORIGIN IHC - JOIN
*******************************************************************************************/

/* ORIGIN ARB JOIN ( ARB CONV RULE ) */
AND			DECODE(RT.ARB_RT_APPL_TP_CD, NULL, DECODE(RT.GEN_SPCL_RT_TP_CD, 'S', 'N', 'Y'), 'N', 'N', 'Y') = 'Y'

/* ORIGIN ARB JOIN ( OIHC.BPORT = RATE.DEST ) */
AND			NVL(RT.OP_RCV_DE_TERM_CD, '*' )	NOT IN ( 'D', 'S' )

AND			( RT.OP_ROUT_PNT_LOC_TP_CD, RT.OP_ROUT_PNT_LOC_DEF_CD ) IN
				(
				SELECT	OI.BSE_PORT_TP_CD, OI.BSE_PORT_DEF_CD
				FROM		DUAL
				UNION ALL
				SELECT	'L', GL.LOC_CD
				FROM		GL
				WHERE		OI.BSE_PORT_TP_CD	= 'G'
				AND		  GL.PRC_GRP_LOC_CD	= OI.BSE_PORT_DEF_CD
				UNION ALL
				SELECT	'G', GL.PRC_GRP_LOC_CD
				FROM		GL
				WHERE		OI.BSE_PORT_TP_CD	= 'L'
				AND			GL.LOC_CD					= OI.BSE_PORT_DEF_CD
				)


UNION ALL


/*******************************************************************************************
	6. PATTERN #6 ( 1100 )
*******************************************************************************************/

SELECT	'1100'												PRC_RT_MTCH_PATT_CD				,
				BQ.SC_NO											CTRT_NO										,
				BQ.PROP_NO										PROP_NO										,
				BQ.AMDT_SEQ										AMDT_SEQ									,
				BQ.SVC_SCP_CD									SVC_SCP_CD								,
				BQ.BQ_SEQ											BQ_SEQ										,
				BQ.BKG_BQ_SEQ									BKG_BQ_SEQ								,
				BQ.CNTR_TPSZ_CD								BQ_CNTR_TPSZ_CD						,
				BQ.CTRT_CNTR_TPSZ_CD					BQ_CTRT_CNTR_TPSZ_CD			,
				BQ.RCV_TERM_CD								BQ_RCV_TERM_CD						,
				BQ.DE_TERM_CD									BQ_DE_TERM_CD							,
				BQ.DRY_CGO_FLG								BQ_DRY_CGO_FLG						,
				BQ.DCGO_FLG										BQ_DCGO_FLG								,
				BQ.RC_FLG											BQ_RC_FLG									,
				BQ.AWK_CGO_FLG								BQ_AWK_CGO_FLG						,
				BQ.BB_CGO_FLG									BQ_BB_CGO_FLG							,
				BQ.SOC_FLG										BQ_SOC_FLG								,
				BQ.PRC_CGO_TP_CD							BQ_PRC_CGO_TP_CD					,
				BQ.IMDG_CLSS_CD								BQ_IMDG_CLSS_CD						,
				BQ.CTRT_CNTR_QTY							BQ_CTRT_CNTR_QTY					,
				BQ.POR_APPL_FLG								BQ_POR_APPL_FLG						,
				BQ.POL_APPL_FLG								BQ_POL_APPL_FLG						,
				BQ.POD_APPL_FLG								BQ_POD_APPL_FLG						,
				BQ.DEL_APPL_FLG								BQ_DEL_APPL_FLG						,
				BQ.PRE_RLY_PORT_APPL_FLG			BQ_POR_RLY_PORT_APPL_FLG	,
				BQ.PST_RLY_PORT_APPL_FLG			BQ_PST_RLY_PORT_APPL_FLG	,

				RT.CMDT_HDR_SEQ								RT_CMDT_HDR_SEQ						,
				RT.ROUT_SEQ										RT_ROUT_SEQ								,
				RT.RT_SEQ											RT_RT_SEQ									,
				OI.ADD_CHG_SEQ								OI_ADD_CHG_SEQ						,
				OA.ADD_CHG_SEQ								OA_ADD_CHG_SEQ						,
				0															DA_ADD_CHG_SEQ						,
				0															DI_ADD_CHG_SEQ						,

				RT.GEN_SPCL_RT_TP_CD					RT_GEN_SPCL_RT_TP_CD			,
				RT.CM_PRC_CMDT_TP_CD					CM_PRC_CMDT_TP_CD					,
				RT.CM_PRC_CMDT_DEF_CD					CM_PRC_CMDT_DEF_CD				,
				OI.ROUT_PNT_LOC_DEF_CD				POR_CD										,
				OA.ROUT_PNT_LOC_DEF_CD				POL_CD										,
				RT.DV_ROUT_VIA_PORT_DEF_CD		POD_CD										,
				RT.DP_ROUT_PNT_LOC_DEF_CD			DEL_CD										,
				OA.DIR_CALL_FLG								DIR_CALL_FLG							,
				OI.RCV_DE_TERM_CD							RCV_TERM_CD								,
				RT.DP_RCV_DE_TERM_CD					DE_TERM_CD								,
				RT.RAT_UT_CD									RAT_UT_CD									,
				RT.PRC_CGO_TP_CD							PRC_CGO_TP_CD							,
				RT.CURR_CD										CURR_CD										,
				OI.PRC_TRSP_MOD_CD						ORG_TRSP_MOD_CD						,
				RT.DP_PRC_TRSP_MOD_CD					DEST_TRSP_MOD_CD					,

				RT.OP_ROUT_PNT_LOC_DEF_CD			OP_ROUT_PNT_LOC_DEF_CD		,
				RT.OV_ROUT_VIA_PORT_DEF_CD		OV_ROUT_VIA_PORT_DEF_CD		,
				RT.DV_ROUT_VIA_PORT_DEF_CD		DV_ROUT_VIA_PORT_DEF_CD		,
				RT.DP_ROUT_PNT_LOC_DEF_CD			DP_ROUT_PNT_LOC_DEF_CD		,
				RT.RD_DIR_CALL_FLG						RD_DIR_CALL_FLG						,
				RT.RAT_UT_CD									RT_RAT_UT_CD							,
				RT.PRC_CGO_TP_CD							RT_PRC_CGO_TP_CD					,
				RT.OP_PRC_TRSP_MOD_CD					OP_PRC_TRSP_MOD_CD				,
				RT.DP_PRC_TRSP_MOD_CD					DP_PRC_TRSP_MOD_CD				,
				RT.CURR_CD										RT_CURR_CD								,
				RT.FNL_FRT_RT_AMT							RT_FNL_FRT_RT_AMT					,

				OI.ROUT_PNT_LOC_DEF_CD				OI_ROUT_PNT_LOC_DEF_CD		,
				OI.BSE_PORT_DEF_CD						OI_BSE_PORT_DEF_CD				,
				OI.VIA_PORT_DEF_CD						OI_VIA_PORT_DEF_CD				,
				OI.DIR_CALL_FLG								OI_DIR_CALL_FLG						,
				OI.RAT_UT_CD									OI_RAT_UT_CD							,
				OI.PRC_CGO_TP_CD							OI_PRC_CGO_TP_CD					,
				OI.PRC_TRSP_MOD_CD						OI_PRC_TRSP_MOD_CD				,
				OI.RCV_DE_TERM_CD							OI_RCV_DE_TERM_CD					,
				OI.PRC_CMDT_DEF_CD						OI_PRC_CMDT_DEF_CD				,
				OI.CURR_CD										OI_CURR_CD								,
				OI.FNL_FRT_RT_AMT							OI_FNL_FRT_RT_AMT					,
				OI.RAT_UT_MTCH_PRIO						OI_RAT_UT_MTCH_PRIO				,

				OA.ROUT_PNT_LOC_DEF_CD				OA_ROUT_PNT_LOC_DEF_CD		,
				OA.BSE_PORT_DEF_CD						OA_BSE_PORT_DEF_CD				,
				OA.VIA_PORT_DEF_CD						OA_VIA_PORT_DEF_CD				,
				OA.DIR_CALL_FLG								OA_DIR_CALL_FLG						,
				OA.RAT_UT_CD									OA_RAT_UT_CD							,
				OA.PRC_CGO_TP_CD							OA_PRC_CGO_TP_CD					,
				OA.PRC_TRSP_MOD_CD						OA_PRC_TRSP_MOD_CD				,
				OA.RCV_DE_TERM_CD							OA_RCV_DE_TERM_CD					,
				OA.PRC_CMDT_DEF_CD						OA_PRC_CMDT_DEF_CD				,
				OA.CURR_CD										OA_CURR_CD								,
				OA.FNL_FRT_RT_AMT							OA_FNL_FRT_RT_AMT					,
				OA.RAT_UT_MTCH_PRIO						OA_RAT_UT_MTCH_PRIO				,

				NULL													DA_ROUT_PNT_LOC_DEF_CD		,
				NULL													DA_BSE_PORT_DEF_CD				,
				NULL													DA_VIA_PORT_DEF_CD				,
				NULL													DA_DIR_CALL_FLG						,
				NULL													DA_RAT_UT_CD							,
				NULL													DA_PRC_CGO_TP_CD					,
				NULL													DA_PRC_TRSP_MOD_CD				,
				NULL													DA_RCV_DE_TERM_CD					,
				NULL													DA_PRC_CMDT_DEF_CD				,
				NULL													DA_CURR_CD								,
				NULL													DA_FNL_FRT_RT_AMT					,
				NULL													DA_RAT_UT_MTCH_PRIO				,

				NULL													DI_ROUT_PNT_LOC_DEF_CD		,
				NULL													DI_BSE_PORT_DEF_CD				,
				NULL													DI_VIA_PORT_DEF_CD				,
				NULL													DI_DIR_CALL_FLG						,
				NULL													DI_RAT_UT_CD							,
				NULL													DI_PRC_CGO_TP_CD					,
				NULL													DI_PRC_TRSP_MOD_CD				,
				NULL													DI_RCV_DE_TERM_CD					,
				NULL													DI_PRC_CMDT_DEF_CD				,
				NULL													DI_CURR_CD								,
				NULL													DI_FNL_FRT_RT_AMT					,
				NULL													DI_RAT_UT_MTCH_PRIO				,

				RT_RAP.BKG_CONV_TP_CD      		RT_RAP_BKG_CONV_TP_CD			,
				RT_RAP.NOTE_CONV_MAPG_ID   		RT_RAP_NOTE_CONV_MAPG_ID  ,
				RT_RAP.NOTE_CONV_SEQ       		RT_RAP_NOTE_CONV_SEQ      ,
				RT_RAP.NOTE_CONV_RULE_CD   		RT_RAP_NOTE_CONV_RULE_CD  ,
				RT_RAP.NOTE_CONV_TP_CD     		RT_RAP_NOTE_CONV_TP_CD    ,
				RT_RAP.RT_OP_CD            		RT_RAP_RT_OP_CD           ,
				RT_RAP.CURR_CD             		RT_RAP_CURR_CD            ,
				RT_RAP.FRT_RT_AMT          		RT_RAP_FRT_RT_AMT         ,
				RT_RAP.RAP_CONV_CTNT					RT_RAP_CONV_CTNT					,

				RT_RAR.BKG_CONV_TP_CD      		RT_RAR_BKG_CONV_TP_CD     ,
				RT_RAR.NOTE_CONV_MAPG_ID   		RT_RAR_NOTE_CONV_MAPG_ID  ,
				RT_RAR.NOTE_CONV_SEQ       		RT_RAR_NOTE_CONV_SEQ      ,
				RT_RAR.NOTE_CONV_RULE_CD   		RT_RAR_NOTE_CONV_RULE_CD  ,
				RT_RAR.NOTE_CONV_TP_CD     		RT_RAR_NOTE_CONV_TP_CD    ,
				RT_RAR.RT_OP_CD            		RT_RAR_RT_OP_CD           ,
				RT_RAR.CURR_CD             		RT_RAR_CURR_CD            ,
				RT_RAR.FRT_RT_AMT          		RT_RAR_FRT_RT_AMT         ,
				RT_RAR.RAR_CONV_CTNT					RT_RAR_CONV_CTNT					,

				RT_DOR.BKG_CONV_TP_CD      		RT_DOR_BKG_CONV_TP_CD     ,
				RT_DOR.NOTE_CONV_MAPG_ID   		RT_DOR_NOTE_CONV_MAPG_ID  ,
				RT_DOR.NOTE_CONV_SEQ       		RT_DOR_NOTE_CONV_SEQ      ,
				RT_DOR.NOTE_CONV_RULE_CD   		RT_DOR_NOTE_CONV_RULE_CD  ,
				RT_DOR.NOTE_CONV_TP_CD     		RT_DOR_NOTE_CONV_TP_CD    ,
				RT_DOR.RT_OP_CD            		RT_DOR_RT_OP_CD           ,
				RT_DOR.CURR_CD             		RT_DOR_CURR_CD            ,
				RT_DOR.FRT_RT_AMT          		RT_DOR_FRT_RT_AMT         ,
				RT_DOR.DOR_CONV_CTNT					RT_DOR_CONV_CTNT					,

				RT_TYP.BKG_CONV_TP_CD      		RT_TYP_BKG_CONV_TP_CD     ,
				RT_TYP.NOTE_CONV_MAPG_ID   		RT_TYP_NOTE_CONV_MAPG_ID  ,
				RT_TYP.NOTE_CONV_SEQ       		RT_TYP_NOTE_CONV_SEQ      ,
				RT_TYP.NOTE_CONV_RULE_CD   		RT_TYP_NOTE_CONV_RULE_CD  ,
				RT_TYP.NOTE_CONV_TP_CD     		RT_TYP_NOTE_CONV_TP_CD    ,
				RT_TYP.RT_OP_CD            		RT_TYP_RT_OP_CD           ,
				RT_TYP.CURR_CD             		RT_TYP_CURR_CD            ,
				RT_TYP.FRT_RT_AMT          		RT_TYP_FRT_RT_AMT         ,
				RT_TYP.TYP_CONV_CTNT					RT_TYP_CONV_CTNT					,

				RT_RAC.BKG_CONV_TP_CD      		RT_RAC_BKG_CONV_TP_CD     ,
				RT_RAC.NOTE_CONV_MAPG_ID   		RT_RAC_NOTE_CONV_MAPG_ID  ,
				RT_RAC.NOTE_CONV_SEQ       		RT_RAC_NOTE_CONV_SEQ      ,
				RT_RAC.NOTE_CONV_RULE_CD   		RT_RAC_NOTE_CONV_RULE_CD  ,
				RT_RAC.NOTE_CONV_TP_CD     		RT_RAC_NOTE_CONV_TP_CD    ,
				RT_RAC.RT_OP_CD            		RT_RAC_RT_OP_CD           ,
				RT_RAC.CURR_CD             		RT_RAC_CURR_CD            ,
				RT_RAC.FRT_RT_AMT          		RT_RAC_FRT_RT_AMT         ,
				RT_RAC.RAC_CONV_CTNT					RT_RAC_CONV_CTNT					,

				RT.APP_BKG_CONV_TP_CD      		RT_APP_BKG_CONV_TP_CD     ,
				RT.APP_NOTE_CONV_MAPG_ID   		RT_APP_NOTE_CONV_MAPG_ID  ,
				RT.APP_NOTE_CONV_SEQ       		RT_APP_NOTE_CONV_SEQ      ,
				RT.APP_NOTE_CONV_RULE_CD   		RT_APP_NOTE_CONV_RULE_CD  ,
				RT.APP_NOTE_CONV_TP_CD     		RT_APP_NOTE_CONV_TP_CD    ,
				RT.APP_RT_OP_CD            		RT_APP_RT_OP_CD           ,
				RT.APP_CURR_CD             		RT_APP_CURR_CD            ,
				RT.APP_FRT_RT_AMT          		RT_APP_FRT_RT_AMT         ,

				RT.RAS_BKG_CONV_TP_CD      		RT_RAS_BKG_CONV_TP_CD     ,
				RT.RAS_NOTE_CONV_MAPG_ID   		RT_RAS_NOTE_CONV_MAPG_ID  ,
				RT.RAS_NOTE_CONV_SEQ       		RT_RAS_NOTE_CONV_SEQ      ,
				RT.RAS_NOTE_CONV_RULE_CD   		RT_RAS_NOTE_CONV_RULE_CD  ,
				RT.RAS_NOTE_CONV_TP_CD     		RT_RAS_NOTE_CONV_TP_CD    ,
				RT.RAS_RT_OP_CD            		RT_RAS_RT_OP_CD           ,
				RT.RAS_CURR_CD             		RT_RAS_CURR_CD            ,
				RT.RAS_FRT_RT_AMT          		RT_RAS_FRT_RT_AMT         ,
				RT.RAS_RAS_CONV_CTNT					RT_RAS_CONV_CTNT					,

				RT.ARB_BKG_CONV_TP_CD      		RT_ARB_BKG_CONV_TP_CD     ,
				RT.ARB_NOTE_CONV_MAPG_ID   		RT_ARB_NOTE_CONV_MAPG_ID  ,
				RT.ARB_NOTE_CONV_SEQ       		RT_ARB_NOTE_CONV_SEQ      ,
				RT.ARB_NOTE_CONV_RULE_CD   		RT_ARB_NOTE_CONV_RULE_CD  ,
				RT.ARB_NOTE_CONV_TP_CD     		RT_ARB_NOTE_CONV_TP_CD    ,
				RT.ARB_RT_OP_CD            		RT_ARB_RT_OP_CD           ,
				RT.ARB_CURR_CD             		RT_ARB_CURR_CD            ,
				RT.ARB_FRT_RT_AMT          		RT_ARB_FRT_RT_AMT         ,

				NULL										  		RT_ADD_BKG_CONV_TP_CD     ,
				NULL										  		RT_ADD_NOTE_CONV_MAPG_ID  ,
				NULL										  		RT_ADD_NOTE_CONV_SEQ      ,
				NULL										  		RT_ADD_NOTE_CONV_RULE_CD  ,
				NULL										  		RT_ADD_NOTE_CONV_TP_CD    ,
				NULL										  		RT_ADD_RT_OP_CD           ,
				NULL										  		RT_ADD_CURR_CD            ,
				NULL										  		RT_ADD_FRT_RT_AMT         ,

				OA_TYP.BKG_CONV_TP_CD      		OA_TYP_BKG_CONV_TP_CD     ,
				OA_TYP.NOTE_CONV_MAPG_ID   		OA_TYP_NOTE_CONV_MAPG_ID  ,
				OA_TYP.NOTE_CONV_SEQ       		OA_TYP_NOTE_CONV_SEQ      ,
				OA_TYP.NOTE_CONV_RULE_CD   		OA_TYP_NOTE_CONV_RULE_CD  ,
				OA_TYP.NOTE_CONV_TP_CD     		OA_TYP_NOTE_CONV_TP_CD    ,
				OA_TYP.RT_OP_CD            		OA_TYP_RT_OP_CD           ,
				OA_TYP.CURR_CD             		OA_TYP_CURR_CD            ,
				OA_TYP.FRT_RT_AMT          		OA_TYP_FRT_RT_AMT         ,
				OA_TYP.TYP_CONV_CTNT       		OA_TYP_CONV_CTNT         	,

				OA_RAC.BKG_CONV_TP_CD      		OA_RAC_BKG_CONV_TP_CD     ,
				OA_RAC.NOTE_CONV_MAPG_ID   		OA_RAC_NOTE_CONV_MAPG_ID  ,
				OA_RAC.NOTE_CONV_SEQ       		OA_RAC_NOTE_CONV_SEQ      ,
				OA_RAC.NOTE_CONV_RULE_CD   		OA_RAC_NOTE_CONV_RULE_CD  ,
				OA_RAC.NOTE_CONV_TP_CD     		OA_RAC_NOTE_CONV_TP_CD    ,
				OA_RAC.RT_OP_CD            		OA_RAC_RT_OP_CD           ,
				OA_RAC.CURR_CD             		OA_RAC_CURR_CD            ,
				OA_RAC.FRT_RT_AMT          		OA_RAC_FRT_RT_AMT         ,
				OA_RAC.RAC_CONV_CTNT       		OA_RAC_CONV_CTNT         	,

				NULL													DA_TYP_BKG_CONV_TP_CD     ,
				NULL													DA_TYP_NOTE_CONV_MAPG_ID  ,
				NULL													DA_TYP_NOTE_CONV_SEQ      ,
				NULL													DA_TYP_NOTE_CONV_RULE_CD  ,
				NULL													DA_TYP_NOTE_CONV_TP_CD    ,
				NULL													DA_TYP_DA_OP_CD           ,
				NULL													DA_TYP_CURR_CD            ,
				NULL													DA_TYP_FRT_RT_AMT					,
				NULL													DA_TYP_CONV_CTNT					,

				NULL													DA_RAC_BKG_CONV_TP_CD     ,
				NULL													DA_RAC_NOTE_CONV_MAPG_ID  ,
				NULL													DA_RAC_NOTE_CONV_SEQ      ,
				NULL													DA_RAC_NOTE_CONV_RULE_CD  ,
				NULL													DA_RAC_NOTE_CONV_TP_CD    ,
				NULL													DA_RAC_DA_OP_CD           ,
				NULL													DA_RAC_CURR_CD            ,
				NULL													DA_RAC_FRT_RT_AMT					,
				NULL													DA_RAC_CONV_CTNT					,

				'Y'														POR_MTCH_FLG							,
				RT.DEL_MTCH_FLG								DEL_MTCH_FLG

FROM
/*******************************************************************************************
JOIN TABLE
1.1 BQ, CH, CM, CR, RD, OP, DV, DP, RT
1.2 RT RULE					: RAP, RAR, DOR, TYP, RAC, APP, RAS, ADD
2.1 OA							: O
2.2 OA RULE					: TYP, RAC ( RAP, RAR, DOR 는 RT 와 동일하게 적용 )
3.1 DA							: X
3.2 DA RULE					: X
*******************************************************************************************/
				BQ	,
				OI	,
				OA	,
				RT	,
				NC_P											RT_RAP	,			/* COMMODITY CONVERSION */
				NC_P											RT_RAR	,			/* ROUTE CONVERSION */
				NC_P											RT_DOR	,			/* R/D TERM CONVERSION */
				NC_P											RT_TYP	,			/* RATING UNIT CONVERSION */
				NC_P											RT_RAC	,			/* CARGO TYPE CONVERSION */
				NC_P											OA_TYP	,			/* RATING UNIT CONVERSION */
				NC_P											OA_RAC				/* CARGO TYPE CONVERSION */

WHERE		RT.BQ_SEQ		=	BQ.BQ_SEQ
AND			OI.BQ_SEQ		= BQ.BQ_SEQ
AND			OA.BQ_SEQ		= BQ.BQ_SEQ
AND			RT_RAP.BQ_SEQ	= RT.BQ_SEQ AND RT_RAP.NOTE_CONV_RULE_CD = 'RAP' AND ( RT_RAP.BKG_CONV_TP_CD = 'B' OR RT_RAP.NC_SEQ = RT.RAP_NC_SEQ )
AND			RT_RAR.BQ_SEQ	= RT.BQ_SEQ AND RT_RAR.NOTE_CONV_RULE_CD = 'RAR' AND ( RT_RAR.BKG_CONV_TP_CD = 'B' OR RT_RAR.NC_SEQ = RT.RAR_NC_SEQ )
AND			RT_DOR.BQ_SEQ	= RT.BQ_SEQ AND RT_DOR.NOTE_CONV_RULE_CD = 'DOR' AND ( RT_DOR.BKG_CONV_TP_CD = 'B' OR RT_DOR.NC_SEQ = RT.DOR_NC_SEQ )
AND			RT_TYP.BQ_SEQ	= RT.BQ_SEQ AND RT_TYP.NOTE_CONV_RULE_CD = 'TYP' AND ( RT_TYP.BKG_CONV_TP_CD = 'B' OR RT_TYP.NC_SEQ = RT.TYP_NC_SEQ )
AND			RT_RAC.BQ_SEQ	= RT.BQ_SEQ AND RT_RAC.NOTE_CONV_RULE_CD = 'RAC' AND ( RT_RAC.BKG_CONV_TP_CD = 'B' OR RT_RAC.NC_SEQ = RT.RAC_NC_SEQ )
AND			OA_TYP.BQ_SEQ	= RT.BQ_SEQ AND OA_TYP.NOTE_CONV_RULE_CD = 'TYP' AND ( OA_TYP.BKG_CONV_TP_CD = 'B' OR OA_TYP.NC_SEQ = RT.TYP_NC_SEQ )
AND			OA_RAC.BQ_SEQ	= RT.BQ_SEQ AND OA_RAC.NOTE_CONV_RULE_CD = 'RAC' AND ( OA_RAC.BKG_CONV_TP_CD = 'B' OR OA_RAC.NC_SEQ = RT.RAC_NC_SEQ )


/*******************************************************************************************
	6.1 RATE
*******************************************************************************************/

/*******************************************************************************************
	6.1.1 RATE - COMMODITY
	(주의)
	COMMODITY 나 RATING UNIT 등의 조건이 위의 OA, DA, RT 와 중복조건으로 보일 수 있으나,
	OA, DA, RT 는 CONVERSION 이 정확하게 적용한 것이 아니므로, 다시한번 정확하게 조건을 연결해야 한다.
*******************************************************************************************/

/*******************************************************************************************
< COMMODITY >
그룹, 개별간으로 일치하는 경우
*******************************************************************************************/
AND			( RT.CM_PRC_CMDT_TP_CD, RT.CM_PRC_CMDT_DEF_CD ) IN
				(
				SELECT	RT_RAP.CONV_CMDT_TP_CD, RT_RAP.CONV_CMDT_DEF_CD
				FROM		DUAL
				UNION ALL
				SELECT  'C', GC.PRC_CMDT_DEF_CD
				FROM		GC
				WHERE		RT_RAP.CONV_CMDT_TP_CD	= 'G'
				AND     GC.PRC_CMDT_TP_CD   		= 'C'
				AND			GC.PRC_GRP_CMDT_CD  		= RT_RAP.CONV_CMDT_DEF_CD
				UNION ALL
				SELECT  'G', GC.PRC_GRP_CMDT_CD
				FROM		GC
				WHERE		RT_RAP.CONV_CMDT_TP_CD	= 'C'
				AND     GC.PRC_CMDT_TP_CD   		= 'C'
				AND     GC.PRC_CMDT_DEF_CD  		= RT_RAP.CONV_CMDT_DEF_CD
				UNION ALL
				/* TAW 일 경우 FAK 고려함 */
				SELECT	'C', CMDT_CD
				FROM		MDM_COMMODITY
				WHERE		REP_CMDT_CD		= '0000'
				UNION ALL
				SELECT	'G', GC.PRC_GRP_CMDT_CD
				FROM		GC
				WHERE		GC.PRC_CMDT_TP_CD		= 'C'
				AND			GC.PRC_CMDT_DEF_CD  IN ( SELECT CMDT_CD FROM MDM_COMMODITY WHERE REP_CMDT_CD = '0000' )
				)


/*******************************************************************************************
	6.1.2 RATE - ROUTE
*******************************************************************************************/

/*******************************************************************************************
< ORIGIN ( PRE RELAY ) >
*******************************************************************************************/

AND     ( RT.OP_ROUT_PNT_LOC_TP_CD, RT.OP_ROUT_PNT_LOC_DEF_CD ) IN
				(
				SELECT	'L', BQ.PRE_RLY_PORT_CD
				FROM		DUAL
				UNION ALL
				SELECT  'G', GL.PRC_GRP_LOC_CD
				FROM		GL
				WHERE		GL.LOC_CD						= BQ.PRE_RLY_PORT_CD
				)


/*******************************************************************************************
< ORIGIN VIA ( PRE RELAY ) >
*******************************************************************************************/

AND     (
						RT.OV_ROUT_VIA_PORT_DEF_CD IS NULL
				OR	( RT.OV_ROUT_VIA_PORT_TP_CD, RT.OV_ROUT_VIA_PORT_DEF_CD ) IN
						(
						SELECT	'L', BQ.PRE_RLY_PORT_CD
						FROM		DUAL
						UNION ALL
						SELECT  'G', GL.PRC_GRP_LOC_CD
						FROM		GL
						WHERE		GL.LOC_CD						= BQ.PRE_RLY_PORT_CD
						)
				)


/*******************************************************************************************
< DESTINATION VIA ( POD ) >
*******************************************************************************************/

AND     (
						RT.DV_ROUT_VIA_PORT_DEF_CD IS NULL
				OR	( RT.DV_ROUT_VIA_PORT_TP_CD, RT.DV_ROUT_VIA_PORT_DEF_CD ) IN
						(
						SELECT	RT_RAR.CONV_DEST_VIA_LOC_TP_CD,	RT_RAR.CONV_DEST_VIA_LOC_DEF_CD
						FROM		DUAL
						UNION ALL
						SELECT  'L', GL.LOC_CD
						FROM		GL
						WHERE		RT_RAR.CONV_DEST_VIA_LOC_TP_CD	= 'G'
						AND		  GL.PRC_GRP_LOC_CD 						= RT_RAR.CONV_DEST_VIA_LOC_DEF_CD
						UNION ALL
						SELECT  'G', GL.PRC_GRP_LOC_CD
						FROM		GL
						WHERE		RT_RAR.CONV_DEST_VIA_LOC_TP_CD	= 'L'
						AND     GL.LOC_CD											= RT_RAR.CONV_DEST_VIA_LOC_DEF_CD
						)
				)


/*******************************************************************************************
< DESTINATION (DEL OR POD ) >
*******************************************************************************************/

AND     ( RT.DP_ROUT_PNT_LOC_TP_CD, RT.DP_ROUT_PNT_LOC_DEF_CD ) IN
				(
				SELECT	RT_RAR.CONV_DEST_LOC_TP_CD,	RT_RAR.CONV_DEST_LOC_DEF_CD
				FROM		DUAL
				UNION ALL
				SELECT  'L', GL.LOC_CD
				FROM		GL
				WHERE		RT_RAR.CONV_DEST_LOC_TP_CD	= 'G'
				AND		  GL.PRC_GRP_LOC_CD 				= RT_RAR.CONV_DEST_LOC_DEF_CD
				UNION ALL
				SELECT  'G', GL.PRC_GRP_LOC_CD
				FROM		GL
				WHERE		RT_RAR.CONV_DEST_LOC_TP_CD	= 'L'
				AND     GL.LOC_CD									= RT_RAR.CONV_DEST_LOC_DEF_CD
				UNION ALL
				SELECT	RT_RAR.CONV_DEST_VIA_LOC_TP_CD,	RT_RAR.CONV_DEST_VIA_LOC_DEF_CD
				FROM		DUAL
				UNION ALL
				SELECT  'L', GL.LOC_CD
				FROM		GL
				WHERE		RT_RAR.CONV_DEST_VIA_LOC_TP_CD	= 'G'
				AND		  GL.PRC_GRP_LOC_CD 				= RT_RAR.CONV_DEST_VIA_LOC_DEF_CD
				UNION ALL
				SELECT  'G', GL.PRC_GRP_LOC_CD
				FROM		GL
				WHERE		RT_RAR.CONV_DEST_VIA_LOC_TP_CD	= 'L'
				AND     GL.LOC_CD									= RT_RAR.CONV_DEST_VIA_LOC_DEF_CD
				)


/*******************************************************************************************
< DE TERM >
*******************************************************************************************/

AND     (
						(
								RT.DEL_MTCH_FLG			= 'Y'
						AND	NVL(RT.DP_RCV_DE_TERM_CD, '*') IN
								(
								SELECT  B.RCV_DE_TERM_CD
								FROM		(
												SELECT 'Y' CONV_PRC_TERM_CD, 'Y' RCV_DE_TERM_CD FROM DUAL UNION ALL
												SELECT 'Y' CONV_PRC_TERM_CD, 'L' RCV_DE_TERM_CD FROM DUAL UNION ALL
												SELECT 'Y' CONV_PRC_TERM_CD, '*' RCV_DE_TERM_CD FROM DUAL UNION ALL
												SELECT 'S' CONV_PRC_TERM_CD, 'S' RCV_DE_TERM_CD FROM DUAL UNION ALL
												SELECT 'S' CONV_PRC_TERM_CD, 'Y' RCV_DE_TERM_CD FROM DUAL UNION ALL
												SELECT 'S' CONV_PRC_TERM_CD, 'T' RCV_DE_TERM_CD FROM DUAL UNION ALL
												SELECT 'S' CONV_PRC_TERM_CD, 'I' RCV_DE_TERM_CD FROM DUAL UNION ALL
												SELECT 'S' CONV_PRC_TERM_CD, 'L' RCV_DE_TERM_CD FROM DUAL UNION ALL
												SELECT 'S' CONV_PRC_TERM_CD, '*' RCV_DE_TERM_CD FROM DUAL UNION ALL
												SELECT 'D' CONV_PRC_TERM_CD, 'D' RCV_DE_TERM_CD FROM DUAL UNION ALL
												SELECT 'T' CONV_PRC_TERM_CD, 'T' RCV_DE_TERM_CD FROM DUAL UNION ALL
												SELECT 'I' CONV_PRC_TERM_CD, 'I' RCV_DE_TERM_CD FROM DUAL
												)	B
								WHERE		B.CONV_PRC_TERM_CD	= RT_DOR.CONV_PRC_DE_TERM_CD
								)
						)
				OR	(
								BQ.DEL_CD										= BQ.POD_CD
						AND	NVL(RT.DP_RCV_DE_TERM_CD, '*') IN
								(
								SELECT  B.RCV_DE_TERM_CD
								FROM		(
												SELECT 'Y' CONV_PRC_TERM_CD, 'Y' RCV_DE_TERM_CD FROM DUAL UNION ALL
												SELECT 'Y' CONV_PRC_TERM_CD, 'L' RCV_DE_TERM_CD FROM DUAL UNION ALL
												SELECT 'Y' CONV_PRC_TERM_CD, '*' RCV_DE_TERM_CD FROM DUAL UNION ALL
												SELECT 'S' CONV_PRC_TERM_CD, 'S' RCV_DE_TERM_CD FROM DUAL UNION ALL
												SELECT 'S' CONV_PRC_TERM_CD, 'Y' RCV_DE_TERM_CD FROM DUAL UNION ALL
												SELECT 'S' CONV_PRC_TERM_CD, 'T' RCV_DE_TERM_CD FROM DUAL UNION ALL
												SELECT 'S' CONV_PRC_TERM_CD, 'I' RCV_DE_TERM_CD FROM DUAL UNION ALL
												SELECT 'S' CONV_PRC_TERM_CD, 'L' RCV_DE_TERM_CD FROM DUAL UNION ALL
												SELECT 'S' CONV_PRC_TERM_CD, '*' RCV_DE_TERM_CD FROM DUAL UNION ALL
												SELECT 'D' CONV_PRC_TERM_CD, 'D' RCV_DE_TERM_CD FROM DUAL UNION ALL
												SELECT 'D' CONV_PRC_TERM_CD, 'Y' RCV_DE_TERM_CD FROM DUAL UNION ALL	-- 예외 적용
												SELECT 'T' CONV_PRC_TERM_CD, 'T' RCV_DE_TERM_CD FROM DUAL UNION ALL
												SELECT 'I' CONV_PRC_TERM_CD, 'I' RCV_DE_TERM_CD FROM DUAL
												)	B
								WHERE		B.CONV_PRC_TERM_CD	= RT_DOR.CONV_PRC_DE_TERM_CD
								)
						)
				OR	(
								RT.DEL_MTCH_FLG 								= 'N'
						AND	NVL(RT.DP_RCV_DE_TERM_CD, '*')	IN ( 'Y', '*' )
						)
				)


/*******************************************************************************************
< DEST TRANS MODE >
*******************************************************************************************/

AND			(
					  RT.DEL_MTCH_FLG = 'N'
				OR	(
								RT.DP_PRC_TRSP_MOD_CD	IS NULL
						OR	BQ.DEST_TRNS_MOD_CD		IS NULL
						OR	RT.DP_PRC_TRSP_MOD_CD	= BQ.DEST_TRNS_MOD_CD
						OR  (
										RT.DP_PRC_TRSP_MOD_CD	IN ( 'R', 'A' )
								AND	BQ.DEST_TRNS_MOD_CD		= 'R'
								)
						)
				)


/*******************************************************************************************
	6.1.3 RATE - RATING UNIT
*******************************************************************************************/

AND     (
								RT.RAT_UT_CD	= RT_TYP.CONV_RAT_UT_CD
		        OR
    		    (
        				RT.RAT_UT_CD	IN ( '20', '40', 'HC', '45', '53' )
       			AND ( SELECT A.CNTR_SZ_CD FROM PRI_RAT_UT A WHERE A.RAT_UT_CD = RT.RAT_UT_CD )	= RT_TYP.CONV_RAT_UT_SZ_CD
        		)
				)

AND			RT.PRC_CGO_TP_CD	IN ( RT_RAC.CONV_DR_TP, RT_RAC.CONV_DG_TP, RT_RAC.CONV_RF_TP, RT_RAC.CONV_AK_TP, RT_RAC.CONV_BB_TP )


/*******************************************************************************************
	6.2 ORIGIN IHC
*******************************************************************************************/

/*******************************************************************************************
	6.2.2 ORIGIN IHC - ROUTE
*******************************************************************************************/

/*******************************************************************************************
< POINT ( POR ) >
*******************************************************************************************/

AND     ( OI.ROUT_PNT_LOC_TP_CD, OI.ROUT_PNT_LOC_DEF_CD ) IN
				(
				SELECT  RT_RAR.CONV_ORG_LOC_TP_CD, RT_RAR.CONV_ORG_LOC_DEF_CD
				FROM		DUAL
				UNION ALL
				SELECT  'L', GL.LOC_CD
				FROM		GL
				WHERE		RT_RAR.CONV_ORG_LOC_TP_CD	= 'G'
				AND		  GL.PRC_GRP_LOC_CD 				= RT_RAR.CONV_ORG_LOC_DEF_CD
				UNION ALL
				SELECT  'G', GL.PRC_GRP_LOC_CD
				FROM		GL
				WHERE		RT_RAR.CONV_ORG_LOC_TP_CD	= 'L'
				AND     GL.LOC_CD									= RT_RAR.CONV_ORG_LOC_DEF_CD
				)


/*******************************************************************************************
< RCV TERM >
*******************************************************************************************/

AND     NVL(OI.RCV_DE_TERM_CD, '*') IN
				(
				SELECT  B.RCV_DE_TERM_CD
				FROM		(
								SELECT 'Y' CONV_PRC_TERM_CD, 'Y' RCV_DE_TERM_CD FROM DUAL UNION ALL
								SELECT 'Y' CONV_PRC_TERM_CD, 'L' RCV_DE_TERM_CD FROM DUAL UNION ALL
								SELECT 'Y' CONV_PRC_TERM_CD, '*' RCV_DE_TERM_CD FROM DUAL UNION ALL
								SELECT 'S' CONV_PRC_TERM_CD, 'S' RCV_DE_TERM_CD FROM DUAL UNION ALL
								SELECT 'D' CONV_PRC_TERM_CD, 'D' RCV_DE_TERM_CD FROM DUAL UNION ALL
								SELECT 'T' CONV_PRC_TERM_CD, 'T' RCV_DE_TERM_CD FROM DUAL UNION ALL
								SELECT 'I' CONV_PRC_TERM_CD, 'I' RCV_DE_TERM_CD FROM DUAL
								)	B
				WHERE		B.CONV_PRC_TERM_CD	= RT_DOR.CONV_PRC_RCV_TERM_CD
				)


/*******************************************************************************************
< BASE PORT ( POL ) >
*******************************************************************************************/

AND     ( OI.BSE_PORT_TP_CD, OI.BSE_PORT_DEF_CD ) IN
				(
				SELECT  RT_RAR.CONV_ORG_VIA_LOC_TP_CD, RT_RAR.CONV_ORG_VIA_LOC_DEF_CD
				FROM		DUAL
				UNION ALL
				SELECT  'L', GL.LOC_CD
				FROM		GL
				WHERE		RT_RAR.CONV_ORG_VIA_LOC_TP_CD	= 'G'
				AND		  GL.PRC_GRP_LOC_CD 				= RT_RAR.CONV_ORG_VIA_LOC_DEF_CD
				UNION ALL
				SELECT  'G', GL.PRC_GRP_LOC_CD
				FROM		GL
				WHERE		RT_RAR.CONV_ORG_VIA_LOC_TP_CD	= 'L'
				AND     GL.LOC_CD									= RT_RAR.CONV_ORG_VIA_LOC_DEF_CD
				)


/*******************************************************************************************
	6.2.3 ORIGIN IHC - RATING UNIT
*******************************************************************************************/

/* ORIGIN ARB RATING UNIT */
AND     (
								OI.RAT_UT_CD	= OA_TYP.CONV_RAT_UT_CD
		        OR	OI.RAT_UT_CD	= 'BX'
		        OR
    		    (
        				OI.RAT_UT_CD	IN ( '20', '40', 'HC', '45', '53' )
       			AND ( SELECT A.CNTR_SZ_CD FROM PRI_RAT_UT A WHERE A.RAT_UT_CD = OI.RAT_UT_CD )	= OA_TYP.CONV_RAT_UT_SZ_CD
        		)
				)


/* ORIGIN ARB CARGO TYPE */
AND			NVL(OI.PRC_CGO_TP_CD, '*')	IN ( '*', OA_RAC.CONV_DR_TP, OA_RAC.CONV_DG_TP, OA_RAC.CONV_RF_TP, OA_RAC.CONV_AK_TP, OA_RAC.CONV_BB_TP )


/*******************************************************************************************
	6.3 ORIGIN ARB
*******************************************************************************************/

/*******************************************************************************************
	6.3.1 ORIGIN ARB - COMMODITY
*******************************************************************************************/

AND			(
						OA.PRC_CMDT_DEF_CD	IS NULL
				OR	( OA.PRC_CMDT_TP_CD, OA.PRC_CMDT_DEF_CD ) IN
						(
						SELECT	RT_RAP.CONV_CMDT_TP_CD, RT_RAP.CONV_CMDT_DEF_CD
						FROM		DUAL
						UNION ALL
						SELECT  'C', GC.PRC_CMDT_DEF_CD
						FROM		GC
						WHERE		RT_RAP.CONV_CMDT_TP_CD	= 'G'
						AND     GC.PRC_CMDT_TP_CD   		= 'C'
						AND			GC.PRC_GRP_CMDT_CD  		= RT_RAP.CONV_CMDT_DEF_CD
						UNION ALL
						SELECT  'G', GC.PRC_GRP_CMDT_CD
						FROM		GC
						WHERE		RT_RAP.CONV_CMDT_TP_CD	= 'C'
						AND     GC.PRC_CMDT_TP_CD   		= 'C'
						AND     GC.PRC_CMDT_DEF_CD  		= RT_RAP.CONV_CMDT_DEF_CD
						UNION ALL
						/* TAW 일 경우 FAK 고려함 */
						SELECT	'C', CMDT_CD
						FROM		MDM_COMMODITY
						WHERE		REP_CMDT_CD		= '0000'
						UNION ALL
						SELECT	'G', GC.PRC_GRP_CMDT_CD
						FROM		GC
						WHERE		GC.PRC_CMDT_TP_CD		= 'C'
						AND			GC.PRC_CMDT_DEF_CD  IN ( SELECT CMDT_CD FROM MDM_COMMODITY WHERE REP_CMDT_CD = '0000' )
						)
				)


/*******************************************************************************************
	6.3.2 ORIGIN ARB - ROUTE
*******************************************************************************************/

/*******************************************************************************************
< POINT ( POL ) >
*******************************************************************************************/

AND     ( OA.ROUT_PNT_LOC_TP_CD, OA.ROUT_PNT_LOC_DEF_CD ) IN
				(
				SELECT	RT_RAR.CONV_ORG_VIA_LOC_TP_CD,	RT_RAR.CONV_ORG_VIA_LOC_DEF_CD
				FROM		DUAL
				UNION ALL
				SELECT  'L', GL.LOC_CD
				FROM		GL
				WHERE		RT_RAR.CONV_ORG_VIA_LOC_TP_CD	= 'G'
				AND		  GL.PRC_GRP_LOC_CD 				= RT_RAR.CONV_ORG_VIA_LOC_DEF_CD
				UNION ALL
				SELECT  'G', GL.PRC_GRP_LOC_CD
				FROM		GL
				WHERE		RT_RAR.CONV_ORG_VIA_LOC_TP_CD	= 'L'
				AND     GL.LOC_CD									= RT_RAR.CONV_ORG_VIA_LOC_DEF_CD
				)


/*******************************************************************************************
< VIA PORT ( PRE RELAY ) >
*******************************************************************************************/

AND     (
                OA.VIA_PORT_DEF_CD  IS NULL
            OR	( OA.VIA_PORT_TP_CD, OA.VIA_PORT_DEF_CD ) IN
								(
								SELECT	'L', BQ.PRE_RLY_PORT_CD
								FROM		DUAL
								UNION ALL
								SELECT  'G', GL.PRC_GRP_LOC_CD
								FROM		GL
								WHERE		GL.LOC_CD						= BQ.PRE_RLY_PORT_CD
								)
        )


/*******************************************************************************************
	6.3.3 ORIGIN ARB - RATING UNIT
*******************************************************************************************/

/* ORIGIN ARB RATING UNIT */
AND     (
								OA.RAT_UT_CD	= OA_TYP.CONV_RAT_UT_CD
		        OR	OA.RAT_UT_CD	= 'BX'
		        OR
    		    (
        				OA.RAT_UT_CD	IN ( '20', '40', 'HC', '45', '53' )
       			AND ( SELECT A.CNTR_SZ_CD FROM PRI_RAT_UT A WHERE A.RAT_UT_CD = OA.RAT_UT_CD )	= OA_TYP.CONV_RAT_UT_SZ_CD
        		)
				)

/* ORIGIN ARB CARGO TYPE */
AND			NVL(OA.PRC_CGO_TP_CD, '*')	IN ('*', OA_RAC.CONV_DR_TP, OA_RAC.CONV_DG_TP, OA_RAC.CONV_RF_TP, OA_RAC.CONV_AK_TP, OA_RAC.CONV_BB_TP )


/*******************************************************************************************
	6.3.4 ORIGIN ARB - JOIN
*******************************************************************************************/

/* ORIGIN ARB JOIN ( ARB CONV RULE ) */
AND			DECODE(RT.ARB_RT_APPL_TP_CD, NULL, DECODE(RT.GEN_SPCL_RT_TP_CD, 'S', 'N', 'Y'), 'N', 'N', 'Y') = 'Y'

/* ORIGIN ARB JOIN ( OARB.BPORT = RATE.ORIGIN ) */
AND			NVL(RT.OP_RCV_DE_TERM_CD, '*' )	NOT IN ( 'D', 'S' )

AND			( RT.OP_ROUT_PNT_LOC_TP_CD, RT.OP_ROUT_PNT_LOC_DEF_CD ) IN
				(
				SELECT	OA.BSE_PORT_TP_CD, OA.BSE_PORT_DEF_CD
				FROM		DUAL
				UNION ALL
				SELECT	'L', GL.LOC_CD
				FROM		GL
				WHERE		OA.BSE_PORT_TP_CD	= 'G'
				AND		  GL.PRC_GRP_LOC_CD	= OA.BSE_PORT_DEF_CD
				UNION ALL
				SELECT	'G', GL.PRC_GRP_LOC_CD
				FROM		GL
				WHERE		OA.BSE_PORT_TP_CD	= 'L'
				AND			GL.LOC_CD					= OA.BSE_PORT_DEF_CD
				)


UNION ALL


/*******************************************************************************************
	7. PATTERN #7 ( 1010 )
*******************************************************************************************/

SELECT	'1010'												PRC_RT_MTCH_PATT_CD				,
				BQ.SC_NO											CTRT_NO										,
				BQ.PROP_NO										PROP_NO										,
				BQ.AMDT_SEQ										AMDT_SEQ									,
				BQ.SVC_SCP_CD									SVC_SCP_CD								,
				BQ.BQ_SEQ											BQ_SEQ										,
				BQ.BKG_BQ_SEQ									BKG_BQ_SEQ								,
				BQ.CNTR_TPSZ_CD								BQ_CNTR_TPSZ_CD						,
				BQ.CTRT_CNTR_TPSZ_CD					BQ_CTRT_CNTR_TPSZ_CD			,
				BQ.RCV_TERM_CD								BQ_RCV_TERM_CD						,
				BQ.DE_TERM_CD									BQ_DE_TERM_CD							,
				BQ.DRY_CGO_FLG								BQ_DRY_CGO_FLG						,
				BQ.DCGO_FLG										BQ_DCGO_FLG								,
				BQ.RC_FLG											BQ_RC_FLG									,
				BQ.AWK_CGO_FLG								BQ_AWK_CGO_FLG						,
				BQ.BB_CGO_FLG									BQ_BB_CGO_FLG							,
				BQ.SOC_FLG										BQ_SOC_FLG								,
				BQ.PRC_CGO_TP_CD							BQ_PRC_CGO_TP_CD					,
				BQ.IMDG_CLSS_CD								BQ_IMDG_CLSS_CD						,
				BQ.CTRT_CNTR_QTY							BQ_CTRT_CNTR_QTY					,
				BQ.POR_APPL_FLG								BQ_POR_APPL_FLG						,
				BQ.POL_APPL_FLG								BQ_POL_APPL_FLG						,
				BQ.POD_APPL_FLG								BQ_POD_APPL_FLG						,
				BQ.DEL_APPL_FLG								BQ_DEL_APPL_FLG						,
				BQ.PRE_RLY_PORT_APPL_FLG			BQ_POR_RLY_PORT_APPL_FLG	,
				BQ.PST_RLY_PORT_APPL_FLG			BQ_PST_RLY_PORT_APPL_FLG	,

				RT.CMDT_HDR_SEQ								RT_CMDT_HDR_SEQ						,
				RT.ROUT_SEQ										RT_ROUT_SEQ								,
				RT.RT_SEQ											RT_RT_SEQ									,
				OI.ADD_CHG_SEQ								OI_ADD_CHG_SEQ						,
				0															OA_ADD_CHG_SEQ						,
				DA.ADD_CHG_SEQ								DA_ADD_CHG_SEQ						,
				0															DI_ADD_CHG_SEQ						,

				RT.GEN_SPCL_RT_TP_CD					RT_GEN_SPCL_RT_TP_CD			,
				RT.CM_PRC_CMDT_TP_CD					CM_PRC_CMDT_TP_CD					,
				RT.CM_PRC_CMDT_DEF_CD					CM_PRC_CMDT_DEF_CD				,
				OI.ROUT_PNT_LOC_DEF_CD				POR_CD										,
				RT.OP_ROUT_PNT_LOC_DEF_CD			POL_CD										,
				RT.DP_ROUT_PNT_LOC_DEF_CD			POD_CD										,
				DA.ROUT_PNT_LOC_DEF_CD				DEL_CD										,
				DA.DIR_CALL_FLG								DIR_CALL_FLG							,
				OI.RCV_DE_TERM_CD							RCV_TERM_CD								,
				DA.RCV_DE_TERM_CD							DE_TERM_CD								,
				RT.RAT_UT_CD									RAT_UT_CD									,
				RT.PRC_CGO_TP_CD							PRC_CGO_TP_CD							,
				RT.CURR_CD										CURR_CD										,
				OI.PRC_TRSP_MOD_CD						ORG_TRSP_MOD_CD						,
				DA.PRC_TRSP_MOD_CD						DEST_TRSP_MOD_CD					,

				RT.OP_ROUT_PNT_LOC_DEF_CD			OP_ROUT_PNT_LOC_DEF_CD		,
				RT.OV_ROUT_VIA_PORT_DEF_CD		OV_ROUT_VIA_PORT_DEF_CD		,
				RT.DV_ROUT_VIA_PORT_DEF_CD		DV_ROUT_VIA_PORT_DEF_CD		,
				RT.DP_ROUT_PNT_LOC_DEF_CD			DP_ROUT_PNT_LOC_DEF_CD		,
				RT.RD_DIR_CALL_FLG						RD_DIR_CALL_FLG						,
				RT.RAT_UT_CD									RT_RAT_UT_CD							,
				RT.PRC_CGO_TP_CD							RT_PRC_CGO_TP_CD					,
				RT.OP_PRC_TRSP_MOD_CD					OP_PRC_TRSP_MOD_CD				,
				RT.DP_PRC_TRSP_MOD_CD					DP_PRC_TRSP_MOD_CD				,
				RT.CURR_CD										RT_CURR_CD								,
				RT.FNL_FRT_RT_AMT							RT_FNL_FRT_RT_AMT					,

				OI.ROUT_PNT_LOC_DEF_CD				OI_ROUT_PNT_LOC_DEF_CD		,
				OI.BSE_PORT_DEF_CD						OI_BSE_PORT_DEF_CD				,
				OI.VIA_PORT_DEF_CD						OI_VIA_PORT_DEF_CD				,
				OI.DIR_CALL_FLG								OI_DIR_CALL_FLG						,
				OI.RAT_UT_CD									OI_RAT_UT_CD							,
				OI.PRC_CGO_TP_CD							OI_PRC_CGO_TP_CD					,
				OI.PRC_TRSP_MOD_CD						OI_PRC_TRSP_MOD_CD				,
				OI.RCV_DE_TERM_CD							OI_RCV_DE_TERM_CD					,
				OI.PRC_CMDT_DEF_CD						OI_PRC_CMDT_DEF_CD				,
				OI.CURR_CD										OI_CURR_CD								,
				OI.FNL_FRT_RT_AMT							OI_FNL_FRT_RT_AMT					,
				OI.RAT_UT_MTCH_PRIO						OI_RAT_UT_MTCH_PRIO				,

				NULL													OA_ROUT_PNT_LOC_DEF_CD		,
				NULL													OA_BSE_PORT_DEF_CD				,
				NULL													OA_VIA_PORT_DEF_CD				,
				NULL													OA_DIR_CALL_FLG						,
				NULL													OA_RAT_UT_CD							,
				NULL													OA_PRC_CGO_TP_CD					,
				NULL													OA_PRC_TRSP_MOD_CD				,
				NULL													OA_RCV_DE_TERM_CD					,
				NULL													OA_PRC_CMDT_DEF_CD				,
				NULL													OA_CURR_CD								,
				NULL													OA_FNL_FRT_RT_AMT					,
				NULL													OA_RAT_UT_MTCH_PRIO				,

				DA.ROUT_PNT_LOC_DEF_CD				DA_ROUT_PNT_LOC_DEF_CD		,
				DA.BSE_PORT_DEF_CD						DA_BSE_PORT_DEF_CD				,
				DA.VIA_PORT_DEF_CD						DA_VIA_PORT_DEF_CD				,
				DA.DIR_CALL_FLG								DA_DIR_CALL_FLG						,
				DA.RAT_UT_CD									DA_RAT_UT_CD							,
				DA.PRC_CGO_TP_CD							DA_PRC_CGO_TP_CD					,
				DA.PRC_TRSP_MOD_CD						DA_PRC_TRSP_MOD_CD				,
				DA.RCV_DE_TERM_CD							DA_RCV_DE_TERM_CD					,
				DA.PRC_CMDT_DEF_CD						DA_PRC_CMDT_DEF_CD				,
				DA.CURR_CD										DA_CURR_CD								,
				DA.FNL_FRT_RT_AMT							DA_FNL_FRT_RT_AMT					,
				DA.RAT_UT_MTCH_PRIO						DA_RAT_UT_MTCH_PRIO				,

				NULL													DI_ROUT_PNT_LOC_DEF_CD		,
				NULL													DI_BSE_PORT_DEF_CD				,
				NULL													DI_VIA_PORT_DEF_CD				,
				NULL													DI_DIR_CALL_FLG						,
				NULL													DI_RAT_UT_CD							,
				NULL													DI_PRC_CGO_TP_CD					,
				NULL													DI_PRC_TRSP_MOD_CD				,
				NULL													DI_RCV_DE_TERM_CD					,
				NULL													DI_PRC_CMDT_DEF_CD				,
				NULL													DI_CURR_CD								,
				NULL													DI_FNL_FRT_RT_AMT					,
				NULL													DI_RAT_UT_MTCH_PRIO				,

				RT_RAP.BKG_CONV_TP_CD      		RT_RAP_BKG_CONV_TP_CD			,
				RT_RAP.NOTE_CONV_MAPG_ID   		RT_RAP_NOTE_CONV_MAPG_ID  ,
				RT_RAP.NOTE_CONV_SEQ       		RT_RAP_NOTE_CONV_SEQ      ,
				RT_RAP.NOTE_CONV_RULE_CD   		RT_RAP_NOTE_CONV_RULE_CD  ,
				RT_RAP.NOTE_CONV_TP_CD     		RT_RAP_NOTE_CONV_TP_CD    ,
				RT_RAP.RT_OP_CD            		RT_RAP_RT_OP_CD           ,
				RT_RAP.CURR_CD             		RT_RAP_CURR_CD            ,
				RT_RAP.FRT_RT_AMT          		RT_RAP_FRT_RT_AMT         ,
				RT_RAP.RAP_CONV_CTNT					RT_RAP_CONV_CTNT					,

				RT_RAR.BKG_CONV_TP_CD      		RT_RAR_BKG_CONV_TP_CD     ,
				RT_RAR.NOTE_CONV_MAPG_ID   		RT_RAR_NOTE_CONV_MAPG_ID  ,
				RT_RAR.NOTE_CONV_SEQ       		RT_RAR_NOTE_CONV_SEQ      ,
				RT_RAR.NOTE_CONV_RULE_CD   		RT_RAR_NOTE_CONV_RULE_CD  ,
				RT_RAR.NOTE_CONV_TP_CD     		RT_RAR_NOTE_CONV_TP_CD    ,
				RT_RAR.RT_OP_CD            		RT_RAR_RT_OP_CD           ,
				RT_RAR.CURR_CD             		RT_RAR_CURR_CD            ,
				RT_RAR.FRT_RT_AMT          		RT_RAR_FRT_RT_AMT         ,
				RT_RAR.RAR_CONV_CTNT					RT_RAR_CONV_CTNT					,

				RT_DOR.BKG_CONV_TP_CD      		RT_DOR_BKG_CONV_TP_CD     ,
				RT_DOR.NOTE_CONV_MAPG_ID   		RT_DOR_NOTE_CONV_MAPG_ID  ,
				RT_DOR.NOTE_CONV_SEQ       		RT_DOR_NOTE_CONV_SEQ      ,
				RT_DOR.NOTE_CONV_RULE_CD   		RT_DOR_NOTE_CONV_RULE_CD  ,
				RT_DOR.NOTE_CONV_TP_CD     		RT_DOR_NOTE_CONV_TP_CD    ,
				RT_DOR.RT_OP_CD            		RT_DOR_RT_OP_CD           ,
				RT_DOR.CURR_CD             		RT_DOR_CURR_CD            ,
				RT_DOR.FRT_RT_AMT          		RT_DOR_FRT_RT_AMT         ,
				RT_DOR.DOR_CONV_CTNT					RT_DOR_CONV_CTNT					,

				RT_TYP.BKG_CONV_TP_CD      		RT_TYP_BKG_CONV_TP_CD     ,
				RT_TYP.NOTE_CONV_MAPG_ID   		RT_TYP_NOTE_CONV_MAPG_ID  ,
				RT_TYP.NOTE_CONV_SEQ       		RT_TYP_NOTE_CONV_SEQ      ,
				RT_TYP.NOTE_CONV_RULE_CD   		RT_TYP_NOTE_CONV_RULE_CD  ,
				RT_TYP.NOTE_CONV_TP_CD     		RT_TYP_NOTE_CONV_TP_CD    ,
				RT_TYP.RT_OP_CD            		RT_TYP_RT_OP_CD           ,
				RT_TYP.CURR_CD             		RT_TYP_CURR_CD            ,
				RT_TYP.FRT_RT_AMT          		RT_TYP_FRT_RT_AMT         ,
				RT_TYP.TYP_CONV_CTNT					RT_TYP_CONV_CTNT					,

				RT_RAC.BKG_CONV_TP_CD      		RT_RAC_BKG_CONV_TP_CD     ,
				RT_RAC.NOTE_CONV_MAPG_ID   		RT_RAC_NOTE_CONV_MAPG_ID  ,
				RT_RAC.NOTE_CONV_SEQ       		RT_RAC_NOTE_CONV_SEQ      ,
				RT_RAC.NOTE_CONV_RULE_CD   		RT_RAC_NOTE_CONV_RULE_CD  ,
				RT_RAC.NOTE_CONV_TP_CD     		RT_RAC_NOTE_CONV_TP_CD    ,
				RT_RAC.RT_OP_CD            		RT_RAC_RT_OP_CD           ,
				RT_RAC.CURR_CD             		RT_RAC_CURR_CD            ,
				RT_RAC.FRT_RT_AMT          		RT_RAC_FRT_RT_AMT         ,
				RT_RAC.RAC_CONV_CTNT					RT_RAC_CONV_CTNT					,

				RT.APP_BKG_CONV_TP_CD      		RT_APP_BKG_CONV_TP_CD     ,
				RT.APP_NOTE_CONV_MAPG_ID   		RT_APP_NOTE_CONV_MAPG_ID  ,
				RT.APP_NOTE_CONV_SEQ       		RT_APP_NOTE_CONV_SEQ      ,
				RT.APP_NOTE_CONV_RULE_CD   		RT_APP_NOTE_CONV_RULE_CD  ,
				RT.APP_NOTE_CONV_TP_CD     		RT_APP_NOTE_CONV_TP_CD    ,
				RT.APP_RT_OP_CD            		RT_APP_RT_OP_CD           ,
				RT.APP_CURR_CD             		RT_APP_CURR_CD            ,
				RT.APP_FRT_RT_AMT          		RT_APP_FRT_RT_AMT         ,

				RT.RAS_BKG_CONV_TP_CD      		RT_RAS_BKG_CONV_TP_CD     ,
				RT.RAS_NOTE_CONV_MAPG_ID   		RT_RAS_NOTE_CONV_MAPG_ID  ,
				RT.RAS_NOTE_CONV_SEQ       		RT_RAS_NOTE_CONV_SEQ      ,
				RT.RAS_NOTE_CONV_RULE_CD   		RT_RAS_NOTE_CONV_RULE_CD  ,
				RT.RAS_NOTE_CONV_TP_CD     		RT_RAS_NOTE_CONV_TP_CD    ,
				RT.RAS_RT_OP_CD            		RT_RAS_RT_OP_CD           ,
				RT.RAS_CURR_CD             		RT_RAS_CURR_CD            ,
				RT.RAS_FRT_RT_AMT          		RT_RAS_FRT_RT_AMT         ,
				RT.RAS_RAS_CONV_CTNT					RT_RAS_CONV_CTNT					,

				RT.ARB_BKG_CONV_TP_CD      		RT_ARB_BKG_CONV_TP_CD     ,
				RT.ARB_NOTE_CONV_MAPG_ID   		RT_ARB_NOTE_CONV_MAPG_ID  ,
				RT.ARB_NOTE_CONV_SEQ       		RT_ARB_NOTE_CONV_SEQ      ,
				RT.ARB_NOTE_CONV_RULE_CD   		RT_ARB_NOTE_CONV_RULE_CD  ,
				RT.ARB_NOTE_CONV_TP_CD     		RT_ARB_NOTE_CONV_TP_CD    ,
				RT.ARB_RT_OP_CD            		RT_ARB_RT_OP_CD           ,
				RT.ARB_CURR_CD             		RT_ARB_CURR_CD            ,
				RT.ARB_FRT_RT_AMT          		RT_ARB_FRT_RT_AMT         ,

				RT.ADD_BKG_CONV_TP_CD      		RT_ADD_BKG_CONV_TP_CD     ,
				RT.ADD_NOTE_CONV_MAPG_ID   		RT_ADD_NOTE_CONV_MAPG_ID  ,
				RT.ADD_NOTE_CONV_SEQ       		RT_ADD_NOTE_CONV_SEQ      ,
				RT.ADD_NOTE_CONV_RULE_CD   		RT_ADD_NOTE_CONV_RULE_CD  ,
				RT.ADD_NOTE_CONV_TP_CD     		RT_ADD_NOTE_CONV_TP_CD    ,
				RT.ADD_RT_OP_CD            		RT_ADD_RT_OP_CD           ,
				RT.ADD_CURR_CD             		RT_ADD_CURR_CD            ,
				RT.ADD_FRT_RT_AMT          		RT_ADD_FRT_RT_AMT         ,

				OA_TYP.BKG_CONV_TP_CD      		OA_TYP_BKG_CONV_TP_CD     ,
				OA_TYP.NOTE_CONV_MAPG_ID   		OA_TYP_NOTE_CONV_MAPG_ID  ,
				OA_TYP.NOTE_CONV_SEQ       		OA_TYP_NOTE_CONV_SEQ      ,
				OA_TYP.NOTE_CONV_RULE_CD   		OA_TYP_NOTE_CONV_RULE_CD  ,
				OA_TYP.NOTE_CONV_TP_CD     		OA_TYP_NOTE_CONV_TP_CD    ,
				OA_TYP.RT_OP_CD            		OA_TYP_RT_OP_CD           ,
				OA_TYP.CURR_CD             		OA_TYP_CURR_CD            ,
				OA_TYP.FRT_RT_AMT          		OA_TYP_FRT_RT_AMT         ,
				OA_TYP.TYP_CONV_CTNT       		OA_TYP_CONV_CTNT         	,

				OA_RAC.BKG_CONV_TP_CD      		OA_RAC_BKG_CONV_TP_CD     ,
				OA_RAC.NOTE_CONV_MAPG_ID   		OA_RAC_NOTE_CONV_MAPG_ID  ,
				OA_RAC.NOTE_CONV_SEQ       		OA_RAC_NOTE_CONV_SEQ      ,
				OA_RAC.NOTE_CONV_RULE_CD   		OA_RAC_NOTE_CONV_RULE_CD  ,
				OA_RAC.NOTE_CONV_TP_CD     		OA_RAC_NOTE_CONV_TP_CD    ,
				OA_RAC.RT_OP_CD            		OA_RAC_RT_OP_CD           ,
				OA_RAC.CURR_CD             		OA_RAC_CURR_CD            ,
				OA_RAC.FRT_RT_AMT          		OA_RAC_FRT_RT_AMT         ,
				OA_RAC.RAC_CONV_CTNT       		OA_RAC_CONV_CTNT         	,

				DA_TYP.BKG_CONV_TP_CD      		DA_TYP_BKG_CONV_TP_CD     ,
				DA_TYP.NOTE_CONV_MAPG_ID   		DA_TYP_NOTE_CONV_MAPG_ID  ,
				DA_TYP.NOTE_CONV_SEQ       		DA_TYP_NOTE_CONV_SEQ      ,
				DA_TYP.NOTE_CONV_RULE_CD   		DA_TYP_NOTE_CONV_RULE_CD  ,
				DA_TYP.NOTE_CONV_TP_CD     		DA_TYP_NOTE_CONV_TP_CD    ,
				DA_TYP.RT_OP_CD            		DA_TYP_DA_OP_CD           ,
				DA_TYP.CURR_CD             		DA_TYP_CURR_CD            ,
				DA_TYP.FRT_RT_AMT          		DA_TYP_FRT_RT_AMT					,
				DA_TYP.TYP_CONV_CTNT       		DA_TYP_CONV_CTNT         	,

				DA_RAC.BKG_CONV_TP_CD      		DA_RAC_BKG_CONV_TP_CD     ,
				DA_RAC.NOTE_CONV_MAPG_ID   		DA_RAC_NOTE_CONV_MAPG_ID  ,
				DA_RAC.NOTE_CONV_SEQ       		DA_RAC_NOTE_CONV_SEQ      ,
				DA_RAC.NOTE_CONV_RULE_CD   		DA_RAC_NOTE_CONV_RULE_CD  ,
				DA_RAC.NOTE_CONV_TP_CD     		DA_RAC_NOTE_CONV_TP_CD    ,
				DA_RAC.RT_OP_CD            		DA_RAC_DA_OP_CD           ,
				DA_RAC.CURR_CD             		DA_RAC_CURR_CD            ,
				DA_RAC.FRT_RT_AMT          		DA_RAC_FRT_RT_AMT					,
				DA_RAC.RAC_CONV_CTNT       		DA_RAC_CONV_CTNT         	,

				'Y'														POR_MTCH_FLG							,
				'Y'														DEL_MTCH_FLG

FROM
/*******************************************************************************************
JOIN TABLE
1.1 BQ, CH, CM, CR, RD, OP, DV, DP, RT
1.2 RT RULE					: RAP, RAR, DOR, TYP, RAC, APP, RAS, ADD
2.1 OA							: O
2.2 OA RULE					: TYP, RAC ( RAP, RAR, DOR 는 RT 와 동일하게 적용 )
3.1 DA							: O
3.2 DA RULE					: TYP, RAC ( RAP, RAR, DOR 는 RT 와 동일하게 적용 )
*******************************************************************************************/
				BQ	,
				OI	,
				DA	,
				RT	,
				NC_P											RT_RAP	,			/* COMMODITY CONVERSION */
				NC_P											RT_RAR	,			/* ROUTE CONVERSION */
				NC_P											RT_DOR	,			/* R/D TERM CONVERSION */
				NC_P											RT_TYP	,			/* RATING UNIT CONVERSION */
				NC_P											RT_RAC	,			/* CARGO TYPE CONVERSION */
				NC_P											OA_TYP	,			/* RATING UNIT CONVERSION */
				NC_P											OA_RAC	,			/* CARGO TYPE CONVERSION */
				NC_P											DA_TYP	,			/* RATING UNIT CONVERSION */
				NC_P											DA_RAC				/* CARGO TYPE CONVERSION */

WHERE		RT.BQ_SEQ		=	BQ.BQ_SEQ
AND			OI.BQ_SEQ		= BQ.BQ_SEQ
AND			DA.BQ_SEQ		= BQ.BQ_SEQ
AND			RT_RAP.BQ_SEQ	= RT.BQ_SEQ AND RT_RAP.NOTE_CONV_RULE_CD = 'RAP' AND ( RT_RAP.BKG_CONV_TP_CD = 'B' OR RT_RAP.NC_SEQ = RT.RAP_NC_SEQ )
AND			RT_RAR.BQ_SEQ	= RT.BQ_SEQ AND RT_RAR.NOTE_CONV_RULE_CD = 'RAR' AND ( RT_RAR.BKG_CONV_TP_CD = 'B' OR RT_RAR.NC_SEQ = RT.RAR_NC_SEQ )
AND			RT_DOR.BQ_SEQ	= RT.BQ_SEQ AND RT_DOR.NOTE_CONV_RULE_CD = 'DOR' AND ( RT_DOR.BKG_CONV_TP_CD = 'B' OR RT_DOR.NC_SEQ = RT.DOR_NC_SEQ )
AND			RT_TYP.BQ_SEQ	= RT.BQ_SEQ AND RT_TYP.NOTE_CONV_RULE_CD = 'TYP' AND ( RT_TYP.BKG_CONV_TP_CD = 'B' OR RT_TYP.NC_SEQ = RT.TYP_NC_SEQ )
AND			RT_RAC.BQ_SEQ	= RT.BQ_SEQ AND RT_RAC.NOTE_CONV_RULE_CD = 'RAC' AND ( RT_RAC.BKG_CONV_TP_CD = 'B' OR RT_RAC.NC_SEQ = RT.RAC_NC_SEQ )
AND			OA_TYP.BQ_SEQ	= RT.BQ_SEQ AND OA_TYP.NOTE_CONV_RULE_CD = 'TYP' AND ( OA_TYP.BKG_CONV_TP_CD = 'B' OR OA_TYP.NC_SEQ = RT.TYP_NC_SEQ )
AND			OA_RAC.BQ_SEQ	= RT.BQ_SEQ AND OA_RAC.NOTE_CONV_RULE_CD = 'RAC' AND ( OA_RAC.BKG_CONV_TP_CD = 'B' OR OA_RAC.NC_SEQ = RT.RAC_NC_SEQ )
AND			DA_TYP.BQ_SEQ	= RT.BQ_SEQ AND DA_TYP.NOTE_CONV_RULE_CD = 'TYP' AND ( DA_TYP.BKG_CONV_TP_CD = 'B' OR DA_TYP.NC_SEQ = RT.TYP_NC_SEQ )
AND			DA_RAC.BQ_SEQ	= RT.BQ_SEQ AND DA_RAC.NOTE_CONV_RULE_CD = 'RAC' AND ( DA_RAC.BKG_CONV_TP_CD = 'B' OR DA_RAC.NC_SEQ = RT.RAC_NC_SEQ )


/*******************************************************************************************
	7.1 RATE
*******************************************************************************************/

/*******************************************************************************************
	7.1.1 RATE - COMMODITY
	(주의)
	COMMODITY 나 RATING UNIT 등의 조건이 위의 OA, DA, RT 와 중복조건으로 보일 수 있으나,
	OA, DA, RT 는 CONVERSION 이 정확하게 적용한 것이 아니므로, 다시한번 정확하게 조건을 연결해야 한다.
*******************************************************************************************/

/*******************************************************************************************
< COMMODITY >
그룹, 개별간으로 일치하는 경우
*******************************************************************************************/
AND			( RT.CM_PRC_CMDT_TP_CD, RT.CM_PRC_CMDT_DEF_CD ) IN
				(
				SELECT	RT_RAP.CONV_CMDT_TP_CD, RT_RAP.CONV_CMDT_DEF_CD
				FROM		DUAL
				UNION ALL
				SELECT  'C', GC.PRC_CMDT_DEF_CD
				FROM		GC
				WHERE		RT_RAP.CONV_CMDT_TP_CD	= 'G'
				AND     GC.PRC_CMDT_TP_CD   		= 'C'
				AND			GC.PRC_GRP_CMDT_CD  		= RT_RAP.CONV_CMDT_DEF_CD
				UNION ALL
				SELECT  'G', GC.PRC_GRP_CMDT_CD
				FROM		GC
				WHERE		RT_RAP.CONV_CMDT_TP_CD	= 'C'
				AND     GC.PRC_CMDT_TP_CD   		= 'C'
				AND     GC.PRC_CMDT_DEF_CD  		= RT_RAP.CONV_CMDT_DEF_CD
				UNION ALL
				/* TAW 일 경우 FAK 고려함 */
				SELECT	'C', CMDT_CD
				FROM		MDM_COMMODITY
				WHERE		REP_CMDT_CD		= '0000'
				UNION ALL
				SELECT	'G', GC.PRC_GRP_CMDT_CD
				FROM		GC
				WHERE		GC.PRC_CMDT_TP_CD		= 'C'
				AND			GC.PRC_CMDT_DEF_CD  IN ( SELECT CMDT_CD FROM MDM_COMMODITY WHERE REP_CMDT_CD = '0000' )
				)


/*******************************************************************************************
	7.1.2 RATE - ROUTE
*******************************************************************************************/

/*******************************************************************************************
< ORIGIN ( POL ) >
*******************************************************************************************/

AND     ( RT.OP_ROUT_PNT_LOC_TP_CD, RT.OP_ROUT_PNT_LOC_DEF_CD ) IN
				(
				SELECT	RT_RAR.CONV_ORG_VIA_LOC_TP_CD,	RT_RAR.CONV_ORG_VIA_LOC_DEF_CD
				FROM		DUAL
				UNION ALL
				SELECT  'L', GL.LOC_CD
				FROM		GL
				WHERE		RT_RAR.CONV_ORG_VIA_LOC_TP_CD	= 'G'
				AND		  GL.PRC_GRP_LOC_CD 				= RT_RAR.CONV_ORG_VIA_LOC_DEF_CD
				UNION ALL
				SELECT  'G', GL.PRC_GRP_LOC_CD
				FROM		GL
				WHERE		RT_RAR.CONV_ORG_VIA_LOC_TP_CD	= 'L'
				AND     GL.LOC_CD									= RT_RAR.CONV_ORG_VIA_LOC_DEF_CD
				)


/*******************************************************************************************
< ORIGIN VIA ( POL ) >
*******************************************************************************************/

AND     (
						RT.OV_ROUT_VIA_PORT_DEF_CD IS NULL
				OR	( RT.OV_ROUT_VIA_PORT_TP_CD, RT.OV_ROUT_VIA_PORT_DEF_CD ) IN
						(
						SELECT	RT_RAR.CONV_ORG_VIA_LOC_TP_CD,	RT_RAR.CONV_ORG_VIA_LOC_DEF_CD
						FROM		DUAL
						UNION ALL
						SELECT  'L', GL.LOC_CD
						FROM		GL
						WHERE		RT_RAR.CONV_ORG_VIA_LOC_TP_CD	= 'G'
						AND		  GL.PRC_GRP_LOC_CD 						= RT_RAR.CONV_ORG_VIA_LOC_DEF_CD
						UNION ALL
						SELECT  'G', GL.PRC_GRP_LOC_CD
						FROM		GL
						WHERE		RT_RAR.CONV_ORG_VIA_LOC_TP_CD	= 'L'
						AND     GL.LOC_CD											= RT_RAR.CONV_ORG_VIA_LOC_DEF_CD
						)
				)


/*******************************************************************************************
< DESTINATION VIA ( POD ) >
*******************************************************************************************/

AND     (
						RT.DV_ROUT_VIA_PORT_DEF_CD IS NULL
				OR	( RT.DV_ROUT_VIA_PORT_TP_CD, RT.DV_ROUT_VIA_PORT_DEF_CD ) IN
						(
						SELECT	RT_RAR.CONV_DEST_VIA_LOC_TP_CD,	RT_RAR.CONV_DEST_VIA_LOC_DEF_CD
						FROM		DUAL
						UNION ALL
						SELECT  'L', GL.LOC_CD
						FROM		GL
						WHERE		RT_RAR.CONV_DEST_VIA_LOC_TP_CD	= 'G'
						AND		  GL.PRC_GRP_LOC_CD 						= RT_RAR.CONV_DEST_VIA_LOC_DEF_CD
						UNION ALL
						SELECT  'G', GL.PRC_GRP_LOC_CD
						FROM		GL
						WHERE		RT_RAR.CONV_DEST_VIA_LOC_TP_CD	= 'L'
						AND     GL.LOC_CD											= RT_RAR.CONV_DEST_VIA_LOC_DEF_CD
						)
				)


/*******************************************************************************************
< DESTINATION ( POD ) >
*******************************************************************************************/

AND     ( RT.DP_ROUT_PNT_LOC_TP_CD, RT.DP_ROUT_PNT_LOC_DEF_CD ) IN
				(
				SELECT	RT_RAR.CONV_DEST_VIA_LOC_TP_CD,	RT_RAR.CONV_DEST_VIA_LOC_DEF_CD
				FROM		DUAL
				UNION ALL
				SELECT  'L', GL.LOC_CD
				FROM		GL
				WHERE		RT_RAR.CONV_DEST_VIA_LOC_TP_CD	= 'G'
				AND		  GL.PRC_GRP_LOC_CD 				= RT_RAR.CONV_DEST_VIA_LOC_DEF_CD
				UNION ALL
				SELECT  'G', GL.PRC_GRP_LOC_CD
				FROM		GL
				WHERE		RT_RAR.CONV_DEST_VIA_LOC_TP_CD	= 'L'
				AND     GL.LOC_CD									= RT_RAR.CONV_DEST_VIA_LOC_DEF_CD
				)


/*******************************************************************************************
	7.1.3 RATE - RATING UNIT
*******************************************************************************************/

AND     (
								RT.RAT_UT_CD	= RT_TYP.CONV_RAT_UT_CD
		        OR
    		    (
        				RT.RAT_UT_CD	IN ( '20', '40', 'HC', '45', '53' )
       			AND ( SELECT A.CNTR_SZ_CD FROM PRI_RAT_UT A WHERE A.RAT_UT_CD = RT.RAT_UT_CD )	= RT_TYP.CONV_RAT_UT_SZ_CD
        		)
				)

AND			RT.PRC_CGO_TP_CD	IN ( RT_RAC.CONV_DR_TP, RT_RAC.CONV_DG_TP, RT_RAC.CONV_RF_TP, RT_RAC.CONV_AK_TP, RT_RAC.CONV_BB_TP )


/*******************************************************************************************
	7.2 ORIGIN IHC
*******************************************************************************************/

/*******************************************************************************************
	7.2.2 ORIGIN IHC - ROUTE
*******************************************************************************************/

/*******************************************************************************************
< POINT ( POR ) >
*******************************************************************************************/

AND     ( OI.ROUT_PNT_LOC_TP_CD, OI.ROUT_PNT_LOC_DEF_CD ) IN
				(
				SELECT  RT_RAR.CONV_ORG_LOC_TP_CD, RT_RAR.CONV_ORG_LOC_DEF_CD
				FROM		DUAL
				UNION ALL
				SELECT  'L', GL.LOC_CD
				FROM		GL
				WHERE		RT_RAR.CONV_ORG_LOC_TP_CD	= 'G'
				AND		  GL.PRC_GRP_LOC_CD 				= RT_RAR.CONV_ORG_LOC_DEF_CD
				UNION ALL
				SELECT  'G', GL.PRC_GRP_LOC_CD
				FROM		GL
				WHERE		RT_RAR.CONV_ORG_LOC_TP_CD	= 'L'
				AND     GL.LOC_CD									= RT_RAR.CONV_ORG_LOC_DEF_CD
				)


/*******************************************************************************************
< RCV TERM >
*******************************************************************************************/

AND     NVL(OI.RCV_DE_TERM_CD, '*') IN
				(
				SELECT  B.RCV_DE_TERM_CD
				FROM		(
								SELECT 'Y' CONV_PRC_TERM_CD, 'Y' RCV_DE_TERM_CD FROM DUAL UNION ALL
								SELECT 'Y' CONV_PRC_TERM_CD, 'L' RCV_DE_TERM_CD FROM DUAL UNION ALL
								SELECT 'Y' CONV_PRC_TERM_CD, '*' RCV_DE_TERM_CD FROM DUAL UNION ALL
								SELECT 'S' CONV_PRC_TERM_CD, 'S' RCV_DE_TERM_CD FROM DUAL UNION ALL
								SELECT 'D' CONV_PRC_TERM_CD, 'D' RCV_DE_TERM_CD FROM DUAL UNION ALL
								SELECT 'T' CONV_PRC_TERM_CD, 'T' RCV_DE_TERM_CD FROM DUAL UNION ALL
								SELECT 'I' CONV_PRC_TERM_CD, 'I' RCV_DE_TERM_CD FROM DUAL
								)	B
				WHERE		B.CONV_PRC_TERM_CD	= RT_DOR.CONV_PRC_RCV_TERM_CD
				)


/*******************************************************************************************
< BASE PORT ( POL ) >
*******************************************************************************************/

AND     ( OI.BSE_PORT_TP_CD, OI.BSE_PORT_DEF_CD ) IN
				(
				SELECT  RT_RAR.CONV_ORG_VIA_LOC_TP_CD, RT_RAR.CONV_ORG_VIA_LOC_DEF_CD
				FROM		DUAL
				UNION ALL
				SELECT  'L', GL.LOC_CD
				FROM		GL
				WHERE		RT_RAR.CONV_ORG_VIA_LOC_TP_CD	= 'G'
				AND		  GL.PRC_GRP_LOC_CD 				= RT_RAR.CONV_ORG_VIA_LOC_DEF_CD
				UNION ALL
				SELECT  'G', GL.PRC_GRP_LOC_CD
				FROM		GL
				WHERE		RT_RAR.CONV_ORG_VIA_LOC_TP_CD	= 'L'
				AND     GL.LOC_CD									= RT_RAR.CONV_ORG_VIA_LOC_DEF_CD
				)


/*******************************************************************************************
	7.2.3 ORIGIN IHC - RATING UNIT
*******************************************************************************************/

/* ORIGIN ARB RATING UNIT */
AND     (
								OI.RAT_UT_CD	= OA_TYP.CONV_RAT_UT_CD
		        OR	OI.RAT_UT_CD	= 'BX'
		        OR
    		    (
        				OI.RAT_UT_CD	IN ( '20', '40', 'HC', '45', '53' )
       			AND ( SELECT A.CNTR_SZ_CD FROM PRI_RAT_UT A WHERE A.RAT_UT_CD = OI.RAT_UT_CD )	= OA_TYP.CONV_RAT_UT_SZ_CD
        		)
				)


/* ORIGIN ARB CARGO TYPE */
AND			NVL(OI.PRC_CGO_TP_CD, '*')	IN ( '*', OA_RAC.CONV_DR_TP, OA_RAC.CONV_DG_TP, OA_RAC.CONV_RF_TP, OA_RAC.CONV_AK_TP, OA_RAC.CONV_BB_TP )


/*******************************************************************************************
	7.2.4 ORIGIN ARB - JOIN
*******************************************************************************************/

/* ORIGIN ARB JOIN ( ARB CONV RULE ) */
AND			DECODE(RT.ARB_RT_APPL_TP_CD, NULL, DECODE(RT.GEN_SPCL_RT_TP_CD, 'S', 'N', 'Y'), 'N', 'N', 'Y') = 'Y'

/* ORIGIN ARB JOIN ( DIHC.BPORT = RATE.DEST ) */
AND			NVL(RT.OP_RCV_DE_TERM_CD, '*' )	NOT IN ( 'D', 'S' )

AND			( RT.OP_ROUT_PNT_LOC_TP_CD, RT.OP_ROUT_PNT_LOC_DEF_CD ) IN
				(
				SELECT	OI.BSE_PORT_TP_CD, OI.BSE_PORT_DEF_CD
				FROM		DUAL
				UNION ALL
				SELECT	'L', GL.LOC_CD
				FROM		GL
				WHERE		OI.BSE_PORT_TP_CD	= 'G'
				AND		  GL.PRC_GRP_LOC_CD	= OI.BSE_PORT_DEF_CD
				UNION ALL
				SELECT	'G', GL.PRC_GRP_LOC_CD
				FROM		GL
				WHERE		OI.BSE_PORT_TP_CD	= 'L'
				AND			GL.LOC_CD					= OI.BSE_PORT_DEF_CD
				)


/*******************************************************************************************
	4.3 DEST ARB
*******************************************************************************************/

/*******************************************************************************************
	4.3.1 DEST ARB - COMMODITY
*******************************************************************************************/

AND			(
						DA.PRC_CMDT_DEF_CD	IS NULL
				OR	( DA.PRC_CMDT_TP_CD, DA.PRC_CMDT_DEF_CD ) IN
						(
						SELECT	RT_RAP.CONV_CMDT_TP_CD, RT_RAP.CONV_CMDT_DEF_CD
						FROM		DUAL
						UNION ALL
						SELECT  'C', GC.PRC_CMDT_DEF_CD
						FROM		GC
						WHERE		RT_RAP.CONV_CMDT_TP_CD	= 'G'
						AND     GC.PRC_CMDT_TP_CD   		= 'C'
						AND			GC.PRC_GRP_CMDT_CD  		= RT_RAP.CONV_CMDT_DEF_CD
						UNION ALL
						SELECT  'G', GC.PRC_GRP_CMDT_CD
						FROM		GC
						WHERE		RT_RAP.CONV_CMDT_TP_CD	= 'C'
						AND     GC.PRC_CMDT_TP_CD   		= 'C'
						AND     GC.PRC_CMDT_DEF_CD  		= RT_RAP.CONV_CMDT_DEF_CD
						UNION ALL
						/* TAW 일 경우 FAK 고려함 */
						SELECT	'C', CMDT_CD
						FROM		MDM_COMMODITY
						WHERE		REP_CMDT_CD		= '0000'
						UNION ALL
						SELECT	'G', GC.PRC_GRP_CMDT_CD
						FROM		GC
						WHERE		GC.PRC_CMDT_TP_CD		= 'C'
						AND			GC.PRC_CMDT_DEF_CD  IN ( SELECT CMDT_CD FROM MDM_COMMODITY WHERE REP_CMDT_CD = '0000' )
						)
				)


/*******************************************************************************************
	7.3.2 DEST ARB - ROUTE
*******************************************************************************************/

/*******************************************************************************************
< VIA PORT ( POD ) >
*******************************************************************************************/

AND     (
                DA.VIA_PORT_DEF_CD  IS NULL
            OR	( DA.VIA_PORT_TP_CD, DA.VIA_PORT_DEF_CD ) IN
								(
								SELECT  RT_RAR.CONV_DEST_VIA_LOC_TP_CD, RT_RAR.CONV_DEST_VIA_LOC_DEF_CD
								FROM		DUAL
								UNION ALL
								SELECT  'L', GL.LOC_CD
								FROM		GL
								WHERE		RT_RAR.CONV_DEST_VIA_LOC_TP_CD	= 'G'
								AND		  GL.PRC_GRP_LOC_CD 				= RT_RAR.CONV_DEST_VIA_LOC_DEF_CD
								UNION ALL
								SELECT  'G', GL.PRC_GRP_LOC_CD
								FROM		GL
								WHERE		RT_RAR.CONV_DEST_VIA_LOC_TP_CD	= 'L'
								AND     GL.LOC_CD									= RT_RAR.CONV_DEST_VIA_LOC_DEF_CD
								)
        )


/*******************************************************************************************
< POINT ( DEL ) >
*******************************************************************************************/

AND     ( DA.ROUT_PNT_LOC_TP_CD, DA.ROUT_PNT_LOC_DEF_CD ) IN
				(
				SELECT  RT_RAR.CONV_DEST_LOC_TP_CD, RT_RAR.CONV_DEST_LOC_DEF_CD
				FROM		DUAL
				UNION ALL
				SELECT  'L', GL.LOC_CD
				FROM		GL
				WHERE		RT_RAR.CONV_DEST_LOC_TP_CD	= 'G'
				AND		  GL.PRC_GRP_LOC_CD 				= RT_RAR.CONV_DEST_LOC_DEF_CD
				UNION ALL
				SELECT  'G', GL.PRC_GRP_LOC_CD
				FROM		GL
				WHERE		RT_RAR.CONV_DEST_LOC_TP_CD	= 'L'
				AND     GL.LOC_CD									= RT_RAR.CONV_DEST_LOC_DEF_CD
				)


/*******************************************************************************************
< DE TERM >
*******************************************************************************************/

AND			NVL(DA.RCV_DE_TERM_CD, '*') IN
				(
				SELECT  B.RCV_DE_TERM_CD
				FROM		(
								SELECT 'Y' CONV_PRC_TERM_CD, 'Y' RCV_DE_TERM_CD FROM DUAL UNION ALL
								SELECT 'Y' CONV_PRC_TERM_CD, 'L' RCV_DE_TERM_CD FROM DUAL UNION ALL
								SELECT 'Y' CONV_PRC_TERM_CD, '*' RCV_DE_TERM_CD FROM DUAL UNION ALL
								SELECT 'S' CONV_PRC_TERM_CD, 'S' RCV_DE_TERM_CD FROM DUAL UNION ALL
								SELECT 'S' CONV_PRC_TERM_CD, 'Y' RCV_DE_TERM_CD FROM DUAL UNION ALL
								SELECT 'S' CONV_PRC_TERM_CD, 'T' RCV_DE_TERM_CD FROM DUAL UNION ALL
								SELECT 'S' CONV_PRC_TERM_CD, 'I' RCV_DE_TERM_CD FROM DUAL UNION ALL
								SELECT 'S' CONV_PRC_TERM_CD, 'L' RCV_DE_TERM_CD FROM DUAL UNION ALL
								SELECT 'S' CONV_PRC_TERM_CD, '*' RCV_DE_TERM_CD FROM DUAL UNION ALL
								SELECT 'D' CONV_PRC_TERM_CD, 'D' RCV_DE_TERM_CD FROM DUAL UNION ALL
								SELECT 'T' CONV_PRC_TERM_CD, 'T' RCV_DE_TERM_CD FROM DUAL UNION ALL
								SELECT 'I' CONV_PRC_TERM_CD, 'I' RCV_DE_TERM_CD FROM DUAL
								)	B
				WHERE		B.CONV_PRC_TERM_CD	= RT_DOR.CONV_PRC_DE_TERM_CD
				)


/*******************************************************************************************
< DEST TRANS MODE >
*******************************************************************************************/

AND     (
						DA.PRC_TRSP_MOD_CD		IS NULL
				OR	BQ.DEST_TRNS_MOD_CD		IS NULL
				OR	DA.PRC_TRSP_MOD_CD		= BQ.DEST_TRNS_MOD_CD
				OR  (
								DA.PRC_TRSP_MOD_CD		IN ( 'R', 'A' )
						AND	BQ.DEST_TRNS_MOD_CD		= 'R'
						)
				)


/*******************************************************************************************
	7.2.3 DEST ARB - RATING UNIT
*******************************************************************************************/

/* DEST ARB RATING UNIT */
AND     (
								DA.RAT_UT_CD	= DA_TYP.CONV_RAT_UT_CD
		        OR	DA.RAT_UT_CD	= 'BX'
		        OR
    		    (
        				DA.RAT_UT_CD	IN ( '20', '40', 'HC', '45', '53' )
       			AND ( SELECT A.CNTR_SZ_CD FROM PRI_RAT_UT A WHERE A.RAT_UT_CD = DA.RAT_UT_CD )	= DA_TYP.CONV_RAT_UT_SZ_CD
        		)
				)


/* DEST ARB CARGO TYPE */
AND			NVL(DA.PRC_CGO_TP_CD, '*')	IN ( '*', DA_RAC.CONV_DR_TP, DA_RAC.CONV_DG_TP, DA_RAC.CONV_RF_TP, DA_RAC.CONV_AK_TP, DA_RAC.CONV_BB_TP )


/*******************************************************************************************
	7.2.4 DEST ARB - JOIN
*******************************************************************************************/

/* DEST ARB JOIN ( ADD CONV RULE ) */
AND			DECODE(RT.ADD_RT_APPL_TP_CD, NULL, DECODE(RT.GEN_SPCL_RT_TP_CD, 'S', 'N', 'Y'), 'N', 'N', 'Y') = 'Y'

/* DEST ARB JOIN ( DARB.BPORT = RATE.DEST ) */
AND			NVL(RT.DP_RCV_DE_TERM_CD, '*' )	NOT IN ( 'D', 'S' )

AND			( RT.DP_ROUT_PNT_LOC_TP_CD, RT.DP_ROUT_PNT_LOC_DEF_CD ) IN
				(
				SELECT	DA.BSE_PORT_TP_CD, DA.BSE_PORT_DEF_CD
				FROM		DUAL
				UNION ALL
				SELECT	'L', GL.LOC_CD
				FROM		GL
				WHERE		DA.BSE_PORT_TP_CD	= 'G'
				AND		  GL.PRC_GRP_LOC_CD	= DA.BSE_PORT_DEF_CD
				UNION ALL
				SELECT	'G', GL.PRC_GRP_LOC_CD
				FROM		GL
				WHERE		DA.BSE_PORT_TP_CD	= 'L'
				AND			GL.LOC_CD					= DA.BSE_PORT_DEF_CD
				)


UNION ALL


/*******************************************************************************************
	8. PATTERN #8 ( 1110 )
*******************************************************************************************/

SELECT	'1110'												PRC_RT_MTCH_PATT_CD				,
				BQ.SC_NO											CTRT_NO										,
				BQ.PROP_NO										PROP_NO										,
				BQ.AMDT_SEQ										AMDT_SEQ									,
				BQ.SVC_SCP_CD									SVC_SCP_CD								,
				BQ.BQ_SEQ											BQ_SEQ										,
				BQ.BKG_BQ_SEQ									BKG_BQ_SEQ								,
				BQ.CNTR_TPSZ_CD								BQ_CNTR_TPSZ_CD						,
				BQ.CTRT_CNTR_TPSZ_CD					BQ_CTRT_CNTR_TPSZ_CD			,
				BQ.RCV_TERM_CD								BQ_RCV_TERM_CD						,
				BQ.DE_TERM_CD									BQ_DE_TERM_CD							,
				BQ.DRY_CGO_FLG								BQ_DRY_CGO_FLG						,
				BQ.DCGO_FLG										BQ_DCGO_FLG								,
				BQ.RC_FLG											BQ_RC_FLG									,
				BQ.AWK_CGO_FLG								BQ_AWK_CGO_FLG						,
				BQ.BB_CGO_FLG									BQ_BB_CGO_FLG							,
				BQ.SOC_FLG										BQ_SOC_FLG								,
				BQ.PRC_CGO_TP_CD							BQ_PRC_CGO_TP_CD					,
				BQ.IMDG_CLSS_CD								BQ_IMDG_CLSS_CD						,
				BQ.CTRT_CNTR_QTY							BQ_CTRT_CNTR_QTY					,
				BQ.POR_APPL_FLG								BQ_POR_APPL_FLG						,
				BQ.POL_APPL_FLG								BQ_POL_APPL_FLG						,
				BQ.POD_APPL_FLG								BQ_POD_APPL_FLG						,
				BQ.DEL_APPL_FLG								BQ_DEL_APPL_FLG						,
				BQ.PRE_RLY_PORT_APPL_FLG			BQ_POR_RLY_PORT_APPL_FLG	,
				BQ.PST_RLY_PORT_APPL_FLG			BQ_PST_RLY_PORT_APPL_FLG	,

				RT.CMDT_HDR_SEQ								RT_CMDT_HDR_SEQ						,
				RT.ROUT_SEQ										RT_ROUT_SEQ								,
				RT.RT_SEQ											RT_RT_SEQ									,
				OI.ADD_CHG_SEQ								OI_ADD_CHG_SEQ						,
				OA.ADD_CHG_SEQ								OA_ADD_CHG_SEQ						,
				DA.ADD_CHG_SEQ								DA_ADD_CHG_SEQ						,
				0															DI_ADD_CHG_SEQ						,

				RT.GEN_SPCL_RT_TP_CD					RT_GEN_SPCL_RT_TP_CD			,
				RT.CM_PRC_CMDT_TP_CD					CM_PRC_CMDT_TP_CD					,
				RT.CM_PRC_CMDT_DEF_CD					CM_PRC_CMDT_DEF_CD				,
				OI.ROUT_PNT_LOC_DEF_CD				POR_CD										,
				OA.ROUT_PNT_LOC_DEF_CD				POL_CD										,
				RT.DP_ROUT_PNT_LOC_DEF_CD			POD_CD										,
				DA.ROUT_PNT_LOC_DEF_CD				DEL_CD										,
				DECODE(OA.DIR_CALL_FLG, 'Y', 'Y', DECODE(DA.DIR_CALL_FLG, 'Y', 'Y', 'N'))	DIR_CALL_FLG		,
				OI.RCV_DE_TERM_CD							RCV_TERM_CD								,
				DA.RCV_DE_TERM_CD							DE_TERM_CD								,
				RT.RAT_UT_CD									RAT_UT_CD									,
				RT.PRC_CGO_TP_CD							PRC_CGO_TP_CD							,
				RT.CURR_CD										CURR_CD										,
				OI.PRC_TRSP_MOD_CD						ORG_TRSP_MOD_CD						,
				DA.PRC_TRSP_MOD_CD						DEST_TRSP_MOD_CD					,

				RT.OP_ROUT_PNT_LOC_DEF_CD			OP_ROUT_PNT_LOC_DEF_CD		,
				RT.OV_ROUT_VIA_PORT_DEF_CD		OV_ROUT_VIA_PORT_DEF_CD		,
				RT.DV_ROUT_VIA_PORT_DEF_CD		DV_ROUT_VIA_PORT_DEF_CD		,
				RT.DP_ROUT_PNT_LOC_DEF_CD			DP_ROUT_PNT_LOC_DEF_CD		,
				RT.RD_DIR_CALL_FLG						RD_DIR_CALL_FLG						,
				RT.RAT_UT_CD									RT_RAT_UT_CD							,
				RT.PRC_CGO_TP_CD							RT_PRC_CGO_TP_CD					,
				RT.OP_PRC_TRSP_MOD_CD					OP_PRC_TRSP_MOD_CD				,
				RT.DP_PRC_TRSP_MOD_CD					DP_PRC_TRSP_MOD_CD				,
				RT.CURR_CD										RT_CURR_CD								,
				RT.FNL_FRT_RT_AMT							RT_FNL_FRT_RT_AMT					,

				OI.ROUT_PNT_LOC_DEF_CD				OI_ROUT_PNT_LOC_DEF_CD		,
				OI.BSE_PORT_DEF_CD						OI_BSE_PORT_DEF_CD				,
				OI.VIA_PORT_DEF_CD						OI_VIA_PORT_DEF_CD				,
				OI.DIR_CALL_FLG								OI_DIR_CALL_FLG						,
				OI.RAT_UT_CD									OI_RAT_UT_CD							,
				OI.PRC_CGO_TP_CD							OI_PRC_CGO_TP_CD					,
				OI.PRC_TRSP_MOD_CD						OI_PRC_TRSP_MOD_CD				,
				OI.RCV_DE_TERM_CD							OI_RCV_DE_TERM_CD					,
				OI.PRC_CMDT_DEF_CD						OI_PRC_CMDT_DEF_CD				,
				OI.CURR_CD										OI_CURR_CD								,
				OI.FNL_FRT_RT_AMT							OI_FNL_FRT_RT_AMT					,
				OI.RAT_UT_MTCH_PRIO						OI_RAT_UT_MTCH_PRIO				,

				OA.ROUT_PNT_LOC_DEF_CD				OA_ROUT_PNT_LOC_DEF_CD		,
				OA.BSE_PORT_DEF_CD						OA_BSE_PORT_DEF_CD				,
				OA.VIA_PORT_DEF_CD						OA_VIA_PORT_DEF_CD				,
				OA.DIR_CALL_FLG								OA_DIR_CALL_FLG						,
				OA.RAT_UT_CD									OA_RAT_UT_CD							,
				OA.PRC_CGO_TP_CD							OA_PRC_CGO_TP_CD					,
				OA.PRC_TRSP_MOD_CD						OA_PRC_TRSP_MOD_CD				,
				OA.RCV_DE_TERM_CD							OA_RCV_DE_TERM_CD					,
				OA.PRC_CMDT_DEF_CD						OA_PRC_CMDT_DEF_CD				,
				OA.CURR_CD										OA_CURR_CD								,
				OA.FNL_FRT_RT_AMT							OA_FNL_FRT_RT_AMT					,
				OA.RAT_UT_MTCH_PRIO						OA_RAT_UT_MTCH_PRIO				,

				DA.ROUT_PNT_LOC_DEF_CD				DA_ROUT_PNT_LOC_DEF_CD		,
				DA.BSE_PORT_DEF_CD						DA_BSE_PORT_DEF_CD				,
				DA.VIA_PORT_DEF_CD						DA_VIA_PORT_DEF_CD				,
				DA.DIR_CALL_FLG								DA_DIR_CALL_FLG						,
				DA.RAT_UT_CD									DA_RAT_UT_CD							,
				DA.PRC_CGO_TP_CD							DA_PRC_CGO_TP_CD					,
				DA.PRC_TRSP_MOD_CD						DA_PRC_TRSP_MOD_CD				,
				DA.RCV_DE_TERM_CD							DA_RCV_DE_TERM_CD					,
				DA.PRC_CMDT_DEF_CD						DA_PRC_CMDT_DEF_CD				,
				DA.CURR_CD										DA_CURR_CD								,
				DA.FNL_FRT_RT_AMT							DA_FNL_FRT_RT_AMT					,
				DA.RAT_UT_MTCH_PRIO						DA_RAT_UT_MTCH_PRIO				,

				NULL													DI_ROUT_PNT_LOC_DEF_CD		,
				NULL													DI_BSE_PORT_DEF_CD				,
				NULL													DI_VIA_PORT_DEF_CD				,
				NULL													DI_DIR_CALL_FLG						,
				NULL													DI_RAT_UT_CD							,
				NULL													DI_PRC_CGO_TP_CD					,
				NULL													DI_PRC_TRSP_MOD_CD				,
				NULL													DI_RCV_DE_TERM_CD					,
				NULL													DI_PRC_CMDT_DEF_CD				,
				NULL													DI_CURR_CD								,
				NULL													DI_FNL_FRT_RT_AMT					,
				NULL													DI_RAT_UT_MTCH_PRIO				,

				RT_RAP.BKG_CONV_TP_CD      		RT_RAP_BKG_CONV_TP_CD			,
				RT_RAP.NOTE_CONV_MAPG_ID   		RT_RAP_NOTE_CONV_MAPG_ID  ,
				RT_RAP.NOTE_CONV_SEQ       		RT_RAP_NOTE_CONV_SEQ      ,
				RT_RAP.NOTE_CONV_RULE_CD   		RT_RAP_NOTE_CONV_RULE_CD  ,
				RT_RAP.NOTE_CONV_TP_CD     		RT_RAP_NOTE_CONV_TP_CD    ,
				RT_RAP.RT_OP_CD            		RT_RAP_RT_OP_CD           ,
				RT_RAP.CURR_CD             		RT_RAP_CURR_CD            ,
				RT_RAP.FRT_RT_AMT          		RT_RAP_FRT_RT_AMT         ,
				RT_RAP.RAP_CONV_CTNT					RT_RAP_CONV_CTNT					,

				RT_RAR.BKG_CONV_TP_CD      		RT_RAR_BKG_CONV_TP_CD     ,
				RT_RAR.NOTE_CONV_MAPG_ID   		RT_RAR_NOTE_CONV_MAPG_ID  ,
				RT_RAR.NOTE_CONV_SEQ       		RT_RAR_NOTE_CONV_SEQ      ,
				RT_RAR.NOTE_CONV_RULE_CD   		RT_RAR_NOTE_CONV_RULE_CD  ,
				RT_RAR.NOTE_CONV_TP_CD     		RT_RAR_NOTE_CONV_TP_CD    ,
				RT_RAR.RT_OP_CD            		RT_RAR_RT_OP_CD           ,
				RT_RAR.CURR_CD             		RT_RAR_CURR_CD            ,
				RT_RAR.FRT_RT_AMT          		RT_RAR_FRT_RT_AMT         ,
				RT_RAR.RAR_CONV_CTNT					RT_RAR_CONV_CTNT					,

				RT_DOR.BKG_CONV_TP_CD      		RT_DOR_BKG_CONV_TP_CD     ,
				RT_DOR.NOTE_CONV_MAPG_ID   		RT_DOR_NOTE_CONV_MAPG_ID  ,
				RT_DOR.NOTE_CONV_SEQ       		RT_DOR_NOTE_CONV_SEQ      ,
				RT_DOR.NOTE_CONV_RULE_CD   		RT_DOR_NOTE_CONV_RULE_CD  ,
				RT_DOR.NOTE_CONV_TP_CD     		RT_DOR_NOTE_CONV_TP_CD    ,
				RT_DOR.RT_OP_CD            		RT_DOR_RT_OP_CD           ,
				RT_DOR.CURR_CD             		RT_DOR_CURR_CD            ,
				RT_DOR.FRT_RT_AMT          		RT_DOR_FRT_RT_AMT         ,
				RT_DOR.DOR_CONV_CTNT					RT_DOR_CONV_CTNT					,

				RT_TYP.BKG_CONV_TP_CD      		RT_TYP_BKG_CONV_TP_CD     ,
				RT_TYP.NOTE_CONV_MAPG_ID   		RT_TYP_NOTE_CONV_MAPG_ID  ,
				RT_TYP.NOTE_CONV_SEQ       		RT_TYP_NOTE_CONV_SEQ      ,
				RT_TYP.NOTE_CONV_RULE_CD   		RT_TYP_NOTE_CONV_RULE_CD  ,
				RT_TYP.NOTE_CONV_TP_CD     		RT_TYP_NOTE_CONV_TP_CD    ,
				RT_TYP.RT_OP_CD            		RT_TYP_RT_OP_CD           ,
				RT_TYP.CURR_CD             		RT_TYP_CURR_CD            ,
				RT_TYP.FRT_RT_AMT          		RT_TYP_FRT_RT_AMT         ,
				RT_TYP.TYP_CONV_CTNT					RT_TYP_CONV_CTNT					,

				RT_RAC.BKG_CONV_TP_CD      		RT_RAC_BKG_CONV_TP_CD     ,
				RT_RAC.NOTE_CONV_MAPG_ID   		RT_RAC_NOTE_CONV_MAPG_ID  ,
				RT_RAC.NOTE_CONV_SEQ       		RT_RAC_NOTE_CONV_SEQ      ,
				RT_RAC.NOTE_CONV_RULE_CD   		RT_RAC_NOTE_CONV_RULE_CD  ,
				RT_RAC.NOTE_CONV_TP_CD     		RT_RAC_NOTE_CONV_TP_CD    ,
				RT_RAC.RT_OP_CD            		RT_RAC_RT_OP_CD           ,
				RT_RAC.CURR_CD             		RT_RAC_CURR_CD            ,
				RT_RAC.FRT_RT_AMT          		RT_RAC_FRT_RT_AMT         ,
				RT_RAC.RAC_CONV_CTNT					RT_RAC_CONV_CTNT					,

				RT.APP_BKG_CONV_TP_CD      		RT_APP_BKG_CONV_TP_CD     ,
				RT.APP_NOTE_CONV_MAPG_ID   		RT_APP_NOTE_CONV_MAPG_ID  ,
				RT.APP_NOTE_CONV_SEQ       		RT_APP_NOTE_CONV_SEQ      ,
				RT.APP_NOTE_CONV_RULE_CD   		RT_APP_NOTE_CONV_RULE_CD  ,
				RT.APP_NOTE_CONV_TP_CD     		RT_APP_NOTE_CONV_TP_CD    ,
				RT.APP_RT_OP_CD            		RT_APP_RT_OP_CD           ,
				RT.APP_CURR_CD             		RT_APP_CURR_CD            ,
				RT.APP_FRT_RT_AMT          		RT_APP_FRT_RT_AMT         ,

				RT.RAS_BKG_CONV_TP_CD      		RT_RAS_BKG_CONV_TP_CD     ,
				RT.RAS_NOTE_CONV_MAPG_ID   		RT_RAS_NOTE_CONV_MAPG_ID  ,
				RT.RAS_NOTE_CONV_SEQ       		RT_RAS_NOTE_CONV_SEQ      ,
				RT.RAS_NOTE_CONV_RULE_CD   		RT_RAS_NOTE_CONV_RULE_CD  ,
				RT.RAS_NOTE_CONV_TP_CD     		RT_RAS_NOTE_CONV_TP_CD    ,
				RT.RAS_RT_OP_CD            		RT_RAS_RT_OP_CD           ,
				RT.RAS_CURR_CD             		RT_RAS_CURR_CD            ,
				RT.RAS_FRT_RT_AMT          		RT_RAS_FRT_RT_AMT         ,
				RT.RAS_RAS_CONV_CTNT					RT_RAS_CONV_CTNT					,

				RT.ARB_BKG_CONV_TP_CD      		RT_ARB_BKG_CONV_TP_CD     ,
				RT.ARB_NOTE_CONV_MAPG_ID   		RT_ARB_NOTE_CONV_MAPG_ID  ,
				RT.ARB_NOTE_CONV_SEQ       		RT_ARB_NOTE_CONV_SEQ      ,
				RT.ARB_NOTE_CONV_RULE_CD   		RT_ARB_NOTE_CONV_RULE_CD  ,
				RT.ARB_NOTE_CONV_TP_CD     		RT_ARB_NOTE_CONV_TP_CD    ,
				RT.ARB_RT_OP_CD            		RT_ARB_RT_OP_CD           ,
				RT.ARB_CURR_CD             		RT_ARB_CURR_CD            ,
				RT.ARB_FRT_RT_AMT          		RT_ARB_FRT_RT_AMT         ,

				RT.ADD_BKG_CONV_TP_CD      		RT_ADD_BKG_CONV_TP_CD     ,
				RT.ADD_NOTE_CONV_MAPG_ID   		RT_ADD_NOTE_CONV_MAPG_ID  ,
				RT.ADD_NOTE_CONV_SEQ       		RT_ADD_NOTE_CONV_SEQ      ,
				RT.ADD_NOTE_CONV_RULE_CD   		RT_ADD_NOTE_CONV_RULE_CD  ,
				RT.ADD_NOTE_CONV_TP_CD     		RT_ADD_NOTE_CONV_TP_CD    ,
				RT.ADD_RT_OP_CD            		RT_ADD_RT_OP_CD           ,
				RT.ADD_CURR_CD             		RT_ADD_CURR_CD            ,
				RT.ADD_FRT_RT_AMT          		RT_ADD_FRT_RT_AMT         ,

				OA_TYP.BKG_CONV_TP_CD      		OA_TYP_BKG_CONV_TP_CD     ,
				OA_TYP.NOTE_CONV_MAPG_ID   		OA_TYP_NOTE_CONV_MAPG_ID  ,
				OA_TYP.NOTE_CONV_SEQ       		OA_TYP_NOTE_CONV_SEQ      ,
				OA_TYP.NOTE_CONV_RULE_CD   		OA_TYP_NOTE_CONV_RULE_CD  ,
				OA_TYP.NOTE_CONV_TP_CD     		OA_TYP_NOTE_CONV_TP_CD    ,
				OA_TYP.RT_OP_CD            		OA_TYP_RT_OP_CD           ,
				OA_TYP.CURR_CD             		OA_TYP_CURR_CD            ,
				OA_TYP.FRT_RT_AMT          		OA_TYP_FRT_RT_AMT         ,
				OA_TYP.TYP_CONV_CTNT       		OA_TYP_CONV_CTNT         	,

				OA_RAC.BKG_CONV_TP_CD      		OA_RAC_BKG_CONV_TP_CD     ,
				OA_RAC.NOTE_CONV_MAPG_ID   		OA_RAC_NOTE_CONV_MAPG_ID  ,
				OA_RAC.NOTE_CONV_SEQ       		OA_RAC_NOTE_CONV_SEQ      ,
				OA_RAC.NOTE_CONV_RULE_CD   		OA_RAC_NOTE_CONV_RULE_CD  ,
				OA_RAC.NOTE_CONV_TP_CD     		OA_RAC_NOTE_CONV_TP_CD    ,
				OA_RAC.RT_OP_CD            		OA_RAC_RT_OP_CD           ,
				OA_RAC.CURR_CD             		OA_RAC_CURR_CD            ,
				OA_RAC.FRT_RT_AMT          		OA_RAC_FRT_RT_AMT         ,
				OA_RAC.RAC_CONV_CTNT       		OA_RAC_CONV_CTNT         	,

				DA_TYP.BKG_CONV_TP_CD      		DA_TYP_BKG_CONV_TP_CD     ,
				DA_TYP.NOTE_CONV_MAPG_ID   		DA_TYP_NOTE_CONV_MAPG_ID  ,
				DA_TYP.NOTE_CONV_SEQ       		DA_TYP_NOTE_CONV_SEQ      ,
				DA_TYP.NOTE_CONV_RULE_CD   		DA_TYP_NOTE_CONV_RULE_CD  ,
				DA_TYP.NOTE_CONV_TP_CD     		DA_TYP_NOTE_CONV_TP_CD    ,
				DA_TYP.RT_OP_CD            		DA_TYP_DA_OP_CD           ,
				DA_TYP.CURR_CD             		DA_TYP_CURR_CD            ,
				DA_TYP.FRT_RT_AMT          		DA_TYP_FRT_RT_AMT					,
				DA_TYP.TYP_CONV_CTNT       		DA_TYP_CONV_CTNT         	,

				DA_RAC.BKG_CONV_TP_CD      		DA_RAC_BKG_CONV_TP_CD     ,
				DA_RAC.NOTE_CONV_MAPG_ID   		DA_RAC_NOTE_CONV_MAPG_ID  ,
				DA_RAC.NOTE_CONV_SEQ       		DA_RAC_NOTE_CONV_SEQ      ,
				DA_RAC.NOTE_CONV_RULE_CD   		DA_RAC_NOTE_CONV_RULE_CD  ,
				DA_RAC.NOTE_CONV_TP_CD     		DA_RAC_NOTE_CONV_TP_CD    ,
				DA_RAC.RT_OP_CD            		DA_RAC_DA_OP_CD           ,
				DA_RAC.CURR_CD             		DA_RAC_CURR_CD            ,
				DA_RAC.FRT_RT_AMT          		DA_RAC_FRT_RT_AMT					,
				DA_RAC.RAC_CONV_CTNT       		DA_RAC_CONV_CTNT         	,

				'Y'														POR_MTCH_FLG							,
				'Y'														DEL_MTCH_FLG

FROM
/*******************************************************************************************
JOIN TABLE
1.1 BQ, CH, CM, CR, RD, OP, DV, DP, RT
1.2 RT RULE					: RAP, RAR, DOR, TYP, RAC, APP, RAS, ADD
2.1 OA							: O
2.2 OA RULE					: TYP, RAC ( RAP, RAR, DOR 는 RT 와 동일하게 적용 )
3.1 DA							: O
3.2 DA RULE					: TYP, RAC ( RAP, RAR, DOR 는 RT 와 동일하게 적용 )
*******************************************************************************************/
				BQ	,
				OI	,
				OA	,
				DA	,
				RT	,
				NC_P											RT_RAP	,			/* COMMODITY CONVERSION */
				NC_P											RT_RAR	,			/* ROUTE CONVERSION */
				NC_P											RT_DOR	,			/* R/D TERM CONVERSION */
				NC_P											RT_TYP	,			/* RATING UNIT CONVERSION */
				NC_P											RT_RAC	,			/* CARGO TYPE CONVERSION */
				NC_P											OA_TYP	,			/* RATING UNIT CONVERSION */
				NC_P											OA_RAC	,			/* CARGO TYPE CONVERSION */
				NC_P											DA_TYP	,			/* RATING UNIT CONVERSION */
				NC_P											DA_RAC				/* CARGO TYPE CONVERSION */

WHERE		RT.BQ_SEQ		=	BQ.BQ_SEQ
AND			OI.BQ_SEQ		= BQ.BQ_SEQ
AND			OA.BQ_SEQ		= BQ.BQ_SEQ
AND			DA.BQ_SEQ		= BQ.BQ_SEQ
AND			RT_RAP.BQ_SEQ	= RT.BQ_SEQ AND RT_RAP.NOTE_CONV_RULE_CD = 'RAP' AND ( RT_RAP.BKG_CONV_TP_CD = 'B' OR RT_RAP.NC_SEQ = RT.RAP_NC_SEQ )
AND			RT_RAR.BQ_SEQ	= RT.BQ_SEQ AND RT_RAR.NOTE_CONV_RULE_CD = 'RAR' AND ( RT_RAR.BKG_CONV_TP_CD = 'B' OR RT_RAR.NC_SEQ = RT.RAR_NC_SEQ )
AND			RT_DOR.BQ_SEQ	= RT.BQ_SEQ AND RT_DOR.NOTE_CONV_RULE_CD = 'DOR' AND ( RT_DOR.BKG_CONV_TP_CD = 'B' OR RT_DOR.NC_SEQ = RT.DOR_NC_SEQ )
AND			RT_TYP.BQ_SEQ	= RT.BQ_SEQ AND RT_TYP.NOTE_CONV_RULE_CD = 'TYP' AND ( RT_TYP.BKG_CONV_TP_CD = 'B' OR RT_TYP.NC_SEQ = RT.TYP_NC_SEQ )
AND			RT_RAC.BQ_SEQ	= RT.BQ_SEQ AND RT_RAC.NOTE_CONV_RULE_CD = 'RAC' AND ( RT_RAC.BKG_CONV_TP_CD = 'B' OR RT_RAC.NC_SEQ = RT.RAC_NC_SEQ )
AND			OA_TYP.BQ_SEQ	= RT.BQ_SEQ AND OA_TYP.NOTE_CONV_RULE_CD = 'TYP' AND ( OA_TYP.BKG_CONV_TP_CD = 'B' OR OA_TYP.NC_SEQ = RT.TYP_NC_SEQ )
AND			OA_RAC.BQ_SEQ	= RT.BQ_SEQ AND OA_RAC.NOTE_CONV_RULE_CD = 'RAC' AND ( OA_RAC.BKG_CONV_TP_CD = 'B' OR OA_RAC.NC_SEQ = RT.RAC_NC_SEQ )
AND			DA_TYP.BQ_SEQ	= RT.BQ_SEQ AND DA_TYP.NOTE_CONV_RULE_CD = 'TYP' AND ( DA_TYP.BKG_CONV_TP_CD = 'B' OR DA_TYP.NC_SEQ = RT.TYP_NC_SEQ )
AND			DA_RAC.BQ_SEQ	= RT.BQ_SEQ AND DA_RAC.NOTE_CONV_RULE_CD = 'RAC' AND ( DA_RAC.BKG_CONV_TP_CD = 'B' OR DA_RAC.NC_SEQ = RT.RAC_NC_SEQ )


/*******************************************************************************************
	8.1 RATE
*******************************************************************************************/

/*******************************************************************************************
	8.1.1 RATE - COMMODITY
	(주의)
	COMMODITY 나 RATING UNIT 등의 조건이 위의 OA, DA, RT 와 중복조건으로 보일 수 있으나,
	OA, DA, RT 는 CONVERSION 이 정확하게 적용한 것이 아니므로, 다시한번 정확하게 조건을 연결해야 한다.
*******************************************************************************************/

/*******************************************************************************************
< COMMODITY >
그룹, 개별간으로 일치하는 경우
*******************************************************************************************/
AND			( RT.CM_PRC_CMDT_TP_CD, RT.CM_PRC_CMDT_DEF_CD ) IN
				(
				SELECT	RT_RAP.CONV_CMDT_TP_CD, RT_RAP.CONV_CMDT_DEF_CD
				FROM		DUAL
				UNION ALL
				SELECT  'C', GC.PRC_CMDT_DEF_CD
				FROM		GC
				WHERE		RT_RAP.CONV_CMDT_TP_CD	= 'G'
				AND     GC.PRC_CMDT_TP_CD   		= 'C'
				AND			GC.PRC_GRP_CMDT_CD  		= RT_RAP.CONV_CMDT_DEF_CD
				UNION ALL
				SELECT  'G', GC.PRC_GRP_CMDT_CD
				FROM		GC
				WHERE		RT_RAP.CONV_CMDT_TP_CD	= 'C'
				AND     GC.PRC_CMDT_TP_CD   		= 'C'
				AND     GC.PRC_CMDT_DEF_CD  		= RT_RAP.CONV_CMDT_DEF_CD
				UNION ALL
				/* TAW 일 경우 FAK 고려함 */
				SELECT	'C', CMDT_CD
				FROM		MDM_COMMODITY
				WHERE		REP_CMDT_CD		= '0000'
				UNION ALL
				SELECT	'G', GC.PRC_GRP_CMDT_CD
				FROM		GC
				WHERE		GC.PRC_CMDT_TP_CD		= 'C'
				AND			GC.PRC_CMDT_DEF_CD  IN ( SELECT CMDT_CD FROM MDM_COMMODITY WHERE REP_CMDT_CD = '0000' )
				)


/*******************************************************************************************
	8.1.2 RATE - ROUTE
*******************************************************************************************/

/*******************************************************************************************
< ORIGIN ( PRE PELAY ) >
*******************************************************************************************/

AND     ( RT.OP_ROUT_PNT_LOC_TP_CD, RT.OP_ROUT_PNT_LOC_DEF_CD ) IN
				(
				SELECT	'L', BQ.PRE_RLY_PORT_CD
				FROM		DUAL
				UNION ALL
				SELECT  'G', GL.PRC_GRP_LOC_CD
				FROM		GL
				WHERE		GL.LOC_CD						= BQ.PRE_RLY_PORT_CD
				)


/*******************************************************************************************
< ORIGIN VIA ( PRE PELAY ) >
*******************************************************************************************/

AND     (
						RT.OV_ROUT_VIA_PORT_DEF_CD IS NULL
				OR	( RT.OV_ROUT_VIA_PORT_TP_CD, RT.OV_ROUT_VIA_PORT_DEF_CD ) IN
						(
						SELECT	'L', BQ.PRE_RLY_PORT_CD
						FROM		DUAL
						UNION ALL
						SELECT  'G', GL.PRC_GRP_LOC_CD
						FROM		GL
						WHERE		GL.LOC_CD						= BQ.PRE_RLY_PORT_CD
						)
				)


/*******************************************************************************************
< DESTINATION VIA ( POD ) >
*******************************************************************************************/

AND     (
						RT.DV_ROUT_VIA_PORT_DEF_CD IS NULL
				OR	( RT.DV_ROUT_VIA_PORT_TP_CD, RT.DV_ROUT_VIA_PORT_DEF_CD ) IN
						(
						SELECT	RT_RAR.CONV_DEST_VIA_LOC_TP_CD,	RT_RAR.CONV_DEST_VIA_LOC_DEF_CD
						FROM		DUAL
						UNION ALL
						SELECT  'L', GL.LOC_CD
						FROM		GL
						WHERE		RT_RAR.CONV_DEST_VIA_LOC_TP_CD	= 'G'
						AND		  GL.PRC_GRP_LOC_CD 						= RT_RAR.CONV_DEST_VIA_LOC_DEF_CD
						UNION ALL
						SELECT  'G', GL.PRC_GRP_LOC_CD
						FROM		GL
						WHERE		RT_RAR.CONV_DEST_VIA_LOC_TP_CD	= 'L'
						AND     GL.LOC_CD											= RT_RAR.CONV_DEST_VIA_LOC_DEF_CD
						)
				)


/*******************************************************************************************
< DESTINATION ( POD ) >
*******************************************************************************************/

AND     ( RT.DP_ROUT_PNT_LOC_TP_CD, RT.DP_ROUT_PNT_LOC_DEF_CD ) IN
				(
				SELECT	RT_RAR.CONV_DEST_VIA_LOC_TP_CD,	RT_RAR.CONV_DEST_VIA_LOC_DEF_CD
				FROM		DUAL
				UNION ALL
				SELECT  'L', GL.LOC_CD
				FROM		GL
				WHERE		RT_RAR.CONV_DEST_VIA_LOC_TP_CD	= 'G'
				AND		  GL.PRC_GRP_LOC_CD 				= RT_RAR.CONV_DEST_VIA_LOC_DEF_CD
				UNION ALL
				SELECT  'G', GL.PRC_GRP_LOC_CD
				FROM		GL
				WHERE		RT_RAR.CONV_DEST_VIA_LOC_TP_CD	= 'L'
				AND     GL.LOC_CD									= RT_RAR.CONV_DEST_VIA_LOC_DEF_CD
				)


/*******************************************************************************************
	8.1.3 RATE - RATING UNIT
*******************************************************************************************/

AND     (
								RT.RAT_UT_CD	= RT_TYP.CONV_RAT_UT_CD
		        OR
    		    (
        				RT.RAT_UT_CD	IN ( '20', '40', 'HC', '45', '53' )
       			AND ( SELECT A.CNTR_SZ_CD FROM PRI_RAT_UT A WHERE A.RAT_UT_CD = RT.RAT_UT_CD )	= RT_TYP.CONV_RAT_UT_SZ_CD
        		)
				)

AND			RT.PRC_CGO_TP_CD	IN ( RT_RAC.CONV_DR_TP, RT_RAC.CONV_DG_TP, RT_RAC.CONV_RF_TP, RT_RAC.CONV_AK_TP, RT_RAC.CONV_BB_TP )


/*******************************************************************************************
	8.2 ORIGIN IHC
*******************************************************************************************/

/*******************************************************************************************
	8.2.2 ORIGIN IHC - ROUTE
*******************************************************************************************/

/*******************************************************************************************
< POINT ( POR ) >
*******************************************************************************************/

AND     ( OI.ROUT_PNT_LOC_TP_CD, OI.ROUT_PNT_LOC_DEF_CD ) IN
				(
				SELECT  RT_RAR.CONV_ORG_LOC_TP_CD, RT_RAR.CONV_ORG_LOC_DEF_CD
				FROM		DUAL
				UNION ALL
				SELECT  'L', GL.LOC_CD
				FROM		GL
				WHERE		RT_RAR.CONV_ORG_LOC_TP_CD	= 'G'
				AND		  GL.PRC_GRP_LOC_CD 				= RT_RAR.CONV_ORG_LOC_DEF_CD
				UNION ALL
				SELECT  'G', GL.PRC_GRP_LOC_CD
				FROM		GL
				WHERE		RT_RAR.CONV_ORG_LOC_TP_CD	= 'L'
				AND     GL.LOC_CD									= RT_RAR.CONV_ORG_LOC_DEF_CD
				)


/*******************************************************************************************
< RCV TERM >
*******************************************************************************************/

AND     NVL(OI.RCV_DE_TERM_CD, '*') IN
				(
				SELECT  B.RCV_DE_TERM_CD
				FROM		(
								SELECT 'Y' CONV_PRC_TERM_CD, 'Y' RCV_DE_TERM_CD FROM DUAL UNION ALL
								SELECT 'Y' CONV_PRC_TERM_CD, 'L' RCV_DE_TERM_CD FROM DUAL UNION ALL
								SELECT 'Y' CONV_PRC_TERM_CD, '*' RCV_DE_TERM_CD FROM DUAL UNION ALL
								SELECT 'S' CONV_PRC_TERM_CD, 'S' RCV_DE_TERM_CD FROM DUAL UNION ALL
								SELECT 'D' CONV_PRC_TERM_CD, 'D' RCV_DE_TERM_CD FROM DUAL UNION ALL
								SELECT 'T' CONV_PRC_TERM_CD, 'T' RCV_DE_TERM_CD FROM DUAL UNION ALL
								SELECT 'I' CONV_PRC_TERM_CD, 'I' RCV_DE_TERM_CD FROM DUAL
								)	B
				WHERE		B.CONV_PRC_TERM_CD	= RT_DOR.CONV_PRC_RCV_TERM_CD
				)


/*******************************************************************************************
< BASE PORT ( POL ) >
*******************************************************************************************/

AND     ( OI.BSE_PORT_TP_CD, OI.BSE_PORT_DEF_CD ) IN
				(
				SELECT  RT_RAR.CONV_ORG_VIA_LOC_TP_CD, RT_RAR.CONV_ORG_VIA_LOC_DEF_CD
				FROM		DUAL
				UNION ALL
				SELECT  'L', GL.LOC_CD
				FROM		GL
				WHERE		RT_RAR.CONV_ORG_VIA_LOC_TP_CD	= 'G'
				AND		  GL.PRC_GRP_LOC_CD 				= RT_RAR.CONV_ORG_VIA_LOC_DEF_CD
				UNION ALL
				SELECT  'G', GL.PRC_GRP_LOC_CD
				FROM		GL
				WHERE		RT_RAR.CONV_ORG_VIA_LOC_TP_CD	= 'L'
				AND     GL.LOC_CD									= RT_RAR.CONV_ORG_VIA_LOC_DEF_CD
				)


/*******************************************************************************************
	8.2.3 ORIGIN IHC - RATING UNIT
*******************************************************************************************/

/* ORIGIN ARB RATING UNIT */
AND     (
								OI.RAT_UT_CD	= OA_TYP.CONV_RAT_UT_CD
		        OR	OI.RAT_UT_CD	= 'BX'
		        OR
    		    (
        				OI.RAT_UT_CD	IN ( '20', '40', 'HC', '45', '53' )
       			AND ( SELECT A.CNTR_SZ_CD FROM PRI_RAT_UT A WHERE A.RAT_UT_CD = OI.RAT_UT_CD )	= OA_TYP.CONV_RAT_UT_SZ_CD
        		)
				)


/* ORIGIN ARB CARGO TYPE */
AND			NVL(OI.PRC_CGO_TP_CD, '*')	IN ( '*', OA_RAC.CONV_DR_TP, OA_RAC.CONV_DG_TP, OA_RAC.CONV_RF_TP, OA_RAC.CONV_AK_TP, OA_RAC.CONV_BB_TP )


/*******************************************************************************************
	8.3 ORIGIN ARB
*******************************************************************************************/

/*******************************************************************************************
	8.3.1 ORIGIN ARB - COMMODITY
*******************************************************************************************/

AND			(
						OA.PRC_CMDT_DEF_CD	IS NULL
				OR	( OA.PRC_CMDT_TP_CD, OA.PRC_CMDT_DEF_CD ) IN
						(
						SELECT	RT_RAP.CONV_CMDT_TP_CD, RT_RAP.CONV_CMDT_DEF_CD
						FROM		DUAL
						UNION ALL
						SELECT  'C', GC.PRC_CMDT_DEF_CD
						FROM		GC
						WHERE		RT_RAP.CONV_CMDT_TP_CD	= 'G'
						AND     GC.PRC_CMDT_TP_CD   		= 'C'
						AND			GC.PRC_GRP_CMDT_CD  		= RT_RAP.CONV_CMDT_DEF_CD
						UNION ALL
						SELECT  'G', GC.PRC_GRP_CMDT_CD
						FROM		GC
						WHERE		RT_RAP.CONV_CMDT_TP_CD	= 'C'
						AND     GC.PRC_CMDT_TP_CD   		= 'C'
						AND     GC.PRC_CMDT_DEF_CD  		= RT_RAP.CONV_CMDT_DEF_CD
						UNION ALL
						/* TAW 일 경우 FAK 고려함 */
						SELECT	'C', CMDT_CD
						FROM		MDM_COMMODITY
						WHERE		REP_CMDT_CD		= '0000'
						UNION ALL
						SELECT	'G', GC.PRC_GRP_CMDT_CD
						FROM		GC
						WHERE		GC.PRC_CMDT_TP_CD		= 'C'
						AND			GC.PRC_CMDT_DEF_CD  IN ( SELECT CMDT_CD FROM MDM_COMMODITY WHERE REP_CMDT_CD = '0000' )
						)
				)


/*******************************************************************************************
	8.3.2 ORIGIN ARB - ROUTE
*******************************************************************************************/

/*******************************************************************************************
< POINT ( POL ) >
*******************************************************************************************/

AND     ( OA.ROUT_PNT_LOC_TP_CD, OA.ROUT_PNT_LOC_DEF_CD ) IN
				(
				SELECT	RT_RAR.CONV_ORG_VIA_LOC_TP_CD,	RT_RAR.CONV_ORG_VIA_LOC_DEF_CD
				FROM		DUAL
				UNION ALL
				SELECT  'L', GL.LOC_CD
				FROM		GL
				WHERE		RT_RAR.CONV_ORG_VIA_LOC_TP_CD	= 'G'
				AND		  GL.PRC_GRP_LOC_CD 				= RT_RAR.CONV_ORG_VIA_LOC_DEF_CD
				UNION ALL
				SELECT  'G', GL.PRC_GRP_LOC_CD
				FROM		GL
				WHERE		RT_RAR.CONV_ORG_VIA_LOC_TP_CD	= 'L'
				AND     GL.LOC_CD									= RT_RAR.CONV_ORG_VIA_LOC_DEF_CD
				)


/*******************************************************************************************
< VIA PORT ( PRE RELAY ) >
*******************************************************************************************/

AND     (
                OA.VIA_PORT_DEF_CD  IS NULL
            OR	( OA.VIA_PORT_TP_CD, OA.VIA_PORT_DEF_CD ) IN
								(
								SELECT	'L', BQ.PRE_RLY_PORT_CD
								FROM		DUAL
								UNION ALL
								SELECT  'G', GL.PRC_GRP_LOC_CD
								FROM		GL
								WHERE		GL.LOC_CD						= BQ.PRE_RLY_PORT_CD
								)
        )


/*******************************************************************************************
	8.3.3 ORIGIN ARB - RATING UNIT
*******************************************************************************************/

/* ORIGIN ARB RATING UNIT */
AND     (
								OA.RAT_UT_CD	= OA_TYP.CONV_RAT_UT_CD
		        OR	OA.RAT_UT_CD	= 'BX'
		        OR
    		    (
        				OA.RAT_UT_CD	IN ( '20', '40', 'HC', '45', '53' )
       			AND ( SELECT A.CNTR_SZ_CD FROM PRI_RAT_UT A WHERE A.RAT_UT_CD = OA.RAT_UT_CD )	= OA_TYP.CONV_RAT_UT_SZ_CD
        		)
				)

/* ORIGIN ARB CARGO TYPE */
AND			NVL(OA.PRC_CGO_TP_CD, '*')	IN ('*', OA_RAC.CONV_DR_TP, OA_RAC.CONV_DG_TP, OA_RAC.CONV_RF_TP, OA_RAC.CONV_AK_TP, OA_RAC.CONV_BB_TP )


/*******************************************************************************************
	8.3.4 ORIGIN ARB - JOIN
*******************************************************************************************/

/* ORIGIN ARB JOIN ( ARB CONV RULE ) */
AND			DECODE(RT.ARB_RT_APPL_TP_CD, NULL, DECODE(RT.GEN_SPCL_RT_TP_CD, 'S', 'N', 'Y'), 'N', 'N', 'Y') = 'Y'

/* ORIGIN ARB JOIN ( OARB.BPORT = RATE.ORIGIN ) */
AND			NVL(RT.OP_RCV_DE_TERM_CD, '*' )	NOT IN ( 'D', 'S' )

AND			( RT.OP_ROUT_PNT_LOC_TP_CD, RT.OP_ROUT_PNT_LOC_DEF_CD ) IN
				(
				SELECT	OA.BSE_PORT_TP_CD, OA.BSE_PORT_DEF_CD
				FROM		DUAL
				UNION ALL
				SELECT	'L', GL.LOC_CD
				FROM		GL
				WHERE		OA.BSE_PORT_TP_CD	= 'G'
				AND		  GL.PRC_GRP_LOC_CD	= OA.BSE_PORT_DEF_CD
				UNION ALL
				SELECT	'G', GL.PRC_GRP_LOC_CD
				FROM		GL
				WHERE		OA.BSE_PORT_TP_CD	= 'L'
				AND			GL.LOC_CD					= OA.BSE_PORT_DEF_CD
				)


/*******************************************************************************************
	8.4 DEST ARB
*******************************************************************************************/

/*******************************************************************************************
	8.4.1 DEST ARB - COMMODITY
*******************************************************************************************/

AND			(
						DA.PRC_CMDT_DEF_CD	IS NULL
				OR	( DA.PRC_CMDT_TP_CD, DA.PRC_CMDT_DEF_CD ) IN
						(
						SELECT	RT_RAP.CONV_CMDT_TP_CD, RT_RAP.CONV_CMDT_DEF_CD
						FROM		DUAL
						UNION ALL
						SELECT  'C', GC.PRC_CMDT_DEF_CD
						FROM		GC
						WHERE		RT_RAP.CONV_CMDT_TP_CD	= 'G'
						AND     GC.PRC_CMDT_TP_CD   		= 'C'
						AND			GC.PRC_GRP_CMDT_CD  		= RT_RAP.CONV_CMDT_DEF_CD
						UNION ALL
						SELECT  'G', GC.PRC_GRP_CMDT_CD
						FROM		GC
						WHERE		RT_RAP.CONV_CMDT_TP_CD	= 'C'
						AND     GC.PRC_CMDT_TP_CD   		= 'C'
						AND     GC.PRC_CMDT_DEF_CD  		= RT_RAP.CONV_CMDT_DEF_CD
						UNION ALL
						/* TAW 일 경우 FAK 고려함 */
						SELECT	'C', CMDT_CD
						FROM		MDM_COMMODITY
						WHERE		REP_CMDT_CD		= '0000'
						UNION ALL
						SELECT	'G', GC.PRC_GRP_CMDT_CD
						FROM		GC
						WHERE		GC.PRC_CMDT_TP_CD		= 'C'
						AND			GC.PRC_CMDT_DEF_CD  IN ( SELECT CMDT_CD FROM MDM_COMMODITY WHERE REP_CMDT_CD = '0000' )
						)
				)


/*******************************************************************************************
	8.4.2 DEST ARB - ROUTE
*******************************************************************************************/

/*******************************************************************************************
< VIA PORT ( POD ) >
*******************************************************************************************/

AND     (
                DA.VIA_PORT_DEF_CD  IS NULL
            OR	( DA.VIA_PORT_TP_CD, DA.VIA_PORT_DEF_CD ) IN
								(
								SELECT  RT_RAR.CONV_DEST_VIA_LOC_TP_CD, RT_RAR.CONV_DEST_VIA_LOC_DEF_CD
								FROM		DUAL
								UNION ALL
								SELECT  'L', GL.LOC_CD
								FROM		GL
								WHERE		RT_RAR.CONV_DEST_VIA_LOC_TP_CD	= 'G'
								AND		  GL.PRC_GRP_LOC_CD 				= RT_RAR.CONV_DEST_VIA_LOC_DEF_CD
								UNION ALL
								SELECT  'G', GL.PRC_GRP_LOC_CD
								FROM		GL
								WHERE		RT_RAR.CONV_DEST_VIA_LOC_TP_CD	= 'L'
								AND     GL.LOC_CD									= RT_RAR.CONV_DEST_VIA_LOC_DEF_CD
								)
        )


/*******************************************************************************************
< POINT ( DEL ) >
*******************************************************************************************/

AND     ( DA.ROUT_PNT_LOC_TP_CD, DA.ROUT_PNT_LOC_DEF_CD ) IN
				(
				SELECT  RT_RAR.CONV_DEST_LOC_TP_CD, RT_RAR.CONV_DEST_LOC_DEF_CD
				FROM		DUAL
				UNION ALL
				SELECT  'L', GL.LOC_CD
				FROM		GL
				WHERE		RT_RAR.CONV_DEST_LOC_TP_CD	= 'G'
				AND		  GL.PRC_GRP_LOC_CD 				= RT_RAR.CONV_DEST_LOC_DEF_CD
				UNION ALL
				SELECT  'G', GL.PRC_GRP_LOC_CD
				FROM		GL
				WHERE		RT_RAR.CONV_DEST_LOC_TP_CD	= 'L'
				AND     GL.LOC_CD									= RT_RAR.CONV_DEST_LOC_DEF_CD
				)


/*******************************************************************************************
< DE TERM >
*******************************************************************************************/

AND			NVL(DA.RCV_DE_TERM_CD, '*') IN
				(
				SELECT  B.RCV_DE_TERM_CD
				FROM		(
								SELECT 'Y' CONV_PRC_TERM_CD, 'Y' RCV_DE_TERM_CD FROM DUAL UNION ALL
								SELECT 'Y' CONV_PRC_TERM_CD, 'L' RCV_DE_TERM_CD FROM DUAL UNION ALL
								SELECT 'Y' CONV_PRC_TERM_CD, '*' RCV_DE_TERM_CD FROM DUAL UNION ALL
								SELECT 'S' CONV_PRC_TERM_CD, 'S' RCV_DE_TERM_CD FROM DUAL UNION ALL
								SELECT 'S' CONV_PRC_TERM_CD, 'Y' RCV_DE_TERM_CD FROM DUAL UNION ALL
								SELECT 'S' CONV_PRC_TERM_CD, 'T' RCV_DE_TERM_CD FROM DUAL UNION ALL
								SELECT 'S' CONV_PRC_TERM_CD, 'I' RCV_DE_TERM_CD FROM DUAL UNION ALL
								SELECT 'S' CONV_PRC_TERM_CD, 'L' RCV_DE_TERM_CD FROM DUAL UNION ALL
								SELECT 'S' CONV_PRC_TERM_CD, '*' RCV_DE_TERM_CD FROM DUAL UNION ALL
								SELECT 'D' CONV_PRC_TERM_CD, 'D' RCV_DE_TERM_CD FROM DUAL UNION ALL
								SELECT 'T' CONV_PRC_TERM_CD, 'T' RCV_DE_TERM_CD FROM DUAL UNION ALL
								SELECT 'I' CONV_PRC_TERM_CD, 'I' RCV_DE_TERM_CD FROM DUAL
								)	B
				WHERE		B.CONV_PRC_TERM_CD	= RT_DOR.CONV_PRC_DE_TERM_CD
				)


/*******************************************************************************************
< DEST TRANS MODE >
*******************************************************************************************/

AND     (
						DA.PRC_TRSP_MOD_CD		IS NULL
				OR	BQ.DEST_TRNS_MOD_CD		IS NULL
				OR	DA.PRC_TRSP_MOD_CD		= BQ.DEST_TRNS_MOD_CD
				OR  (
								DA.PRC_TRSP_MOD_CD		IN ( 'R', 'A' )
						AND	BQ.DEST_TRNS_MOD_CD		= 'R'
						)
				)


/*******************************************************************************************
	8.4.3 DEST ARB - RATING UNIT
*******************************************************************************************/

/* DEST ARB RATING UNIT */
AND     (
								DA.RAT_UT_CD	= DA_TYP.CONV_RAT_UT_CD
		        OR	DA.RAT_UT_CD	= 'BX'
		        OR
    		    (
        				DA.RAT_UT_CD	IN ( '20', '40', 'HC', '45', '53' )
       			AND ( SELECT A.CNTR_SZ_CD FROM PRI_RAT_UT A WHERE A.RAT_UT_CD = DA.RAT_UT_CD )	= DA_TYP.CONV_RAT_UT_SZ_CD
        		)
				)


/* DEST ARB CARGO TYPE */
AND			NVL(DA.PRC_CGO_TP_CD, '*')	IN ( '*', DA_RAC.CONV_DR_TP, DA_RAC.CONV_DG_TP, DA_RAC.CONV_RF_TP, DA_RAC.CONV_AK_TP, DA_RAC.CONV_BB_TP )


/*******************************************************************************************
	8.4.4 DEST ARB - JOIN
*******************************************************************************************/

/* DEST ARB JOIN ( ADD CONV RULE ) */
AND			DECODE(RT.ADD_RT_APPL_TP_CD, NULL, DECODE(RT.GEN_SPCL_RT_TP_CD, 'S', 'N', 'Y'), 'N', 'N', 'Y') = 'Y'

/* DEST ARB JOIN ( DARB.BPORT = RATE.DEST ) */
AND			NVL(RT.DP_RCV_DE_TERM_CD, '*' )	NOT IN ( 'D', 'S' )

AND			( RT.DP_ROUT_PNT_LOC_TP_CD, RT.DP_ROUT_PNT_LOC_DEF_CD ) IN
				(
				SELECT	DA.BSE_PORT_TP_CD, DA.BSE_PORT_DEF_CD
				FROM		DUAL
				UNION ALL
				SELECT	'L', GL.LOC_CD
				FROM		GL
				WHERE		DA.BSE_PORT_TP_CD	= 'G'
				AND		  GL.PRC_GRP_LOC_CD	= DA.BSE_PORT_DEF_CD
				UNION ALL
				SELECT	'G', GL.PRC_GRP_LOC_CD
				FROM		GL
				WHERE		DA.BSE_PORT_TP_CD	= 'L'
				AND			GL.LOC_CD					= DA.BSE_PORT_DEF_CD
				)


UNION ALL


/*******************************************************************************************
	9. PATTERN #9 ( 0001 )
*******************************************************************************************/

SELECT	'0001'												PRC_RT_MTCH_PATT_CD				,
				BQ.SC_NO											CTRT_NO										,
				BQ.PROP_NO										PROP_NO										,
				BQ.AMDT_SEQ										AMDT_SEQ									,
				BQ.SVC_SCP_CD									SVC_SCP_CD								,
				BQ.BQ_SEQ											BQ_SEQ										,
				BQ.BKG_BQ_SEQ									BKG_BQ_SEQ								,
				BQ.CNTR_TPSZ_CD								BQ_CNTR_TPSZ_CD						,
				BQ.CTRT_CNTR_TPSZ_CD					BQ_CTRT_CNTR_TPSZ_CD			,
				BQ.RCV_TERM_CD								BQ_RCV_TERM_CD						,
				BQ.DE_TERM_CD									BQ_DE_TERM_CD							,
				BQ.DRY_CGO_FLG								BQ_DRY_CGO_FLG						,
				BQ.DCGO_FLG										BQ_DCGO_FLG								,
				BQ.RC_FLG											BQ_RC_FLG									,
				BQ.AWK_CGO_FLG								BQ_AWK_CGO_FLG						,
				BQ.BB_CGO_FLG									BQ_BB_CGO_FLG							,
				BQ.SOC_FLG										BQ_SOC_FLG								,
				BQ.PRC_CGO_TP_CD							BQ_PRC_CGO_TP_CD					,
				BQ.IMDG_CLSS_CD								BQ_IMDG_CLSS_CD						,
				BQ.CTRT_CNTR_QTY							BQ_CTRT_CNTR_QTY					,
				BQ.POR_APPL_FLG								BQ_POR_APPL_FLG						,
				BQ.POL_APPL_FLG								BQ_POL_APPL_FLG						,
				BQ.POD_APPL_FLG								BQ_POD_APPL_FLG						,
				BQ.DEL_APPL_FLG								BQ_DEL_APPL_FLG						,
				BQ.PRE_RLY_PORT_APPL_FLG			BQ_POR_RLY_PORT_APPL_FLG	,
				BQ.PST_RLY_PORT_APPL_FLG			BQ_PST_RLY_PORT_APPL_FLG	,

				RT.CMDT_HDR_SEQ								RT_CMDT_HDR_SEQ						,
				RT.ROUT_SEQ										RT_ROUT_SEQ								,
				RT.RT_SEQ											RT_RT_SEQ									,
				0															OI_ADD_CHG_SEQ						,
				0															OA_ADD_CHG_SEQ						,
				0															DA_ADD_CHG_SEQ						,
				DI.ADD_CHG_SEQ								DI_ADD_CHG_SEQ						,

				RT.GEN_SPCL_RT_TP_CD					RT_GEN_SPCL_RT_TP_CD			,
				RT.CM_PRC_CMDT_TP_CD					CM_PRC_CMDT_TP_CD					,
				RT.CM_PRC_CMDT_DEF_CD					CM_PRC_CMDT_DEF_CD				,
				RT.OP_ROUT_PNT_LOC_DEF_CD			POR_CD										,
				RT.OV_ROUT_VIA_PORT_DEF_CD		POL_CD										,
				RT.DV_ROUT_VIA_PORT_DEF_CD		POD_CD										,
				DI.ROUT_PNT_LOC_DEF_CD				DEL_CD										,
				NULL													DIR_CALL_FLG							,
				RT.OP_RCV_DE_TERM_CD					RCV_TERM_CD								,
				DI.RCV_DE_TERM_CD							DE_TERM_CD								,
				RT.RAT_UT_CD									RAT_UT_CD									,
				RT.PRC_CGO_TP_CD							PRC_CGO_TP_CD							,
				RT.CURR_CD										CURR_CD										,
				RT.OP_PRC_TRSP_MOD_CD					ORG_TRSP_MOD_CD						,
				DI.PRC_TRSP_MOD_CD						DEST_TRSP_MOD_CD					,

				RT.OP_ROUT_PNT_LOC_DEF_CD			OP_ROUT_PNT_LOC_DEF_CD		,
				RT.OV_ROUT_VIA_PORT_DEF_CD		OV_ROUT_VIA_PORT_DEF_CD		,
				RT.DV_ROUT_VIA_PORT_DEF_CD		DV_ROUT_VIA_PORT_DEF_CD		,
				RT.DP_ROUT_PNT_LOC_DEF_CD			DP_ROUT_PNT_LOC_DEF_CD		,
				RT.RD_DIR_CALL_FLG						RD_DIR_CALL_FLG						,
				RT.RAT_UT_CD									RT_RAT_UT_CD							,
				RT.PRC_CGO_TP_CD							RT_PRC_CGO_TP_CD					,
				RT.OP_PRC_TRSP_MOD_CD					OP_PRC_TRSP_MOD_CD				,
				RT.DP_PRC_TRSP_MOD_CD					DP_PRC_TRSP_MOD_CD				,
				RT.CURR_CD										RT_CURR_CD								,
				RT.FNL_FRT_RT_AMT							RT_FNL_FRT_RT_AMT					,

				NULL													OI_ROUT_PNT_LOC_DEF_CD		,
				NULL													OI_BSE_PORT_DEF_CD				,
				NULL													OI_VIA_PORT_DEF_CD				,
				NULL													OI_DIR_CALL_FLG						,
				NULL													OI_RAT_UT_CD							,
				NULL													OI_PRC_CGO_TP_CD					,
				NULL													OI_PRC_TRSP_MOD_CD				,
				NULL													OI_RCV_DE_TERM_CD					,
				NULL													OI_PRC_CMDT_DEF_CD				,
				NULL													OI_CURR_CD								,
				NULL													OI_FNL_FRT_RT_AMT					,
				NULL													OI_RAT_UT_MTCH_PRIO				,

				NULL													OA_ROUT_PNT_LOC_DEF_CD		,
				NULL													OA_BSE_PORT_DEF_CD				,
				NULL													OA_VIA_PORT_DEF_CD				,
				NULL													OA_DIR_CALL_FLG						,
				NULL													OA_RAT_UT_CD							,
				NULL													OA_PRC_CGO_TP_CD					,
				NULL													OA_PRC_TRSP_MOD_CD				,
				NULL													OA_RCV_DE_TERM_CD					,
				NULL													OA_PRC_CMDT_DEF_CD				,
				NULL													OA_CURR_CD								,
				NULL													OA_FNL_FRT_RT_AMT					,
				NULL													OA_RAT_UT_MTCH_PRIO				,

				NULL													DA_ROUT_PNT_LOC_DEF_CD		,
				NULL													DA_BSE_PORT_DEF_CD				,
				NULL													DA_VIA_PORT_DEF_CD				,
				NULL													DA_DIR_CALL_FLG						,
				NULL													DA_RAT_UT_CD							,
				NULL													DA_PRC_CGO_TP_CD					,
				NULL													DA_PRC_TRSP_MOD_CD				,
				NULL													DA_RCV_DE_TERM_CD					,
				NULL													DA_PRC_CMDT_DEF_CD				,
				NULL													DA_CURR_CD								,
				NULL													DA_FNL_FRT_RT_AMT					,
				NULL													DA_RAT_UT_MTCH_PRIO				,

				DI.ROUT_PNT_LOC_DEF_CD				DI_ROUT_PNT_LOC_DEF_CD		,
				DI.BSE_PORT_DEF_CD						DI_BSE_PORT_DEF_CD				,
				DI.VIA_PORT_DEF_CD						DI_VIA_PORT_DEF_CD				,
				DI.DIR_CALL_FLG								DI_DIR_CALL_FLG						,
				DI.RAT_UT_CD									DI_RAT_UT_CD							,
				DI.PRC_CGO_TP_CD							DI_PRC_CGO_TP_CD					,
				DI.PRC_TRSP_MOD_CD						DI_PRC_TRSP_MOD_CD				,
				DI.RCV_DE_TERM_CD							DI_RCV_DE_TERM_CD					,
				DI.PRC_CMDT_DEF_CD						DI_PRC_CMDT_DEF_CD				,
				DI.CURR_CD										DI_CURR_CD								,
				DI.FNL_FRT_RT_AMT							DI_FNL_FRT_RT_AMT					,
				DI.RAT_UT_MTCH_PRIO						DI_RAT_UT_MTCH_PRIO				,

				RT_RAP.BKG_CONV_TP_CD      		RT_RAP_BKG_CONV_TP_CD			,
				RT_RAP.NOTE_CONV_MAPG_ID   		RT_RAP_NOTE_CONV_MAPG_ID  ,
				RT_RAP.NOTE_CONV_SEQ       		RT_RAP_NOTE_CONV_SEQ      ,
				RT_RAP.NOTE_CONV_RULE_CD   		RT_RAP_NOTE_CONV_RULE_CD  ,
				RT_RAP.NOTE_CONV_TP_CD     		RT_RAP_NOTE_CONV_TP_CD    ,
				RT_RAP.RT_OP_CD            		RT_RAP_RT_OP_CD           ,
				RT_RAP.CURR_CD             		RT_RAP_CURR_CD            ,
				RT_RAP.FRT_RT_AMT          		RT_RAP_FRT_RT_AMT         ,
				RT_RAP.RAP_CONV_CTNT					RT_RAP_CONV_CTNT					,

				RT_RAR.BKG_CONV_TP_CD      		RT_RAR_BKG_CONV_TP_CD     ,
				RT_RAR.NOTE_CONV_MAPG_ID   		RT_RAR_NOTE_CONV_MAPG_ID  ,
				RT_RAR.NOTE_CONV_SEQ       		RT_RAR_NOTE_CONV_SEQ      ,
				RT_RAR.NOTE_CONV_RULE_CD   		RT_RAR_NOTE_CONV_RULE_CD  ,
				RT_RAR.NOTE_CONV_TP_CD     		RT_RAR_NOTE_CONV_TP_CD    ,
				RT_RAR.RT_OP_CD            		RT_RAR_RT_OP_CD           ,
				RT_RAR.CURR_CD             		RT_RAR_CURR_CD            ,
				RT_RAR.FRT_RT_AMT          		RT_RAR_FRT_RT_AMT         ,
				RT_RAR.RAR_CONV_CTNT					RT_RAR_CONV_CTNT					,

				RT_DOR.BKG_CONV_TP_CD      		RT_DOR_BKG_CONV_TP_CD     ,
				RT_DOR.NOTE_CONV_MAPG_ID   		RT_DOR_NOTE_CONV_MAPG_ID  ,
				RT_DOR.NOTE_CONV_SEQ       		RT_DOR_NOTE_CONV_SEQ      ,
				RT_DOR.NOTE_CONV_RULE_CD   		RT_DOR_NOTE_CONV_RULE_CD  ,
				RT_DOR.NOTE_CONV_TP_CD     		RT_DOR_NOTE_CONV_TP_CD    ,
				RT_DOR.RT_OP_CD            		RT_DOR_RT_OP_CD           ,
				RT_DOR.CURR_CD             		RT_DOR_CURR_CD            ,
				RT_DOR.FRT_RT_AMT          		RT_DOR_FRT_RT_AMT         ,
				RT_DOR.DOR_CONV_CTNT					RT_DOR_CONV_CTNT					,

				RT_TYP.BKG_CONV_TP_CD      		RT_TYP_BKG_CONV_TP_CD     ,
				RT_TYP.NOTE_CONV_MAPG_ID   		RT_TYP_NOTE_CONV_MAPG_ID  ,
				RT_TYP.NOTE_CONV_SEQ       		RT_TYP_NOTE_CONV_SEQ      ,
				RT_TYP.NOTE_CONV_RULE_CD   		RT_TYP_NOTE_CONV_RULE_CD  ,
				RT_TYP.NOTE_CONV_TP_CD     		RT_TYP_NOTE_CONV_TP_CD    ,
				RT_TYP.RT_OP_CD            		RT_TYP_RT_OP_CD           ,
				RT_TYP.CURR_CD             		RT_TYP_CURR_CD            ,
				RT_TYP.FRT_RT_AMT          		RT_TYP_FRT_RT_AMT         ,
				RT_TYP.TYP_CONV_CTNT					RT_TYP_CONV_CTNT					,

				RT_RAC.BKG_CONV_TP_CD      		RT_RAC_BKG_CONV_TP_CD     ,
				RT_RAC.NOTE_CONV_MAPG_ID   		RT_RAC_NOTE_CONV_MAPG_ID  ,
				RT_RAC.NOTE_CONV_SEQ       		RT_RAC_NOTE_CONV_SEQ      ,
				RT_RAC.NOTE_CONV_RULE_CD   		RT_RAC_NOTE_CONV_RULE_CD  ,
				RT_RAC.NOTE_CONV_TP_CD     		RT_RAC_NOTE_CONV_TP_CD    ,
				RT_RAC.RT_OP_CD            		RT_RAC_RT_OP_CD           ,
				RT_RAC.CURR_CD             		RT_RAC_CURR_CD            ,
				RT_RAC.FRT_RT_AMT          		RT_RAC_FRT_RT_AMT         ,
				RT_RAC.RAC_CONV_CTNT					RT_RAC_CONV_CTNT					,

				RT.APP_BKG_CONV_TP_CD      		RT_APP_BKG_CONV_TP_CD     ,
				RT.APP_NOTE_CONV_MAPG_ID   		RT_APP_NOTE_CONV_MAPG_ID  ,
				RT.APP_NOTE_CONV_SEQ       		RT_APP_NOTE_CONV_SEQ      ,
				RT.APP_NOTE_CONV_RULE_CD   		RT_APP_NOTE_CONV_RULE_CD  ,
				RT.APP_NOTE_CONV_TP_CD     		RT_APP_NOTE_CONV_TP_CD    ,
				RT.APP_RT_OP_CD            		RT_APP_RT_OP_CD           ,
				RT.APP_CURR_CD             		RT_APP_CURR_CD            ,
				RT.APP_FRT_RT_AMT          		RT_APP_FRT_RT_AMT         ,

				RT.RAS_BKG_CONV_TP_CD      		RT_RAS_BKG_CONV_TP_CD     ,
				RT.RAS_NOTE_CONV_MAPG_ID   		RT_RAS_NOTE_CONV_MAPG_ID  ,
				RT.RAS_NOTE_CONV_SEQ       		RT_RAS_NOTE_CONV_SEQ      ,
				RT.RAS_NOTE_CONV_RULE_CD   		RT_RAS_NOTE_CONV_RULE_CD  ,
				RT.RAS_NOTE_CONV_TP_CD     		RT_RAS_NOTE_CONV_TP_CD    ,
				RT.RAS_RT_OP_CD            		RT_RAS_RT_OP_CD           ,
				RT.RAS_CURR_CD             		RT_RAS_CURR_CD            ,
				RT.RAS_FRT_RT_AMT          		RT_RAS_FRT_RT_AMT         ,
				RT.RAS_RAS_CONV_CTNT					RT_RAS_CONV_CTNT					,

				NULL													RT_ARB_BKG_CONV_TP_CD     ,
				NULL													RT_ARB_NOTE_CONV_MAPG_ID  ,
				NULL													RT_ARB_NOTE_CONV_SEQ      ,
				NULL													RT_ARB_NOTE_CONV_RULE_CD  ,
				NULL													RT_ARB_NOTE_CONV_TP_CD    ,
				NULL													RT_ARB_RT_OP_CD           ,
				NULL													RT_ARB_CURR_CD            ,
				NULL													RT_ARB_FRT_RT_AMT         ,

				RT.ADD_BKG_CONV_TP_CD      		RT_ADD_BKG_CONV_TP_CD     ,
				RT.ADD_NOTE_CONV_MAPG_ID   		RT_ADD_NOTE_CONV_MAPG_ID  ,
				RT.ADD_NOTE_CONV_SEQ       		RT_ADD_NOTE_CONV_SEQ      ,
				RT.ADD_NOTE_CONV_RULE_CD   		RT_ADD_NOTE_CONV_RULE_CD  ,
				RT.ADD_NOTE_CONV_TP_CD     		RT_ADD_NOTE_CONV_TP_CD    ,
				RT.ADD_RT_OP_CD            		RT_ADD_RT_OP_CD           ,
				RT.ADD_CURR_CD             		RT_ADD_CURR_CD            ,
				RT.ADD_FRT_RT_AMT          		RT_ADD_FRT_RT_AMT         ,

				NULL													OA_TYP_BKG_CONV_TP_CD     ,
				NULL													OA_TYP_NOTE_CONV_MAPG_ID  ,
				NULL													OA_TYP_NOTE_CONV_SEQ      ,
				NULL													OA_TYP_NOTE_CONV_RULE_CD  ,
				NULL													OA_TYP_NOTE_CONV_TP_CD    ,
				NULL													OA_TYP_RT_OP_CD           ,
				NULL													OA_TYP_CURR_CD            ,
				NULL													OA_TYP_FRT_RT_AMT         ,
				NULL													OA_TYP_CONV_CTNT					,

				NULL													OA_RAC_BKG_CONV_TP_CD     ,
				NULL													OA_RAC_NOTE_CONV_MAPG_ID  ,
				NULL													OA_RAC_NOTE_CONV_SEQ      ,
				NULL													OA_RAC_NOTE_CONV_RULE_CD  ,
				NULL													OA_RAC_NOTE_CONV_TP_CD    ,
				NULL													OA_RAC_RT_OP_CD           ,
				NULL													OA_RAC_CURR_CD            ,
				NULL													OA_RAC_FRT_RT_AMT         ,
				NULL													OA_RAC_CONV_CTNT					,

				DA_TYP.BKG_CONV_TP_CD      		DA_TYP_BKG_CONV_TP_CD     ,
				DA_TYP.NOTE_CONV_MAPG_ID   		DA_TYP_NOTE_CONV_MAPG_ID  ,
				DA_TYP.NOTE_CONV_SEQ       		DA_TYP_NOTE_CONV_SEQ      ,
				DA_TYP.NOTE_CONV_RULE_CD   		DA_TYP_NOTE_CONV_RULE_CD  ,
				DA_TYP.NOTE_CONV_TP_CD     		DA_TYP_NOTE_CONV_TP_CD    ,
				DA_TYP.RT_OP_CD            		DA_TYP_DA_OP_CD           ,
				DA_TYP.CURR_CD             		DA_TYP_CURR_CD            ,
				DA_TYP.FRT_RT_AMT          		DA_TYP_FRT_RT_AMT					,
				DA_TYP.TYP_CONV_CTNT       		DA_TYP_CONV_CTNT         	,

				DA_RAC.BKG_CONV_TP_CD      		DA_RAC_BKG_CONV_TP_CD     ,
				DA_RAC.NOTE_CONV_MAPG_ID   		DA_RAC_NOTE_CONV_MAPG_ID  ,
				DA_RAC.NOTE_CONV_SEQ       		DA_RAC_NOTE_CONV_SEQ      ,
				DA_RAC.NOTE_CONV_RULE_CD   		DA_RAC_NOTE_CONV_RULE_CD  ,
				DA_RAC.NOTE_CONV_TP_CD     		DA_RAC_NOTE_CONV_TP_CD    ,
				DA_RAC.RT_OP_CD            		DA_RAC_DA_OP_CD           ,
				DA_RAC.CURR_CD             		DA_RAC_CURR_CD            ,
				DA_RAC.FRT_RT_AMT          		DA_RAC_FRT_RT_AMT					,
				DA_RAC.RAC_CONV_CTNT       		DA_RAC_CONV_CTNT         	,

				RT.POR_MTCH_FLG								POR_MTCH_FLG							,
				'Y'														DEL_MTCH_FLG

FROM
/*******************************************************************************************
JOIN TABLE
1.1 BQ, CH, CM, CR, RD, OP, DV, DP, RT
1.2 RT RULE					: RAP, RAR, DOR, TYP, RAC, APP, RAS, ADD
2.1 OA							: X
2.2 OA RULE					: X
3.1 DA							: O
3.2 DA RULE					: TYP, RAC ( RAP, RAR, DOR 는 RT 와 동일하게 적용 )
*******************************************************************************************/
				BQ	,
				DI	,
				RT	,
				NC_P											RT_RAP	,			/* COMMODITY CONVERSION */
				NC_P											RT_RAR	,			/* ROUTE CONVERSION */
				NC_P											RT_DOR	,			/* R/D TERM CONVERSION */
				NC_P											RT_TYP	,			/* RATING UNIT CONVERSION */
				NC_P											RT_RAC	,			/* CARGO TYPE CONVERSION */
				NC_P											DA_TYP	,			/* RATING UNIT CONVERSION */
				NC_P											DA_RAC				/* CARGO TYPE CONVERSION */

WHERE		RT.BQ_SEQ		=	BQ.BQ_SEQ
AND			DI.BQ_SEQ		= BQ.BQ_SEQ
AND			RT_RAP.BQ_SEQ	= RT.BQ_SEQ AND RT_RAP.NOTE_CONV_RULE_CD = 'RAP' AND ( RT_RAP.BKG_CONV_TP_CD = 'B' OR RT_RAP.NC_SEQ = RT.RAP_NC_SEQ )
AND			RT_RAR.BQ_SEQ	= RT.BQ_SEQ AND RT_RAR.NOTE_CONV_RULE_CD = 'RAR' AND ( RT_RAR.BKG_CONV_TP_CD = 'B' OR RT_RAR.NC_SEQ = RT.RAR_NC_SEQ )
AND			RT_DOR.BQ_SEQ	= RT.BQ_SEQ AND RT_DOR.NOTE_CONV_RULE_CD = 'DOR' AND ( RT_DOR.BKG_CONV_TP_CD = 'B' OR RT_DOR.NC_SEQ = RT.DOR_NC_SEQ )
AND			RT_TYP.BQ_SEQ	= RT.BQ_SEQ AND RT_TYP.NOTE_CONV_RULE_CD = 'TYP' AND ( RT_TYP.BKG_CONV_TP_CD = 'B' OR RT_TYP.NC_SEQ = RT.TYP_NC_SEQ )
AND			RT_RAC.BQ_SEQ	= RT.BQ_SEQ AND RT_RAC.NOTE_CONV_RULE_CD = 'RAC' AND ( RT_RAC.BKG_CONV_TP_CD = 'B' OR RT_RAC.NC_SEQ = RT.RAC_NC_SEQ )
AND			DA_TYP.BQ_SEQ	= RT.BQ_SEQ AND DA_TYP.NOTE_CONV_RULE_CD = 'TYP' AND ( DA_TYP.BKG_CONV_TP_CD = 'B' OR DA_TYP.NC_SEQ = RT.TYP_NC_SEQ )
AND			DA_RAC.BQ_SEQ	= RT.BQ_SEQ AND DA_RAC.NOTE_CONV_RULE_CD = 'RAC' AND ( DA_RAC.BKG_CONV_TP_CD = 'B' OR DA_RAC.NC_SEQ = RT.RAC_NC_SEQ )


/*******************************************************************************************
	9.1 RATE
*******************************************************************************************/

/*******************************************************************************************
	9.1.1 RATE - COMMODITY
*******************************************************************************************/

/*******************************************************************************************
< COMMODITY >
그룹, 개별간으로 일치하는 경우
*******************************************************************************************/

AND			( RT.CM_PRC_CMDT_TP_CD, RT.CM_PRC_CMDT_DEF_CD ) IN
				(
				SELECT	RT_RAP.CONV_CMDT_TP_CD, RT_RAP.CONV_CMDT_DEF_CD
				FROM		DUAL
				UNION ALL
				SELECT  'C', GC.PRC_CMDT_DEF_CD
				FROM		GC
				WHERE		RT_RAP.CONV_CMDT_TP_CD	= 'G'
				AND     GC.PRC_CMDT_TP_CD   		= 'C'
				AND			GC.PRC_GRP_CMDT_CD  		= RT_RAP.CONV_CMDT_DEF_CD
				UNION ALL
				SELECT  'G', GC.PRC_GRP_CMDT_CD
				FROM		GC
				WHERE		RT_RAP.CONV_CMDT_TP_CD	= 'C'
				AND     GC.PRC_CMDT_TP_CD   		= 'C'
				AND     GC.PRC_CMDT_DEF_CD  		= RT_RAP.CONV_CMDT_DEF_CD
				UNION ALL
				/* TAW 일 경우 FAK 고려함 */
				SELECT	'C', CMDT_CD
				FROM		MDM_COMMODITY
				WHERE		REP_CMDT_CD		= '0000'
				UNION ALL
				SELECT	'G', GC.PRC_GRP_CMDT_CD
				FROM		GC
				WHERE		GC.PRC_CMDT_TP_CD		= 'C'
				AND			GC.PRC_CMDT_DEF_CD  IN ( SELECT CMDT_CD FROM MDM_COMMODITY WHERE REP_CMDT_CD = '0000' )
				)


/*******************************************************************************************
	9.1.2 RATE - ROUTE
*******************************************************************************************/

/*******************************************************************************************
< ORIGIN ( POR OR POL ) >
*******************************************************************************************/

AND     ( RT.OP_ROUT_PNT_LOC_TP_CD, RT.OP_ROUT_PNT_LOC_DEF_CD ) IN
				(
				SELECT	RT_RAR.CONV_ORG_LOC_TP_CD,	RT_RAR.CONV_ORG_LOC_DEF_CD
				FROM		DUAL
				UNION ALL
				SELECT  'L', GL.LOC_CD
				FROM		GL
				WHERE		RT_RAR.CONV_ORG_LOC_TP_CD	= 'G'
				AND		  GL.PRC_GRP_LOC_CD 				= RT_RAR.CONV_ORG_LOC_DEF_CD
				UNION ALL
				SELECT  'G', GL.PRC_GRP_LOC_CD
				FROM		GL
				WHERE		RT_RAR.CONV_ORG_LOC_TP_CD	= 'L'
				AND     GL.LOC_CD									= RT_RAR.CONV_ORG_LOC_DEF_CD
				UNION ALL
				SELECT	RT_RAR.CONV_ORG_VIA_LOC_TP_CD,	RT_RAR.CONV_ORG_VIA_LOC_DEF_CD
				FROM		DUAL
				UNION ALL
				SELECT  'L', GL.LOC_CD
				FROM		GL
				WHERE		RT_RAR.CONV_ORG_VIA_LOC_TP_CD	= 'G'
				AND		  GL.PRC_GRP_LOC_CD 						= RT_RAR.CONV_ORG_VIA_LOC_DEF_CD
				UNION ALL
				SELECT  'G', GL.PRC_GRP_LOC_CD
				FROM		GL
				WHERE		RT_RAR.CONV_ORG_VIA_LOC_TP_CD	= 'L'
				AND     GL.LOC_CD											= RT_RAR.CONV_ORG_VIA_LOC_DEF_CD
				)


/*******************************************************************************************
< RCV TERM >
*******************************************************************************************/

AND     (
						(
								RT.POR_MTCH_FLG			= 'Y'
						AND	NVL(RT.OP_RCV_DE_TERM_CD, '*') IN
								(
								SELECT  B.RCV_DE_TERM_CD
								FROM		(
												SELECT 'Y' CONV_PRC_TERM_CD, 'Y' RCV_DE_TERM_CD FROM DUAL UNION ALL
												SELECT 'Y' CONV_PRC_TERM_CD, 'L' RCV_DE_TERM_CD FROM DUAL UNION ALL
												SELECT 'Y' CONV_PRC_TERM_CD, '*' RCV_DE_TERM_CD FROM DUAL UNION ALL
												SELECT 'S' CONV_PRC_TERM_CD, 'S' RCV_DE_TERM_CD FROM DUAL UNION ALL
												SELECT 'D' CONV_PRC_TERM_CD, 'D' RCV_DE_TERM_CD FROM DUAL UNION ALL
												SELECT 'T' CONV_PRC_TERM_CD, 'T' RCV_DE_TERM_CD FROM DUAL UNION ALL
												SELECT 'I' CONV_PRC_TERM_CD, 'I' RCV_DE_TERM_CD FROM DUAL
												)	B
								WHERE		B.CONV_PRC_TERM_CD	= RT_DOR.CONV_PRC_RCV_TERM_CD
								)
						)
				OR	(
								BQ.POR_CD										= BQ.POL_CD
						AND	NVL(RT.OP_RCV_DE_TERM_CD, '*') IN
								(
								SELECT  B.RCV_DE_TERM_CD
								FROM		(
												SELECT 'Y' CONV_PRC_TERM_CD, 'Y' RCV_DE_TERM_CD FROM DUAL UNION ALL
												SELECT 'Y' CONV_PRC_TERM_CD, 'L' RCV_DE_TERM_CD FROM DUAL UNION ALL
												SELECT 'Y' CONV_PRC_TERM_CD, '*' RCV_DE_TERM_CD FROM DUAL UNION ALL
												SELECT 'S' CONV_PRC_TERM_CD, 'S' RCV_DE_TERM_CD FROM DUAL UNION ALL
												SELECT 'D' CONV_PRC_TERM_CD, 'D' RCV_DE_TERM_CD FROM DUAL UNION ALL
												SELECT 'D' CONV_PRC_TERM_CD, 'Y' RCV_DE_TERM_CD FROM DUAL UNION ALL	-- 예외 적용
												SELECT 'T' CONV_PRC_TERM_CD, 'T' RCV_DE_TERM_CD FROM DUAL UNION ALL
												SELECT 'I' CONV_PRC_TERM_CD, 'I' RCV_DE_TERM_CD FROM DUAL
												)	B
								WHERE		B.CONV_PRC_TERM_CD	= RT_DOR.CONV_PRC_RCV_TERM_CD
								)
						)
				OR	(
								RT.POR_MTCH_FLG 								= 'N'
						AND	NVL(RT.OP_RCV_DE_TERM_CD, '*')	IN ( 'Y', '*' )
						)
				)


/*******************************************************************************************
< ORIGIN TRANS MODE >
*******************************************************************************************/

AND			(
					  RT.POR_MTCH_FLG = 'N'
				OR	(
								RT.OP_PRC_TRSP_MOD_CD	IS NULL
						OR	BQ.ORG_TRNS_MOD_CD		IS NULL
						OR	RT.OP_PRC_TRSP_MOD_CD	= BQ.ORG_TRNS_MOD_CD
						OR  (
										RT.OP_PRC_TRSP_MOD_CD	IN ( 'R', 'A' )
								AND	BQ.ORG_TRNS_MOD_CD		= 'R'
								)
						)
				)


/*******************************************************************************************
< ORIGIN VIA ( POL OR PRE RELAY ) >
*******************************************************************************************/

AND     (
						RT.OV_ROUT_VIA_PORT_DEF_CD IS NULL
				OR	( RT.OV_ROUT_VIA_PORT_TP_CD, RT.OV_ROUT_VIA_PORT_DEF_CD ) IN
						(
						SELECT	RT_RAR.CONV_ORG_VIA_LOC_TP_CD,	RT_RAR.CONV_ORG_VIA_LOC_DEF_CD
						FROM		DUAL
						UNION ALL
						SELECT  'L', GL.LOC_CD
						FROM		GL
						WHERE		RT_RAR.CONV_ORG_VIA_LOC_TP_CD	= 'G'
						AND		  GL.PRC_GRP_LOC_CD 						= RT_RAR.CONV_ORG_VIA_LOC_DEF_CD
						UNION ALL
						SELECT  'G', GL.PRC_GRP_LOC_CD
						FROM		GL
						WHERE		RT_RAR.CONV_ORG_VIA_LOC_TP_CD	= 'L'
						AND     GL.LOC_CD											= RT_RAR.CONV_ORG_VIA_LOC_DEF_CD
						UNION ALL
						SELECT	'L', BQ.PRE_RLY_PORT_CD
						FROM		DUAL
						UNION ALL
						SELECT  'G', GL.PRC_GRP_LOC_CD
						FROM		GL
						WHERE		GL.LOC_CD						= BQ.PRE_RLY_PORT_CD
						)
				)


/*******************************************************************************************
< DESTINATION VIA ( POD ) >
*******************************************************************************************/

AND     (
						RT.DV_ROUT_VIA_PORT_DEF_CD IS NULL
				OR	( RT.DV_ROUT_VIA_PORT_TP_CD, RT.DV_ROUT_VIA_PORT_DEF_CD ) IN
						(
						SELECT	RT_RAR.CONV_DEST_VIA_LOC_TP_CD,	RT_RAR.CONV_DEST_VIA_LOC_DEF_CD
						FROM		DUAL
						UNION ALL
						SELECT  'L', GL.LOC_CD
						FROM		GL
						WHERE		RT_RAR.CONV_DEST_VIA_LOC_TP_CD	= 'G'
						AND		  GL.PRC_GRP_LOC_CD 						= RT_RAR.CONV_DEST_VIA_LOC_DEF_CD
						UNION ALL
						SELECT  'G', GL.PRC_GRP_LOC_CD
						FROM		GL
						WHERE		RT_RAR.CONV_DEST_VIA_LOC_TP_CD	= 'L'
						AND     GL.LOC_CD											= RT_RAR.CONV_DEST_VIA_LOC_DEF_CD
						)
				)


/*******************************************************************************************
< DESTINATION ( POD ) >
*******************************************************************************************/

AND     ( RT.DP_ROUT_PNT_LOC_TP_CD, RT.DP_ROUT_PNT_LOC_DEF_CD ) IN
				(
				SELECT	RT_RAR.CONV_DEST_VIA_LOC_TP_CD,	RT_RAR.CONV_DEST_VIA_LOC_DEF_CD
				FROM		DUAL
				UNION ALL
				SELECT  'L', GL.LOC_CD
				FROM		GL
				WHERE		RT_RAR.CONV_DEST_VIA_LOC_TP_CD	= 'G'
				AND		  GL.PRC_GRP_LOC_CD 						= RT_RAR.CONV_DEST_VIA_LOC_DEF_CD
				UNION ALL
				SELECT  'G', GL.PRC_GRP_LOC_CD
				FROM		GL
				WHERE		RT_RAR.CONV_DEST_VIA_LOC_TP_CD	= 'L'
				AND     GL.LOC_CD											= RT_RAR.CONV_DEST_VIA_LOC_DEF_CD
				)


/*******************************************************************************************
	9.1.3 RATE - RATING UNIT
*******************************************************************************************/

AND     (
								RT.RAT_UT_CD	= RT_TYP.CONV_RAT_UT_CD
		        OR
    		    (
        				RT.RAT_UT_CD	IN ( '20', '40', 'HC', '45', '53' )
       			AND ( SELECT A.CNTR_SZ_CD FROM PRI_RAT_UT A WHERE A.RAT_UT_CD = RT.RAT_UT_CD )	= RT_TYP.CONV_RAT_UT_SZ_CD
        		)
				)

AND			RT.PRC_CGO_TP_CD	IN ( RT_RAC.CONV_DR_TP, RT_RAC.CONV_DG_TP, RT_RAC.CONV_RF_TP, RT_RAC.CONV_AK_TP, RT_RAC.CONV_BB_TP )


/*******************************************************************************************
	9.2 DEST IHC
*******************************************************************************************/

/*******************************************************************************************
	9.2.2 DEST ARB - ROUTE
*******************************************************************************************/

/*******************************************************************************************
< BASE PORT ( POD ) >
*******************************************************************************************/

AND     ( DI.BSE_PORT_TP_CD, DI.BSE_PORT_DEF_CD ) IN
				(
				SELECT  RT_RAR.CONV_DEST_VIA_LOC_TP_CD, RT_RAR.CONV_DEST_VIA_LOC_DEF_CD
				FROM		DUAL
				UNION ALL
				SELECT  'L', GL.LOC_CD
				FROM		GL
				WHERE		RT_RAR.CONV_DEST_VIA_LOC_TP_CD	= 'G'
				AND		  GL.PRC_GRP_LOC_CD 				= RT_RAR.CONV_DEST_VIA_LOC_DEF_CD
				UNION ALL
				SELECT  'G', GL.PRC_GRP_LOC_CD
				FROM		GL
				WHERE		RT_RAR.CONV_DEST_VIA_LOC_TP_CD	= 'L'
				AND     GL.LOC_CD									= RT_RAR.CONV_DEST_VIA_LOC_DEF_CD
				)


/*******************************************************************************************
< POINT ( DEL ) >
*******************************************************************************************/

AND     ( DI.ROUT_PNT_LOC_TP_CD, DI.ROUT_PNT_LOC_DEF_CD ) IN
				(
				SELECT  RT_RAR.CONV_DEST_LOC_TP_CD, RT_RAR.CONV_DEST_LOC_DEF_CD
				FROM		DUAL
				UNION ALL
				SELECT  'L', GL.LOC_CD
				FROM		GL
				WHERE		RT_RAR.CONV_DEST_LOC_TP_CD	= 'G'
				AND		  GL.PRC_GRP_LOC_CD 				= RT_RAR.CONV_DEST_LOC_DEF_CD
				UNION ALL
				SELECT  'G', GL.PRC_GRP_LOC_CD
				FROM		GL
				WHERE		RT_RAR.CONV_DEST_LOC_TP_CD	= 'L'
				AND     GL.LOC_CD									= RT_RAR.CONV_DEST_LOC_DEF_CD
				)


/*******************************************************************************************
< DE TERM >
*******************************************************************************************/

AND			NVL(DI.RCV_DE_TERM_CD, '*') IN
				(
				SELECT  B.RCV_DE_TERM_CD
				FROM		(
								SELECT 'Y' CONV_PRC_TERM_CD, 'Y' RCV_DE_TERM_CD FROM DUAL UNION ALL
								SELECT 'Y' CONV_PRC_TERM_CD, 'L' RCV_DE_TERM_CD FROM DUAL UNION ALL
								SELECT 'Y' CONV_PRC_TERM_CD, '*' RCV_DE_TERM_CD FROM DUAL UNION ALL
								SELECT 'S' CONV_PRC_TERM_CD, 'S' RCV_DE_TERM_CD FROM DUAL UNION ALL
								SELECT 'S' CONV_PRC_TERM_CD, 'Y' RCV_DE_TERM_CD FROM DUAL UNION ALL
								SELECT 'S' CONV_PRC_TERM_CD, 'T' RCV_DE_TERM_CD FROM DUAL UNION ALL
								SELECT 'S' CONV_PRC_TERM_CD, 'I' RCV_DE_TERM_CD FROM DUAL UNION ALL
								SELECT 'S' CONV_PRC_TERM_CD, 'L' RCV_DE_TERM_CD FROM DUAL UNION ALL
								SELECT 'S' CONV_PRC_TERM_CD, '*' RCV_DE_TERM_CD FROM DUAL UNION ALL
								SELECT 'D' CONV_PRC_TERM_CD, 'D' RCV_DE_TERM_CD FROM DUAL UNION ALL
								SELECT 'T' CONV_PRC_TERM_CD, 'T' RCV_DE_TERM_CD FROM DUAL UNION ALL
								SELECT 'I' CONV_PRC_TERM_CD, 'I' RCV_DE_TERM_CD FROM DUAL
								)	B
				WHERE		B.CONV_PRC_TERM_CD	= RT_DOR.CONV_PRC_DE_TERM_CD
				)


/*******************************************************************************************
	9.2.3 DEST ARB - RATING UNIT
*******************************************************************************************/

/* DEST ARB RATING UNIT */
AND     (
								DI.RAT_UT_CD	= DA_TYP.CONV_RAT_UT_CD
		        OR	DI.RAT_UT_CD	= 'BX'
		        OR
    		    (
        				DI.RAT_UT_CD	IN ( '20', '40', 'HC', '45', '53' )
       			AND ( SELECT A.CNTR_SZ_CD FROM PRI_RAT_UT A WHERE A.RAT_UT_CD = DI.RAT_UT_CD )	= DA_TYP.CONV_RAT_UT_SZ_CD
        		)
				)


/* DEST ARB CARGO TYPE */
AND			NVL(DI.PRC_CGO_TP_CD, '*')	IN ( '*', DA_RAC.CONV_DR_TP, DA_RAC.CONV_DG_TP, DA_RAC.CONV_RF_TP, DA_RAC.CONV_AK_TP, DA_RAC.CONV_BB_TP )


/*******************************************************************************************
	9.2.4 DEST ARB - JOIN
*******************************************************************************************/

/* DEST ARB JOIN ( ADD CONV RULE ) */
AND			DECODE(RT.ADD_RT_APPL_TP_CD, NULL, DECODE(RT.GEN_SPCL_RT_TP_CD, 'S', 'N', 'Y'), 'N', 'N', 'Y') = 'Y'

/* DEST ARB JOIN ( DARB.BPORT = RATE.DEST ) */
AND			NVL(RT.DP_RCV_DE_TERM_CD, '*' )	NOT IN ( 'D', 'S' )

AND			( RT.DP_ROUT_PNT_LOC_TP_CD, RT.DP_ROUT_PNT_LOC_DEF_CD ) IN
				(
				SELECT	DI.BSE_PORT_TP_CD, DI.BSE_PORT_DEF_CD
				FROM		DUAL
				UNION ALL
				SELECT	'L', GL.LOC_CD
				FROM		GL
				WHERE		DI.BSE_PORT_TP_CD	= 'G'
				AND		  GL.PRC_GRP_LOC_CD	= DI.BSE_PORT_DEF_CD
				UNION ALL
				SELECT	'G', GL.PRC_GRP_LOC_CD
				FROM		GL
				WHERE		DI.BSE_PORT_TP_CD	= 'L'
				AND			GL.LOC_CD					= DI.BSE_PORT_DEF_CD
				)


UNION ALL


/*******************************************************************************************
	10. PATTERN #10 ( 0101 )
*******************************************************************************************/

SELECT	'0101'												PRC_RT_MTCH_PATT_CD				,
				BQ.SC_NO											CTRT_NO										,
				BQ.PROP_NO										PROP_NO										,
				BQ.AMDT_SEQ										AMDT_SEQ									,
				BQ.SVC_SCP_CD									SVC_SCP_CD								,
				BQ.BQ_SEQ											BQ_SEQ										,
				BQ.BKG_BQ_SEQ									BKG_BQ_SEQ								,
				BQ.CNTR_TPSZ_CD								BQ_CNTR_TPSZ_CD						,
				BQ.CTRT_CNTR_TPSZ_CD					BQ_CTRT_CNTR_TPSZ_CD			,
				BQ.RCV_TERM_CD								BQ_RCV_TERM_CD						,
				BQ.DE_TERM_CD									BQ_DE_TERM_CD							,
				BQ.DRY_CGO_FLG								BQ_DRY_CGO_FLG						,
				BQ.DCGO_FLG										BQ_DCGO_FLG								,
				BQ.RC_FLG											BQ_RC_FLG									,
				BQ.AWK_CGO_FLG								BQ_AWK_CGO_FLG						,
				BQ.BB_CGO_FLG									BQ_BB_CGO_FLG							,
				BQ.SOC_FLG										BQ_SOC_FLG								,
				BQ.PRC_CGO_TP_CD							BQ_PRC_CGO_TP_CD					,
				BQ.IMDG_CLSS_CD								BQ_IMDG_CLSS_CD						,
				BQ.CTRT_CNTR_QTY							BQ_CTRT_CNTR_QTY					,
				BQ.POR_APPL_FLG								BQ_POR_APPL_FLG						,
				BQ.POL_APPL_FLG								BQ_POL_APPL_FLG						,
				BQ.POD_APPL_FLG								BQ_POD_APPL_FLG						,
				BQ.DEL_APPL_FLG								BQ_DEL_APPL_FLG						,
				BQ.PRE_RLY_PORT_APPL_FLG			BQ_POR_RLY_PORT_APPL_FLG	,
				BQ.PST_RLY_PORT_APPL_FLG			BQ_PST_RLY_PORT_APPL_FLG	,

				RT.CMDT_HDR_SEQ								RT_CMDT_HDR_SEQ						,
				RT.ROUT_SEQ										RT_ROUT_SEQ								,
				RT.RT_SEQ											RT_RT_SEQ									,
				0															OI_ADD_CHG_SEQ						,
				OA.ADD_CHG_SEQ								OA_ADD_CHG_SEQ						,
				0															DA_ADD_CHG_SEQ						,
				DI.ADD_CHG_SEQ								DI_ADD_CHG_SEQ						,

				RT.GEN_SPCL_RT_TP_CD					RT_GEN_SPCL_RT_TP_CD			,
				RT.CM_PRC_CMDT_TP_CD					CM_PRC_CMDT_TP_CD					,
				RT.CM_PRC_CMDT_DEF_CD					CM_PRC_CMDT_DEF_CD				,
				OA.ROUT_PNT_LOC_DEF_CD				POR_CD										,
				'N/A'													POL_CD										,
				RT.DV_ROUT_VIA_PORT_DEF_CD		POD_CD										,
				DI.ROUT_PNT_LOC_DEF_CD				DEL_CD										,
				OA.DIR_CALL_FLG								DIR_CALL_FLG		,
				OA.RCV_DE_TERM_CD							RCV_TERM_CD								,
				DI.RCV_DE_TERM_CD							DE_TERM_CD								,
				RT.RAT_UT_CD									RAT_UT_CD									,
				RT.PRC_CGO_TP_CD							PRC_CGO_TP_CD							,
				RT.CURR_CD										CURR_CD										,
				OA.PRC_TRSP_MOD_CD						ORG_TRSP_MOD_CD						,
				DI.PRC_TRSP_MOD_CD						DEST_TRSP_MOD_CD					,

				RT.OP_ROUT_PNT_LOC_DEF_CD			OP_ROUT_PNT_LOC_DEF_CD		,
				RT.OV_ROUT_VIA_PORT_DEF_CD		OV_ROUT_VIA_PORT_DEF_CD		,
				RT.DV_ROUT_VIA_PORT_DEF_CD		DV_ROUT_VIA_PORT_DEF_CD		,
				RT.DP_ROUT_PNT_LOC_DEF_CD			DP_ROUT_PNT_LOC_DEF_CD		,
				RT.RD_DIR_CALL_FLG						RD_DIR_CALL_FLG						,
				RT.RAT_UT_CD									RT_RAT_UT_CD							,
				RT.PRC_CGO_TP_CD							RT_PRC_CGO_TP_CD					,
				RT.OP_PRC_TRSP_MOD_CD					OP_PRC_TRSP_MOD_CD				,
				RT.DP_PRC_TRSP_MOD_CD					DP_PRC_TRSP_MOD_CD				,
				RT.CURR_CD										RT_CURR_CD								,
				RT.FNL_FRT_RT_AMT							RT_FNL_FRT_RT_AMT					,

				NULL													OI_ROUT_PNT_LOC_DEF_CD		,
				NULL													OI_BSE_PORT_DEF_CD				,
				NULL													OI_VIA_PORT_DEF_CD				,
				NULL													OI_DIR_CALL_FLG						,
				NULL													OI_RAT_UT_CD							,
				NULL													OI_PRC_CGO_TP_CD					,
				NULL													OI_PRC_TRSP_MOD_CD				,
				NULL													OI_RCV_DE_TERM_CD					,
				NULL													OI_PRC_CMDT_DEF_CD				,
				NULL													OI_CURR_CD								,
				NULL													OI_FNL_FRT_RT_AMT					,
				NULL													OI_RAT_UT_MTCH_PRIO				,

				OA.ROUT_PNT_LOC_DEF_CD				OA_ROUT_PNT_LOC_DEF_CD		,
				OA.BSE_PORT_DEF_CD						OA_BSE_PORT_DEF_CD				,
				OA.VIA_PORT_DEF_CD						OA_VIA_PORT_DEF_CD				,
				OA.DIR_CALL_FLG								OA_DIR_CALL_FLG						,
				OA.RAT_UT_CD									OA_RAT_UT_CD							,
				OA.PRC_CGO_TP_CD							OA_PRC_CGO_TP_CD					,
				OA.PRC_TRSP_MOD_CD						OA_PRC_TRSP_MOD_CD				,
				OA.RCV_DE_TERM_CD							OA_RCV_DE_TERM_CD					,
				OA.PRC_CMDT_DEF_CD						OA_PRC_CMDT_DEF_CD				,
				OA.CURR_CD										OA_CURR_CD								,
				OA.FNL_FRT_RT_AMT							OA_FNL_FRT_RT_AMT					,
				OA.RAT_UT_MTCH_PRIO						OA_RAT_UT_MTCH_PRIO				,

				NULL													DA_ROUT_PNT_LOC_DEF_CD		,
				NULL													DA_BSE_PORT_DEF_CD				,
				NULL													DA_VIA_PORT_DEF_CD				,
				NULL													DA_DIR_CALL_FLG						,
				NULL													DA_RAT_UT_CD							,
				NULL													DA_PRC_CGO_TP_CD					,
				NULL													DA_PRC_TRSP_MOD_CD				,
				NULL													DA_RCV_DE_TERM_CD					,
				NULL													DA_PRC_CMDT_DEF_CD				,
				NULL													DA_CURR_CD								,
				NULL													DA_FNL_FRT_RT_AMT					,
				NULL													DA_RAT_UT_MTCH_PRIO				,

				DI.ROUT_PNT_LOC_DEF_CD				DI_ROUT_PNT_LOC_DEF_CD		,
				DI.BSE_PORT_DEF_CD						DI_BSE_PORT_DEF_CD				,
				DI.VIA_PORT_DEF_CD						DI_VIA_PORT_DEF_CD				,
				DI.DIR_CALL_FLG								DI_DIR_CALL_FLG						,
				DI.RAT_UT_CD									DI_RAT_UT_CD							,
				DI.PRC_CGO_TP_CD							DI_PRC_CGO_TP_CD					,
				DI.PRC_TRSP_MOD_CD						DI_PRC_TRSP_MOD_CD				,
				DI.RCV_DE_TERM_CD							DI_RCV_DE_TERM_CD					,
				DI.PRC_CMDT_DEF_CD						DI_PRC_CMDT_DEF_CD				,
				DI.CURR_CD										DI_CURR_CD								,
				DI.FNL_FRT_RT_AMT							DI_FNL_FRT_RT_AMT					,
				DI.RAT_UT_MTCH_PRIO						DI_RAT_UT_MTCH_PRIO				,

				RT_RAP.BKG_CONV_TP_CD      		RT_RAP_BKG_CONV_TP_CD			,
				RT_RAP.NOTE_CONV_MAPG_ID   		RT_RAP_NOTE_CONV_MAPG_ID  ,
				RT_RAP.NOTE_CONV_SEQ       		RT_RAP_NOTE_CONV_SEQ      ,
				RT_RAP.NOTE_CONV_RULE_CD   		RT_RAP_NOTE_CONV_RULE_CD  ,
				RT_RAP.NOTE_CONV_TP_CD     		RT_RAP_NOTE_CONV_TP_CD    ,
				RT_RAP.RT_OP_CD            		RT_RAP_RT_OP_CD           ,
				RT_RAP.CURR_CD             		RT_RAP_CURR_CD            ,
				RT_RAP.FRT_RT_AMT          		RT_RAP_FRT_RT_AMT         ,
				RT_RAP.RAP_CONV_CTNT					RT_RAP_CONV_CTNT					,

				RT_RAR.BKG_CONV_TP_CD      		RT_RAR_BKG_CONV_TP_CD     ,
				RT_RAR.NOTE_CONV_MAPG_ID   		RT_RAR_NOTE_CONV_MAPG_ID  ,
				RT_RAR.NOTE_CONV_SEQ       		RT_RAR_NOTE_CONV_SEQ      ,
				RT_RAR.NOTE_CONV_RULE_CD   		RT_RAR_NOTE_CONV_RULE_CD  ,
				RT_RAR.NOTE_CONV_TP_CD     		RT_RAR_NOTE_CONV_TP_CD    ,
				RT_RAR.RT_OP_CD            		RT_RAR_RT_OP_CD           ,
				RT_RAR.CURR_CD             		RT_RAR_CURR_CD            ,
				RT_RAR.FRT_RT_AMT          		RT_RAR_FRT_RT_AMT         ,
				RT_RAR.RAR_CONV_CTNT					RT_RAR_CONV_CTNT					,

				RT_DOR.BKG_CONV_TP_CD      		RT_DOR_BKG_CONV_TP_CD     ,
				RT_DOR.NOTE_CONV_MAPG_ID   		RT_DOR_NOTE_CONV_MAPG_ID  ,
				RT_DOR.NOTE_CONV_SEQ       		RT_DOR_NOTE_CONV_SEQ      ,
				RT_DOR.NOTE_CONV_RULE_CD   		RT_DOR_NOTE_CONV_RULE_CD  ,
				RT_DOR.NOTE_CONV_TP_CD     		RT_DOR_NOTE_CONV_TP_CD    ,
				RT_DOR.RT_OP_CD            		RT_DOR_RT_OP_CD           ,
				RT_DOR.CURR_CD             		RT_DOR_CURR_CD            ,
				RT_DOR.FRT_RT_AMT          		RT_DOR_FRT_RT_AMT         ,
				RT_DOR.DOR_CONV_CTNT					RT_DOR_CONV_CTNT					,

				RT_TYP.BKG_CONV_TP_CD      		RT_TYP_BKG_CONV_TP_CD     ,
				RT_TYP.NOTE_CONV_MAPG_ID   		RT_TYP_NOTE_CONV_MAPG_ID  ,
				RT_TYP.NOTE_CONV_SEQ       		RT_TYP_NOTE_CONV_SEQ      ,
				RT_TYP.NOTE_CONV_RULE_CD   		RT_TYP_NOTE_CONV_RULE_CD  ,
				RT_TYP.NOTE_CONV_TP_CD     		RT_TYP_NOTE_CONV_TP_CD    ,
				RT_TYP.RT_OP_CD            		RT_TYP_RT_OP_CD           ,
				RT_TYP.CURR_CD             		RT_TYP_CURR_CD            ,
				RT_TYP.FRT_RT_AMT          		RT_TYP_FRT_RT_AMT         ,
				RT_TYP.TYP_CONV_CTNT					RT_TYP_CONV_CTNT					,

				RT_RAC.BKG_CONV_TP_CD      		RT_RAC_BKG_CONV_TP_CD     ,
				RT_RAC.NOTE_CONV_MAPG_ID   		RT_RAC_NOTE_CONV_MAPG_ID  ,
				RT_RAC.NOTE_CONV_SEQ       		RT_RAC_NOTE_CONV_SEQ      ,
				RT_RAC.NOTE_CONV_RULE_CD   		RT_RAC_NOTE_CONV_RULE_CD  ,
				RT_RAC.NOTE_CONV_TP_CD     		RT_RAC_NOTE_CONV_TP_CD    ,
				RT_RAC.RT_OP_CD            		RT_RAC_RT_OP_CD           ,
				RT_RAC.CURR_CD             		RT_RAC_CURR_CD            ,
				RT_RAC.FRT_RT_AMT          		RT_RAC_FRT_RT_AMT         ,
				RT_RAC.RAC_CONV_CTNT					RT_RAC_CONV_CTNT					,

				RT.APP_BKG_CONV_TP_CD      		RT_APP_BKG_CONV_TP_CD     ,
				RT.APP_NOTE_CONV_MAPG_ID   		RT_APP_NOTE_CONV_MAPG_ID  ,
				RT.APP_NOTE_CONV_SEQ       		RT_APP_NOTE_CONV_SEQ      ,
				RT.APP_NOTE_CONV_RULE_CD   		RT_APP_NOTE_CONV_RULE_CD  ,
				RT.APP_NOTE_CONV_TP_CD     		RT_APP_NOTE_CONV_TP_CD    ,
				RT.APP_RT_OP_CD            		RT_APP_RT_OP_CD           ,
				RT.APP_CURR_CD             		RT_APP_CURR_CD            ,
				RT.APP_FRT_RT_AMT          		RT_APP_FRT_RT_AMT         ,

				RT.RAS_BKG_CONV_TP_CD      		RT_RAS_BKG_CONV_TP_CD     ,
				RT.RAS_NOTE_CONV_MAPG_ID   		RT_RAS_NOTE_CONV_MAPG_ID  ,
				RT.RAS_NOTE_CONV_SEQ       		RT_RAS_NOTE_CONV_SEQ      ,
				RT.RAS_NOTE_CONV_RULE_CD   		RT_RAS_NOTE_CONV_RULE_CD  ,
				RT.RAS_NOTE_CONV_TP_CD     		RT_RAS_NOTE_CONV_TP_CD    ,
				RT.RAS_RT_OP_CD            		RT_RAS_RT_OP_CD           ,
				RT.RAS_CURR_CD             		RT_RAS_CURR_CD            ,
				RT.RAS_FRT_RT_AMT          		RT_RAS_FRT_RT_AMT         ,
				RT.RAS_RAS_CONV_CTNT					RT_RAS_CONV_CTNT					,

				RT.ARB_BKG_CONV_TP_CD      		RT_ARB_BKG_CONV_TP_CD     ,
				RT.ARB_NOTE_CONV_MAPG_ID   		RT_ARB_NOTE_CONV_MAPG_ID  ,
				RT.ARB_NOTE_CONV_SEQ       		RT_ARB_NOTE_CONV_SEQ      ,
				RT.ARB_NOTE_CONV_RULE_CD   		RT_ARB_NOTE_CONV_RULE_CD  ,
				RT.ARB_NOTE_CONV_TP_CD     		RT_ARB_NOTE_CONV_TP_CD    ,
				RT.ARB_RT_OP_CD            		RT_ARB_RT_OP_CD           ,
				RT.ARB_CURR_CD             		RT_ARB_CURR_CD            ,
				RT.ARB_FRT_RT_AMT          		RT_ARB_FRT_RT_AMT         ,

				RT.ADD_BKG_CONV_TP_CD      		RT_ADD_BKG_CONV_TP_CD     ,
				RT.ADD_NOTE_CONV_MAPG_ID   		RT_ADD_NOTE_CONV_MAPG_ID  ,
				RT.ADD_NOTE_CONV_SEQ       		RT_ADD_NOTE_CONV_SEQ      ,
				RT.ADD_NOTE_CONV_RULE_CD   		RT_ADD_NOTE_CONV_RULE_CD  ,
				RT.ADD_NOTE_CONV_TP_CD     		RT_ADD_NOTE_CONV_TP_CD    ,
				RT.ADD_RT_OP_CD            		RT_ADD_RT_OP_CD           ,
				RT.ADD_CURR_CD             		RT_ADD_CURR_CD            ,
				RT.ADD_FRT_RT_AMT          		RT_ADD_FRT_RT_AMT         ,

				OA_TYP.BKG_CONV_TP_CD      		OA_TYP_BKG_CONV_TP_CD     ,
				OA_TYP.NOTE_CONV_MAPG_ID   		OA_TYP_NOTE_CONV_MAPG_ID  ,
				OA_TYP.NOTE_CONV_SEQ       		OA_TYP_NOTE_CONV_SEQ      ,
				OA_TYP.NOTE_CONV_RULE_CD   		OA_TYP_NOTE_CONV_RULE_CD  ,
				OA_TYP.NOTE_CONV_TP_CD     		OA_TYP_NOTE_CONV_TP_CD    ,
				OA_TYP.RT_OP_CD            		OA_TYP_RT_OP_CD           ,
				OA_TYP.CURR_CD             		OA_TYP_CURR_CD            ,
				OA_TYP.FRT_RT_AMT          		OA_TYP_FRT_RT_AMT         ,
				OA_TYP.TYP_CONV_CTNT       		OA_TYP_CONV_CTNT         	,

				OA_RAC.BKG_CONV_TP_CD      		OA_RAC_BKG_CONV_TP_CD     ,
				OA_RAC.NOTE_CONV_MAPG_ID   		OA_RAC_NOTE_CONV_MAPG_ID  ,
				OA_RAC.NOTE_CONV_SEQ       		OA_RAC_NOTE_CONV_SEQ      ,
				OA_RAC.NOTE_CONV_RULE_CD   		OA_RAC_NOTE_CONV_RULE_CD  ,
				OA_RAC.NOTE_CONV_TP_CD     		OA_RAC_NOTE_CONV_TP_CD    ,
				OA_RAC.RT_OP_CD            		OA_RAC_RT_OP_CD           ,
				OA_RAC.CURR_CD             		OA_RAC_CURR_CD            ,
				OA_RAC.FRT_RT_AMT          		OA_RAC_FRT_RT_AMT         ,
				OA_RAC.RAC_CONV_CTNT       		OA_RAC_CONV_CTNT         	,

				DA_TYP.BKG_CONV_TP_CD      		DA_TYP_BKG_CONV_TP_CD     ,
				DA_TYP.NOTE_CONV_MAPG_ID   		DA_TYP_NOTE_CONV_MAPG_ID  ,
				DA_TYP.NOTE_CONV_SEQ       		DA_TYP_NOTE_CONV_SEQ      ,
				DA_TYP.NOTE_CONV_RULE_CD   		DA_TYP_NOTE_CONV_RULE_CD  ,
				DA_TYP.NOTE_CONV_TP_CD     		DA_TYP_NOTE_CONV_TP_CD    ,
				DA_TYP.RT_OP_CD            		DA_TYP_DA_OP_CD           ,
				DA_TYP.CURR_CD             		DA_TYP_CURR_CD            ,
				DA_TYP.FRT_RT_AMT          		DA_TYP_FRT_RT_AMT					,
				DA_TYP.TYP_CONV_CTNT       		DA_TYP_CONV_CTNT         	,

				DA_RAC.BKG_CONV_TP_CD      		DA_RAC_BKG_CONV_TP_CD     ,
				DA_RAC.NOTE_CONV_MAPG_ID   		DA_RAC_NOTE_CONV_MAPG_ID  ,
				DA_RAC.NOTE_CONV_SEQ       		DA_RAC_NOTE_CONV_SEQ      ,
				DA_RAC.NOTE_CONV_RULE_CD   		DA_RAC_NOTE_CONV_RULE_CD  ,
				DA_RAC.NOTE_CONV_TP_CD     		DA_RAC_NOTE_CONV_TP_CD    ,
				DA_RAC.RT_OP_CD            		DA_RAC_DA_OP_CD           ,
				DA_RAC.CURR_CD             		DA_RAC_CURR_CD            ,
				DA_RAC.FRT_RT_AMT          		DA_RAC_FRT_RT_AMT					,
				DA_RAC.RAC_CONV_CTNT       		DA_RAC_CONV_CTNT         	,

				OA.POR_MTCH_FLG								POR_MTCH_FLG							,
				'Y'														DEL_MTCH_FLG

FROM
/*******************************************************************************************
JOIN TABLE
1.1 BQ, CH, CM, CR, RD, OP, DV, DP, RT
1.2 RT RULE					: RAP, RAR, TYP, RAC, APP, RAS, ARB, ADD
2.1 OA							: O
2.2 OA RULE					: TYP, RAC ( RAP, RAR, DOR 는 RT 와 동일하게 적용 )
3.1 DA							: O
3.2 DA RULE					: TYP, RAC ( RAP, RAR, DOR 는 RT 와 동일하게 적용 )
*******************************************************************************************/
				BQ	,
				OA	,
				DI	,
				RT	,
				NC_P											RT_RAP	,			/* COMMODITY CONVERSION */
				NC_P											RT_RAR	,			/* ROUTE CONVERSION */
				NC_P											RT_DOR	,			/* R/D TERM CONVERSION */
				NC_P											RT_TYP	,			/* RATING UNIT CONVERSION */
				NC_P											RT_RAC	,			/* CARGO TYPE CONVERSION */
				NC_P											OA_TYP	,			/* RATING UNIT CONVERSION */
				NC_P											OA_RAC	,			/* CARGO TYPE CONVERSION */
				NC_P											DA_TYP	,			/* RATING UNIT CONVERSION */
				NC_P											DA_RAC				/* CARGO TYPE CONVERSION */

WHERE		RT.BQ_SEQ		=	BQ.BQ_SEQ
AND			OA.BQ_SEQ		= BQ.BQ_SEQ
AND			DI.BQ_SEQ		= BQ.BQ_SEQ
AND			RT_RAP.BQ_SEQ	= RT.BQ_SEQ AND RT_RAP.NOTE_CONV_RULE_CD = 'RAP' AND ( RT_RAP.BKG_CONV_TP_CD = 'B' OR RT_RAP.NC_SEQ = RT.RAP_NC_SEQ )
AND			RT_RAR.BQ_SEQ	= RT.BQ_SEQ AND RT_RAR.NOTE_CONV_RULE_CD = 'RAR' AND ( RT_RAR.BKG_CONV_TP_CD = 'B' OR RT_RAR.NC_SEQ = RT.RAR_NC_SEQ )
AND			RT_DOR.BQ_SEQ	= RT.BQ_SEQ AND RT_DOR.NOTE_CONV_RULE_CD = 'DOR' AND ( RT_DOR.BKG_CONV_TP_CD = 'B' OR RT_DOR.NC_SEQ = RT.DOR_NC_SEQ )
AND			RT_TYP.BQ_SEQ	= RT.BQ_SEQ AND RT_TYP.NOTE_CONV_RULE_CD = 'TYP' AND ( RT_TYP.BKG_CONV_TP_CD = 'B' OR RT_TYP.NC_SEQ = RT.TYP_NC_SEQ )
AND			RT_RAC.BQ_SEQ	= RT.BQ_SEQ AND RT_RAC.NOTE_CONV_RULE_CD = 'RAC' AND ( RT_RAC.BKG_CONV_TP_CD = 'B' OR RT_RAC.NC_SEQ = RT.RAC_NC_SEQ )
AND			OA_TYP.BQ_SEQ	= RT.BQ_SEQ AND OA_TYP.NOTE_CONV_RULE_CD = 'TYP' AND ( OA_TYP.BKG_CONV_TP_CD = 'B' OR OA_TYP.NC_SEQ = RT.TYP_NC_SEQ )
AND			OA_RAC.BQ_SEQ	= RT.BQ_SEQ AND OA_RAC.NOTE_CONV_RULE_CD = 'RAC' AND ( OA_RAC.BKG_CONV_TP_CD = 'B' OR OA_RAC.NC_SEQ = RT.RAC_NC_SEQ )
AND			DA_TYP.BQ_SEQ	= RT.BQ_SEQ AND DA_TYP.NOTE_CONV_RULE_CD = 'TYP' AND ( DA_TYP.BKG_CONV_TP_CD = 'B' OR DA_TYP.NC_SEQ = RT.TYP_NC_SEQ )
AND			DA_RAC.BQ_SEQ	= RT.BQ_SEQ AND DA_RAC.NOTE_CONV_RULE_CD = 'RAC' AND ( DA_RAC.BKG_CONV_TP_CD = 'B' OR DA_RAC.NC_SEQ = RT.RAC_NC_SEQ )


/*******************************************************************************************
	10.1 RATE
*******************************************************************************************/

/*******************************************************************************************
	10.1.1 RATE - COMMODITY
*******************************************************************************************/

/*******************************************************************************************
< COMMODITY >
그룹, 개별간으로 일치하는 경우
*******************************************************************************************/

AND			( RT.CM_PRC_CMDT_TP_CD, RT.CM_PRC_CMDT_DEF_CD ) IN
				(
				SELECT	RT_RAP.CONV_CMDT_TP_CD, RT_RAP.CONV_CMDT_DEF_CD
				FROM		DUAL
				UNION ALL
				SELECT  'C', GC.PRC_CMDT_DEF_CD
				FROM		GC
				WHERE		RT_RAP.CONV_CMDT_TP_CD	= 'G'
				AND     GC.PRC_CMDT_TP_CD   		= 'C'
				AND			GC.PRC_GRP_CMDT_CD  		= RT_RAP.CONV_CMDT_DEF_CD
				UNION ALL
				SELECT  'G', GC.PRC_GRP_CMDT_CD
				FROM		GC
				WHERE		RT_RAP.CONV_CMDT_TP_CD	= 'C'
				AND     GC.PRC_CMDT_TP_CD   		= 'C'
				AND     GC.PRC_CMDT_DEF_CD  		= RT_RAP.CONV_CMDT_DEF_CD
				UNION ALL
				/* TAW 일 경우 FAK 고려함 */
				SELECT	'C', CMDT_CD
				FROM		MDM_COMMODITY
				WHERE		REP_CMDT_CD		= '0000'
				UNION ALL
				SELECT	'G', GC.PRC_GRP_CMDT_CD
				FROM		GC
				WHERE		GC.PRC_CMDT_TP_CD		= 'C'
				AND			GC.PRC_CMDT_DEF_CD  IN ( SELECT CMDT_CD FROM MDM_COMMODITY WHERE REP_CMDT_CD = '0000' )
				)


/*******************************************************************************************
	10.1.2 RATE - ROUTE
*******************************************************************************************/

/*******************************************************************************************
< ORIGIN ( PRE RELAY ) >
*******************************************************************************************/

AND     ( RT.OP_ROUT_PNT_LOC_TP_CD, RT.OP_ROUT_PNT_LOC_DEF_CD ) IN
				(
				SELECT	'L', BQ.PRE_RLY_PORT_CD
				FROM		DUAL
				UNION ALL
				SELECT  'G', GL.PRC_GRP_LOC_CD
				FROM		GL
				WHERE		GL.LOC_CD						= BQ.PRE_RLY_PORT_CD
				)


/*******************************************************************************************
< ORIGIN VIA ( PRE RELAY ) >
*******************************************************************************************/

AND     (
						RT.OV_ROUT_VIA_PORT_DEF_CD IS NULL
				OR	( RT.OV_ROUT_VIA_PORT_TP_CD, RT.OV_ROUT_VIA_PORT_DEF_CD ) IN
						(
						SELECT	'L', BQ.PRE_RLY_PORT_CD
						FROM		DUAL
						UNION ALL
						SELECT  'G', GL.PRC_GRP_LOC_CD
						FROM		GL
						WHERE		GL.LOC_CD						= BQ.PRE_RLY_PORT_CD
						)
				)


/*******************************************************************************************
< DESTINATION VIA ( POD ) >
*******************************************************************************************/

AND     (
						RT.DV_ROUT_VIA_PORT_DEF_CD IS NULL
				OR	( RT.DV_ROUT_VIA_PORT_TP_CD, RT.DV_ROUT_VIA_PORT_DEF_CD ) IN
						(
						SELECT  RT_RAR.CONV_DEST_VIA_LOC_TP_CD, RT_RAR.CONV_DEST_VIA_LOC_DEF_CD
						FROM		DUAL
						UNION ALL
						SELECT  'L', GL.LOC_CD
						FROM		GL
						WHERE		RT_RAR.CONV_DEST_VIA_LOC_TP_CD	= 'G'
						AND		  GL.PRC_GRP_LOC_CD 				= RT_RAR.CONV_DEST_VIA_LOC_DEF_CD
						UNION ALL
						SELECT  'G', GL.PRC_GRP_LOC_CD
						FROM		GL
						WHERE		RT_RAR.CONV_DEST_VIA_LOC_TP_CD	= 'L'
						AND     GL.LOC_CD									= RT_RAR.CONV_DEST_VIA_LOC_DEF_CD
						)
				)


/*******************************************************************************************
< DESTINATION ( POD ) >
*******************************************************************************************/

AND			( RT.DP_ROUT_PNT_LOC_TP_CD, RT.DP_ROUT_PNT_LOC_DEF_CD ) IN
				(
				SELECT  RT_RAR.CONV_DEST_VIA_LOC_TP_CD, RT_RAR.CONV_DEST_VIA_LOC_DEF_CD
				FROM		DUAL
				UNION ALL
				SELECT  'L', GL.LOC_CD
				FROM		GL
				WHERE		RT_RAR.CONV_DEST_VIA_LOC_TP_CD	= 'G'
				AND		  GL.PRC_GRP_LOC_CD 				= RT_RAR.CONV_DEST_VIA_LOC_DEF_CD
				UNION ALL
				SELECT  'G', GL.PRC_GRP_LOC_CD
				FROM		GL
				WHERE		RT_RAR.CONV_DEST_VIA_LOC_TP_CD	= 'L'
				AND     GL.LOC_CD									= RT_RAR.CONV_DEST_VIA_LOC_DEF_CD
				)


/*******************************************************************************************
	10.1.3 RATE - RATING UNIT
*******************************************************************************************/

AND     (
								RT.RAT_UT_CD	= RT_TYP.CONV_RAT_UT_CD
		        OR
    		    (
        				RT.RAT_UT_CD	IN ( '20', '40', 'HC', '45', '53' )
       			AND ( SELECT A.CNTR_SZ_CD FROM PRI_RAT_UT A WHERE A.RAT_UT_CD = RT.RAT_UT_CD )	= RT_TYP.CONV_RAT_UT_SZ_CD
        		)
				)

AND			RT.PRC_CGO_TP_CD	IN ( RT_RAC.CONV_DR_TP, RT_RAC.CONV_DG_TP, RT_RAC.CONV_RF_TP, RT_RAC.CONV_AK_TP, RT_RAC.CONV_BB_TP )


/*******************************************************************************************
	10.2 ORIGIN ARB
*******************************************************************************************/

/*******************************************************************************************
	10.2.1 ORIGIN ARB - COMMODITY
*******************************************************************************************/

AND			(
						OA.PRC_CMDT_DEF_CD	IS NULL
				OR	( OA.PRC_CMDT_TP_CD, OA.PRC_CMDT_DEF_CD ) IN
						(
						SELECT	RT_RAP.CONV_CMDT_TP_CD, RT_RAP.CONV_CMDT_DEF_CD
						FROM		DUAL
						UNION ALL
						SELECT  'C', GC.PRC_CMDT_DEF_CD
						FROM		GC
						WHERE		RT_RAP.CONV_CMDT_TP_CD	= 'G'
						AND     GC.PRC_CMDT_TP_CD   		= 'C'
						AND			GC.PRC_GRP_CMDT_CD  		= RT_RAP.CONV_CMDT_DEF_CD
						UNION ALL
						SELECT  'G', GC.PRC_GRP_CMDT_CD
						FROM		GC
						WHERE		RT_RAP.CONV_CMDT_TP_CD	= 'C'
						AND     GC.PRC_CMDT_TP_CD   		= 'C'
						AND     GC.PRC_CMDT_DEF_CD  		= RT_RAP.CONV_CMDT_DEF_CD
						UNION ALL
						/* TAW 일 경우 FAK 고려함 */
						SELECT	'C', CMDT_CD
						FROM		MDM_COMMODITY
						WHERE		REP_CMDT_CD		= '0000'
						UNION ALL
						SELECT	'G', GC.PRC_GRP_CMDT_CD
						FROM		GC
						WHERE		GC.PRC_CMDT_TP_CD		= 'C'
						AND			GC.PRC_CMDT_DEF_CD  IN ( SELECT CMDT_CD FROM MDM_COMMODITY WHERE REP_CMDT_CD = '0000' )
						)
				)


/*******************************************************************************************
	10.2.2 ORIGIN ARB - ROUTE
*******************************************************************************************/

/*******************************************************************************************
< POINT ( POR OR POL ) >
*******************************************************************************************/

AND     ( OA.ROUT_PNT_LOC_TP_CD, OA.ROUT_PNT_LOC_DEF_CD ) IN
				(
				SELECT  RT_RAR.CONV_ORG_LOC_TP_CD, RT_RAR.CONV_ORG_LOC_DEF_CD
				FROM		DUAL
				UNION ALL
				SELECT  'L', GL.LOC_CD
				FROM		GL
				WHERE		RT_RAR.CONV_ORG_LOC_TP_CD	= 'G'
				AND		  GL.PRC_GRP_LOC_CD 				= RT_RAR.CONV_ORG_LOC_DEF_CD
				UNION ALL
				SELECT  'G', GL.PRC_GRP_LOC_CD
				FROM		GL
				WHERE		RT_RAR.CONV_ORG_LOC_TP_CD	= 'L'
				AND     GL.LOC_CD									= RT_RAR.CONV_ORG_LOC_DEF_CD
				UNION ALL
				SELECT	RT_RAR.CONV_ORG_VIA_LOC_TP_CD,	RT_RAR.CONV_ORG_VIA_LOC_DEF_CD
				FROM		DUAL
				UNION ALL
				SELECT  'L', GL.LOC_CD
				FROM		GL
				WHERE		RT_RAR.CONV_ORG_VIA_LOC_TP_CD	= 'G'
				AND		  GL.PRC_GRP_LOC_CD 				= RT_RAR.CONV_ORG_VIA_LOC_DEF_CD
				UNION ALL
				SELECT  'G', GL.PRC_GRP_LOC_CD
				FROM		GL
				WHERE		RT_RAR.CONV_ORG_VIA_LOC_TP_CD	= 'L'
				AND     GL.LOC_CD									= RT_RAR.CONV_ORG_VIA_LOC_DEF_CD
				)


/*******************************************************************************************
< RCV TERM >
*******************************************************************************************/

AND     (
						(
								OA.POR_MTCH_FLG			= 'Y'
						AND	NVL(OA.RCV_DE_TERM_CD, '*') IN
								(
								SELECT  B.RCV_DE_TERM_CD
								FROM		(
												SELECT 'Y' CONV_PRC_TERM_CD, 'Y' RCV_DE_TERM_CD FROM DUAL UNION ALL
												SELECT 'Y' CONV_PRC_TERM_CD, 'L' RCV_DE_TERM_CD FROM DUAL UNION ALL
												SELECT 'Y' CONV_PRC_TERM_CD, '*' RCV_DE_TERM_CD FROM DUAL UNION ALL
												SELECT 'S' CONV_PRC_TERM_CD, 'S' RCV_DE_TERM_CD FROM DUAL UNION ALL
												SELECT 'D' CONV_PRC_TERM_CD, 'D' RCV_DE_TERM_CD FROM DUAL UNION ALL
												SELECT 'T' CONV_PRC_TERM_CD, 'T' RCV_DE_TERM_CD FROM DUAL UNION ALL
												SELECT 'I' CONV_PRC_TERM_CD, 'I' RCV_DE_TERM_CD FROM DUAL
												)	B
								WHERE		B.CONV_PRC_TERM_CD	= RT_DOR.CONV_PRC_RCV_TERM_CD
								)
						)
				OR	(
								BQ.POR_CD										= BQ.POL_CD
						AND	NVL(OA.RCV_DE_TERM_CD, '*') IN
								(
								SELECT  B.RCV_DE_TERM_CD
								FROM		(
												SELECT 'Y' CONV_PRC_TERM_CD, 'Y' RCV_DE_TERM_CD FROM DUAL UNION ALL
												SELECT 'Y' CONV_PRC_TERM_CD, 'L' RCV_DE_TERM_CD FROM DUAL UNION ALL
												SELECT 'Y' CONV_PRC_TERM_CD, '*' RCV_DE_TERM_CD FROM DUAL UNION ALL
												SELECT 'S' CONV_PRC_TERM_CD, 'S' RCV_DE_TERM_CD FROM DUAL UNION ALL
												SELECT 'D' CONV_PRC_TERM_CD, 'D' RCV_DE_TERM_CD FROM DUAL UNION ALL
												SELECT 'D' CONV_PRC_TERM_CD, 'Y' RCV_DE_TERM_CD FROM DUAL UNION ALL	-- 예외 적용
												SELECT 'T' CONV_PRC_TERM_CD, 'T' RCV_DE_TERM_CD FROM DUAL UNION ALL
												SELECT 'I' CONV_PRC_TERM_CD, 'I' RCV_DE_TERM_CD FROM DUAL
												)	B
								WHERE		B.CONV_PRC_TERM_CD	= RT_DOR.CONV_PRC_RCV_TERM_CD
								)
						)
				OR	(
								OA.POR_MTCH_FLG 								= 'N'
						AND	NVL(OA.RCV_DE_TERM_CD, '*')	IN ( 'Y', '*' )
						)
				)


/*******************************************************************************************
< ORIGIN TRANS MODE >
*******************************************************************************************/

AND			(
					  OA.POR_MTCH_FLG = 'N'
				OR	(
								OA.PRC_TRSP_MOD_CD		IS NULL
						OR	BQ.ORG_TRNS_MOD_CD		IS NULL
						OR	OA.PRC_TRSP_MOD_CD		= BQ.ORG_TRNS_MOD_CD
						OR  (
										OA.PRC_TRSP_MOD_CD		IN ( 'R', 'A' )
								AND	BQ.ORG_TRNS_MOD_CD		= 'R'
								)
						)
				)


/*******************************************************************************************
< VIA PORT ( PRE RELAY ) >
*******************************************************************************************/

AND     (
                OA.VIA_PORT_DEF_CD  IS NULL
            OR	( OA.VIA_PORT_TP_CD, OA.VIA_PORT_DEF_CD ) IN
								(
								SELECT	'L', BQ.PRE_RLY_PORT_CD
								FROM		DUAL
								UNION ALL
								SELECT  'G', GL.PRC_GRP_LOC_CD
								FROM		GL
								WHERE		GL.LOC_CD						= BQ.PRE_RLY_PORT_CD
								)
        )


/*******************************************************************************************
	10.2.3 ORIGIN ARB - RATING UNIT
*******************************************************************************************/

/* ORIGIN ARB RATING UNIT */
AND     (
								OA.RAT_UT_CD	= OA_TYP.CONV_RAT_UT_CD
		        OR	OA.RAT_UT_CD	= 'BX'
		        OR
    		    (
        				OA.RAT_UT_CD	IN ( '20', '40', 'HC', '45', '53' )
       			AND ( SELECT A.CNTR_SZ_CD FROM PRI_RAT_UT A WHERE A.RAT_UT_CD = OA.RAT_UT_CD )	= OA_TYP.CONV_RAT_UT_SZ_CD
        		)
				)

/* ORIGIN ARB CARGO TYPE */
AND			NVL(OA.PRC_CGO_TP_CD, '*')	IN ('*', OA_RAC.CONV_DR_TP, OA_RAC.CONV_DG_TP, OA_RAC.CONV_RF_TP, OA_RAC.CONV_AK_TP, OA_RAC.CONV_BB_TP )


/*******************************************************************************************
	10.2.4 ORIGIN ARB - JOIN
*******************************************************************************************/

/* ORIGIN ARB JOIN ( ARB CONV RULE ) */
AND			DECODE(RT.ARB_RT_APPL_TP_CD, NULL, DECODE(RT.GEN_SPCL_RT_TP_CD, 'S', 'N', 'Y'), 'N', 'N', 'Y') = 'Y'

/* ORIGIN ARB JOIN ( OARB.BPORT = RATE.ORIGIN ) */
AND			NVL(RT.OP_RCV_DE_TERM_CD, '*' )	NOT IN ( 'D', 'S' )

AND			( RT.OP_ROUT_PNT_LOC_TP_CD, RT.OP_ROUT_PNT_LOC_DEF_CD ) IN
				(
				SELECT	OA.BSE_PORT_TP_CD, OA.BSE_PORT_DEF_CD
				FROM		DUAL
				UNION ALL
				SELECT	'L', GL.LOC_CD
				FROM		GL
				WHERE		OA.BSE_PORT_TP_CD	= 'G'
				AND		  GL.PRC_GRP_LOC_CD	= OA.BSE_PORT_DEF_CD
				UNION ALL
				SELECT	'G', GL.PRC_GRP_LOC_CD
				FROM		GL
				WHERE		OA.BSE_PORT_TP_CD	= 'L'
				AND			GL.LOC_CD					= OA.BSE_PORT_DEF_CD
				)


/*******************************************************************************************
	10.3 DEST IHC
*******************************************************************************************/

/*******************************************************************************************
	10.3.2 DEST ARB - ROUTE
*******************************************************************************************/

/*******************************************************************************************
< BASE PORT ( POD ) >
*******************************************************************************************/

AND     ( DI.BSE_PORT_TP_CD, DI.BSE_PORT_DEF_CD ) IN
				(
				SELECT  RT_RAR.CONV_DEST_VIA_LOC_TP_CD, RT_RAR.CONV_DEST_VIA_LOC_DEF_CD
				FROM		DUAL
				UNION ALL
				SELECT  'L', GL.LOC_CD
				FROM		GL
				WHERE		RT_RAR.CONV_DEST_VIA_LOC_TP_CD	= 'G'
				AND		  GL.PRC_GRP_LOC_CD 				= RT_RAR.CONV_DEST_VIA_LOC_DEF_CD
				UNION ALL
				SELECT  'G', GL.PRC_GRP_LOC_CD
				FROM		GL
				WHERE		RT_RAR.CONV_DEST_VIA_LOC_TP_CD	= 'L'
				AND     GL.LOC_CD									= RT_RAR.CONV_DEST_VIA_LOC_DEF_CD
				)


/*******************************************************************************************
< POINT ( DEL ) >
*******************************************************************************************/

AND     ( DI.ROUT_PNT_LOC_TP_CD, DI.ROUT_PNT_LOC_DEF_CD ) IN
				(
				SELECT  RT_RAR.CONV_DEST_LOC_TP_CD, RT_RAR.CONV_DEST_LOC_DEF_CD
				FROM		DUAL
				UNION ALL
				SELECT  'L', GL.LOC_CD
				FROM		GL
				WHERE		RT_RAR.CONV_DEST_LOC_TP_CD	= 'G'
				AND		  GL.PRC_GRP_LOC_CD 				= RT_RAR.CONV_DEST_LOC_DEF_CD
				UNION ALL
				SELECT  'G', GL.PRC_GRP_LOC_CD
				FROM		GL
				WHERE		RT_RAR.CONV_DEST_LOC_TP_CD	= 'L'
				AND     GL.LOC_CD									= RT_RAR.CONV_DEST_LOC_DEF_CD
				)


/*******************************************************************************************
< DE TERM >
*******************************************************************************************/

AND			NVL(DI.RCV_DE_TERM_CD, '*') IN
				(
				SELECT  B.RCV_DE_TERM_CD
				FROM		(
								SELECT 'Y' CONV_PRC_TERM_CD, 'Y' RCV_DE_TERM_CD FROM DUAL UNION ALL
								SELECT 'Y' CONV_PRC_TERM_CD, 'L' RCV_DE_TERM_CD FROM DUAL UNION ALL
								SELECT 'Y' CONV_PRC_TERM_CD, '*' RCV_DE_TERM_CD FROM DUAL UNION ALL
								SELECT 'S' CONV_PRC_TERM_CD, 'S' RCV_DE_TERM_CD FROM DUAL UNION ALL
								SELECT 'S' CONV_PRC_TERM_CD, 'Y' RCV_DE_TERM_CD FROM DUAL UNION ALL
								SELECT 'S' CONV_PRC_TERM_CD, 'T' RCV_DE_TERM_CD FROM DUAL UNION ALL
								SELECT 'S' CONV_PRC_TERM_CD, 'I' RCV_DE_TERM_CD FROM DUAL UNION ALL
								SELECT 'S' CONV_PRC_TERM_CD, 'L' RCV_DE_TERM_CD FROM DUAL UNION ALL
								SELECT 'S' CONV_PRC_TERM_CD, '*' RCV_DE_TERM_CD FROM DUAL UNION ALL
								SELECT 'D' CONV_PRC_TERM_CD, 'D' RCV_DE_TERM_CD FROM DUAL UNION ALL
								SELECT 'T' CONV_PRC_TERM_CD, 'T' RCV_DE_TERM_CD FROM DUAL UNION ALL
								SELECT 'I' CONV_PRC_TERM_CD, 'I' RCV_DE_TERM_CD FROM DUAL
								)	B
				WHERE		B.CONV_PRC_TERM_CD	= RT_DOR.CONV_PRC_DE_TERM_CD
				)


/*******************************************************************************************
	10.3.3 DEST ARB - RATING UNIT
*******************************************************************************************/

/* DEST ARB RATING UNIT */
AND     (
								DI.RAT_UT_CD	= DA_TYP.CONV_RAT_UT_CD
		        OR	DI.RAT_UT_CD	= 'BX'
		        OR
    		    (
        				DI.RAT_UT_CD	IN ( '20', '40', 'HC', '45', '53' )
       			AND ( SELECT A.CNTR_SZ_CD FROM PRI_RAT_UT A WHERE A.RAT_UT_CD = DI.RAT_UT_CD )	= DA_TYP.CONV_RAT_UT_SZ_CD
        		)
				)


/* DEST ARB CARGO TYPE */
AND			NVL(DI.PRC_CGO_TP_CD, '*')	IN ( '*', DA_RAC.CONV_DR_TP, DA_RAC.CONV_DG_TP, DA_RAC.CONV_RF_TP, DA_RAC.CONV_AK_TP, DA_RAC.CONV_BB_TP )


/*******************************************************************************************
	10.3.4 DEST ARB - JOIN
*******************************************************************************************/

/* DEST ARB JOIN ( ADD CONV RULE ) */
AND			DECODE(RT.ADD_RT_APPL_TP_CD, NULL, DECODE(RT.GEN_SPCL_RT_TP_CD, 'S', 'N', 'Y'), 'N', 'N', 'Y') = 'Y'

/* DEST ARB JOIN ( DARB.BPORT = RATE.DEST ) */
AND			NVL(RT.DP_RCV_DE_TERM_CD, '*' )	NOT IN ( 'D', 'S' )

AND			( RT.DP_ROUT_PNT_LOC_TP_CD, RT.DP_ROUT_PNT_LOC_DEF_CD ) IN
				(
				SELECT	DI.BSE_PORT_TP_CD, DI.BSE_PORT_DEF_CD
				FROM		DUAL
				UNION ALL
				SELECT	'L', GL.LOC_CD
				FROM		GL
				WHERE		DI.BSE_PORT_TP_CD	= 'G'
				AND		  GL.PRC_GRP_LOC_CD	= DI.BSE_PORT_DEF_CD
				UNION ALL
				SELECT	'G', GL.PRC_GRP_LOC_CD
				FROM		GL
				WHERE		DI.BSE_PORT_TP_CD	= 'L'
				AND			GL.LOC_CD					= DI.BSE_PORT_DEF_CD
				)


UNION ALL


/*******************************************************************************************
	11. PATTERN #11 ( 1001 )
*******************************************************************************************/

SELECT	'1001'												PRC_RT_MTCH_PATT_CD				,
				BQ.SC_NO											CTRT_NO										,
				BQ.PROP_NO										PROP_NO										,
				BQ.AMDT_SEQ										AMDT_SEQ									,
				BQ.SVC_SCP_CD									SVC_SCP_CD								,
				BQ.BQ_SEQ											BQ_SEQ										,
				BQ.BKG_BQ_SEQ									BKG_BQ_SEQ								,
				BQ.CNTR_TPSZ_CD								BQ_CNTR_TPSZ_CD						,
				BQ.CTRT_CNTR_TPSZ_CD					BQ_CTRT_CNTR_TPSZ_CD			,
				BQ.RCV_TERM_CD								BQ_RCV_TERM_CD						,
				BQ.DE_TERM_CD									BQ_DE_TERM_CD							,
				BQ.DRY_CGO_FLG								BQ_DRY_CGO_FLG						,
				BQ.DCGO_FLG										BQ_DCGO_FLG								,
				BQ.RC_FLG											BQ_RC_FLG									,
				BQ.AWK_CGO_FLG								BQ_AWK_CGO_FLG						,
				BQ.BB_CGO_FLG									BQ_BB_CGO_FLG							,
				BQ.SOC_FLG										BQ_SOC_FLG								,
				BQ.PRC_CGO_TP_CD							BQ_PRC_CGO_TP_CD					,
				BQ.IMDG_CLSS_CD								BQ_IMDG_CLSS_CD						,
				BQ.CTRT_CNTR_QTY							BQ_CTRT_CNTR_QTY					,
				BQ.POR_APPL_FLG								BQ_POR_APPL_FLG						,
				BQ.POL_APPL_FLG								BQ_POL_APPL_FLG						,
				BQ.POD_APPL_FLG								BQ_POD_APPL_FLG						,
				BQ.DEL_APPL_FLG								BQ_DEL_APPL_FLG						,
				BQ.PRE_RLY_PORT_APPL_FLG			BQ_POR_RLY_PORT_APPL_FLG	,
				BQ.PST_RLY_PORT_APPL_FLG			BQ_PST_RLY_PORT_APPL_FLG	,

				RT.CMDT_HDR_SEQ								RT_CMDT_HDR_SEQ						,
				RT.ROUT_SEQ										RT_ROUT_SEQ								,
				RT.RT_SEQ											RT_RT_SEQ									,
				OI.ADD_CHG_SEQ								OI_ADD_CHG_SEQ						,
				0															OA_ADD_CHG_SEQ						,
				0															DA_ADD_CHG_SEQ						,
				DI.ADD_CHG_SEQ								DI_ADD_CHG_SEQ						,

				RT.GEN_SPCL_RT_TP_CD					RT_GEN_SPCL_RT_TP_CD			,
				RT.CM_PRC_CMDT_TP_CD					CM_PRC_CMDT_TP_CD					,
				RT.CM_PRC_CMDT_DEF_CD					CM_PRC_CMDT_DEF_CD				,
				OI.ROUT_PNT_LOC_DEF_CD				POR_CD										,
				RT.OP_ROUT_PNT_LOC_DEF_CD			POL_CD										,
				RT.DP_ROUT_PNT_LOC_DEF_CD			POD_CD										,
				DI.ROUT_PNT_LOC_DEF_CD				DEL_CD										,
				NULL													DIR_CALL_FLG							,
				OI.RCV_DE_TERM_CD							RCV_TERM_CD								,
				DI.RCV_DE_TERM_CD							DE_TERM_CD								,
				RT.RAT_UT_CD									RAT_UT_CD									,
				RT.PRC_CGO_TP_CD							PRC_CGO_TP_CD							,
				RT.CURR_CD										CURR_CD										,
				OI.PRC_TRSP_MOD_CD						ORG_TRSP_MOD_CD						,
				DI.PRC_TRSP_MOD_CD						DEST_TRSP_MOD_CD					,

				RT.OP_ROUT_PNT_LOC_DEF_CD			OP_ROUT_PNT_LOC_DEF_CD		,
				RT.OV_ROUT_VIA_PORT_DEF_CD		OV_ROUT_VIA_PORT_DEF_CD		,
				RT.DV_ROUT_VIA_PORT_DEF_CD		DV_ROUT_VIA_PORT_DEF_CD		,
				RT.DP_ROUT_PNT_LOC_DEF_CD			DP_ROUT_PNT_LOC_DEF_CD		,
				RT.RD_DIR_CALL_FLG						RD_DIR_CALL_FLG						,
				RT.RAT_UT_CD									RT_RAT_UT_CD							,
				RT.PRC_CGO_TP_CD							RT_PRC_CGO_TP_CD					,
				RT.OP_PRC_TRSP_MOD_CD					OP_PRC_TRSP_MOD_CD				,
				RT.DP_PRC_TRSP_MOD_CD					DP_PRC_TRSP_MOD_CD				,
				RT.CURR_CD										RT_CURR_CD								,
				RT.FNL_FRT_RT_AMT							RT_FNL_FRT_RT_AMT					,

				OI.ROUT_PNT_LOC_DEF_CD				OI_ROUT_PNT_LOC_DEF_CD		,
				OI.BSE_PORT_DEF_CD						OI_BSE_PORT_DEF_CD				,
				OI.VIA_PORT_DEF_CD						OI_VIA_PORT_DEF_CD				,
				OI.DIR_CALL_FLG								OI_DIR_CALL_FLG						,
				OI.RAT_UT_CD									OI_RAT_UT_CD							,
				OI.PRC_CGO_TP_CD							OI_PRC_CGO_TP_CD					,
				OI.PRC_TRSP_MOD_CD						OI_PRC_TRSP_MOD_CD				,
				OI.RCV_DE_TERM_CD							OI_RCV_DE_TERM_CD					,
				OI.PRC_CMDT_DEF_CD						OI_PRC_CMDT_DEF_CD				,
				OI.CURR_CD										OI_CURR_CD								,
				OI.FNL_FRT_RT_AMT							OI_FNL_FRT_RT_AMT					,
				OI.RAT_UT_MTCH_PRIO						OI_RAT_UT_MTCH_PRIO				,

				NULL													OA_ROUT_PNT_LOC_DEF_CD		,
				NULL													OA_BSE_PORT_DEF_CD				,
				NULL													OA_VIA_PORT_DEF_CD				,
				NULL													OA_DIR_CALL_FLG						,
				NULL													OA_RAT_UT_CD							,
				NULL													OA_PRC_CGO_TP_CD					,
				NULL													OA_PRC_TRSP_MOD_CD				,
				NULL													OA_RCV_DE_TERM_CD					,
				NULL													OA_PRC_CMDT_DEF_CD				,
				NULL													OA_CURR_CD								,
				NULL													OA_FNL_FRT_RT_AMT					,
				NULL													OA_RAT_UT_MTCH_PRIO				,

				NULL													DA_ROUT_PNT_LOC_DEF_CD		,
				NULL													DA_BSE_PORT_DEF_CD				,
				NULL													DA_VIA_PORT_DEF_CD				,
				NULL													DA_DIR_CALL_FLG						,
				NULL													DA_RAT_UT_CD							,
				NULL													DA_PRC_CGO_TP_CD					,
				NULL													DA_PRC_TRSP_MOD_CD				,
				NULL													DA_RCV_DE_TERM_CD					,
				NULL													DA_PRC_CMDT_DEF_CD				,
				NULL													DA_CURR_CD								,
				NULL													DA_FNL_FRT_RT_AMT					,
				NULL													DA_RAT_UT_MTCH_PRIO				,

				DI.ROUT_PNT_LOC_DEF_CD				DI_ROUT_PNT_LOC_DEF_CD		,
				DI.BSE_PORT_DEF_CD						DI_BSE_PORT_DEF_CD				,
				DI.VIA_PORT_DEF_CD						DI_VIA_PORT_DEF_CD				,
				DI.DIR_CALL_FLG								DI_DIR_CALL_FLG						,
				DI.RAT_UT_CD									DI_RAT_UT_CD							,
				DI.PRC_CGO_TP_CD							DI_PRC_CGO_TP_CD					,
				DI.PRC_TRSP_MOD_CD						DI_PRC_TRSP_MOD_CD				,
				DI.RCV_DE_TERM_CD							DI_RCV_DE_TERM_CD					,
				DI.PRC_CMDT_DEF_CD						DI_PRC_CMDT_DEF_CD				,
				DI.CURR_CD										DI_CURR_CD								,
				DI.FNL_FRT_RT_AMT							DI_FNL_FRT_RT_AMT					,
				DI.RAT_UT_MTCH_PRIO						DI_RAT_UT_MTCH_PRIO				,

				RT_RAP.BKG_CONV_TP_CD      		RT_RAP_BKG_CONV_TP_CD			,
				RT_RAP.NOTE_CONV_MAPG_ID   		RT_RAP_NOTE_CONV_MAPG_ID  ,
				RT_RAP.NOTE_CONV_SEQ       		RT_RAP_NOTE_CONV_SEQ      ,
				RT_RAP.NOTE_CONV_RULE_CD   		RT_RAP_NOTE_CONV_RULE_CD  ,
				RT_RAP.NOTE_CONV_TP_CD     		RT_RAP_NOTE_CONV_TP_CD    ,
				RT_RAP.RT_OP_CD            		RT_RAP_RT_OP_CD           ,
				RT_RAP.CURR_CD             		RT_RAP_CURR_CD            ,
				RT_RAP.FRT_RT_AMT          		RT_RAP_FRT_RT_AMT         ,
				RT_RAP.RAP_CONV_CTNT					RT_RAP_CONV_CTNT					,

				RT_RAR.BKG_CONV_TP_CD      		RT_RAR_BKG_CONV_TP_CD     ,
				RT_RAR.NOTE_CONV_MAPG_ID   		RT_RAR_NOTE_CONV_MAPG_ID  ,
				RT_RAR.NOTE_CONV_SEQ       		RT_RAR_NOTE_CONV_SEQ      ,
				RT_RAR.NOTE_CONV_RULE_CD   		RT_RAR_NOTE_CONV_RULE_CD  ,
				RT_RAR.NOTE_CONV_TP_CD     		RT_RAR_NOTE_CONV_TP_CD    ,
				RT_RAR.RT_OP_CD            		RT_RAR_RT_OP_CD           ,
				RT_RAR.CURR_CD             		RT_RAR_CURR_CD            ,
				RT_RAR.FRT_RT_AMT          		RT_RAR_FRT_RT_AMT         ,
				RT_RAR.RAR_CONV_CTNT					RT_RAR_CONV_CTNT					,

				RT_DOR.BKG_CONV_TP_CD      		RT_DOR_BKG_CONV_TP_CD     ,
				RT_DOR.NOTE_CONV_MAPG_ID   		RT_DOR_NOTE_CONV_MAPG_ID  ,
				RT_DOR.NOTE_CONV_SEQ       		RT_DOR_NOTE_CONV_SEQ      ,
				RT_DOR.NOTE_CONV_RULE_CD   		RT_DOR_NOTE_CONV_RULE_CD  ,
				RT_DOR.NOTE_CONV_TP_CD     		RT_DOR_NOTE_CONV_TP_CD    ,
				RT_DOR.RT_OP_CD            		RT_DOR_RT_OP_CD           ,
				RT_DOR.CURR_CD             		RT_DOR_CURR_CD            ,
				RT_DOR.FRT_RT_AMT          		RT_DOR_FRT_RT_AMT         ,
				RT_DOR.DOR_CONV_CTNT					RT_DOR_CONV_CTNT					,

				RT_TYP.BKG_CONV_TP_CD      		RT_TYP_BKG_CONV_TP_CD     ,
				RT_TYP.NOTE_CONV_MAPG_ID   		RT_TYP_NOTE_CONV_MAPG_ID  ,
				RT_TYP.NOTE_CONV_SEQ       		RT_TYP_NOTE_CONV_SEQ      ,
				RT_TYP.NOTE_CONV_RULE_CD   		RT_TYP_NOTE_CONV_RULE_CD  ,
				RT_TYP.NOTE_CONV_TP_CD     		RT_TYP_NOTE_CONV_TP_CD    ,
				RT_TYP.RT_OP_CD            		RT_TYP_RT_OP_CD           ,
				RT_TYP.CURR_CD             		RT_TYP_CURR_CD            ,
				RT_TYP.FRT_RT_AMT          		RT_TYP_FRT_RT_AMT         ,
				RT_TYP.TYP_CONV_CTNT					RT_TYP_CONV_CTNT					,

				RT_RAC.BKG_CONV_TP_CD      		RT_RAC_BKG_CONV_TP_CD     ,
				RT_RAC.NOTE_CONV_MAPG_ID   		RT_RAC_NOTE_CONV_MAPG_ID  ,
				RT_RAC.NOTE_CONV_SEQ       		RT_RAC_NOTE_CONV_SEQ      ,
				RT_RAC.NOTE_CONV_RULE_CD   		RT_RAC_NOTE_CONV_RULE_CD  ,
				RT_RAC.NOTE_CONV_TP_CD     		RT_RAC_NOTE_CONV_TP_CD    ,
				RT_RAC.RT_OP_CD            		RT_RAC_RT_OP_CD           ,
				RT_RAC.CURR_CD             		RT_RAC_CURR_CD            ,
				RT_RAC.FRT_RT_AMT          		RT_RAC_FRT_RT_AMT         ,
				RT_RAC.RAC_CONV_CTNT					RT_RAC_CONV_CTNT					,

				RT.APP_BKG_CONV_TP_CD      		RT_APP_BKG_CONV_TP_CD     ,
				RT.APP_NOTE_CONV_MAPG_ID   		RT_APP_NOTE_CONV_MAPG_ID  ,
				RT.APP_NOTE_CONV_SEQ       		RT_APP_NOTE_CONV_SEQ      ,
				RT.APP_NOTE_CONV_RULE_CD   		RT_APP_NOTE_CONV_RULE_CD  ,
				RT.APP_NOTE_CONV_TP_CD     		RT_APP_NOTE_CONV_TP_CD    ,
				RT.APP_RT_OP_CD            		RT_APP_RT_OP_CD           ,
				RT.APP_CURR_CD             		RT_APP_CURR_CD            ,
				RT.APP_FRT_RT_AMT          		RT_APP_FRT_RT_AMT         ,

				RT.RAS_BKG_CONV_TP_CD      		RT_RAS_BKG_CONV_TP_CD     ,
				RT.RAS_NOTE_CONV_MAPG_ID   		RT_RAS_NOTE_CONV_MAPG_ID  ,
				RT.RAS_NOTE_CONV_SEQ       		RT_RAS_NOTE_CONV_SEQ      ,
				RT.RAS_NOTE_CONV_RULE_CD   		RT_RAS_NOTE_CONV_RULE_CD  ,
				RT.RAS_NOTE_CONV_TP_CD     		RT_RAS_NOTE_CONV_TP_CD    ,
				RT.RAS_RT_OP_CD            		RT_RAS_RT_OP_CD           ,
				RT.RAS_CURR_CD             		RT_RAS_CURR_CD            ,
				RT.RAS_FRT_RT_AMT          		RT_RAS_FRT_RT_AMT         ,
				RT.RAS_RAS_CONV_CTNT					RT_RAS_CONV_CTNT					,

				RT.ARB_BKG_CONV_TP_CD      		RT_ARB_BKG_CONV_TP_CD     ,
				RT.ARB_NOTE_CONV_MAPG_ID   		RT_ARB_NOTE_CONV_MAPG_ID  ,
				RT.ARB_NOTE_CONV_SEQ       		RT_ARB_NOTE_CONV_SEQ      ,
				RT.ARB_NOTE_CONV_RULE_CD   		RT_ARB_NOTE_CONV_RULE_CD  ,
				RT.ARB_NOTE_CONV_TP_CD     		RT_ARB_NOTE_CONV_TP_CD    ,
				RT.ARB_RT_OP_CD            		RT_ARB_RT_OP_CD           ,
				RT.ARB_CURR_CD             		RT_ARB_CURR_CD            ,
				RT.ARB_FRT_RT_AMT          		RT_ARB_FRT_RT_AMT         ,

				RT.ADD_BKG_CONV_TP_CD      		RT_ADD_BKG_CONV_TP_CD     ,
				RT.ADD_NOTE_CONV_MAPG_ID   		RT_ADD_NOTE_CONV_MAPG_ID  ,
				RT.ADD_NOTE_CONV_SEQ       		RT_ADD_NOTE_CONV_SEQ      ,
				RT.ADD_NOTE_CONV_RULE_CD   		RT_ADD_NOTE_CONV_RULE_CD  ,
				RT.ADD_NOTE_CONV_TP_CD     		RT_ADD_NOTE_CONV_TP_CD    ,
				RT.ADD_RT_OP_CD            		RT_ADD_RT_OP_CD           ,
				RT.ADD_CURR_CD             		RT_ADD_CURR_CD            ,
				RT.ADD_FRT_RT_AMT          		RT_ADD_FRT_RT_AMT         ,

				OA_TYP.BKG_CONV_TP_CD      		OA_TYP_BKG_CONV_TP_CD     ,
				OA_TYP.NOTE_CONV_MAPG_ID   		OA_TYP_NOTE_CONV_MAPG_ID  ,
				OA_TYP.NOTE_CONV_SEQ       		OA_TYP_NOTE_CONV_SEQ      ,
				OA_TYP.NOTE_CONV_RULE_CD   		OA_TYP_NOTE_CONV_RULE_CD  ,
				OA_TYP.NOTE_CONV_TP_CD     		OA_TYP_NOTE_CONV_TP_CD    ,
				OA_TYP.RT_OP_CD            		OA_TYP_RT_OP_CD           ,
				OA_TYP.CURR_CD             		OA_TYP_CURR_CD            ,
				OA_TYP.FRT_RT_AMT          		OA_TYP_FRT_RT_AMT         ,
				OA_TYP.TYP_CONV_CTNT       		OA_TYP_CONV_CTNT         	,

				OA_RAC.BKG_CONV_TP_CD      		OA_RAC_BKG_CONV_TP_CD     ,
				OA_RAC.NOTE_CONV_MAPG_ID   		OA_RAC_NOTE_CONV_MAPG_ID  ,
				OA_RAC.NOTE_CONV_SEQ       		OA_RAC_NOTE_CONV_SEQ      ,
				OA_RAC.NOTE_CONV_RULE_CD   		OA_RAC_NOTE_CONV_RULE_CD  ,
				OA_RAC.NOTE_CONV_TP_CD     		OA_RAC_NOTE_CONV_TP_CD    ,
				OA_RAC.RT_OP_CD            		OA_RAC_RT_OP_CD           ,
				OA_RAC.CURR_CD             		OA_RAC_CURR_CD            ,
				OA_RAC.FRT_RT_AMT          		OA_RAC_FRT_RT_AMT         ,
				OA_RAC.RAC_CONV_CTNT       		OA_RAC_CONV_CTNT         	,

				DA_TYP.BKG_CONV_TP_CD      		DA_TYP_BKG_CONV_TP_CD     ,
				DA_TYP.NOTE_CONV_MAPG_ID   		DA_TYP_NOTE_CONV_MAPG_ID  ,
				DA_TYP.NOTE_CONV_SEQ       		DA_TYP_NOTE_CONV_SEQ      ,
				DA_TYP.NOTE_CONV_RULE_CD   		DA_TYP_NOTE_CONV_RULE_CD  ,
				DA_TYP.NOTE_CONV_TP_CD     		DA_TYP_NOTE_CONV_TP_CD    ,
				DA_TYP.RT_OP_CD            		DA_TYP_DA_OP_CD           ,
				DA_TYP.CURR_CD             		DA_TYP_CURR_CD            ,
				DA_TYP.FRT_RT_AMT          		DA_TYP_FRT_RT_AMT					,
				DA_TYP.TYP_CONV_CTNT       		DA_TYP_CONV_CTNT         	,

				DA_RAC.BKG_CONV_TP_CD      		DA_RAC_BKG_CONV_TP_CD     ,
				DA_RAC.NOTE_CONV_MAPG_ID   		DA_RAC_NOTE_CONV_MAPG_ID  ,
				DA_RAC.NOTE_CONV_SEQ       		DA_RAC_NOTE_CONV_SEQ      ,
				DA_RAC.NOTE_CONV_RULE_CD   		DA_RAC_NOTE_CONV_RULE_CD  ,
				DA_RAC.NOTE_CONV_TP_CD     		DA_RAC_NOTE_CONV_TP_CD    ,
				DA_RAC.RT_OP_CD            		DA_RAC_DA_OP_CD           ,
				DA_RAC.CURR_CD             		DA_RAC_CURR_CD            ,
				DA_RAC.FRT_RT_AMT          		DA_RAC_FRT_RT_AMT					,
				DA_RAC.RAC_CONV_CTNT       		DA_RAC_CONV_CTNT         	,

				'Y'														POR_MTCH_FLG							,
				'Y'														DEL_MTCH_FLG

FROM
/*******************************************************************************************
JOIN TABLE
1.1 BQ, CH, CM, CR, RD, OP, DV, DP, RT
1.2 RT RULE					: RAP, RAR, DOR, TYP, RAC, APP, RAS, ADD
2.1 OA							: O
2.2 OA RULE					: TYP, RAC ( RAP, RAR, DOR 는 RT 와 동일하게 적용 )
3.1 DA							: O
3.2 DA RULE					: TYP, RAC ( RAP, RAR, DOR 는 RT 와 동일하게 적용 )
*******************************************************************************************/
				BQ	,
				OI	,
				DI	,
				RT	,
				NC_P											RT_RAP	,			/* COMMODITY CONVERSION */
				NC_P											RT_RAR	,			/* ROUTE CONVERSION */
				NC_P											RT_DOR	,			/* R/D TERM CONVERSION */
				NC_P											RT_TYP	,			/* RATING UNIT CONVERSION */
				NC_P											RT_RAC	,			/* CARGO TYPE CONVERSION */
				NC_P											OA_TYP	,			/* RATING UNIT CONVERSION */
				NC_P											OA_RAC	,			/* CARGO TYPE CONVERSION */
				NC_P											DA_TYP	,			/* RATING UNIT CONVERSION */
				NC_P											DA_RAC				/* CARGO TYPE CONVERSION */

WHERE		RT.BQ_SEQ		=	BQ.BQ_SEQ
AND			OI.BQ_SEQ		= BQ.BQ_SEQ
AND			DI.BQ_SEQ		= BQ.BQ_SEQ
AND			RT_RAP.BQ_SEQ	= RT.BQ_SEQ AND RT_RAP.NOTE_CONV_RULE_CD = 'RAP' AND ( RT_RAP.BKG_CONV_TP_CD = 'B' OR RT_RAP.NC_SEQ = RT.RAP_NC_SEQ )
AND			RT_RAR.BQ_SEQ	= RT.BQ_SEQ AND RT_RAR.NOTE_CONV_RULE_CD = 'RAR' AND ( RT_RAR.BKG_CONV_TP_CD = 'B' OR RT_RAR.NC_SEQ = RT.RAR_NC_SEQ )
AND			RT_DOR.BQ_SEQ	= RT.BQ_SEQ AND RT_DOR.NOTE_CONV_RULE_CD = 'DOR' AND ( RT_DOR.BKG_CONV_TP_CD = 'B' OR RT_DOR.NC_SEQ = RT.DOR_NC_SEQ )
AND			RT_TYP.BQ_SEQ	= RT.BQ_SEQ AND RT_TYP.NOTE_CONV_RULE_CD = 'TYP' AND ( RT_TYP.BKG_CONV_TP_CD = 'B' OR RT_TYP.NC_SEQ = RT.TYP_NC_SEQ )
AND			RT_RAC.BQ_SEQ	= RT.BQ_SEQ AND RT_RAC.NOTE_CONV_RULE_CD = 'RAC' AND ( RT_RAC.BKG_CONV_TP_CD = 'B' OR RT_RAC.NC_SEQ = RT.RAC_NC_SEQ )
AND			OA_TYP.BQ_SEQ	= RT.BQ_SEQ AND OA_TYP.NOTE_CONV_RULE_CD = 'TYP' AND ( OA_TYP.BKG_CONV_TP_CD = 'B' OR OA_TYP.NC_SEQ = RT.TYP_NC_SEQ )
AND			OA_RAC.BQ_SEQ	= RT.BQ_SEQ AND OA_RAC.NOTE_CONV_RULE_CD = 'RAC' AND ( OA_RAC.BKG_CONV_TP_CD = 'B' OR OA_RAC.NC_SEQ = RT.RAC_NC_SEQ )
AND			DA_TYP.BQ_SEQ	= RT.BQ_SEQ AND DA_TYP.NOTE_CONV_RULE_CD = 'TYP' AND ( DA_TYP.BKG_CONV_TP_CD = 'B' OR DA_TYP.NC_SEQ = RT.TYP_NC_SEQ )
AND			DA_RAC.BQ_SEQ	= RT.BQ_SEQ AND DA_RAC.NOTE_CONV_RULE_CD = 'RAC' AND ( DA_RAC.BKG_CONV_TP_CD = 'B' OR DA_RAC.NC_SEQ = RT.RAC_NC_SEQ )


/*******************************************************************************************
	11.1 RATE
*******************************************************************************************/

/*******************************************************************************************
	11.1.1 RATE - COMMODITY
	(주의)
	COMMODITY 나 RATING UNIT 등의 조건이 위의 OA, DA, RT 와 중복조건으로 보일 수 있으나,
	OA, DA, RT 는 CONVERSION 이 정확하게 적용한 것이 아니므로, 다시한번 정확하게 조건을 연결해야 한다.
*******************************************************************************************/

/*******************************************************************************************
< COMMODITY >
그룹, 개별간으로 일치하는 경우
*******************************************************************************************/
AND			( RT.CM_PRC_CMDT_TP_CD, RT.CM_PRC_CMDT_DEF_CD ) IN
				(
				SELECT	RT_RAP.CONV_CMDT_TP_CD, RT_RAP.CONV_CMDT_DEF_CD
				FROM		DUAL
				UNION ALL
				SELECT  'C', GC.PRC_CMDT_DEF_CD
				FROM		GC
				WHERE		RT_RAP.CONV_CMDT_TP_CD	= 'G'
				AND     GC.PRC_CMDT_TP_CD   		= 'C'
				AND			GC.PRC_GRP_CMDT_CD  		= RT_RAP.CONV_CMDT_DEF_CD
				UNION ALL
				SELECT  'G', GC.PRC_GRP_CMDT_CD
				FROM		GC
				WHERE		RT_RAP.CONV_CMDT_TP_CD	= 'C'
				AND     GC.PRC_CMDT_TP_CD   		= 'C'
				AND     GC.PRC_CMDT_DEF_CD  		= RT_RAP.CONV_CMDT_DEF_CD
				UNION ALL
				/* TAW 일 경우 FAK 고려함 */
				SELECT	'C', CMDT_CD
				FROM		MDM_COMMODITY
				WHERE		REP_CMDT_CD		= '0000'
				UNION ALL
				SELECT	'G', GC.PRC_GRP_CMDT_CD
				FROM		GC
				WHERE		GC.PRC_CMDT_TP_CD		= 'C'
				AND			GC.PRC_CMDT_DEF_CD  IN ( SELECT CMDT_CD FROM MDM_COMMODITY WHERE REP_CMDT_CD = '0000' )
				)


/*******************************************************************************************
	11.1.2 RATE - ROUTE
*******************************************************************************************/

/*******************************************************************************************
< ORIGIN ( POL ) >
*******************************************************************************************/

AND     ( RT.OP_ROUT_PNT_LOC_TP_CD, RT.OP_ROUT_PNT_LOC_DEF_CD ) IN
				(
				SELECT	RT_RAR.CONV_ORG_VIA_LOC_TP_CD,	RT_RAR.CONV_ORG_VIA_LOC_DEF_CD
				FROM		DUAL
				UNION ALL
				SELECT  'L', GL.LOC_CD
				FROM		GL
				WHERE		RT_RAR.CONV_ORG_VIA_LOC_TP_CD	= 'G'
				AND		  GL.PRC_GRP_LOC_CD 				= RT_RAR.CONV_ORG_VIA_LOC_DEF_CD
				UNION ALL
				SELECT  'G', GL.PRC_GRP_LOC_CD
				FROM		GL
				WHERE		RT_RAR.CONV_ORG_VIA_LOC_TP_CD	= 'L'
				AND     GL.LOC_CD									= RT_RAR.CONV_ORG_VIA_LOC_DEF_CD
				)


/*******************************************************************************************
< ORIGIN VIA ( POL ) >
*******************************************************************************************/

AND     (
						RT.OV_ROUT_VIA_PORT_DEF_CD IS NULL
				OR	( RT.OV_ROUT_VIA_PORT_TP_CD, RT.OV_ROUT_VIA_PORT_DEF_CD ) IN
						(
						SELECT	RT_RAR.CONV_ORG_VIA_LOC_TP_CD,	RT_RAR.CONV_ORG_VIA_LOC_DEF_CD
						FROM		DUAL
						UNION ALL
						SELECT  'L', GL.LOC_CD
						FROM		GL
						WHERE		RT_RAR.CONV_ORG_VIA_LOC_TP_CD	= 'G'
						AND		  GL.PRC_GRP_LOC_CD 						= RT_RAR.CONV_ORG_VIA_LOC_DEF_CD
						UNION ALL
						SELECT  'G', GL.PRC_GRP_LOC_CD
						FROM		GL
						WHERE		RT_RAR.CONV_ORG_VIA_LOC_TP_CD	= 'L'
						AND     GL.LOC_CD											= RT_RAR.CONV_ORG_VIA_LOC_DEF_CD
						)
				)


/*******************************************************************************************
< DESTINATION VIA ( POD ) >
*******************************************************************************************/

AND     (
						RT.DV_ROUT_VIA_PORT_DEF_CD IS NULL
				OR	( RT.DV_ROUT_VIA_PORT_TP_CD, RT.DV_ROUT_VIA_PORT_DEF_CD ) IN
						(
						SELECT	RT_RAR.CONV_DEST_VIA_LOC_TP_CD,	RT_RAR.CONV_DEST_VIA_LOC_DEF_CD
						FROM		DUAL
						UNION ALL
						SELECT  'L', GL.LOC_CD
						FROM		GL
						WHERE		RT_RAR.CONV_DEST_VIA_LOC_TP_CD	= 'G'
						AND		  GL.PRC_GRP_LOC_CD 						= RT_RAR.CONV_DEST_VIA_LOC_DEF_CD
						UNION ALL
						SELECT  'G', GL.PRC_GRP_LOC_CD
						FROM		GL
						WHERE		RT_RAR.CONV_DEST_VIA_LOC_TP_CD	= 'L'
						AND     GL.LOC_CD											= RT_RAR.CONV_DEST_VIA_LOC_DEF_CD
						)
				)


/*******************************************************************************************
< DESTINATION ( POD ) >
*******************************************************************************************/

AND     ( RT.DP_ROUT_PNT_LOC_TP_CD, RT.DP_ROUT_PNT_LOC_DEF_CD ) IN
				(
				SELECT	RT_RAR.CONV_DEST_VIA_LOC_TP_CD,	RT_RAR.CONV_DEST_VIA_LOC_DEF_CD
				FROM		DUAL
				UNION ALL
				SELECT  'L', GL.LOC_CD
				FROM		GL
				WHERE		RT_RAR.CONV_DEST_VIA_LOC_TP_CD	= 'G'
				AND		  GL.PRC_GRP_LOC_CD 				= RT_RAR.CONV_DEST_VIA_LOC_DEF_CD
				UNION ALL
				SELECT  'G', GL.PRC_GRP_LOC_CD
				FROM		GL
				WHERE		RT_RAR.CONV_DEST_VIA_LOC_TP_CD	= 'L'
				AND     GL.LOC_CD									= RT_RAR.CONV_DEST_VIA_LOC_DEF_CD
				)


/*******************************************************************************************
	11.1.3 RATE - RATING UNIT
*******************************************************************************************/

AND     (
								RT.RAT_UT_CD	= RT_TYP.CONV_RAT_UT_CD
		        OR
    		    (
        				RT.RAT_UT_CD	IN ( '20', '40', 'HC', '45', '53' )
       			AND ( SELECT A.CNTR_SZ_CD FROM PRI_RAT_UT A WHERE A.RAT_UT_CD = RT.RAT_UT_CD )	= RT_TYP.CONV_RAT_UT_SZ_CD
        		)
				)

AND			RT.PRC_CGO_TP_CD	IN ( RT_RAC.CONV_DR_TP, RT_RAC.CONV_DG_TP, RT_RAC.CONV_RF_TP, RT_RAC.CONV_AK_TP, RT_RAC.CONV_BB_TP )


/*******************************************************************************************
	11.2 ORIGIN IHC
*******************************************************************************************/

/*******************************************************************************************
	11.2.2 ORIGIN IHC - ROUTE
*******************************************************************************************/

/*******************************************************************************************
< POINT ( POR ) >
*******************************************************************************************/

AND     ( OI.ROUT_PNT_LOC_TP_CD, OI.ROUT_PNT_LOC_DEF_CD ) IN
				(
				SELECT  RT_RAR.CONV_ORG_LOC_TP_CD, RT_RAR.CONV_ORG_LOC_DEF_CD
				FROM		DUAL
				UNION ALL
				SELECT  'L', GL.LOC_CD
				FROM		GL
				WHERE		RT_RAR.CONV_ORG_LOC_TP_CD	= 'G'
				AND		  GL.PRC_GRP_LOC_CD 				= RT_RAR.CONV_ORG_LOC_DEF_CD
				UNION ALL
				SELECT  'G', GL.PRC_GRP_LOC_CD
				FROM		GL
				WHERE		RT_RAR.CONV_ORG_LOC_TP_CD	= 'L'
				AND     GL.LOC_CD									= RT_RAR.CONV_ORG_LOC_DEF_CD
				)


/*******************************************************************************************
< RCV TERM >
*******************************************************************************************/

AND     NVL(OI.RCV_DE_TERM_CD, '*') IN
				(
				SELECT  B.RCV_DE_TERM_CD
				FROM		(
								SELECT 'Y' CONV_PRC_TERM_CD, 'Y' RCV_DE_TERM_CD FROM DUAL UNION ALL
								SELECT 'Y' CONV_PRC_TERM_CD, 'L' RCV_DE_TERM_CD FROM DUAL UNION ALL
								SELECT 'Y' CONV_PRC_TERM_CD, '*' RCV_DE_TERM_CD FROM DUAL UNION ALL
								SELECT 'S' CONV_PRC_TERM_CD, 'S' RCV_DE_TERM_CD FROM DUAL UNION ALL
								SELECT 'D' CONV_PRC_TERM_CD, 'D' RCV_DE_TERM_CD FROM DUAL UNION ALL
								SELECT 'T' CONV_PRC_TERM_CD, 'T' RCV_DE_TERM_CD FROM DUAL UNION ALL
								SELECT 'I' CONV_PRC_TERM_CD, 'I' RCV_DE_TERM_CD FROM DUAL
								)	B
				WHERE		B.CONV_PRC_TERM_CD	= RT_DOR.CONV_PRC_RCV_TERM_CD
				)


/*******************************************************************************************
< BASE PORT ( POL ) >
*******************************************************************************************/

AND     ( OI.BSE_PORT_TP_CD, OI.BSE_PORT_DEF_CD ) IN
				(
				SELECT  RT_RAR.CONV_ORG_VIA_LOC_TP_CD, RT_RAR.CONV_ORG_VIA_LOC_DEF_CD
				FROM		DUAL
				UNION ALL
				SELECT  'L', GL.LOC_CD
				FROM		GL
				WHERE		RT_RAR.CONV_ORG_VIA_LOC_TP_CD	= 'G'
				AND		  GL.PRC_GRP_LOC_CD 				= RT_RAR.CONV_ORG_VIA_LOC_DEF_CD
				UNION ALL
				SELECT  'G', GL.PRC_GRP_LOC_CD
				FROM		GL
				WHERE		RT_RAR.CONV_ORG_VIA_LOC_TP_CD	= 'L'
				AND     GL.LOC_CD									= RT_RAR.CONV_ORG_VIA_LOC_DEF_CD
				)


/*******************************************************************************************
	11.2.3 ORIGIN IHC - RATING UNIT
*******************************************************************************************/

/* ORIGIN ARB RATING UNIT */
AND     (
								OI.RAT_UT_CD	= OA_TYP.CONV_RAT_UT_CD
		        OR	OI.RAT_UT_CD	= 'BX'
		        OR
    		    (
        				OI.RAT_UT_CD	IN ( '20', '40', 'HC', '45', '53' )
       			AND ( SELECT A.CNTR_SZ_CD FROM PRI_RAT_UT A WHERE A.RAT_UT_CD = OI.RAT_UT_CD )	= OA_TYP.CONV_RAT_UT_SZ_CD
        		)
				)


/* ORIGIN ARB CARGO TYPE */
AND			NVL(OI.PRC_CGO_TP_CD, '*')	IN ( '*', OA_RAC.CONV_DR_TP, OA_RAC.CONV_DG_TP, OA_RAC.CONV_RF_TP, OA_RAC.CONV_AK_TP, OA_RAC.CONV_BB_TP )


/*******************************************************************************************
	11.2.4 ORIGIN IHC - JOIN
*******************************************************************************************/

/* ORIGIN ARB JOIN ( ARB CONV RULE ) */
AND			DECODE(RT.ARB_RT_APPL_TP_CD, NULL, DECODE(RT.GEN_SPCL_RT_TP_CD, 'S', 'N', 'Y'), 'N', 'N', 'Y') = 'Y'

/* ORIGIN ARB JOIN ( DIHC.BPORT = RATE.DEST ) */
AND			NVL(RT.OP_RCV_DE_TERM_CD, '*' )	NOT IN ( 'D', 'S' )

AND			( RT.OP_ROUT_PNT_LOC_TP_CD, RT.OP_ROUT_PNT_LOC_DEF_CD ) IN
				(
				SELECT	OI.BSE_PORT_TP_CD, OI.BSE_PORT_DEF_CD
				FROM		DUAL
				UNION ALL
				SELECT	'L', GL.LOC_CD
				FROM		GL
				WHERE		OI.BSE_PORT_TP_CD	= 'G'
				AND		  GL.PRC_GRP_LOC_CD	= OI.BSE_PORT_DEF_CD
				UNION ALL
				SELECT	'G', GL.PRC_GRP_LOC_CD
				FROM		GL
				WHERE		OI.BSE_PORT_TP_CD	= 'L'
				AND			GL.LOC_CD					= OI.BSE_PORT_DEF_CD
				)


/*******************************************************************************************
	11.3 DEST IHC
*******************************************************************************************/

/*******************************************************************************************
	11.3.2 DEST ARB - ROUTE
*******************************************************************************************/

/*******************************************************************************************
< BASE PORT ( POD ) >
*******************************************************************************************/

AND     ( DI.BSE_PORT_TP_CD, DI.BSE_PORT_DEF_CD ) IN
				(
				SELECT  RT_RAR.CONV_DEST_VIA_LOC_TP_CD, RT_RAR.CONV_DEST_VIA_LOC_DEF_CD
				FROM		DUAL
				UNION ALL
				SELECT  'L', GL.LOC_CD
				FROM		GL
				WHERE		RT_RAR.CONV_DEST_VIA_LOC_TP_CD	= 'G'
				AND		  GL.PRC_GRP_LOC_CD 				= RT_RAR.CONV_DEST_VIA_LOC_DEF_CD
				UNION ALL
				SELECT  'G', GL.PRC_GRP_LOC_CD
				FROM		GL
				WHERE		RT_RAR.CONV_DEST_VIA_LOC_TP_CD	= 'L'
				AND     GL.LOC_CD									= RT_RAR.CONV_DEST_VIA_LOC_DEF_CD
				)


/*******************************************************************************************
< POINT ( DEL ) >
*******************************************************************************************/

AND     ( DI.ROUT_PNT_LOC_TP_CD, DI.ROUT_PNT_LOC_DEF_CD ) IN
				(
				SELECT  RT_RAR.CONV_DEST_LOC_TP_CD, RT_RAR.CONV_DEST_LOC_DEF_CD
				FROM		DUAL
				UNION ALL
				SELECT  'L', GL.LOC_CD
				FROM		GL
				WHERE		RT_RAR.CONV_DEST_LOC_TP_CD	= 'G'
				AND		  GL.PRC_GRP_LOC_CD 				= RT_RAR.CONV_DEST_LOC_DEF_CD
				UNION ALL
				SELECT  'G', GL.PRC_GRP_LOC_CD
				FROM		GL
				WHERE		RT_RAR.CONV_DEST_LOC_TP_CD	= 'L'
				AND     GL.LOC_CD									= RT_RAR.CONV_DEST_LOC_DEF_CD
				)


/*******************************************************************************************
< DE TERM >
*******************************************************************************************/

AND			NVL(DI.RCV_DE_TERM_CD, '*') IN
				(
				SELECT  B.RCV_DE_TERM_CD
				FROM		(
								SELECT 'Y' CONV_PRC_TERM_CD, 'Y' RCV_DE_TERM_CD FROM DUAL UNION ALL
								SELECT 'Y' CONV_PRC_TERM_CD, 'L' RCV_DE_TERM_CD FROM DUAL UNION ALL
								SELECT 'Y' CONV_PRC_TERM_CD, '*' RCV_DE_TERM_CD FROM DUAL UNION ALL
								SELECT 'S' CONV_PRC_TERM_CD, 'S' RCV_DE_TERM_CD FROM DUAL UNION ALL
								SELECT 'S' CONV_PRC_TERM_CD, 'Y' RCV_DE_TERM_CD FROM DUAL UNION ALL
								SELECT 'S' CONV_PRC_TERM_CD, 'T' RCV_DE_TERM_CD FROM DUAL UNION ALL
								SELECT 'S' CONV_PRC_TERM_CD, 'I' RCV_DE_TERM_CD FROM DUAL UNION ALL
								SELECT 'S' CONV_PRC_TERM_CD, 'L' RCV_DE_TERM_CD FROM DUAL UNION ALL
								SELECT 'S' CONV_PRC_TERM_CD, '*' RCV_DE_TERM_CD FROM DUAL UNION ALL
								SELECT 'D' CONV_PRC_TERM_CD, 'D' RCV_DE_TERM_CD FROM DUAL UNION ALL
								SELECT 'T' CONV_PRC_TERM_CD, 'T' RCV_DE_TERM_CD FROM DUAL UNION ALL
								SELECT 'I' CONV_PRC_TERM_CD, 'I' RCV_DE_TERM_CD FROM DUAL
								)	B
				WHERE		B.CONV_PRC_TERM_CD	= RT_DOR.CONV_PRC_DE_TERM_CD
				)


/*******************************************************************************************
	11.3.3 DEST ARB - RATING UNIT
*******************************************************************************************/

/* DEST ARB RATING UNIT */
AND     (
								DI.RAT_UT_CD	= DA_TYP.CONV_RAT_UT_CD
		        OR	DI.RAT_UT_CD	= 'BX'
		        OR
    		    (
        				DI.RAT_UT_CD	IN ( '20', '40', 'HC', '45', '53' )
       			AND ( SELECT A.CNTR_SZ_CD FROM PRI_RAT_UT A WHERE A.RAT_UT_CD = DI.RAT_UT_CD )	= DA_TYP.CONV_RAT_UT_SZ_CD
        		)
				)


/* DEST ARB CARGO TYPE */
AND			NVL(DI.PRC_CGO_TP_CD, '*')	IN ( '*', DA_RAC.CONV_DR_TP, DA_RAC.CONV_DG_TP, DA_RAC.CONV_RF_TP, DA_RAC.CONV_AK_TP, DA_RAC.CONV_BB_TP )


/*******************************************************************************************
	11.3.4 DEST ARB - JOIN
*******************************************************************************************/

/* DEST ARB JOIN ( ADD CONV RULE ) */
AND			DECODE(RT.ADD_RT_APPL_TP_CD, NULL, DECODE(RT.GEN_SPCL_RT_TP_CD, 'S', 'N', 'Y'), 'N', 'N', 'Y') = 'Y'

/* DEST ARB JOIN ( DARB.BPORT = RATE.DEST ) */
AND			NVL(RT.DP_RCV_DE_TERM_CD, '*' )	NOT IN ( 'D', 'S' )

AND			( RT.DP_ROUT_PNT_LOC_TP_CD, RT.DP_ROUT_PNT_LOC_DEF_CD ) IN
				(
				SELECT	DI.BSE_PORT_TP_CD, DI.BSE_PORT_DEF_CD
				FROM		DUAL
				UNION ALL
				SELECT	'L', GL.LOC_CD
				FROM		GL
				WHERE		DI.BSE_PORT_TP_CD	= 'G'
				AND		  GL.PRC_GRP_LOC_CD	= DI.BSE_PORT_DEF_CD
				UNION ALL
				SELECT	'G', GL.PRC_GRP_LOC_CD
				FROM		GL
				WHERE		DI.BSE_PORT_TP_CD	= 'L'
				AND			GL.LOC_CD					= DI.BSE_PORT_DEF_CD
				)


UNION ALL


/*******************************************************************************************
	12. PATTERN #12 ( 1101 )
*******************************************************************************************/

SELECT	'1101'												PRC_RT_MTCH_PATT_CD				,
				BQ.SC_NO											CTRT_NO										,
				BQ.PROP_NO										PROP_NO										,
				BQ.AMDT_SEQ										AMDT_SEQ									,
				BQ.SVC_SCP_CD									SVC_SCP_CD								,
				BQ.BQ_SEQ											BQ_SEQ										,
				BQ.BKG_BQ_SEQ									BKG_BQ_SEQ								,
				BQ.CNTR_TPSZ_CD								BQ_CNTR_TPSZ_CD						,
				BQ.CTRT_CNTR_TPSZ_CD					BQ_CTRT_CNTR_TPSZ_CD			,
				BQ.RCV_TERM_CD								BQ_RCV_TERM_CD						,
				BQ.DE_TERM_CD									BQ_DE_TERM_CD							,
				BQ.DRY_CGO_FLG								BQ_DRY_CGO_FLG						,
				BQ.DCGO_FLG										BQ_DCGO_FLG								,
				BQ.RC_FLG											BQ_RC_FLG									,
				BQ.AWK_CGO_FLG								BQ_AWK_CGO_FLG						,
				BQ.BB_CGO_FLG									BQ_BB_CGO_FLG							,
				BQ.SOC_FLG										BQ_SOC_FLG								,
				BQ.PRC_CGO_TP_CD							BQ_PRC_CGO_TP_CD					,
				BQ.IMDG_CLSS_CD								BQ_IMDG_CLSS_CD						,
				BQ.CTRT_CNTR_QTY							BQ_CTRT_CNTR_QTY					,
				BQ.POR_APPL_FLG								BQ_POR_APPL_FLG						,
				BQ.POL_APPL_FLG								BQ_POL_APPL_FLG						,
				BQ.POD_APPL_FLG								BQ_POD_APPL_FLG						,
				BQ.DEL_APPL_FLG								BQ_DEL_APPL_FLG						,
				BQ.PRE_RLY_PORT_APPL_FLG			BQ_POR_RLY_PORT_APPL_FLG	,
				BQ.PST_RLY_PORT_APPL_FLG			BQ_PST_RLY_PORT_APPL_FLG	,

				RT.CMDT_HDR_SEQ								RT_CMDT_HDR_SEQ						,
				RT.ROUT_SEQ										RT_ROUT_SEQ								,
				RT.RT_SEQ											RT_RT_SEQ									,
				OI.ADD_CHG_SEQ								OI_ADD_CHG_SEQ						,
				OA.ADD_CHG_SEQ								OA_ADD_CHG_SEQ						,
				0															DA_ADD_CHG_SEQ						,
				DI.ADD_CHG_SEQ								DI_ADD_CHG_SEQ						,

				RT.GEN_SPCL_RT_TP_CD					RT_GEN_SPCL_RT_TP_CD			,
				RT.CM_PRC_CMDT_TP_CD					CM_PRC_CMDT_TP_CD					,
				RT.CM_PRC_CMDT_DEF_CD					CM_PRC_CMDT_DEF_CD				,
				OI.ROUT_PNT_LOC_DEF_CD				POR_CD										,
				OA.ROUT_PNT_LOC_DEF_CD				POL_CD										,
				RT.DP_ROUT_PNT_LOC_DEF_CD			POD_CD										,
				DI.ROUT_PNT_LOC_DEF_CD				DEL_CD										,
				OA.DIR_CALL_FLG								DIR_CALL_FLG							,
				OI.RCV_DE_TERM_CD							RCV_TERM_CD								,
				DI.RCV_DE_TERM_CD							DE_TERM_CD								,
				RT.RAT_UT_CD									RAT_UT_CD									,
				RT.PRC_CGO_TP_CD							PRC_CGO_TP_CD							,
				RT.CURR_CD										CURR_CD										,
				OI.PRC_TRSP_MOD_CD						ORG_TRSP_MOD_CD						,
				DI.PRC_TRSP_MOD_CD						DEST_TRSP_MOD_CD					,

				RT.OP_ROUT_PNT_LOC_DEF_CD			OP_ROUT_PNT_LOC_DEF_CD		,
				RT.OV_ROUT_VIA_PORT_DEF_CD		OV_ROUT_VIA_PORT_DEF_CD		,
				RT.DV_ROUT_VIA_PORT_DEF_CD		DV_ROUT_VIA_PORT_DEF_CD		,
				RT.DP_ROUT_PNT_LOC_DEF_CD			DP_ROUT_PNT_LOC_DEF_CD		,
				RT.RD_DIR_CALL_FLG						RD_DIR_CALL_FLG						,
				RT.RAT_UT_CD									RT_RAT_UT_CD							,
				RT.PRC_CGO_TP_CD							RT_PRC_CGO_TP_CD					,
				RT.OP_PRC_TRSP_MOD_CD					OP_PRC_TRSP_MOD_CD				,
				RT.DP_PRC_TRSP_MOD_CD					DP_PRC_TRSP_MOD_CD				,
				RT.CURR_CD										RT_CURR_CD								,
				RT.FNL_FRT_RT_AMT							RT_FNL_FRT_RT_AMT					,

				OI.ROUT_PNT_LOC_DEF_CD				OI_ROUT_PNT_LOC_DEF_CD		,
				OI.BSE_PORT_DEF_CD						OI_BSE_PORT_DEF_CD				,
				OI.VIA_PORT_DEF_CD						OI_VIA_PORT_DEF_CD				,
				OI.DIR_CALL_FLG								OI_DIR_CALL_FLG						,
				OI.RAT_UT_CD									OI_RAT_UT_CD							,
				OI.PRC_CGO_TP_CD							OI_PRC_CGO_TP_CD					,
				OI.PRC_TRSP_MOD_CD						OI_PRC_TRSP_MOD_CD				,
				OI.RCV_DE_TERM_CD							OI_RCV_DE_TERM_CD					,
				OI.PRC_CMDT_DEF_CD						OI_PRC_CMDT_DEF_CD				,
				OI.CURR_CD										OI_CURR_CD								,
				OI.FNL_FRT_RT_AMT							OI_FNL_FRT_RT_AMT					,
				OI.RAT_UT_MTCH_PRIO						OI_RAT_UT_MTCH_PRIO				,

				OA.ROUT_PNT_LOC_DEF_CD				OA_ROUT_PNT_LOC_DEF_CD		,
				OA.BSE_PORT_DEF_CD						OA_BSE_PORT_DEF_CD				,
				OA.VIA_PORT_DEF_CD						OA_VIA_PORT_DEF_CD				,
				OA.DIR_CALL_FLG								OA_DIR_CALL_FLG						,
				OA.RAT_UT_CD									OA_RAT_UT_CD							,
				OA.PRC_CGO_TP_CD							OA_PRC_CGO_TP_CD					,
				OA.PRC_TRSP_MOD_CD						OA_PRC_TRSP_MOD_CD				,
				OA.RCV_DE_TERM_CD							OA_RCV_DE_TERM_CD					,
				OA.PRC_CMDT_DEF_CD						OA_PRC_CMDT_DEF_CD				,
				OA.CURR_CD										OA_CURR_CD								,
				OA.FNL_FRT_RT_AMT							OA_FNL_FRT_RT_AMT					,
				OA.RAT_UT_MTCH_PRIO						OA_RAT_UT_MTCH_PRIO				,

				NULL													DA_ROUT_PNT_LOC_DEF_CD		,
				NULL													DA_BSE_PORT_DEF_CD				,
				NULL													DA_VIA_PORT_DEF_CD				,
				NULL													DA_DIR_CALL_FLG						,
				NULL													DA_RAT_UT_CD							,
				NULL													DA_PRC_CGO_TP_CD					,
				NULL													DA_PRC_TRSP_MOD_CD				,
				NULL													DA_RCV_DE_TERM_CD					,
				NULL													DA_PRC_CMDT_DEF_CD				,
				NULL													DA_CURR_CD								,
				NULL													DA_FNL_FRT_RT_AMT					,
				NULL													DA_RAT_UT_MTCH_PRIO				,

				DI.ROUT_PNT_LOC_DEF_CD				DI_ROUT_PNT_LOC_DEF_CD		,
				DI.BSE_PORT_DEF_CD						DI_BSE_PORT_DEF_CD				,
				DI.VIA_PORT_DEF_CD						DI_VIA_PORT_DEF_CD				,
				DI.DIR_CALL_FLG								DI_DIR_CALL_FLG						,
				DI.RAT_UT_CD									DI_RAT_UT_CD							,
				DI.PRC_CGO_TP_CD							DI_PRC_CGO_TP_CD					,
				DI.PRC_TRSP_MOD_CD						DI_PRC_TRSP_MOD_CD				,
				DI.RCV_DE_TERM_CD							DI_RCV_DE_TERM_CD					,
				DI.PRC_CMDT_DEF_CD						DI_PRC_CMDT_DEF_CD				,
				DI.CURR_CD										DI_CURR_CD								,
				DI.FNL_FRT_RT_AMT							DI_FNL_FRT_RT_AMT					,
				DI.RAT_UT_MTCH_PRIO						DI_RAT_UT_MTCH_PRIO				,

				RT_RAP.BKG_CONV_TP_CD      		RT_RAP_BKG_CONV_TP_CD			,
				RT_RAP.NOTE_CONV_MAPG_ID   		RT_RAP_NOTE_CONV_MAPG_ID  ,
				RT_RAP.NOTE_CONV_SEQ       		RT_RAP_NOTE_CONV_SEQ      ,
				RT_RAP.NOTE_CONV_RULE_CD   		RT_RAP_NOTE_CONV_RULE_CD  ,
				RT_RAP.NOTE_CONV_TP_CD     		RT_RAP_NOTE_CONV_TP_CD    ,
				RT_RAP.RT_OP_CD            		RT_RAP_RT_OP_CD           ,
				RT_RAP.CURR_CD             		RT_RAP_CURR_CD            ,
				RT_RAP.FRT_RT_AMT          		RT_RAP_FRT_RT_AMT         ,
				RT_RAP.RAP_CONV_CTNT					RT_RAP_CONV_CTNT					,

				RT_RAR.BKG_CONV_TP_CD      		RT_RAR_BKG_CONV_TP_CD     ,
				RT_RAR.NOTE_CONV_MAPG_ID   		RT_RAR_NOTE_CONV_MAPG_ID  ,
				RT_RAR.NOTE_CONV_SEQ       		RT_RAR_NOTE_CONV_SEQ      ,
				RT_RAR.NOTE_CONV_RULE_CD   		RT_RAR_NOTE_CONV_RULE_CD  ,
				RT_RAR.NOTE_CONV_TP_CD     		RT_RAR_NOTE_CONV_TP_CD    ,
				RT_RAR.RT_OP_CD            		RT_RAR_RT_OP_CD           ,
				RT_RAR.CURR_CD             		RT_RAR_CURR_CD            ,
				RT_RAR.FRT_RT_AMT          		RT_RAR_FRT_RT_AMT         ,
				RT_RAR.RAR_CONV_CTNT					RT_RAR_CONV_CTNT					,

				RT_DOR.BKG_CONV_TP_CD      		RT_DOR_BKG_CONV_TP_CD     ,
				RT_DOR.NOTE_CONV_MAPG_ID   		RT_DOR_NOTE_CONV_MAPG_ID  ,
				RT_DOR.NOTE_CONV_SEQ       		RT_DOR_NOTE_CONV_SEQ      ,
				RT_DOR.NOTE_CONV_RULE_CD   		RT_DOR_NOTE_CONV_RULE_CD  ,
				RT_DOR.NOTE_CONV_TP_CD     		RT_DOR_NOTE_CONV_TP_CD    ,
				RT_DOR.RT_OP_CD            		RT_DOR_RT_OP_CD           ,
				RT_DOR.CURR_CD             		RT_DOR_CURR_CD            ,
				RT_DOR.FRT_RT_AMT          		RT_DOR_FRT_RT_AMT         ,
				RT_DOR.DOR_CONV_CTNT					RT_DOR_CONV_CTNT					,

				RT_TYP.BKG_CONV_TP_CD      		RT_TYP_BKG_CONV_TP_CD     ,
				RT_TYP.NOTE_CONV_MAPG_ID   		RT_TYP_NOTE_CONV_MAPG_ID  ,
				RT_TYP.NOTE_CONV_SEQ       		RT_TYP_NOTE_CONV_SEQ      ,
				RT_TYP.NOTE_CONV_RULE_CD   		RT_TYP_NOTE_CONV_RULE_CD  ,
				RT_TYP.NOTE_CONV_TP_CD     		RT_TYP_NOTE_CONV_TP_CD    ,
				RT_TYP.RT_OP_CD            		RT_TYP_RT_OP_CD           ,
				RT_TYP.CURR_CD             		RT_TYP_CURR_CD            ,
				RT_TYP.FRT_RT_AMT          		RT_TYP_FRT_RT_AMT         ,
				RT_TYP.TYP_CONV_CTNT					RT_TYP_CONV_CTNT					,

				RT_RAC.BKG_CONV_TP_CD      		RT_RAC_BKG_CONV_TP_CD     ,
				RT_RAC.NOTE_CONV_MAPG_ID   		RT_RAC_NOTE_CONV_MAPG_ID  ,
				RT_RAC.NOTE_CONV_SEQ       		RT_RAC_NOTE_CONV_SEQ      ,
				RT_RAC.NOTE_CONV_RULE_CD   		RT_RAC_NOTE_CONV_RULE_CD  ,
				RT_RAC.NOTE_CONV_TP_CD     		RT_RAC_NOTE_CONV_TP_CD    ,
				RT_RAC.RT_OP_CD            		RT_RAC_RT_OP_CD           ,
				RT_RAC.CURR_CD             		RT_RAC_CURR_CD            ,
				RT_RAC.FRT_RT_AMT          		RT_RAC_FRT_RT_AMT         ,
				RT_RAC.RAC_CONV_CTNT					RT_RAC_CONV_CTNT					,

				RT.APP_BKG_CONV_TP_CD      		RT_APP_BKG_CONV_TP_CD     ,
				RT.APP_NOTE_CONV_MAPG_ID   		RT_APP_NOTE_CONV_MAPG_ID  ,
				RT.APP_NOTE_CONV_SEQ       		RT_APP_NOTE_CONV_SEQ      ,
				RT.APP_NOTE_CONV_RULE_CD   		RT_APP_NOTE_CONV_RULE_CD  ,
				RT.APP_NOTE_CONV_TP_CD     		RT_APP_NOTE_CONV_TP_CD    ,
				RT.APP_RT_OP_CD            		RT_APP_RT_OP_CD           ,
				RT.APP_CURR_CD             		RT_APP_CURR_CD            ,
				RT.APP_FRT_RT_AMT          		RT_APP_FRT_RT_AMT         ,

				RT.RAS_BKG_CONV_TP_CD      		RT_RAS_BKG_CONV_TP_CD     ,
				RT.RAS_NOTE_CONV_MAPG_ID   		RT_RAS_NOTE_CONV_MAPG_ID  ,
				RT.RAS_NOTE_CONV_SEQ       		RT_RAS_NOTE_CONV_SEQ      ,
				RT.RAS_NOTE_CONV_RULE_CD   		RT_RAS_NOTE_CONV_RULE_CD  ,
				RT.RAS_NOTE_CONV_TP_CD     		RT_RAS_NOTE_CONV_TP_CD    ,
				RT.RAS_RT_OP_CD            		RT_RAS_RT_OP_CD           ,
				RT.RAS_CURR_CD             		RT_RAS_CURR_CD            ,
				RT.RAS_FRT_RT_AMT          		RT_RAS_FRT_RT_AMT         ,
				RT.RAS_RAS_CONV_CTNT					RT_RAS_CONV_CTNT					,

				RT.ARB_BKG_CONV_TP_CD      		RT_ARB_BKG_CONV_TP_CD     ,
				RT.ARB_NOTE_CONV_MAPG_ID   		RT_ARB_NOTE_CONV_MAPG_ID  ,
				RT.ARB_NOTE_CONV_SEQ       		RT_ARB_NOTE_CONV_SEQ      ,
				RT.ARB_NOTE_CONV_RULE_CD   		RT_ARB_NOTE_CONV_RULE_CD  ,
				RT.ARB_NOTE_CONV_TP_CD     		RT_ARB_NOTE_CONV_TP_CD    ,
				RT.ARB_RT_OP_CD            		RT_ARB_RT_OP_CD           ,
				RT.ARB_CURR_CD             		RT_ARB_CURR_CD            ,
				RT.ARB_FRT_RT_AMT          		RT_ARB_FRT_RT_AMT         ,

				RT.ADD_BKG_CONV_TP_CD      		RT_ADD_BKG_CONV_TP_CD     ,
				RT.ADD_NOTE_CONV_MAPG_ID   		RT_ADD_NOTE_CONV_MAPG_ID  ,
				RT.ADD_NOTE_CONV_SEQ       		RT_ADD_NOTE_CONV_SEQ      ,
				RT.ADD_NOTE_CONV_RULE_CD   		RT_ADD_NOTE_CONV_RULE_CD  ,
				RT.ADD_NOTE_CONV_TP_CD     		RT_ADD_NOTE_CONV_TP_CD    ,
				RT.ADD_RT_OP_CD            		RT_ADD_RT_OP_CD           ,
				RT.ADD_CURR_CD             		RT_ADD_CURR_CD            ,
				RT.ADD_FRT_RT_AMT          		RT_ADD_FRT_RT_AMT         ,

				OA_TYP.BKG_CONV_TP_CD      		OA_TYP_BKG_CONV_TP_CD     ,
				OA_TYP.NOTE_CONV_MAPG_ID   		OA_TYP_NOTE_CONV_MAPG_ID  ,
				OA_TYP.NOTE_CONV_SEQ       		OA_TYP_NOTE_CONV_SEQ      ,
				OA_TYP.NOTE_CONV_RULE_CD   		OA_TYP_NOTE_CONV_RULE_CD  ,
				OA_TYP.NOTE_CONV_TP_CD     		OA_TYP_NOTE_CONV_TP_CD    ,
				OA_TYP.RT_OP_CD            		OA_TYP_RT_OP_CD           ,
				OA_TYP.CURR_CD             		OA_TYP_CURR_CD            ,
				OA_TYP.FRT_RT_AMT          		OA_TYP_FRT_RT_AMT         ,
				OA_TYP.TYP_CONV_CTNT       		OA_TYP_CONV_CTNT         	,

				OA_RAC.BKG_CONV_TP_CD      		OA_RAC_BKG_CONV_TP_CD     ,
				OA_RAC.NOTE_CONV_MAPG_ID   		OA_RAC_NOTE_CONV_MAPG_ID  ,
				OA_RAC.NOTE_CONV_SEQ       		OA_RAC_NOTE_CONV_SEQ      ,
				OA_RAC.NOTE_CONV_RULE_CD   		OA_RAC_NOTE_CONV_RULE_CD  ,
				OA_RAC.NOTE_CONV_TP_CD     		OA_RAC_NOTE_CONV_TP_CD    ,
				OA_RAC.RT_OP_CD            		OA_RAC_RT_OP_CD           ,
				OA_RAC.CURR_CD             		OA_RAC_CURR_CD            ,
				OA_RAC.FRT_RT_AMT          		OA_RAC_FRT_RT_AMT         ,
				OA_RAC.RAC_CONV_CTNT       		OA_RAC_CONV_CTNT         	,

				DA_TYP.BKG_CONV_TP_CD      		DA_TYP_BKG_CONV_TP_CD     ,
				DA_TYP.NOTE_CONV_MAPG_ID   		DA_TYP_NOTE_CONV_MAPG_ID  ,
				DA_TYP.NOTE_CONV_SEQ       		DA_TYP_NOTE_CONV_SEQ      ,
				DA_TYP.NOTE_CONV_RULE_CD   		DA_TYP_NOTE_CONV_RULE_CD  ,
				DA_TYP.NOTE_CONV_TP_CD     		DA_TYP_NOTE_CONV_TP_CD    ,
				DA_TYP.RT_OP_CD            		DA_TYP_DA_OP_CD           ,
				DA_TYP.CURR_CD             		DA_TYP_CURR_CD            ,
				DA_TYP.FRT_RT_AMT          		DA_TYP_FRT_RT_AMT					,
				DA_TYP.TYP_CONV_CTNT       		DA_TYP_CONV_CTNT         	,

				DA_RAC.BKG_CONV_TP_CD      		DA_RAC_BKG_CONV_TP_CD     ,
				DA_RAC.NOTE_CONV_MAPG_ID   		DA_RAC_NOTE_CONV_MAPG_ID  ,
				DA_RAC.NOTE_CONV_SEQ       		DA_RAC_NOTE_CONV_SEQ      ,
				DA_RAC.NOTE_CONV_RULE_CD   		DA_RAC_NOTE_CONV_RULE_CD  ,
				DA_RAC.NOTE_CONV_TP_CD     		DA_RAC_NOTE_CONV_TP_CD    ,
				DA_RAC.RT_OP_CD            		DA_RAC_DA_OP_CD           ,
				DA_RAC.CURR_CD             		DA_RAC_CURR_CD            ,
				DA_RAC.FRT_RT_AMT          		DA_RAC_FRT_RT_AMT					,
				DA_RAC.RAC_CONV_CTNT       		DA_RAC_CONV_CTNT         	,

				'Y'														POR_MTCH_FLG							,
				'Y'														DEL_MTCH_FLG

FROM
/*******************************************************************************************
JOIN TABLE
1.1 BQ, CH, CM, CR, RD, OP, DV, DP, RT
1.2 RT RULE					: RAP, RAR, DOR, TYP, RAC, APP, RAS, ADD
2.1 OA							: O
2.2 OA RULE					: TYP, RAC ( RAP, RAR, DOR 는 RT 와 동일하게 적용 )
3.1 DA							: O
3.2 DA RULE					: TYP, RAC ( RAP, RAR, DOR 는 RT 와 동일하게 적용 )
*******************************************************************************************/
				BQ	,
				OI	,
				OA	,
				DI	,
				RT	,
				NC_P											RT_RAP	,			/* COMMODITY CONVERSION */
				NC_P											RT_RAR	,			/* ROUTE CONVERSION */
				NC_P											RT_DOR	,			/* R/D TERM CONVERSION */
				NC_P											RT_TYP	,			/* RATING UNIT CONVERSION */
				NC_P											RT_RAC	,			/* CARGO TYPE CONVERSION */
				NC_P											OA_TYP	,			/* RATING UNIT CONVERSION */
				NC_P											OA_RAC	,			/* CARGO TYPE CONVERSION */
				NC_P											DA_TYP	,			/* RATING UNIT CONVERSION */
				NC_P											DA_RAC				/* CARGO TYPE CONVERSION */

WHERE		RT.BQ_SEQ		=	BQ.BQ_SEQ
AND			OI.BQ_SEQ		= BQ.BQ_SEQ
AND			OA.BQ_SEQ		= BQ.BQ_SEQ
AND			DI.BQ_SEQ		= BQ.BQ_SEQ
AND			RT_RAP.BQ_SEQ	= RT.BQ_SEQ AND RT_RAP.NOTE_CONV_RULE_CD = 'RAP' AND ( RT_RAP.BKG_CONV_TP_CD = 'B' OR RT_RAP.NC_SEQ = RT.RAP_NC_SEQ )
AND			RT_RAR.BQ_SEQ	= RT.BQ_SEQ AND RT_RAR.NOTE_CONV_RULE_CD = 'RAR' AND ( RT_RAR.BKG_CONV_TP_CD = 'B' OR RT_RAR.NC_SEQ = RT.RAR_NC_SEQ )
AND			RT_DOR.BQ_SEQ	= RT.BQ_SEQ AND RT_DOR.NOTE_CONV_RULE_CD = 'DOR' AND ( RT_DOR.BKG_CONV_TP_CD = 'B' OR RT_DOR.NC_SEQ = RT.DOR_NC_SEQ )
AND			RT_TYP.BQ_SEQ	= RT.BQ_SEQ AND RT_TYP.NOTE_CONV_RULE_CD = 'TYP' AND ( RT_TYP.BKG_CONV_TP_CD = 'B' OR RT_TYP.NC_SEQ = RT.TYP_NC_SEQ )
AND			RT_RAC.BQ_SEQ	= RT.BQ_SEQ AND RT_RAC.NOTE_CONV_RULE_CD = 'RAC' AND ( RT_RAC.BKG_CONV_TP_CD = 'B' OR RT_RAC.NC_SEQ = RT.RAC_NC_SEQ )
AND			OA_TYP.BQ_SEQ	= RT.BQ_SEQ AND OA_TYP.NOTE_CONV_RULE_CD = 'TYP' AND ( OA_TYP.BKG_CONV_TP_CD = 'B' OR OA_TYP.NC_SEQ = RT.TYP_NC_SEQ )
AND			OA_RAC.BQ_SEQ	= RT.BQ_SEQ AND OA_RAC.NOTE_CONV_RULE_CD = 'RAC' AND ( OA_RAC.BKG_CONV_TP_CD = 'B' OR OA_RAC.NC_SEQ = RT.RAC_NC_SEQ )
AND			DA_TYP.BQ_SEQ	= RT.BQ_SEQ AND DA_TYP.NOTE_CONV_RULE_CD = 'TYP' AND ( DA_TYP.BKG_CONV_TP_CD = 'B' OR DA_TYP.NC_SEQ = RT.TYP_NC_SEQ )
AND			DA_RAC.BQ_SEQ	= RT.BQ_SEQ AND DA_RAC.NOTE_CONV_RULE_CD = 'RAC' AND ( DA_RAC.BKG_CONV_TP_CD = 'B' OR DA_RAC.NC_SEQ = RT.RAC_NC_SEQ )


/*******************************************************************************************
	12.1 RATE
*******************************************************************************************/

/*******************************************************************************************
	12.1.1 RATE - COMMODITY
	(주의)
	COMMODITY 나 RATING UNIT 등의 조건이 위의 OA, DA, RT 와 중복조건으로 보일 수 있으나,
	OA, DA, RT 는 CONVERSION 이 정확하게 적용한 것이 아니므로, 다시한번 정확하게 조건을 연결해야 한다.
*******************************************************************************************/

/*******************************************************************************************
< COMMODITY >
그룹, 개별간으로 일치하는 경우
*******************************************************************************************/
AND			( RT.CM_PRC_CMDT_TP_CD, RT.CM_PRC_CMDT_DEF_CD ) IN
				(
				SELECT	RT_RAP.CONV_CMDT_TP_CD, RT_RAP.CONV_CMDT_DEF_CD
				FROM		DUAL
				UNION ALL
				SELECT  'C', GC.PRC_CMDT_DEF_CD
				FROM		GC
				WHERE		RT_RAP.CONV_CMDT_TP_CD	= 'G'
				AND     GC.PRC_CMDT_TP_CD   		= 'C'
				AND			GC.PRC_GRP_CMDT_CD  		= RT_RAP.CONV_CMDT_DEF_CD
				UNION ALL
				SELECT  'G', GC.PRC_GRP_CMDT_CD
				FROM		GC
				WHERE		RT_RAP.CONV_CMDT_TP_CD	= 'C'
				AND     GC.PRC_CMDT_TP_CD   		= 'C'
				AND     GC.PRC_CMDT_DEF_CD  		= RT_RAP.CONV_CMDT_DEF_CD
				UNION ALL
				/* TAW 일 경우 FAK 고려함 */
				SELECT	'C', CMDT_CD
				FROM		MDM_COMMODITY
				WHERE		REP_CMDT_CD		= '0000'
				UNION ALL
				SELECT	'G', GC.PRC_GRP_CMDT_CD
				FROM		GC
				WHERE		GC.PRC_CMDT_TP_CD		= 'C'
				AND			GC.PRC_CMDT_DEF_CD  IN ( SELECT CMDT_CD FROM MDM_COMMODITY WHERE REP_CMDT_CD = '0000' )
				)


/*******************************************************************************************
	12.1.2 RATE - ROUTE
*******************************************************************************************/

/*******************************************************************************************
< ORIGIN ( PRE PELAY ) >
*******************************************************************************************/

AND     ( RT.OP_ROUT_PNT_LOC_TP_CD, RT.OP_ROUT_PNT_LOC_DEF_CD ) IN
				(
				SELECT	'L', BQ.PRE_RLY_PORT_CD
				FROM		DUAL
				UNION ALL
				SELECT  'G', GL.PRC_GRP_LOC_CD
				FROM		GL
				WHERE		GL.LOC_CD						= BQ.PRE_RLY_PORT_CD
				)


/*******************************************************************************************
< ORIGIN VIA ( PRE PELAY ) >
*******************************************************************************************/

AND     (
						RT.OV_ROUT_VIA_PORT_DEF_CD IS NULL
				OR	( RT.OV_ROUT_VIA_PORT_TP_CD, RT.OV_ROUT_VIA_PORT_DEF_CD ) IN
						(
						SELECT	'L', BQ.PRE_RLY_PORT_CD
						FROM		DUAL
						UNION ALL
						SELECT  'G', GL.PRC_GRP_LOC_CD
						FROM		GL
						WHERE		GL.LOC_CD						= BQ.PRE_RLY_PORT_CD
						)
				)


/*******************************************************************************************
< DESTINATION VIA ( POD ) >
*******************************************************************************************/

AND     (
						RT.DV_ROUT_VIA_PORT_DEF_CD IS NULL
				OR	( RT.DV_ROUT_VIA_PORT_TP_CD, RT.DV_ROUT_VIA_PORT_DEF_CD ) IN
						(
						SELECT	RT_RAR.CONV_DEST_VIA_LOC_TP_CD,	RT_RAR.CONV_DEST_VIA_LOC_DEF_CD
						FROM		DUAL
						UNION ALL
						SELECT  'L', GL.LOC_CD
						FROM		GL
						WHERE		RT_RAR.CONV_DEST_VIA_LOC_TP_CD	= 'G'
						AND		  GL.PRC_GRP_LOC_CD 						= RT_RAR.CONV_DEST_VIA_LOC_DEF_CD
						UNION ALL
						SELECT  'G', GL.PRC_GRP_LOC_CD
						FROM		GL
						WHERE		RT_RAR.CONV_DEST_VIA_LOC_TP_CD	= 'L'
						AND     GL.LOC_CD											= RT_RAR.CONV_DEST_VIA_LOC_DEF_CD
						)
				)


/*******************************************************************************************
< DESTINATION ( POD ) >
*******************************************************************************************/

AND     ( RT.DP_ROUT_PNT_LOC_TP_CD, RT.DP_ROUT_PNT_LOC_DEF_CD ) IN
				(
				SELECT	RT_RAR.CONV_DEST_VIA_LOC_TP_CD,	RT_RAR.CONV_DEST_VIA_LOC_DEF_CD
				FROM		DUAL
				UNION ALL
				SELECT  'L', GL.LOC_CD
				FROM		GL
				WHERE		RT_RAR.CONV_DEST_VIA_LOC_TP_CD	= 'G'
				AND		  GL.PRC_GRP_LOC_CD 				= RT_RAR.CONV_DEST_VIA_LOC_DEF_CD
				UNION ALL
				SELECT  'G', GL.PRC_GRP_LOC_CD
				FROM		GL
				WHERE		RT_RAR.CONV_DEST_VIA_LOC_TP_CD	= 'L'
				AND     GL.LOC_CD									= RT_RAR.CONV_DEST_VIA_LOC_DEF_CD
				)


/*******************************************************************************************
	12.1.3 RATE - RATING UNIT
*******************************************************************************************/

AND     (
								RT.RAT_UT_CD	= RT_TYP.CONV_RAT_UT_CD
		        OR
    		    (
        				RT.RAT_UT_CD	IN ( '20', '40', 'HC', '45', '53' )
       			AND ( SELECT A.CNTR_SZ_CD FROM PRI_RAT_UT A WHERE A.RAT_UT_CD = RT.RAT_UT_CD )	= RT_TYP.CONV_RAT_UT_SZ_CD
        		)
				)

AND			RT.PRC_CGO_TP_CD	IN ( RT_RAC.CONV_DR_TP, RT_RAC.CONV_DG_TP, RT_RAC.CONV_RF_TP, RT_RAC.CONV_AK_TP, RT_RAC.CONV_BB_TP )


/*******************************************************************************************
	12.2 ORIGIN IHC
*******************************************************************************************/

/*******************************************************************************************
	12.2.2 ORIGIN IHC - ROUTE
*******************************************************************************************/

/*******************************************************************************************
< POINT ( POR ) >
*******************************************************************************************/

AND     ( OI.ROUT_PNT_LOC_TP_CD, OI.ROUT_PNT_LOC_DEF_CD ) IN
				(
				SELECT  RT_RAR.CONV_ORG_LOC_TP_CD, RT_RAR.CONV_ORG_LOC_DEF_CD
				FROM		DUAL
				UNION ALL
				SELECT  'L', GL.LOC_CD
				FROM		GL
				WHERE		RT_RAR.CONV_ORG_LOC_TP_CD	= 'G'
				AND		  GL.PRC_GRP_LOC_CD 				= RT_RAR.CONV_ORG_LOC_DEF_CD
				UNION ALL
				SELECT  'G', GL.PRC_GRP_LOC_CD
				FROM		GL
				WHERE		RT_RAR.CONV_ORG_LOC_TP_CD	= 'L'
				AND     GL.LOC_CD									= RT_RAR.CONV_ORG_LOC_DEF_CD
				)


/*******************************************************************************************
< RCV TERM >
*******************************************************************************************/

AND     NVL(OI.RCV_DE_TERM_CD, '*') IN
				(
				SELECT  B.RCV_DE_TERM_CD
				FROM		(
								SELECT 'Y' CONV_PRC_TERM_CD, 'Y' RCV_DE_TERM_CD FROM DUAL UNION ALL
								SELECT 'Y' CONV_PRC_TERM_CD, 'L' RCV_DE_TERM_CD FROM DUAL UNION ALL
								SELECT 'Y' CONV_PRC_TERM_CD, '*' RCV_DE_TERM_CD FROM DUAL UNION ALL
								SELECT 'S' CONV_PRC_TERM_CD, 'S' RCV_DE_TERM_CD FROM DUAL UNION ALL
								SELECT 'D' CONV_PRC_TERM_CD, 'D' RCV_DE_TERM_CD FROM DUAL UNION ALL
								SELECT 'T' CONV_PRC_TERM_CD, 'T' RCV_DE_TERM_CD FROM DUAL UNION ALL
								SELECT 'I' CONV_PRC_TERM_CD, 'I' RCV_DE_TERM_CD FROM DUAL
								)	B
				WHERE		B.CONV_PRC_TERM_CD	= RT_DOR.CONV_PRC_RCV_TERM_CD
				)


/*******************************************************************************************
< BASE PORT ( POL ) >
*******************************************************************************************/

AND     ( OI.BSE_PORT_TP_CD, OI.BSE_PORT_DEF_CD ) IN
				(
				SELECT  RT_RAR.CONV_ORG_VIA_LOC_TP_CD, RT_RAR.CONV_ORG_VIA_LOC_DEF_CD
				FROM		DUAL
				UNION ALL
				SELECT  'L', GL.LOC_CD
				FROM		GL
				WHERE		RT_RAR.CONV_ORG_VIA_LOC_TP_CD	= 'G'
				AND		  GL.PRC_GRP_LOC_CD 				= RT_RAR.CONV_ORG_VIA_LOC_DEF_CD
				UNION ALL
				SELECT  'G', GL.PRC_GRP_LOC_CD
				FROM		GL
				WHERE		RT_RAR.CONV_ORG_VIA_LOC_TP_CD	= 'L'
				AND     GL.LOC_CD									= RT_RAR.CONV_ORG_VIA_LOC_DEF_CD
				)


/*******************************************************************************************
	12.2.3 ORIGIN IHC - RATING UNIT
*******************************************************************************************/

/* ORIGIN ARB RATING UNIT */
AND     (
								OI.RAT_UT_CD	= OA_TYP.CONV_RAT_UT_CD
		        OR	OI.RAT_UT_CD	= 'BX'
		        OR
    		    (
        				OI.RAT_UT_CD	IN ( '20', '40', 'HC', '45', '53' )
       			AND ( SELECT A.CNTR_SZ_CD FROM PRI_RAT_UT A WHERE A.RAT_UT_CD = OI.RAT_UT_CD )	= OA_TYP.CONV_RAT_UT_SZ_CD
        		)
				)


/* ORIGIN ARB CARGO TYPE */
AND			NVL(OI.PRC_CGO_TP_CD, '*')	IN ( '*', OA_RAC.CONV_DR_TP, OA_RAC.CONV_DG_TP, OA_RAC.CONV_RF_TP, OA_RAC.CONV_AK_TP, OA_RAC.CONV_BB_TP )


/*******************************************************************************************
	12.3 ORIGIN ARB
*******************************************************************************************/

/*******************************************************************************************
	12.3.1 ORIGIN ARB - COMMODITY
*******************************************************************************************/

AND			(
						OA.PRC_CMDT_DEF_CD	IS NULL
				OR	( OA.PRC_CMDT_TP_CD, OA.PRC_CMDT_DEF_CD ) IN
						(
						SELECT	RT_RAP.CONV_CMDT_TP_CD, RT_RAP.CONV_CMDT_DEF_CD
						FROM		DUAL
						UNION ALL
						SELECT  'C', GC.PRC_CMDT_DEF_CD
						FROM		GC
						WHERE		RT_RAP.CONV_CMDT_TP_CD	= 'G'
						AND     GC.PRC_CMDT_TP_CD   		= 'C'
						AND			GC.PRC_GRP_CMDT_CD  		= RT_RAP.CONV_CMDT_DEF_CD
						UNION ALL
						SELECT  'G', GC.PRC_GRP_CMDT_CD
						FROM		GC
						WHERE		RT_RAP.CONV_CMDT_TP_CD	= 'C'
						AND     GC.PRC_CMDT_TP_CD   		= 'C'
						AND     GC.PRC_CMDT_DEF_CD  		= RT_RAP.CONV_CMDT_DEF_CD
						UNION ALL
						/* TAW 일 경우 FAK 고려함 */
						SELECT	'C', CMDT_CD
						FROM		MDM_COMMODITY
						WHERE		REP_CMDT_CD		= '0000'
						UNION ALL
						SELECT	'G', GC.PRC_GRP_CMDT_CD
						FROM		GC
						WHERE		GC.PRC_CMDT_TP_CD		= 'C'
						AND			GC.PRC_CMDT_DEF_CD  IN ( SELECT CMDT_CD FROM MDM_COMMODITY WHERE REP_CMDT_CD = '0000' )
						)
				)


/*******************************************************************************************
	12.3.2 ORIGIN ARB - ROUTE
*******************************************************************************************/

/*******************************************************************************************
< POINT ( POL ) >
*******************************************************************************************/

AND     ( OA.ROUT_PNT_LOC_TP_CD, OA.ROUT_PNT_LOC_DEF_CD ) IN
				(
				SELECT	RT_RAR.CONV_ORG_VIA_LOC_TP_CD,	RT_RAR.CONV_ORG_VIA_LOC_DEF_CD
				FROM		DUAL
				UNION ALL
				SELECT  'L', GL.LOC_CD
				FROM		GL
				WHERE		RT_RAR.CONV_ORG_VIA_LOC_TP_CD	= 'G'
				AND		  GL.PRC_GRP_LOC_CD 				= RT_RAR.CONV_ORG_VIA_LOC_DEF_CD
				UNION ALL
				SELECT  'G', GL.PRC_GRP_LOC_CD
				FROM		GL
				WHERE		RT_RAR.CONV_ORG_VIA_LOC_TP_CD	= 'L'
				AND     GL.LOC_CD									= RT_RAR.CONV_ORG_VIA_LOC_DEF_CD
				)


/*******************************************************************************************
< VIA PORT ( PRE RELAY ) >
*******************************************************************************************/

AND     (
                OA.VIA_PORT_DEF_CD  IS NULL
            OR	( OA.VIA_PORT_TP_CD, OA.VIA_PORT_DEF_CD ) IN
								(
								SELECT	'L', BQ.PRE_RLY_PORT_CD
								FROM		DUAL
								UNION ALL
								SELECT  'G', GL.PRC_GRP_LOC_CD
								FROM		GL
								WHERE		GL.LOC_CD						= BQ.PRE_RLY_PORT_CD
								)
        )


/*******************************************************************************************
	12.3.3 ORIGIN ARB - RATING UNIT
*******************************************************************************************/

/* ORIGIN ARB RATING UNIT */
AND     (
								OA.RAT_UT_CD	= OA_TYP.CONV_RAT_UT_CD
		        OR	OA.RAT_UT_CD	= 'BX'
		        OR
    		    (
        				OA.RAT_UT_CD	IN ( '20', '40', 'HC', '45', '53' )
       			AND ( SELECT A.CNTR_SZ_CD FROM PRI_RAT_UT A WHERE A.RAT_UT_CD = OA.RAT_UT_CD )	= OA_TYP.CONV_RAT_UT_SZ_CD
        		)
				)

/* ORIGIN ARB CARGO TYPE */
AND			NVL(OA.PRC_CGO_TP_CD, '*')	IN ('*', OA_RAC.CONV_DR_TP, OA_RAC.CONV_DG_TP, OA_RAC.CONV_RF_TP, OA_RAC.CONV_AK_TP, OA_RAC.CONV_BB_TP )


/*******************************************************************************************
	12.3.4 ORIGIN ARB - JOIN
*******************************************************************************************/

/* ORIGIN ARB JOIN ( ARB CONV RULE ) */
AND			DECODE(RT.ARB_RT_APPL_TP_CD, NULL, DECODE(RT.GEN_SPCL_RT_TP_CD, 'S', 'N', 'Y'), 'N', 'N', 'Y') = 'Y'

/* ORIGIN ARB JOIN ( OARB.BPORT = RATE.ORIGIN ) */
AND			NVL(RT.OP_RCV_DE_TERM_CD, '*' )	NOT IN ( 'D', 'S' )

AND			( RT.OP_ROUT_PNT_LOC_TP_CD, RT.OP_ROUT_PNT_LOC_DEF_CD ) IN
				(
				SELECT	OA.BSE_PORT_TP_CD, OA.BSE_PORT_DEF_CD
				FROM		DUAL
				UNION ALL
				SELECT	'L', GL.LOC_CD
				FROM		GL
				WHERE		OA.BSE_PORT_TP_CD	= 'G'
				AND		  GL.PRC_GRP_LOC_CD	= OA.BSE_PORT_DEF_CD
				UNION ALL
				SELECT	'G', GL.PRC_GRP_LOC_CD
				FROM		GL
				WHERE		OA.BSE_PORT_TP_CD	= 'L'
				AND			GL.LOC_CD					= OA.BSE_PORT_DEF_CD
				)


/*******************************************************************************************
	12.4 DEST IHC
*******************************************************************************************/

/*******************************************************************************************
	12.4.2 DEST ARB - ROUTE
*******************************************************************************************/

/*******************************************************************************************
< BASE PORT ( POD ) >
*******************************************************************************************/

AND     ( DI.BSE_PORT_TP_CD, DI.BSE_PORT_DEF_CD ) IN
				(
				SELECT  RT_RAR.CONV_DEST_VIA_LOC_TP_CD, RT_RAR.CONV_DEST_VIA_LOC_DEF_CD
				FROM		DUAL
				UNION ALL
				SELECT  'L', GL.LOC_CD
				FROM		GL
				WHERE		RT_RAR.CONV_DEST_VIA_LOC_TP_CD	= 'G'
				AND		  GL.PRC_GRP_LOC_CD 				= RT_RAR.CONV_DEST_VIA_LOC_DEF_CD
				UNION ALL
				SELECT  'G', GL.PRC_GRP_LOC_CD
				FROM		GL
				WHERE		RT_RAR.CONV_DEST_VIA_LOC_TP_CD	= 'L'
				AND     GL.LOC_CD									= RT_RAR.CONV_DEST_VIA_LOC_DEF_CD
				)


/*******************************************************************************************
< POINT ( DEL ) >
*******************************************************************************************/

AND     ( DI.ROUT_PNT_LOC_TP_CD, DI.ROUT_PNT_LOC_DEF_CD ) IN
				(
				SELECT  RT_RAR.CONV_DEST_LOC_TP_CD, RT_RAR.CONV_DEST_LOC_DEF_CD
				FROM		DUAL
				UNION ALL
				SELECT  'L', GL.LOC_CD
				FROM		GL
				WHERE		RT_RAR.CONV_DEST_LOC_TP_CD	= 'G'
				AND		  GL.PRC_GRP_LOC_CD 				= RT_RAR.CONV_DEST_LOC_DEF_CD
				UNION ALL
				SELECT  'G', GL.PRC_GRP_LOC_CD
				FROM		GL
				WHERE		RT_RAR.CONV_DEST_LOC_TP_CD	= 'L'
				AND     GL.LOC_CD									= RT_RAR.CONV_DEST_LOC_DEF_CD
				)


/*******************************************************************************************
< DE TERM >
*******************************************************************************************/

AND			NVL(DI.RCV_DE_TERM_CD, '*') IN
				(
				SELECT  B.RCV_DE_TERM_CD
				FROM		(
								SELECT 'Y' CONV_PRC_TERM_CD, 'Y' RCV_DE_TERM_CD FROM DUAL UNION ALL
								SELECT 'Y' CONV_PRC_TERM_CD, 'L' RCV_DE_TERM_CD FROM DUAL UNION ALL
								SELECT 'Y' CONV_PRC_TERM_CD, '*' RCV_DE_TERM_CD FROM DUAL UNION ALL
								SELECT 'S' CONV_PRC_TERM_CD, 'S' RCV_DE_TERM_CD FROM DUAL UNION ALL
								SELECT 'S' CONV_PRC_TERM_CD, 'Y' RCV_DE_TERM_CD FROM DUAL UNION ALL
								SELECT 'S' CONV_PRC_TERM_CD, 'T' RCV_DE_TERM_CD FROM DUAL UNION ALL
								SELECT 'S' CONV_PRC_TERM_CD, 'I' RCV_DE_TERM_CD FROM DUAL UNION ALL
								SELECT 'S' CONV_PRC_TERM_CD, 'L' RCV_DE_TERM_CD FROM DUAL UNION ALL
								SELECT 'S' CONV_PRC_TERM_CD, '*' RCV_DE_TERM_CD FROM DUAL UNION ALL
								SELECT 'D' CONV_PRC_TERM_CD, 'D' RCV_DE_TERM_CD FROM DUAL UNION ALL
								SELECT 'T' CONV_PRC_TERM_CD, 'T' RCV_DE_TERM_CD FROM DUAL UNION ALL
								SELECT 'I' CONV_PRC_TERM_CD, 'I' RCV_DE_TERM_CD FROM DUAL
								)	B
				WHERE		B.CONV_PRC_TERM_CD	= RT_DOR.CONV_PRC_DE_TERM_CD
				)


/*******************************************************************************************
	12.4.3 DEST ARB - RATING UNIT
*******************************************************************************************/

/* DEST ARB RATING UNIT */
AND     (
								DI.RAT_UT_CD	= DA_TYP.CONV_RAT_UT_CD
		        OR	DI.RAT_UT_CD	= 'BX'
		        OR
    		    (
        				DI.RAT_UT_CD	IN ( '20', '40', 'HC', '45', '53' )
       			AND ( SELECT A.CNTR_SZ_CD FROM PRI_RAT_UT A WHERE A.RAT_UT_CD = DI.RAT_UT_CD )	= DA_TYP.CONV_RAT_UT_SZ_CD
        		)
				)


/* DEST ARB CARGO TYPE */
AND			NVL(DI.PRC_CGO_TP_CD, '*')	IN ( '*', DA_RAC.CONV_DR_TP, DA_RAC.CONV_DG_TP, DA_RAC.CONV_RF_TP, DA_RAC.CONV_AK_TP, DA_RAC.CONV_BB_TP )


/*******************************************************************************************
	12.4.4 DEST ARB - JOIN
*******************************************************************************************/

/* DEST ARB JOIN ( ADD CONV RULE ) */
AND			DECODE(RT.ADD_RT_APPL_TP_CD, NULL, DECODE(RT.GEN_SPCL_RT_TP_CD, 'S', 'N', 'Y'), 'N', 'N', 'Y') = 'Y'

/* DEST ARB JOIN ( DARB.BPORT = RATE.DEST ) */
AND			NVL(RT.DP_RCV_DE_TERM_CD, '*' )	NOT IN ( 'D', 'S' )

AND			( RT.DP_ROUT_PNT_LOC_TP_CD, RT.DP_ROUT_PNT_LOC_DEF_CD ) IN
				(
				SELECT	DI.BSE_PORT_TP_CD, DI.BSE_PORT_DEF_CD
				FROM		DUAL
				UNION ALL
				SELECT	'L', GL.LOC_CD
				FROM		GL
				WHERE		DI.BSE_PORT_TP_CD	= 'G'
				AND		  GL.PRC_GRP_LOC_CD	= DI.BSE_PORT_DEF_CD
				UNION ALL
				SELECT	'G', GL.PRC_GRP_LOC_CD
				FROM		GL
				WHERE		DI.BSE_PORT_TP_CD	= 'L'
				AND			GL.LOC_CD					= DI.BSE_PORT_DEF_CD
				)

)

SELECT	@[bkg_no]										BKG_NO										,
				R.CTRT_NO										CTRT_NO										,
				R.PRC_RT_MTCH_PATT_CD				PRC_RT_MTCH_PATT_CD				,
				R.PROP_NO										PROP_NO										,
				R.AMDT_SEQ									AMDT_SEQ									,
				R.SVC_SCP_CD								SVC_SCP_CD								,
				R.BQ_SEQ										BQ_SEQ										,
				R.BKG_BQ_SEQ								BKG_BQ_SEQ								,
				ROWNUM											BKG_BQ_OCCR_SEQ						,
				ROW_NUMBER() OVER ( ORDER BY
																R.RT_GEN_SPCL_RT_TP_CD	DESC	,
																DECODE(R.POR_MTCH_FLG, 'Y', 1, 2)	,
																DECODE(R.DEL_MTCH_FLG, 'Y', 1, 2)	,
																SUBSTR(R.PRC_RT_MTCH_PATT_CD, 1, 1) * 2 + SUBSTR(R.PRC_RT_MTCH_PATT_CD, 2, 1) * 1 + SUBSTR(R.PRC_RT_MTCH_PATT_CD, 3, 1) * 1 + SUBSTR(R.PRC_RT_MTCH_PATT_CD, 4, 1) * 2	,
																R.PRC_RT_MTCH_PATT_CD					,
																R.RT_CMDT_HDR_SEQ							,
																R.RT_ROUT_SEQ									,
																R.BKG_BQ_SEQ									,
																R.RT_RT_SEQ										,
																R.UQ_SEQ
													)			DP_SEQ												,

/* BKG_AUTO_RT_OCN_FRT_TMP 에 임시 저장할 칼럼 START */
				R.BQ_CNTR_TPSZ_CD						CNTR_TPSZ_CD							,
				R.BQ_CTRT_CNTR_TPSZ_CD			CTRT_CNTR_TPSZ_CD					,
				R.BQ_RCV_TERM_CD						RCV_TERM_CD								,
				R.BQ_DE_TERM_CD							DE_TERM_CD								,
				R.BQ_DRY_CGO_FLG						DRY_CGO_FLG								,
				R.BQ_AWK_CGO_FLG						AWK_CGO_FLG								,
				R.BQ_DCGO_FLG								DCGO_FLG									,
				R.BQ_RC_FLG									RC_FLG										,
				R.BQ_BB_CGO_FLG							BB_CGO_FLG								,
				R.BQ_SOC_FLG								SOC_FLG										,
				R.BQ_IMDG_CLSS_CD						IMDG_CLSS_CD							,
				R.RT_GEN_SPCL_RT_TP_CD			PRC_GEN_SPCL_RT_TP_CD			,
				R.RT_CMDT_HDR_SEQ						PRC_CMDT_HDR_SEQ					,
				R.RT_ROUT_SEQ								PRC_ROUT_SEQ							,
				R.RT_RT_SEQ									PRC_RT_SEQ								,
/* BKG_AUTO_RT_OCN_FRT_TMP 에 임시 저장할 칼럼 END */

/* UI GRID START */
				R.RT_GEN_SPCL_RT_TP_CD||R.PRC_RT_MTCH_PATT_CD	RT_MTCH_PATT_CD	,
				CASE
				WHEN CM_PRC_CMDT_TP_CD = 'C' THEN (	SELECT CMDT_NM
																						FROM MDM_COMMODITY A
																						WHERE A.CMDT_CD = R.CM_PRC_CMDT_DEF_CD	)
				WHEN CM_PRC_CMDT_TP_CD = 'G' THEN	(	SELECT PRC_GRP_CMDT_DESC
																				 		FROM PRI_SP_SCP_GRP_CMDT A
																				 		WHERE A.PROP_NO = R.PROP_NO AND A.AMDT_SEQ = R.AMDT_SEQ AND A.SVC_SCP_CD = R.SVC_SCP_CD AND A.PRC_GRP_CMDT_CD = R.CM_PRC_CMDT_DEF_CD	)
				END	CMDT_NM																						,
				R.POR_CD										POR_CD										,
				R.POL_CD										POL_CD										,
				R.POD_CD										POD_CD										,
				R.DEL_CD										DEL_CD										,
				R.DIR_CALL_FLG							DIR_CALL_FLG							,
				R.RCV_TERM_CD||'/'||R.DE_TERM_CD	RCV_DE_TERM_CD			,
				CASE
				WHEN R.BQ_CNTR_TPSZ_CD LIKE 'R%' AND R.BQ_CTRT_CNTR_TPSZ_CD NOT LIKE 'R%'		THEN R.BQ_CNTR_TPSZ_CD
				WHEN RT_TYP_BKG_CONV_TP_CD = 'C'																						THEN R.BQ_CTRT_CNTR_TPSZ_CD
				ELSE R.RAT_UT_CD
				END	RAT_UT_CD																					,
				CASE
				WHEN RT_RAC_BKG_CONV_TP_CD = 'C'	THEN R.BQ_PRC_CGO_TP_CD
				ELSE R.PRC_CGO_TP_CD
				END	PRC_CGO_TP_CD																			,
				R.CURR_CD										CURR_CD										,
				R.ORG_TRSP_MOD_CD						ORG_TRSP_MOD_CD						,
				R.DEST_TRSP_MOD_CD					DEST_TRSP_MOD_CD					,
				0 													FNL_FRT_RT_AMT						,
				R.ORG_TRSP_MOD_CD||'/'||R.DEST_TRSP_MOD_CD	TRNS_MOD_CD			,
				R.BQ_CTRT_CNTR_QTY					OP_CNTR_QTY								,
				RN.NOTE_CTNT								NOTE_CTNT									,
				'NOTE'											NOTE											,
				'DTL'												DTL												,
/* UI GRID END */

/* CHARGE UI 에 필요 속성 START */
				R.BQ_PRC_CGO_TP_CD					CGO_CATE_CD								,
/* CHARGE UI 에 필요 속성 END */

				R.BQ_POR_APPL_FLG						BQ_POR_APPL_FLG						,
				R.BQ_POL_APPL_FLG						BQ_POL_APPL_FLG						,
				R.BQ_POD_APPL_FLG						BQ_POD_APPL_FLG						,
				R.BQ_DEL_APPL_FLG						BQ_DEL_APPL_FLG						,
				R.BQ_POR_RLY_PORT_APPL_FLG	BQ_POR_RLY_PORT_APPL_FLG	,
				R.BQ_PST_RLY_PORT_APPL_FLG	BQ_PST_RLY_PORT_APPL_FLG	,

				R.OI_ADD_CHG_SEQ						OI_ADD_CHG_SEQ						,
				R.OA_ADD_CHG_SEQ						OA_ADD_CHG_SEQ						,
				R.DA_ADD_CHG_SEQ						DA_ADD_CHG_SEQ						,
				R.DI_ADD_CHG_SEQ						DI_ADD_CHG_SEQ						,


				R.CM_PRC_CMDT_TP_CD					CM_PRC_CMDT_TP_CD					,
				R.CM_PRC_CMDT_DEF_CD				CM_PRC_CMDT_DEF_CD				,

				R.OP_ROUT_PNT_LOC_DEF_CD		OP_ROUT_PNT_LOC_DEF_CD		,
				R.OV_ROUT_VIA_PORT_DEF_CD		OV_ROUT_VIA_PORT_DEF_CD		,
				R.DV_ROUT_VIA_PORT_DEF_CD		DV_ROUT_VIA_PORT_DEF_CD		,
				R.DP_ROUT_PNT_LOC_DEF_CD		DP_ROUT_PNT_LOC_DEF_CD		,
				R.RD_DIR_CALL_FLG						RD_DIR_CALL_FLG						,

				R.OP_PRC_TRSP_MOD_CD				OP_PRC_TRSP_MOD_CD				,
				R.DP_PRC_TRSP_MOD_CD				DP_PRC_TRSP_MOD_CD				,

				R.RT_RAT_UT_CD							RT_RAT_UT_CD							,
				R.RT_PRC_CGO_TP_CD					RT_PRC_CGO_TP_CD					,
				R.RT_CURR_CD								RT_CURR_CD								,
				R.RT_FNL_FRT_RT_AMT					RT_FNL_FRT_RT_AMT					,
				0														RT_CALC_FRT_RT_AMT				,

				R.OI_ROUT_PNT_LOC_DEF_CD		OI_ROUT_PNT_LOC_DEF_CD		,
				R.OI_BSE_PORT_DEF_CD				OI_BSE_PORT_DEF_CD				,
				R.OI_VIA_PORT_DEF_CD				OI_VIA_PORT_DEF_CD				,
				R.OI_DIR_CALL_FLG						OI_DIR_CALL_FLG						,
				R.OI_RAT_UT_CD							OI_RAT_UT_CD							,
				R.OI_PRC_CGO_TP_CD					OI_PRC_CGO_TP_CD					,
				R.OI_PRC_TRSP_MOD_CD				OI_PRC_TRSP_MOD_CD				,
				R.OI_RCV_DE_TERM_CD					OI_RCV_DE_TERM_CD					,
				R.OI_PRC_CMDT_DEF_CD				OI_PRC_CMDT_DEF_CD				,
				R.OI_CURR_CD								OI_CURR_CD								,
				NVL(R.OI_FNL_FRT_RT_AMT, 0)	OI_FNL_FRT_RT_AMT					,
				0														OI_CALC_FRT_RT_AMT				,

				R.OA_ROUT_PNT_LOC_DEF_CD		OA_ROUT_PNT_LOC_DEF_CD		,
				R.OA_BSE_PORT_DEF_CD				OA_BSE_PORT_DEF_CD				,
				R.OA_VIA_PORT_DEF_CD				OA_VIA_PORT_DEF_CD				,
				R.OA_DIR_CALL_FLG						OA_DIR_CALL_FLG						,
				R.OA_RAT_UT_CD							OA_RAT_UT_CD							,
				R.OA_PRC_CGO_TP_CD					OA_PRC_CGO_TP_CD					,
				R.OA_PRC_TRSP_MOD_CD				OA_PRC_TRSP_MOD_CD				,
				R.OA_RCV_DE_TERM_CD					OA_RCV_DE_TERM_CD					,
				R.OA_PRC_CMDT_DEF_CD				OA_PRC_CMDT_DEF_CD				,
				R.OA_CURR_CD								OA_CURR_CD								,
				NVL(R.OA_FNL_FRT_RT_AMT, 0)	OA_FNL_FRT_RT_AMT					,
				0														OA_CALC_FRT_RT_AMT				,

				R.DA_ROUT_PNT_LOC_DEF_CD		DA_ROUT_PNT_LOC_DEF_CD		,
				R.DA_BSE_PORT_DEF_CD				DA_BSE_PORT_DEF_CD				,
				R.DA_VIA_PORT_DEF_CD				DA_VIA_PORT_DEF_CD				,
				R.DA_DIR_CALL_FLG						DA_DIR_CALL_FLG						,
				R.DA_RAT_UT_CD							DA_RAT_UT_CD							,
				R.DA_PRC_CGO_TP_CD					DA_PRC_CGO_TP_CD					,
				R.DA_PRC_TRSP_MOD_CD				DA_PRC_TRSP_MOD_CD				,
				R.DA_RCV_DE_TERM_CD					DA_RCV_DE_TERM_CD					,
				R.DA_PRC_CMDT_DEF_CD				DA_PRC_CMDT_DEF_CD				,
				R.DA_CURR_CD								DA_CURR_CD								,
				NVL(R.DA_FNL_FRT_RT_AMT, 0)	DA_FNL_FRT_RT_AMT					,
				0														DA_CALC_FRT_RT_AMT				,

				R.DI_ROUT_PNT_LOC_DEF_CD		DI_ROUT_PNT_LOC_DEF_CD		,
				R.DI_BSE_PORT_DEF_CD				DI_BSE_PORT_DEF_CD				,
				R.DI_VIA_PORT_DEF_CD				DI_VIA_PORT_DEF_CD				,
				R.DI_DIR_CALL_FLG						DI_DIR_CALL_FLG						,
				R.DI_RAT_UT_CD							DI_RAT_UT_CD							,
				R.DI_PRC_CGO_TP_CD					DI_PRC_CGO_TP_CD					,
				R.DI_PRC_TRSP_MOD_CD				DI_PRC_TRSP_MOD_CD				,
				R.DI_RCV_DE_TERM_CD					DI_RCV_DE_TERM_CD					,
				R.DI_PRC_CMDT_DEF_CD				DI_PRC_CMDT_DEF_CD				,
				R.DI_CURR_CD								DI_CURR_CD								,
				NVL(R.DI_FNL_FRT_RT_AMT, 0)	DI_FNL_FRT_RT_AMT					,
				0														DI_CALC_FRT_RT_AMT				,

				NVL(R.RT_RAP_BKG_CONV_TP_CD, 'B')			RT_RAP_BKG_CONV_TP_CD			,
				R.RT_RAP_NOTE_CONV_MAPG_ID  RT_RAP_NOTE_CONV_MAPG_ID  ,
				R.RT_RAP_NOTE_CONV_SEQ      RT_RAP_NOTE_CONV_SEQ      ,
				R.RT_RAP_NOTE_CONV_RULE_CD  RT_RAP_NOTE_CONV_RULE_CD  ,
				R.RT_RAP_NOTE_CONV_TP_CD    RT_RAP_NOTE_CONV_TP_CD    ,
				R.RT_RAP_RT_OP_CD           RT_RAP_RT_OP_CD           ,
				R.RT_RAP_CURR_CD            RT_RAP_CURR_CD            ,
				R.RT_RAP_FRT_RT_AMT         RT_RAP_FRT_RT_AMT         ,

				NVL(R.RT_RAR_BKG_CONV_TP_CD, 'B')     RT_RAR_BKG_CONV_TP_CD     ,
				R.RT_RAR_NOTE_CONV_MAPG_ID  RT_RAR_NOTE_CONV_MAPG_ID  ,
				R.RT_RAR_NOTE_CONV_SEQ      RT_RAR_NOTE_CONV_SEQ      ,
				R.RT_RAR_NOTE_CONV_RULE_CD  RT_RAR_NOTE_CONV_RULE_CD  ,
				R.RT_RAR_NOTE_CONV_TP_CD    RT_RAR_NOTE_CONV_TP_CD    ,
				R.RT_RAR_RT_OP_CD           RT_RAR_RT_OP_CD           ,
				R.RT_RAR_CURR_CD            RT_RAR_CURR_CD            ,
				R.RT_RAR_FRT_RT_AMT         RT_RAR_FRT_RT_AMT         ,

				NVL(R.RT_DOR_BKG_CONV_TP_CD, 'B')     RT_DOR_BKG_CONV_TP_CD     ,
				R.RT_DOR_NOTE_CONV_MAPG_ID  RT_DOR_NOTE_CONV_MAPG_ID  ,
				R.RT_DOR_NOTE_CONV_SEQ      RT_DOR_NOTE_CONV_SEQ      ,
				R.RT_DOR_NOTE_CONV_RULE_CD  RT_DOR_NOTE_CONV_RULE_CD  ,
				R.RT_DOR_NOTE_CONV_TP_CD    RT_DOR_NOTE_CONV_TP_CD    ,
				R.RT_DOR_RT_OP_CD           RT_DOR_RT_OP_CD           ,
				R.RT_DOR_CURR_CD            RT_DOR_CURR_CD            ,
				R.RT_DOR_FRT_RT_AMT         RT_DOR_FRT_RT_AMT         ,

				NVL(R.RT_TYP_BKG_CONV_TP_CD, 'B')     RT_TYP_BKG_CONV_TP_CD     ,
				R.RT_TYP_NOTE_CONV_MAPG_ID  RT_TYP_NOTE_CONV_MAPG_ID  ,
				R.RT_TYP_NOTE_CONV_SEQ      RT_TYP_NOTE_CONV_SEQ      ,
				R.RT_TYP_NOTE_CONV_RULE_CD  RT_TYP_NOTE_CONV_RULE_CD  ,
				R.RT_TYP_NOTE_CONV_TP_CD    RT_TYP_NOTE_CONV_TP_CD    ,
				R.RT_TYP_RT_OP_CD           RT_TYP_RT_OP_CD           ,
				R.RT_TYP_CURR_CD            RT_TYP_CURR_CD            ,
				R.RT_TYP_FRT_RT_AMT         RT_TYP_FRT_RT_AMT         ,

				NVL(R.RT_RAC_BKG_CONV_TP_CD, 'B')     RT_RAC_BKG_CONV_TP_CD     ,
				R.RT_RAC_NOTE_CONV_MAPG_ID  RT_RAC_NOTE_CONV_MAPG_ID  ,
				R.RT_RAC_NOTE_CONV_SEQ      RT_RAC_NOTE_CONV_SEQ      ,
				R.RT_RAC_NOTE_CONV_RULE_CD  RT_RAC_NOTE_CONV_RULE_CD  ,
				R.RT_RAC_NOTE_CONV_TP_CD    RT_RAC_NOTE_CONV_TP_CD    ,
				R.RT_RAC_RT_OP_CD           RT_RAC_RT_OP_CD           ,
				R.RT_RAC_CURR_CD            RT_RAC_CURR_CD            ,
				R.RT_RAC_FRT_RT_AMT         RT_RAC_FRT_RT_AMT         ,

				NVL(R.RT_APP_BKG_CONV_TP_CD, 'B')     RT_APP_BKG_CONV_TP_CD     ,
				R.RT_APP_NOTE_CONV_MAPG_ID  RT_APP_NOTE_CONV_MAPG_ID  ,
				R.RT_APP_NOTE_CONV_SEQ      RT_APP_NOTE_CONV_SEQ      ,
				R.RT_APP_NOTE_CONV_RULE_CD  RT_APP_NOTE_CONV_RULE_CD  ,
				R.RT_APP_NOTE_CONV_TP_CD    RT_APP_NOTE_CONV_TP_CD    ,
				R.RT_APP_RT_OP_CD           RT_APP_RT_OP_CD           ,
				R.RT_APP_CURR_CD            RT_APP_CURR_CD            ,
				R.RT_APP_FRT_RT_AMT         RT_APP_FRT_RT_AMT         ,

				NVL(R.RT_RAS_BKG_CONV_TP_CD, 'B')     RT_RAS_BKG_CONV_TP_CD     ,
				R.RT_RAS_NOTE_CONV_MAPG_ID  RT_RAS_NOTE_CONV_MAPG_ID  ,
				R.RT_RAS_NOTE_CONV_SEQ      RT_RAS_NOTE_CONV_SEQ      ,
				R.RT_RAS_NOTE_CONV_RULE_CD  RT_RAS_NOTE_CONV_RULE_CD  ,
				R.RT_RAS_NOTE_CONV_TP_CD    RT_RAS_NOTE_CONV_TP_CD    ,
				R.RT_RAS_RT_OP_CD           RT_RAS_RT_OP_CD           ,
				R.RT_RAS_CURR_CD            RT_RAS_CURR_CD            ,
				R.RT_RAS_FRT_RT_AMT         RT_RAS_FRT_RT_AMT         ,

				NVL(R.RT_ARB_BKG_CONV_TP_CD, 'B')     RT_ARB_BKG_CONV_TP_CD     ,
				R.RT_ARB_NOTE_CONV_MAPG_ID  RT_ARB_NOTE_CONV_MAPG_ID  ,
				R.RT_ARB_NOTE_CONV_SEQ      RT_ARB_NOTE_CONV_SEQ      ,
				R.RT_ARB_NOTE_CONV_RULE_CD  RT_ARB_NOTE_CONV_RULE_CD  ,
				R.RT_ARB_NOTE_CONV_TP_CD    RT_ARB_NOTE_CONV_TP_CD    ,
				R.RT_ARB_RT_OP_CD           RT_ARB_RT_OP_CD           ,
				R.RT_ARB_CURR_CD            RT_ARB_CURR_CD            ,
				R.RT_ARB_FRT_RT_AMT         RT_ARB_FRT_RT_AMT         ,

				NVL(R.RT_ADD_BKG_CONV_TP_CD, 'B')     RT_ADD_BKG_CONV_TP_CD     ,
				R.RT_ADD_NOTE_CONV_MAPG_ID  RT_ADD_NOTE_CONV_MAPG_ID  ,
				R.RT_ADD_NOTE_CONV_SEQ      RT_ADD_NOTE_CONV_SEQ      ,
				R.RT_ADD_NOTE_CONV_RULE_CD  RT_ADD_NOTE_CONV_RULE_CD  ,
				R.RT_ADD_NOTE_CONV_TP_CD    RT_ADD_NOTE_CONV_TP_CD    ,
				R.RT_ADD_RT_OP_CD           RT_ADD_RT_OP_CD           ,
				R.RT_ADD_CURR_CD            RT_ADD_CURR_CD            ,
				R.RT_ADD_FRT_RT_AMT         RT_ADD_FRT_RT_AMT         ,

				NVL(R.OA_TYP_BKG_CONV_TP_CD, 'B')     OA_TYP_BKG_CONV_TP_CD     ,
				R.OA_TYP_NOTE_CONV_MAPG_ID  OA_TYP_NOTE_CONV_MAPG_ID  ,
				R.OA_TYP_NOTE_CONV_SEQ      OA_TYP_NOTE_CONV_SEQ      ,
				R.OA_TYP_NOTE_CONV_RULE_CD  OA_TYP_NOTE_CONV_RULE_CD  ,
				R.OA_TYP_NOTE_CONV_TP_CD    OA_TYP_NOTE_CONV_TP_CD    ,
				R.OA_TYP_RT_OP_CD           OA_TYP_RT_OP_CD           ,
				R.OA_TYP_CURR_CD            OA_TYP_CURR_CD            ,
				R.OA_TYP_FRT_RT_AMT         OA_TYP_FRT_RT_AMT         ,

				NVL(R.OA_RAC_BKG_CONV_TP_CD, 'B')     OA_RAC_BKG_CONV_TP_CD     ,
				R.OA_RAC_NOTE_CONV_MAPG_ID  OA_RAC_NOTE_CONV_MAPG_ID  ,
				R.OA_RAC_NOTE_CONV_SEQ      OA_RAC_NOTE_CONV_SEQ      ,
				R.OA_RAC_NOTE_CONV_RULE_CD  OA_RAC_NOTE_CONV_RULE_CD  ,
				R.OA_RAC_NOTE_CONV_TP_CD    OA_RAC_NOTE_CONV_TP_CD    ,
				R.OA_RAC_RT_OP_CD           OA_RAC_RT_OP_CD           ,
				R.OA_RAC_CURR_CD            OA_RAC_CURR_CD            ,
				R.OA_RAC_FRT_RT_AMT         OA_RAC_FRT_RT_AMT         ,

				NVL(R.DA_TYP_BKG_CONV_TP_CD, 'B')     DA_TYP_BKG_CONV_TP_CD     ,
				R.DA_TYP_NOTE_CONV_MAPG_ID  DA_TYP_NOTE_CONV_MAPG_ID  ,
				R.DA_TYP_NOTE_CONV_SEQ      DA_TYP_NOTE_CONV_SEQ      ,
				R.DA_TYP_NOTE_CONV_RULE_CD  DA_TYP_NOTE_CONV_RULE_CD  ,
				R.DA_TYP_NOTE_CONV_TP_CD    DA_TYP_NOTE_CONV_TP_CD    ,
				R.DA_TYP_DA_OP_CD           DA_TYP_DA_OP_CD           ,
				R.DA_TYP_CURR_CD            DA_TYP_CURR_CD            ,
				R.DA_TYP_FRT_RT_AMT					DA_TYP_FRT_RT_AMT					,

				NVL(R.DA_RAC_BKG_CONV_TP_CD, 'B')     DA_RAC_BKG_CONV_TP_CD     ,
				R.DA_RAC_NOTE_CONV_MAPG_ID  DA_RAC_NOTE_CONV_MAPG_ID  ,
				R.DA_RAC_NOTE_CONV_SEQ      DA_RAC_NOTE_CONV_SEQ      ,
				R.DA_RAC_NOTE_CONV_RULE_CD  DA_RAC_NOTE_CONV_RULE_CD  ,
				R.DA_RAC_NOTE_CONV_TP_CD    DA_RAC_NOTE_CONV_TP_CD    ,
				R.DA_RAC_DA_OP_CD           DA_RAC_DA_OP_CD           ,
				R.DA_RAC_CURR_CD            DA_RAC_CURR_CD            ,
				R.DA_RAC_FRT_RT_AMT         DA_RAC_FRT_RT_AMT					,

				R.POR_MTCH_FLG							POR_MTCH_FLG							,
				R.DEL_MTCH_FLG							DEL_MTCH_FLG							,

				R.RT_RAP_CONV_CTNT					RT_RAP_CONV_CTNT					,
				R.RT_RAR_CONV_CTNT          RT_RAR_CONV_CTNT          ,
				R.RT_DOR_CONV_CTNT          RT_DOR_CONV_CTNT          ,
				REPLACE(R.RT_TYP_CONV_CTNT, 'TYP :', 'THR :')	RT_TYP_CONV_CTNT	,
				R.RT_RAC_CONV_CTNT          RT_RAC_CONV_CTNT          ,
				R.RT_RAS_CONV_CTNT          RT_RAS_CONV_CTNT          ,
				REPLACE(R.OA_TYP_CONV_CTNT, 'TYP :', 'OAR :')	OA_TYP_CONV_CTNT  ,
				R.OA_RAC_CONV_CTNT          OA_RAC_CONV_CTNT          ,
				REPLACE(R.DA_TYP_CONV_CTNT, 'TYP :', 'DAR :') DA_TYP_CONV_CTNT  ,
				R.DA_RAC_CONV_CTNT          DA_RAC_CONV_CTNT

FROM		(
				SELECT	R.*			,
								ROWNUM	UQ_SEQ	,
								ROW_NUMBER() OVER (	PARTITION BY
																			R.BKG_BQ_SEQ								,
																			R.PRC_RT_MTCH_PATT_CD				,
																			R.RT_GEN_SPCL_RT_TP_CD			,
																			R.RT_CMDT_HDR_SEQ						,
																			R.RT_ROUT_SEQ								,
																			R.RT_RT_SEQ									,
																			R.OI_ADD_CHG_SEQ						,
																			R.OA_ADD_CHG_SEQ						,
																			R.DA_ADD_CHG_SEQ						,
																			R.DI_ADD_CHG_SEQ						,
																			R.RT_RAP_NOTE_CONV_MAPG_ID  ,
																			R.RT_RAP_NOTE_CONV_SEQ      ,
																			R.RT_RAR_NOTE_CONV_MAPG_ID  ,
																			R.RT_RAR_NOTE_CONV_SEQ      ,
																			R.RT_DOR_NOTE_CONV_MAPG_ID  ,
																			R.RT_DOR_NOTE_CONV_SEQ      ,
																			R.RT_TYP_NOTE_CONV_MAPG_ID  ,
																			R.RT_TYP_NOTE_CONV_SEQ      ,
																			R.RT_RAC_NOTE_CONV_MAPG_ID  ,
																			R.RT_RAC_NOTE_CONV_SEQ      ,
																			R.RT_APP_NOTE_CONV_MAPG_ID  ,
																			R.RT_APP_NOTE_CONV_SEQ      ,
																			R.RT_RAS_NOTE_CONV_MAPG_ID  ,
																			R.RT_RAS_NOTE_CONV_SEQ      ,
																			R.RT_ARB_NOTE_CONV_MAPG_ID  ,
																			R.RT_ARB_NOTE_CONV_SEQ      ,
																			R.RT_ADD_NOTE_CONV_MAPG_ID  ,
																			R.RT_ADD_NOTE_CONV_SEQ      ,
																			R.OA_TYP_NOTE_CONV_MAPG_ID  ,
																			R.OA_TYP_NOTE_CONV_SEQ      ,
																			R.OA_RAC_NOTE_CONV_MAPG_ID  ,
																			R.OA_RAC_NOTE_CONV_SEQ      ,
																			R.DA_TYP_NOTE_CONV_MAPG_ID  ,
																			R.DA_TYP_NOTE_CONV_SEQ			,
																			R.DA_RAC_NOTE_CONV_MAPG_ID  ,
																			R.DA_RAC_NOTE_CONV_SEQ
																		ORDER BY
																			DECODE(R.BQ_POR_APPL_FLG,'Y', 1, 0)
																			+ DECODE(R.BQ_POL_APPL_FLG,'Y', 1, 0)
																			+ DECODE(R.BQ_POD_APPL_FLG,'Y', 1, 0)
																			+ DECODE(R.BQ_DEL_APPL_FLG,'Y', 1, 0)
																			+ DECODE(R.BQ_POR_RLY_PORT_APPL_FLG,'Y', 1, 0)
																			+ DECODE(R.BQ_PST_RLY_PORT_APPL_FLG,'Y', 1, 0)
																	)	ROUT_LOC_CONV_PRIO
				FROM		(
								/* MTCH_PATT_CD, RT_SEQ 별 우선 순위 */
								SELECT	R.*	,
												RANK() OVER (	PARTITION BY
																				R.BKG_BQ_SEQ								,
																				R.PRC_RT_MTCH_PATT_CD				,
																				R.RT_GEN_SPCL_RT_TP_CD			,
																				R.RT_CMDT_HDR_SEQ						,
																				R.RT_ROUT_SEQ								,
																				R.RT_RT_SEQ
																			ORDER BY
																				DECODE(R.OA_DIR_CALL_FLG, 'Y', 1, DECODE(R.OA_VIA_PORT_DEF_CD,NULL, 2, 1))	,
																				DECODE(R.OA_TYP_BKG_CONV_TP_CD, 'C', 2, 1)	,
																				DECODE(R.OA_RAC_BKG_CONV_TP_CD, 'C', 2, 1)	,
																				NVL(R.OA_RAT_UT_MTCH_PRIO, 0)	DESC					,
																				NVL(R.OI_RAT_UT_MTCH_PRIO, 0)	DESC					,
																				DECODE(R.DA_DIR_CALL_FLG, 'Y', 1, DECODE(R.DA_VIA_PORT_DEF_CD,NULL, 2, 1))	,
																				DECODE(R.DA_TYP_BKG_CONV_TP_CD, 'C', 2, 1)	,
																				DECODE(R.DA_RAC_BKG_CONV_TP_CD, 'C', 2, 1)	,
																				NVL(R.DA_RAT_UT_MTCH_PRIO, 0)	DESC					,
																				NVL(R.DI_RAT_UT_MTCH_PRIO, 0)	DESC
																		)	ARB_MTCH_PRIO_2
								FROM		(
												/* RT_SEQ 별 우선 순위 */
												SELECT	R.*	,
																RANK() OVER (	PARTITION BY
																								R.BKG_BQ_SEQ								,
																								R.RT_GEN_SPCL_RT_TP_CD			,
																								R.RT_CMDT_HDR_SEQ						,
																								R.RT_ROUT_SEQ								,
																								R.RT_RT_SEQ
																							ORDER BY
																								DECODE(R.RT_TYP_BKG_CONV_TP_CD, 'C', 2, 1)	,
																								DECODE(R.RT_RAC_BKG_CONV_TP_CD, 'C', 2, 1)	,
																								DECODE(R.RT_RAR_BKG_CONV_TP_CD, 'C', 2, 1)	,
																								DECODE(R.POR_MTCH_FLG, 'Y', 1, 2) + DECODE(R.DEL_MTCH_FLG, 'Y', 1, 2)	,
																								DECODE(SUBSTR(R.PRC_RT_MTCH_PATT_CD, 1, 1), '1', 3, 0)
																								+	DECODE(SUBSTR(R.PRC_RT_MTCH_PATT_CD, 2, 1), '1', 2, 0)
																								+	DECODE(SUBSTR(R.PRC_RT_MTCH_PATT_CD, 3, 1), '1', 2, 0)
																								+	DECODE(SUBSTR(R.PRC_RT_MTCH_PATT_CD, 4, 1), '1', 3, 0)
																						)	ARB_MTCH_PRIO_1
												FROM		(
																/* 다른 DATA 가 있으면 'BL' 은 제외한다 */
																SELECT	R.*	,
																				RANK() OVER (	ORDER BY DECODE(R.RT_RAT_UT_CD, 'BL', 2, 1 )
																										)	BL_PRIO
																FROM		RATE	R
																)	R
												WHERE		R.BL_PRIO	= 1
												) R
								WHERE		R.ARB_MTCH_PRIO_1 = 1
								)	R
				WHERE		R.ARB_MTCH_PRIO_2 = 1
				)	R	,
				(
				SELECT	PROP_NO						,
				        AMDT_SEQ					,
				        SVC_SCP_CD				,
				        GEN_SPCL_RT_TP_CD	,
				        CMDT_HDR_SEQ			,
				        ROUT_SEQ					,
								REPLACE(LTRIM(SYS_CONNECT_BY_PATH(NOTE_CTNT,'^|^'),'^|^'), '^|^', CHR(13)||CHR(10)||CHR(13)||CHR(10))	NOTE_CTNT
				FROM		(
								SELECT	RN.PROP_NO						,
												RN.AMDT_SEQ						,
												RN.SVC_SCP_CD					,
												RN.GEN_SPCL_RT_TP_CD	,
												RN.CMDT_HDR_SEQ				,
												RN.ROUT_SEQ						,
								        ROW_NUMBER() OVER ( PARTITION BY RN.PROP_NO, RN.AMDT_SEQ, RN.SVC_SCP_CD, RN.GEN_SPCL_RT_TP_CD, RN.CMDT_HDR_SEQ, RN.ROUT_SEQ ORDER BY RN.ROUT_NOTE_SEQ ) ROW_NUMBER	,
												COUNT(1) OVER ( PARTITION BY RN.PROP_NO, RN.AMDT_SEQ, RN.SVC_SCP_CD, RN.GEN_SPCL_RT_TP_CD, RN.CMDT_HDR_SEQ, RN.ROUT_SEQ )	CNT	,
												RN.ROUT_NOTE_SEQ ||'. '||RN.NOTE_CTNT NOTE_CTNT
								FROM		(
												SELECT	DISTINCT
																PROP_NO								,
																AMDT_SEQ							,
																SVC_SCP_CD						,
																RT_GEN_SPCL_RT_TP_CD	,
																RT_CMDT_HDR_SEQ				,
																RT_ROUT_SEQ
												FROM		RATE
												)	A	,
												PRI_SP_SCP_RT_CMDT_RNOTE RN
								WHERE		RN.PROP_NO						= A.PROP_NO
								AND			RN.AMDT_SEQ						= A.AMDT_SEQ
								AND			RN.SVC_SCP_CD					= A.SVC_SCP_CD
								AND			RN.GEN_SPCL_RT_TP_CD	= A.RT_GEN_SPCL_RT_TP_CD
								AND			RN.CMDT_HDR_SEQ				= A.RT_CMDT_HDR_SEQ
								AND			RN.ROUT_SEQ						= A.RT_ROUT_SEQ
								AND			RN.SRC_INFO_CD				<> 'AD'
								)
				WHERE		LEVEL		= CNT
				START WITH ROW_NUMBER = 1
				CONNECT BY
								PROP_NO 					= PRIOR PROP_NO
				AND			AMDT_SEQ					= PRIOR AMDT_SEQ
				AND			SVC_SCP_CD				= PRIOR SVC_SCP_CD
				AND			GEN_SPCL_RT_TP_CD	= PRIOR GEN_SPCL_RT_TP_CD
				AND			CMDT_HDR_SEQ			= PRIOR CMDT_HDR_SEQ
				AND     ROUT_SEQ					= PRIOR ROUT_SEQ
				AND			ROW_NUMBER				= PRIOR ROW_NUMBER + 1
				)	RN
WHERE		RN.PROP_NO(+)								= R.PROP_NO
AND			RN.AMDT_SEQ(+)							= R.AMDT_SEQ
AND			RN.SVC_SCP_CD(+)						= R.SVC_SCP_CD
AND			RN.GEN_SPCL_RT_TP_CD(+)			= R.RT_GEN_SPCL_RT_TP_CD
AND			RN.CMDT_HDR_SEQ(+)					= R.RT_CMDT_HDR_SEQ
AND			RN.ROUT_SEQ(+)							= R.RT_ROUT_SEQ
AND			R.ROUT_LOC_CONV_PRIO				= 1

ORDER BY
				R.BKG_BQ_SEQ									,
				R.RT_GEN_SPCL_RT_TP_CD	DESC	,
				DECODE(R.POR_MTCH_FLG, 'Y', 1, 2)	,
				DECODE(R.DEL_MTCH_FLG, 'Y', 1, 2)	,
				SUBSTR(R.PRC_RT_MTCH_PATT_CD, 1, 1) * 2 + SUBSTR(R.PRC_RT_MTCH_PATT_CD, 2, 1) * 1 + SUBSTR(R.PRC_RT_MTCH_PATT_CD, 3, 1) * 1 + SUBSTR(R.PRC_RT_MTCH_PATT_CD, 4, 1) * 2	,
				R.PRC_RT_MTCH_PATT_CD					,
				R.RT_CMDT_HDR_SEQ							,
				R.RT_ROUT_SEQ									,
				R.RT_RT_SEQ										,
				R.UQ_SEQ		
/*AUTORATING_20091208-001*/			]]></sql>
			<params>
				<param name="cmdt_cd" type="12" value="" out="N"/>
				<param name="rt_aply_dt" type="12" value="" out="N"/>
				<param name="bkg_no" type="12" value="" out="N"/>
				<param name="ca_flg" type="12" value="" out="N"/>
			</params>
		</query>
	</querys>
</sqls>
