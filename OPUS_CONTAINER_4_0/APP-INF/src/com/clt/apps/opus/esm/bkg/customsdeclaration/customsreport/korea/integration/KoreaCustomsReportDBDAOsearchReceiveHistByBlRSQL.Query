<?xml version="1.0" encoding="UTF-8"?>
<sqls>
	<querys>
		<query name="KoreaCustomsReportDBDAOsearchReceiveHistByBlRSQL">
			<desc><![CDATA[관세청에서 수신된 응답문서들의 현황을 MSG Type(5CG)과 B/L No로 조회]]></desc>
			<sql><![CDATA[
SELECT DISTINCT RLOG.MSG_LOG_TP_CD AS MSG_LOG_TP_CD
     , TO_CHAR(RLOG.RCV_DT,'yyyy-mm-dd hh24:mi:ss') AS RCV_DT
     , SLOG.VSL_CD||SLOG.SKD_VOY_NO||SLOG.SKD_DIR_CD AS VVD
     , SLOG.POL_CD AS POL_CD
     , SLOG.POD_CD AS POD_CD
     , SLOG.OFC_CD AS OFC_CD
     , RLOG.BL_NO AS BL_NO
     , RLOG.SMT_AMD_NO AS SMT_AMD_NO
     , DECODE(RLOG.KR_CSTMS_ACPT_CD,'1','승인','2','부분 승인','3','오류') AS MSG_STS
     , RLOG.KR_CSTMS_RJCT_RSN1 AS MSG_TEXT
     , SLOG.CRE_USR_ID AS USER_ID

  FROM BKG_CSTMS_KR_RCV_LOG RLOG,
       BKG_CSTMS_KR_SND_LOG SLOG

 WHERE RLOG.SMT_AMD_NO = SLOG.SMT_AMD_NO(+)
   AND RLOG.MSG_LOG_TP_CD = NVL(@[msg_log_tp_id],RLOG.MSG_LOG_TP_CD)
   AND RLOG.BL_NO = @[bl_no]
#if(${tp_cd} != 'D')
   AND NVL(SLOG.KR_CSTMS_DECL_CD,' ') LIKE @[tp_cd]||'%' 
#end
#if(${pol_cd} != '')
   AND SLOG.POL_CD LIKE @[pol_cd]||'%' 
#end
#if(${pod_cd} != '')
   AND SLOG.POD_CD LIKE @[pod_cd]||'%' 
#end
#if(${ofc_cd} != '')
   AND SLOG.OFC_CD LIKE @[ofc_cd]||'%' 
#end
#if(${user_id} != '')
   AND SLOG.TRSM_USR_ID LIKE @[user_id]||'%' 
#end			]]></sql>
			<params>
				<param name="msg_log_tp_id" type="12" value="" out="N"/>
				<param name="bl_no" type="12" value="" out="N"/>
				<param name="tp_cd" type="12" value="" out="N"/>
				<param name="pol_cd" type="12" value="" out="N"/>
				<param name="pod_cd" type="12" value="" out="N"/>
				<param name="ofc_cd" type="12" value="" out="N"/>
				<param name="user_id" type="12" value="" out="N"/>
			</params>
		</query>
	</querys>
</sqls>
