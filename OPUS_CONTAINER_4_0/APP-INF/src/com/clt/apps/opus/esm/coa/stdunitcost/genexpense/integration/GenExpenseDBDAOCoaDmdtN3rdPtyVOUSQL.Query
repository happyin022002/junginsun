<?xml version="1.0" encoding="UTF-8"?>
<sqls>
	<querys>
		<query name="GenExpenseDBDAOCoaDmdtN3rdPtyVOUSQL">
			<desc><![CDATA[@ SJH.20140808.MOD : COST_YRMON -> COST_YRMON-1]]></desc>
			<sql><![CDATA[
MERGE INTO COA_DMDT_N3RD_PTY A USING
(
         SELECT TO_CHAR(ADD_MONTHS(TO_DATE(@[cost_yrmon], 'YYYYMM'), -1), 'YYYYMM') COST_YRMON
              , 'TEU' CNTR_TPSZ_CD
              , '75000000' STND_COST_CD
              , @[uc_amt] UC_AMT
              , @[upd_usr_id] CRE_USR_ID
              , SYSDATE CRE_DT
              , @[upd_usr_id] UPD_USR_ID
              , SYSDATE UPD_DT
           FROM DUAL
) B 
  ON (A.COST_YRMON = B.COST_YRMON AND A.CNTR_TPSZ_CD = B.CNTR_TPSZ_CD AND A.STND_COST_CD = B.STND_COST_CD )

WHEN NOT MATCHED THEN
INSERT (
        COST_YRMON
      , CNTR_TPSZ_CD
      , STND_COST_CD
      , UC_AMT
      , CRE_USR_ID
      , CRE_DT
      , UPD_USR_ID
      , UPD_DT )
VALUES (
        B.COST_YRMON
      , B.CNTR_TPSZ_CD
      , B.STND_COST_CD
      , B.UC_AMT
      , B.CRE_USR_ID
      , B.CRE_DT
      , B.UPD_USR_ID
      , B.UPD_DT )

WHEN MATCHED THEN
UPDATE
   SET A.UC_AMT     = B.UC_AMT
     , A.UPD_DT     = B.UPD_DT
     , A.UPD_USR_ID = B.UPD_USR_ID			]]></sql>
			<params>
				<param name="cost_yrmon" type="12" value="" out="N"/>
				<param name="uc_amt" type="12" value="" out="N"/>
				<param name="upd_usr_id" type="12" value="" out="N"/>
			</params>
		</query>
	</querys>
</sqls>
