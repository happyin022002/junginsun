<?xml version="1.0" encoding="UTF-8"?>
<sqls>
	<querys>
		<query name="BLDocumentationCMDBDAOCmBkgInfoRSQL">
			<desc><![CDATA[select]]></desc>
			<sql><![CDATA[
#if (${ca_flg} == 'Y') 
SELECT A.BKG_NO
,      A.BL_NO || NVL(A.BL_TP_CD, DECODE(E.OBL_SRND_FLG, 'Y', 'S', NULL)) AS BL_NO
,      A.BL_TP_CD
,      A.VSL_CD||A.SKD_VOY_NO||A.SKD_DIR_CD T_VVD
,      A.VSL_CD
,      A.SKD_VOY_NO
,      A.SKD_DIR_CD
,      A.BKG_CGO_TP_CD
,      A.POR_CD
,      A.POL_CD
,      A.POD_CD
,      A.DEL_CD
,      A.PRE_RLY_PORT_CD
,      A.PST_RLY_PORT_CD
,      A.RCV_TERM_CD BKG_RCV_TERM_CD
,      A.DE_TERM_CD BKG_DE_TERM_CD
,      A.CMDT_CD
,      A.REP_CMDT_CD
,      A.BKG_STS_CD 
,      (SELECT CMDT_NM FROM MDM_COMMODITY WHERE CMDT_CD=A.CMDT_CD) CMDT_NM
,      B.BDR_FLG 
,      NVL2(B.CORR_NO, 'Y', 'N') CORR_FLG
,      'N' HTS_FLG
,      B.PCK_QTY BKG_PCK_QTY
,      B.PCK_TP_CD  BKG_PCK_UNIT
,      B.ACT_WGT BKG_WGT_QTY
,      B.WGT_UT_CD  BKG_WGT_UNIT
,      B.MEAS_QTY BKG_MEAS_QTY
,      B.MEAS_UT_CD BKG_MEAS_UNIT
,      C.CUST_CNT_CD SHPR_CNT_CD
,      C.CUST_SEQ SHPR_SEQ
,      C.CUST_NM SHPR_NM
,      D.CUST_CNT_CD CNEE_CNT_CD
,      D.CUST_SEQ CNEE_SEQ
,      D.CUST_NM CNEE_NM
,      (SELECT MK_DESC FROM BKG_BL_MK_DESC_HIS WHERE BKG_NO = A.BKG_NO AND CORR_NO='TMP0000001' AND MK_SEQ=1) BKG_MK_DESC
,      (SELECT CSTMS_DESC FROM BKG_BL_DOC_HIS WHERE BKG_NO = A.BKG_NO AND CORR_NO='TMP0000001') BKG_CSTMS_DESC
,      (SELECT 'Y' FROM BKG_VVD_HIS WHERE BKG_NO=A.BKG_NO AND CORR_NO='TMP0000001' AND VSL_PRE_PST_CD||VSL_SEQ<>'S1' AND POL_CD='MYPKG') MYPKG_FLG
,      A.CRE_USR_ID
,      A.UPD_USR_ID
,	   DECODE((SELECT CONTI_CD FROM MDM_LOCATION WHERE LOC_CD = A.POD_CD),'E','Y','N') EUR_FLG
,      TO_CHAR(BKG_HS_APLY_DT_PKG.BKG_GET_REV_APLY_DT_FNC(@[bkg_no],'Y'),'YYYY-MM-DD') AS HS_APLY_DT
FROM   BKG_BKG_HIS A, BKG_BL_DOC_HIS B, BKG_CUST_HIS C, BKG_CUST_HIS D, BKG_BL_ISS_HIS E
WHERE  B.BKG_NO = A.BKG_NO
AND    B.CORR_NO = 'TMP0000001'
AND    C.BKG_NO = A.BKG_NO
AND    C.CORR_NO = 'TMP0000001'
AND    C.BKG_CUST_TP_CD = 'S'
AND    D.BKG_NO = A.BKG_NO
AND    D.CORR_NO = 'TMP0000001'
AND    D.BKG_CUST_TP_CD = 'C'
AND    E.BKG_NO(+) = A.BKG_NO
AND    E.CORR_NO(+) = A.CORR_NO
AND    A.BKG_NO = @[bkg_no]
AND    A.CORR_NO = 'TMP0000001'
#else 
SELECT A.BKG_NO
,      A.BL_NO || NVL(A.BL_TP_CD, DECODE(E.OBL_SRND_FLG, 'Y', 'S', NULL)) AS BL_NO
,      A.BL_TP_CD
,      A.VSL_CD||A.SKD_VOY_NO||A.SKD_DIR_CD T_VVD
,      A.VSL_CD
,      A.SKD_VOY_NO
,      A.SKD_DIR_CD
,      A.BKG_CGO_TP_CD
,      A.POR_CD
,      A.POL_CD
,      A.POD_CD
,      A.DEL_CD
,      A.PRE_RLY_PORT_CD
,      A.PST_RLY_PORT_CD
,      A.RCV_TERM_CD BKG_RCV_TERM_CD
,      A.DE_TERM_CD BKG_DE_TERM_CD
,      A.CMDT_CD
,      A.REP_CMDT_CD
,      A.BKG_STS_CD 
,      (SELECT CMDT_NM FROM MDM_COMMODITY WHERE CMDT_CD=A.CMDT_CD) CMDT_NM
,      B.BDR_FLG 
,      NVL2(B.CORR_NO, 'Y', 'N') CORR_FLG
,      'N' HTS_FLG
,      B.PCK_QTY BKG_PCK_QTY
,      B.PCK_TP_CD  BKG_PCK_UNIT
,      B.ACT_WGT BKG_WGT_QTY
,      B.WGT_UT_CD  BKG_WGT_UNIT
,      B.MEAS_QTY BKG_MEAS_QTY
,      B.MEAS_UT_CD BKG_MEAS_UNIT
,      C.CUST_CNT_CD SHPR_CNT_CD
,      C.CUST_SEQ SHPR_SEQ
,      C.CUST_NM SHPR_NM
,      D.CUST_CNT_CD CNEE_CNT_CD
,      D.CUST_SEQ CNEE_SEQ
,      D.CUST_NM CNEE_NM
,      (SELECT MK_DESC FROM BKG_BL_MK_DESC WHERE BKG_NO = A.BKG_NO AND MK_SEQ = 1) BKG_MK_DESC
,      (SELECT CSTMS_DESC FROM BKG_BL_DOC WHERE BKG_NO = A.BKG_NO) BKG_CSTMS_DESC
,      (SELECT 'Y' FROM BKG_VVD WHERE BKG_NO=A.BKG_NO AND VSL_PRE_PST_CD||VSL_SEQ<>'S1' AND POL_CD='MYPKG') MYPKG_FLG
,      A.CRE_USR_ID
,      A.UPD_USR_ID
,	   DECODE((SELECT CONTI_CD FROM MDM_LOCATION WHERE LOC_CD = A.POD_CD),'E','Y','N') EUR_FLG
,      TO_CHAR(BKG_HS_APLY_DT_PKG.BKG_GET_REV_APLY_DT_FNC(@[bkg_no],'N'),'YYYY-MM-DD') AS HS_APLY_DT
FROM   BKG_BOOKING A, BKG_BL_DOC B, BKG_CUSTOMER C, BKG_CUSTOMER D, BKG_BL_ISS E
WHERE  B.BKG_NO = A.BKG_NO
AND    C.BKG_NO = A.BKG_NO
AND    C.BKG_CUST_TP_CD = 'S'
AND    D.BKG_NO = A.BKG_NO
AND    D.BKG_CUST_TP_CD = 'C'
AND    E.BKG_NO(+) = A.BKG_NO
AND    A.BKG_NO = @[bkg_no]
#end			]]></sql>
			<params>
				<param name="bkg_no" type="12" value="" out="N"/>
			</params>
		</query>
	</querys>
</sqls>
