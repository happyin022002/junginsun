<?xml version="1.0" encoding="UTF-8"?>
<sqls>
	<querys>
		<query name="BlRatingDBDAOSearchChgRateRSQL">
			<desc><![CDATA[운임 목록 리스트 데이터를 조회한다.]]></desc>
			<sql><![CDATA[
#if (${caflag} == 'Y') 

SELECT
    BKG_NO
    ,RT_SEQ
    ,CHG_CD
    ,TRF_ITM_NO
    ,CURR_CD
    ,CHG_UT_AMT
    ,RAT_AS_QTY
    ,RAT_UT_CD
    ,CHG_AMT
    ,FRT_INCL_XCLD_DIV_CD as INCL_OFT_FLG
    ,FRT_TERM_CD
    ,N3PTY_RCV_OFC_CD
    ,N3PTY_CUST_CNT_CD
	,DECODE(N3PTY_CUST_SEQ,0,'',N3PTY_CUST_SEQ) AS N3PTY_CUST_SEQ
    ,CGO_CATE_CD
    ,RCV_TERM_CD
    ,DE_TERM_CD
    ,IMDG_CLSS_CD
    ,AUTO_RAT_CD
    ,PRN_HDN_FLG
	,NOTE_RT_SEQ
	,PROP_NO
	,AMDT_SEQ
	,SVC_SCP_CD
	,GEN_SPCL_RT_TP_CD
	,CMDT_HDR_SEQ
	,ROUT_SEQ
	,CASE  
	 WHEN DP_SEQ = 0 THEN DP_SEQ + 999	
	 ELSE DP_SEQ
	 END DP_SEQ 
	,TAX_FLG
	,(SELECT DP_PRCS_KNT FROM MDM_CURRENCY WHERE CURR_CD = A.CURR_CD) AS DP_PRCS_KNT
    ,CASE WHEN (SELECT COUNT(TAX_CNT_CD) FROM MDM_CHARGE WHERE TAX_CNT_CD='VN' AND DELT_FLG ='N' AND CHG_CD = A.CHG_CD) > 0 THEN 'Y' ELSE 'N' END VN_FLG
FROM
    BKG_CHG_RT_HIS A
WHERE
    BKG_NO=@[bkg_no]
    AND CORR_NO = 'TMP0000001'
ORDER BY DECODE(FRT_INCL_XCLD_DIV_CD,'N','1','I','2','E','3','4'), DP_SEQ, RT_SEQ


#else 


SELECT 
	BKG_NO
	,RT_SEQ
    ,CHG_CD
    ,TRF_ITM_NO
    ,CURR_CD
    ,CHG_UT_AMT
    ,RAT_AS_QTY
    ,RAT_UT_CD
    ,CHG_AMT
    ,FRT_INCL_XCLD_DIV_CD as INCL_OFT_FLG
    ,FRT_TERM_CD
    ,N3PTY_RCV_OFC_CD
    ,N3PTY_CUST_CNT_CD
	,DECODE(N3PTY_CUST_SEQ,0,'',N3PTY_CUST_SEQ) AS N3PTY_CUST_SEQ
    ,CGO_CATE_CD
    ,RCV_TERM_CD
    ,DE_TERM_CD
    ,IMDG_CLSS_CD
    ,AUTO_RAT_CD
    ,PRN_HDN_FLG
	,NOTE_RT_SEQ
	,PROP_NO
	,AMDT_SEQ
	,SVC_SCP_CD
	,GEN_SPCL_RT_TP_CD
	,CMDT_HDR_SEQ
	,ROUT_SEQ
	,CASE  
	 WHEN DP_SEQ = 0 THEN DP_SEQ + 999	
	 ELSE DP_SEQ
	 END DP_SEQ
	,TAX_FLG
	,(SELECT DP_PRCS_KNT FROM MDM_CURRENCY WHERE CURR_CD = A.CURR_CD) AS DP_PRCS_KNT
    ,CASE WHEN (SELECT COUNT(TAX_CNT_CD) FROM MDM_CHARGE WHERE TAX_CNT_CD='VN' AND DELT_FLG ='N' AND CHG_CD = A.CHG_CD) > 0 THEN 'Y' ELSE 'N' END VN_FLG
FROM 
    BKG_CHG_RT A
WHERE  BKG_NO=@[bkg_no]
ORDER BY DECODE(FRT_INCL_XCLD_DIV_CD,'N','1','I','2','E','3','4'), DP_SEQ, RT_SEQ
#end			]]></sql>
			<params>
				<param name="bkg_no" type="12" value="" out="N"/>
			</params>
		</query>
	</querys>
</sqls>
