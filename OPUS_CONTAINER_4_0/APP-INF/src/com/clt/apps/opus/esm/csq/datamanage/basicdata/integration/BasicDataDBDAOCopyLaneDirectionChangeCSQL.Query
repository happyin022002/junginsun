<?xml version="1.0" encoding="UTF-8"?>
<sqls>
	<querys>
		<query name="BasicDataDBDAOCopyLaneDirectionChangeCSQL">
			<desc><![CDATA[최근 이전 분기의 데이터를 복사]]></desc>
			<sql><![CDATA[
INSERT INTO CSQ_DIR_CONV (
     BSE_TP_CD 
	,BSE_YR 
	,BSE_QTR_CD 
	,TRD_CD 
    ,RLANE_CD
    ,DIR_CD 
    ,CONV_DIR_CD 
	,CRE_USR_ID
	,CRE_DT
	,UPD_USR_ID
	,UPD_DT
	) 
SELECT  @[f_bse_tp_cd] 
        ,@[f_bse_yr] 
        ,DECODE(@[f_bse_tp_cd],'Y','00',@[f_bse_qtr_cd]) 
        ,TRD_CD 
        ,RLANE_CD 
        ,DIR_CD 
        ,CONV_DIR_CD 
        ,@[usr_id]
        ,SYSDATE
        ,@[usr_id]
        ,SYSDATE
  FROM (
        SELECT /*+ INDEX_DESC(CSQ_DIR_CONV XPKCSQ_DIR_CONV) */
                BSE_YR 
               ,BSE_QTR_CD
         FROM CSQ_DIR_CONV
        WHERE BSE_YR || BSE_QTR_CD  <  @[f_bse_yr]||DECODE(@[f_bse_tp_cd],'Y','00',@[f_bse_qtr_cd]) 
          AND BSE_TP_CD = 'Q'
          AND ROWNUM = 1
        ) A
      ,CSQ_DIR_CONV CONV             
 WHERE CONV.BSE_YR = A.BSE_YR 
   AND CONV.BSE_QTR_CD = A.BSE_QTR_CD			]]></sql>
			<params>
				<param name="f_bse_tp_cd" type="12" value="" out="N"/>
				<param name="f_bse_yr" type="12" value="" out="N"/>
				<param name="f_bse_qtr_cd" type="12" value="" out="N"/>
				<param name="usr_id" type="12" value="" out="N"/>
			</params>
		</query>
	</querys>
</sqls>
