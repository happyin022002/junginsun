<?xml version="1.0" encoding="UTF-8"?>
<sqls>
	<querys>
		<query name="PerformanceReportDBDAOAddQueueRtnToRtnCSQL">
			<desc><![CDATA[PerformanceReportDBDAOAddQueueRtnToRtnCSQL]]></desc>
			<sql><![CDATA[
INSERT INTO BKG_SR_HIS
    (       SR_KND_CD,
            SR_NO,
            BKG_NO,
            SR_HIS_SEQ,
            SR_STS_CD,
            SR_PROC_STS_CD,
            ATND_USR_ID,
            ST_DT,
            FNT_OFC_RTN_CD,
            DIFF_RMK,
            CRE_USR_ID,
            CRE_DT,
            UPD_USR_ID,
            UPD_DT
    )
    VALUES
    (@[src_cd],
     @[sr_no],
     @[bkg_no],
     ( SELECT NVL(MAX(SR_HIS_SEQ) + 1,0)
        FROM BKG_SR_HIS
        WHERE SR_KND_CD = @[src_cd] /* 0421의 SRC_CD*/
          AND  SR_NO    = @[sr_no]
          AND  BKG_NO   = @[bkg_no]                
     ) ,
     DECODE(@[grp_cd], 'I', 'ID', 'R', 'RD', 'A', 'AD', '  '), /*WORK GROUP 코드*/
     'T', /*상수 */
     @[usr_id],
     
    GLOBALDATE_PKG.TIME_CONV_FNC(COM_CONSTANTMGR_PKG.COM_GETBASELOCATIONCODE_FNC(), SYSDATE, GLOBALDATE_PKG.GET_LOCCD_FNC( (SELECT OFC_CD
                                                                                FROM   COM_USER
                                                                                WHERE  USR_ID = @[usr_id]) )
                            ),
     (SELECT RTN_FM_STS_CD
        FROM BKG_SR_CRNT_RQST X
        WHERE SR_KND_CD   = @[src_cd] /* 0421의 SRC_CD*/
         AND SR_NO        = @[sr_no]    
         AND BKG_NO       = @[bkg_no]
         AND SR_AMD_TP_CD = @[sr_knd_cd]/* 0421의 SR_KND_CD*/ 
         AND SR_AMD_SEQ = (SELECT NVL(MAX(SR_AMD_SEQ),0)
                             FROM  BKG_SR_CRNT_RQST
                            WHERE SR_KND_CD = X.SR_KND_CD
                              AND SR_AMD_TP_CD = X.SR_AMD_TP_CD
                              AND BKG_NO = X.BKG_NO
                              AND SR_NO = X.SR_NO
                           )
       ),
      @[message],
      @[usr_id],
      SYSDATE,
      @[usr_id],
      SYSDATE
     )			]]></sql>
			<params>
				<param name="src_cd" type="12" value="" out="N"/>
				<param name="sr_no" type="12" value="" out="N"/>
				<param name="bkg_no" type="12" value="" out="N"/>
				<param name="grp_cd" type="12" value="" out="N"/>
				<param name="usr_id" type="12" value="" out="N"/>
				<param name="sr_knd_cd" type="12" value="" out="N"/>
				<param name="message" type="12" value="" out="N"/>
			</params>
		</query>
	</querys>
</sqls>
