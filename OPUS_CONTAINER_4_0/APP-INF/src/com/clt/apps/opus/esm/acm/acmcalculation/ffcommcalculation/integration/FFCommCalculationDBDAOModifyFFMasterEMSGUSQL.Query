<?xml version="1.0" encoding="UTF-8"?>
<sqls>
	<querys>
		<query name="FFCommCalculationDBDAOModifyFFMasterEMSGUSQL">
			<desc><![CDATA[FFCommCalculationDBDAOModifyFFMasterEMSGUSQL]]></desc>
			<sql><![CDATA[
MERGE INTO ACM_FF_CMPN A 
USING ( SELECT @[bkg_no] BKG_NO, @[ff_cmpn_seq] FF_CMPN_SEQ, @[ff_cmpn_sts_cd] FF_CMPN_STS_CD, @[ff_cmpn_rmk] FF_CMPN_RMK, 
				 TO_DATE (@[trunk_etd_dt], 'YYYYMMDDHH24MISS') VSL_DEP_DT, 
				 @[bkg_ff_cnt_cd] BKG_FF_CNT_CD, TO_NUMBER(@[bkg_ff_seq]) BKG_FF_SEQ, @[ff_cnt_cd] FF_CNT_CD, TO_NUMBER(@[ff_seq]) FF_SEQ, 0 FF_CHG_AMT,
				 0 PPD_AMT, 0 CRNT_AMT, 0 IF_AMT, 'COMMISSION' UPD_USR_ID, SYSDATE UPD_DT, 'COMMISSION' CRE_USR_ID, SYSDATE CRE_DT 
	  	  FROM DUAL 
	    ) B
ON ( A.BKG_NO = B.BKG_NO AND A.FF_CMPN_SEQ = B.FF_CMPN_SEQ) 
WHEN MATCHED THEN 
	 UPDATE SET A.FF_CMPN_STS_CD = B.FF_CMPN_STS_CD, A.FF_CMPN_RMK = B.FF_CMPN_RMK, 
	 			A.VSL_DEP_DT = B.VSL_DEP_DT, 
	 			A.BKG_FF_CNT_CD = B.BKG_FF_CNT_CD, A.BKG_FF_SEQ = B.BKG_FF_SEQ, A.UPD_DT = B.UPD_DT 
WHEN NOT MATCHED THEN 
	 INSERT (A.BKG_NO, A.FF_CMPN_SEQ, A.FF_CMPN_STS_CD, A.FF_CMPN_RMK, 
	 		 A.FF_CHG_AMT, A.PPD_AMT, A.CRNT_AMT, A.IF_AMT, 
	 		 A.VSL_DEP_DT, A.BKG_FF_CNT_CD, A.BKG_FF_SEQ, A.FF_CNT_CD, A.FF_SEQ, A.UPD_USR_ID, A.UPD_DT, A.CRE_USR_ID, A.CRE_DT) 
	 VALUES (B.BKG_NO, B.FF_CMPN_SEQ, B.FF_CMPN_STS_CD, B.FF_CMPN_RMK, 
	 		 B.FF_CHG_AMT, B.PPD_AMT, B.CRNT_AMT, B.IF_AMT, 
	 		 B.VSL_DEP_DT, B.BKG_FF_CNT_CD, B.BKG_FF_SEQ, B.FF_CNT_CD, B.FF_SEQ, B.UPD_USR_ID, B.UPD_DT, B.CRE_USR_ID, B.CRE_DT)			]]></sql>
			<params>
				<param name="bkg_no" type="12" value="" out="N"/>
				<param name="ff_cmpn_seq" type="12" value="" out="N"/>
				<param name="ff_cmpn_sts_cd" type="12" value="" out="N"/>
				<param name="ff_cmpn_rmk" type="12" value="" out="N"/>
				<param name="trunk_etd_dt" type="12" value="" out="N"/>
				<param name="bkg_ff_cnt_cd" type="12" value="" out="N"/>
				<param name="bkg_ff_seq" type="12" value="" out="N"/>
				<param name="ff_cnt_cd" type="12" value="" out="N"/>
				<param name="ff_seq" type="12" value="" out="N"/>
			</params>
		</query>
	</querys>
</sqls>
