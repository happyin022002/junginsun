<?xml version="1.0" encoding="UTF-8"?>
<sqls>
	<querys>
		<query name="BLDocumentationBLDBDAOcopyBkgBlDocByBkgCSQL">
			<desc><![CDATA[insert]]></desc>
			<sql><![CDATA[
insert into bkg_bl_doc 
        (BKG_NO
        , PCK_QTY
        , PCK_TP_CD
        , MEAS_QTY
        , MEAS_UT_CD
        , ACT_WGT
        , WGT_UT_CD
        , ACT_WGT_PRN_FLG
        , HBL_TTL_KNT
        , SPCL_CGO_AUTH_KNT
        , BL_OBRD_TP_CD
        , BL_OBRD_DT
        , AUD_ERR_CTNT
        , IB_MF_CFM_FLG
        , BIS_SYS_FLG
        , ORG_CNT_NM
        , POR_CD
        , POR_NM
        , POL_CD
        , POL_NM
        , POD_CD
        , POD_NM
        , DEL_CD
        , DEL_NM
        , BL_MV_TP_NM
        , FNL_DEST_NM
        , VSL_NM
        , PRE_VSL_NM
        , BL_CVRD_TP_CD
        , MST_CVRD_BL_NO
        , BDR_FLG
        , BDR_DT
        , BDR_CNG_FLG
        , BKG_CLZ_FLG
        , BKG_CLZ_CNG_FLG
        , BKG_CLZ_CNG_CFM_FLG
        , TTL_PCK_DESC
        , CSTMS_DESC
        , MK_DESC_CFM_FLG
        , PCK_CMDT_DESC
        , CNTR_CMDT_DESC
		, CNTR_WGT_PRN_FLG
		, CNTR_MEAS_PRN_FLG
        , CRE_USR_ID
        , CRE_DT
        , UPD_USR_ID
        , UPD_DT)
select @[targetBkg] BKG_NO
    , @[pck_qty] PCK_QTY
    , @[pck_tp_cd] PCK_TP_CD
    , @[meas_qty] MEAS_QTY
    , @[meas_ut_cd] MEAS_UT_CD
    , @[act_wgt] ACT_WGT
    , @[wgt_ut_cd] WGT_UT_CD
    , ACT_WGT_PRN_FLG
    , 0 HBL_TTL_KNT
    , 0 SPCL_CGO_AUTH_KNT
    , BL_OBRD_TP_CD
    , BL_OBRD_DT
    , AUD_ERR_CTNT
    , 'N' IB_MF_CFM_FLG
    , 'N' BIS_SYS_FLG
    , ORG_CNT_NM
    , POR_CD
    , POR_NM
    , POL_CD
    , POL_NM
    , POD_CD
    , POD_NM
    , DEL_CD
    , DEL_NM
    , BL_MV_TP_NM
    , FNL_DEST_NM
    -- If trunk VVD is not changed, keep the original vessel name
    , CASE WHEN (SELECT VSL_CD||SKD_VOY_NO||SKD_DIR_CD FROM BKG_BOOKING WHERE BKG_NO = @[bkg_no])
                = (SELECT VSL_CD||SKD_VOY_NO||SKD_DIR_CD FROM BKG_BOOKING WHERE BKG_NO = @[targetBkg]) THEN
                VSL_NM
           ELSE (SELECT MDM.VSL_ENG_NM||' '||VSK.OB_CSSM_VOY_NO 
           		   FROM MDM_VSL_CNTR MDM, VSK_VSL_PORT_SKD VSK, BKG_VVD VVD
                  WHERE 1=1
             	    AND VVD.BKG_NO = @[targetBkg]
             		AND VVD.VSL_PRE_PST_CD ='T'
             		AND VVD.VSL_CD = VSK.VSL_CD
            	 	AND VVD.SKD_VOY_NO = VSK.SKD_VOY_NO
             		AND VVD.SKD_DIR_CD = VSK.SKD_DIR_CD
            		AND VVD.POL_CD = VSK.VPS_PORT_CD
             		AND VVD.POL_YD_CD = VSK.YD_CD
             		AND VVD.POL_CLPT_IND_SEQ = VSK.CLPT_IND_SEQ
             		AND VVD.VSL_CD = MDM.VSL_CD
             		AND ROWNUM =1)
      END VSL_NM
    , CASE WHEN (SELECT VSL_CD||SKD_VOY_NO||SKD_DIR_CD FROM BKG_VVD WHERE BKG_NO = @[bkg_no] AND VSL_PRE_PST_CD = 'S' AND VSL_SEQ = '1')
                = (SELECT VSL_CD||SKD_VOY_NO||SKD_DIR_CD FROM BKG_VVD WHERE BKG_NO = @[targetBkg] AND VSL_PRE_PST_CD = 'S' AND VSL_SEQ = '1') THEN

                PRE_VSL_NM
           ELSE (SELECT MDM.VSL_ENG_NM||' '||VSK.OB_CSSM_VOY_NO 
           		   FROM MDM_VSL_CNTR MDM, VSK_VSL_PORT_SKD VSK, BKG_VVD VVD
                  WHERE 1=1
             	    AND VVD.BKG_NO = @[targetBkg]
             		AND VVD.VSL_PRE_PST_CD ='S'
					AND VVD.VSL_SEQ = '1'
             		AND VVD.VSL_CD = VSK.VSL_CD
            	 	AND VVD.SKD_VOY_NO = VSK.SKD_VOY_NO
             		AND VVD.SKD_DIR_CD = VSK.SKD_DIR_CD
            		AND VVD.POL_CD = VSK.VPS_PORT_CD
             		AND VVD.POL_YD_CD = VSK.YD_CD
             		AND VVD.POL_CLPT_IND_SEQ = VSK.CLPT_IND_SEQ
             		AND VVD.VSL_CD = MDM.VSL_CD
             		AND ROWNUM =1)
      END PRE_VSL_NM
    , BL_CVRD_TP_CD
    , MST_CVRD_BL_NO
    , BDR_FLG
    , BDR_DT
    , BDR_CNG_FLG
    , 'N' BKG_CLZ_FLG
    , 'N' BKG_CLZ_CNG_FLG
    , 'N' BKG_CLZ_CNG_CFM_FLG
    , TTL_PCK_DESC
    , CSTMS_DESC
    , MK_DESC_CFM_FLG
    , PCK_CMDT_DESC
    , CNTR_CMDT_DESC
	, CNTR_WGT_PRN_FLG
	, CNTR_MEAS_PRN_FLG
    , @[usr_id] CRE_USR_ID
    , sysdate CRE_DT
    , @[usr_id] UPD_USR_ID
    , sysdate UPD_DT
  from bkg_bl_doc
 where bkg_no = @[bkg_no]			]]></sql>
			<params>
				<param name="targetBkg" type="12" value="" out="N"/>
				<param name="pck_qty" type="6" value="" out="N"/>
				<param name="pck_tp_cd" type="12" value="" out="N"/>
				<param name="meas_qty" type="6" value="" out="N"/>
				<param name="meas_ut_cd" type="12" value="" out="N"/>
				<param name="act_wgt" type="6" value="" out="N"/>
				<param name="wgt_ut_cd" type="12" value="" out="N"/>
				<param name="bkg_no" type="12" value="" out="N"/>
				<param name="usr_id" type="12" value="" out="N"/>
			</params>
		</query>
	</querys>
</sqls>
