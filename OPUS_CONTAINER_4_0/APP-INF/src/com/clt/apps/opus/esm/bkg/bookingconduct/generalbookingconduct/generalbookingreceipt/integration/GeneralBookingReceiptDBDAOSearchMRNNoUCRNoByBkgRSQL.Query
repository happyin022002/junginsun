<?xml version="1.0" encoding="UTF-8"?>
<sqls>
	<querys>
		<query name="GeneralBookingReceiptDBDAOSearchMRNNoUCRNoByBkgRSQL">
			<desc><![CDATA[Search MRN No, UCR No]]></desc>
			<sql><![CDATA[
#if (${ca_flg} == 'Y')
SELECT REF_SEQ
    , BKG_NO
    , REF_NO
    , CNTR_NO
    , BKG_REF_TP_CD
    , CUST_REF_NO_CTNT
    , (SELECT COUNT(*) FROM BKG_CNTR_HIS WHERE BKG_NO=A.BKG_NO AND CNTR_NO=A.CNTR_NO AND CORR_NO=A.CORR_NO) AS CNTR_FLG
	, BKG_REF_TP_CD AS OLD_BKG_REF_TP_CD
    , CUST_REF_NO_CTNT AS OLD_CUST_REF_NO_CTNT
FROM  BKG_REF_HIS A
WHERE BKG_NO = @[bkg_no]
AND CORR_NO = 'TMP0000001'
AND BKG_REF_TP_CD IN ('CMRN','CUCR')
AND NOT (CUST_REF_NO_CTNT IS NULL AND REF_NO IS NULL)
ORDER BY REF_SEQ
#else
SELECT REF_SEQ
    , BKG_NO
    , REF_NO
    , CNTR_NO
    , BKG_REF_TP_CD
    , CUST_REF_NO_CTNT
    , (SELECT COUNT(*) FROM BKG_CONTAINER WHERE BKG_NO=A.BKG_NO AND CNTR_NO=A.CNTR_NO) AS CNTR_FLG
	, BKG_REF_TP_CD AS OLD_BKG_REF_TP_CD
    , CUST_REF_NO_CTNT AS OLD_CUST_REF_NO_CTNT
FROM  BKG_REFERENCE A
WHERE BKG_NO = @[bkg_no]
AND BKG_REF_TP_CD IN ('CMRN','CUCR')
AND NOT (CUST_REF_NO_CTNT IS NULL AND REF_NO IS NULL)
ORDER BY REF_SEQ

#end			]]></sql>
			<params>
				<param name="bkg_no" type="12" value="" out="N"/>
			</params>
		</query>
	</querys>
</sqls>
