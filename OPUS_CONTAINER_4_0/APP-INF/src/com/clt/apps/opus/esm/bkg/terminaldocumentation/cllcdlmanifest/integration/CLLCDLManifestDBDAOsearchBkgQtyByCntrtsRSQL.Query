<?xml version="1.0" encoding="UTF-8"?>
<sqls>
	<querys>
		<query name="CLLCDLManifestDBDAOsearchBkgQtyByCntrtsRSQL">
			<desc><![CDATA[searchBkgQtyByCntrts]]></desc>
			<sql><![CDATA[
SELECT 
	NVL((SELECT	SUM(NVL(OP_CNTR_QTY,0)) 
	FROM	BKG_QUANTITY
	WHERE	BKG_NO = @[bkg_no]
	AND	SUBSTR(CNTR_TPSZ_CD,2,1) = '2'
	AND	CNTR_TPSZ_CD != 'Q2'
	AND	CNTR_TPSZ_CD != 'Q4'),0) IN_TEU,
	NVL((SELECT	SUM(NVL(OP_CNTR_QTY,0)) 
	FROM	BKG_QUANTITY
	WHERE	BKG_NO = @[bkg_no]
	AND	SUBSTR(CNTR_TPSZ_CD,2,1) != '2'
	AND	CNTR_TPSZ_CD != 'Q2'
	AND	CNTR_TPSZ_CD != 'Q4'),0) IN_FEU,

#if (${in_cntr_match} == 'Y') 
	NVL((SELECT	SUM(DECODE(SUBSTR(CNTR_TPSZ_CD,2,1),'2',1,2)/DECODE(SUBSTR(@[cntr_tpsz_cd],2,1),'2',1,2))--전체 대비 내 비중을 위한 분모값
	FROM	BKG_CONTAINER
	WHERE	BKG_NO = @[bkg_no]
	AND	CNTR_TPSZ_CD != 'Q2'
	AND	CNTR_TPSZ_CD != 'Q4'),0) IN_QTY
#else 
	NVL((SELECT	SUM(DECODE(SUBSTR(CNTR_TPSZ_CD,2,1),'2',1,2)*NVL(OP_CNTR_QTY,0)/DECODE(SUBSTR(@[cntr_tpsz_cd],2,1),'2',1,2))--전체 대비 내 비중을 위한 분모값
	FROM	BKG_QUANTITY
	WHERE	BKG_NO = @[bkg_no]
	AND	CNTR_TPSZ_CD != 'Q2'
	AND	CNTR_TPSZ_CD != 'Q4'),0) IN_QTY
#end
FROM DUAL			]]></sql>
			<params>
				<param name="bkg_no" type="12" value="" out="N"/>
				<param name="cntr_tpsz_cd" type="12" value="" out="N"/>
			</params>
		</query>
	</querys>
</sqls>
