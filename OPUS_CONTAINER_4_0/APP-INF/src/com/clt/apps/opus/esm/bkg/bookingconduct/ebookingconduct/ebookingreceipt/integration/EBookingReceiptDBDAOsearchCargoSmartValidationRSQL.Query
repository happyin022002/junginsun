<?xml version="1.0" encoding="UTF-8"?>
<sqls>
	<querys>
		<query name="EBookingReceiptDBDAOsearchCargoSmartValidationRSQL">
			<desc><![CDATA[searchXterBkgAck]]></desc>
			<sql><![CDATA[
SELECT
	VGM.XTER_VGM_RQST_SEQ,
  	CASE 
    WHEN (SELECT
            COUNT(BKG.BKG_NO) CNT
          FROM BKG_BOOKING BKG, BKG_CONTAINER CNT
          WHERE BKG.BKG_NO = (SELECT REF_NO FROM BKG_XTER_VGM_REF_NO WHERE XTER_SNDR_ID = VGM.XTER_SNDR_ID AND XTER_VGM_DOC_ID = VGM.XTER_VGM_DOC_ID AND XTER_VGM_RQST_SEQ = VGM.XTER_VGM_RQST_SEQ AND CNTR_NO = VGM.CNTR_NO AND XTER_REF_TP_CD = 'BN' AND ROWNUM = 1)
          AND BKG.BKG_NO = CNT.BKG_NO
          AND BKG_STS_CD <> 'X'
          AND CNT.CNTR_NO = VGM.CNTR_NO) = 0 THEN '2'
    WHEN VGM.RQST_DT - 1 > SYSDATE  THEN '3'
    WHEN (SELECT MST_SPEC_FNC('TARE',VGM.CNTR_NO) TARE FROM DUAL) >= DECODE(VGM.WGT_UT_CD, 'LBS', VGM.VGM_WGT*0.453592, VGM.VGM_WGT)  THEN '4'
    WHEN (SELECT MST_SPEC_FNC('GRSS',VGM.CNTR_NO) GRSS FROM DUAL) < DECODE(VGM.WGT_UT_CD, 'LBS', VGM.VGM_WGT*0.453592, VGM.VGM_WGT) THEN '5'
  ELSE '1'
  END RES_TP_CD
FROM BKG_XTER_VGM_RQST VGM
WHERE VGM.EDI_MSG_PROC_ID = @[edi_no]			]]></sql>
			<params>
				<param name="edi_no" type="12" value="" out="N"/>
			</params>
		</query>
	</querys>
</sqls>
