<?xml version="1.0" encoding="UTF-8"?>
<sqls>
	<querys>
		<query name="MonthlyQuotaGuidelineDBDAOMonthlyQuotaStepVersionInfo0076CSQL">
			<desc><![CDATA[SAQ_MON_QTA_STEP_VER Insert]]></desc>
			<sql><![CDATA[
INSERT INTO SAQ_MON_QTA_STEP_VER (							
            MQTA_STEP_CD                                        ,
            BSE_YR                                              ,
            BSE_QTR_CD                                          ,
            TRD_CD                                              ,
            DIR_CD                                              ,
            MQTA_VER_NO                                         ,
            SAQ_STS_CD                                          ,
            GLINE_VER_NO                                        ,
            QTA_MST_VER_NO                                      ,
            CRE_OFC_CD                                          ,
            CRE_USR_ID                                          ,
            CRE_DT                                              ,
            UPD_USR_ID                                          ,
            UPD_DT )                                             
SELECT
            '01'                                        AS MQTA_STEP_CD ,
            GVR.BSE_YR                                                  ,
            GVR.BSE_QTR_CD                                              ,
            GTR.TRD_CD                                                  ,
            GTR.DIR_CD                                                  ,
            ( SELECT  GVR.GLINE_VER_NO                               
                        ||TO_CHAR(NVL(MAX(SUBSTR(STV.MQTA_VER_NO,    
                          LENGTH(GVR.GLINE_VER_NO)+1)), 0)+1,'FM09') 
              FROM   SAQ_MON_QTA_STEP_VER STV                        
              WHERE  STV.MQTA_STEP_CD   = '01'                         
              AND    STV.GLINE_VER_NO   = GVR.GLINE_VER_NO             
              AND    STV.BSE_YR         = GVR.BSE_YR                     
              AND    STV.BSE_QTR_CD     = GVR.BSE_QTR_CD                 
              AND    STV.TRD_CD         = GTR.TRD_CD                     
              AND    STV.DIR_CD         = GTR.DIR_CD )  AS YQTA_VER_NO  ,
            '00'                                        AS SAQ_STS_CD   ,
            GVR.GLINE_VER_NO                                            ,
            GVR.QTA_MST_VER_NO                                          ,
            GVR.CRE_OFC_CD                                              ,
            @[user_id]                                  AS CRE_USR_ID   ,
            SYSDATE                                     AS CRE_DT       ,
            @[user_id]                                  AS UPD_USR_ID   ,
            SYSDATE                                     AS UPD_DT        
FROM        SAQ_MON_QTA_GLINE_VER GVR,                              
            SAQ_MON_QTA_GLINE_TRD GTR                               
WHERE       GVR.BSE_YR          = @[year]                                
AND         GVR.BSE_QTR_CD      = @[bse_qtr_cd]                          
AND         GVR.SAQ_TGT_GRP_CD  = @[target_grp]                          
AND         GVR.GLINE_VER_NO    = @[version]                             
AND         GTR.BSE_YR          = GVR.BSE_YR                             
AND         GTR.SAQ_TGT_GRP_CD  = GVR.SAQ_TGT_GRP_CD                
AND         GTR.GLINE_VER_NO    = GVR.GLINE_VER_NO                    
GROUP BY    GVR.BSE_YR, GVR.BSE_QTR_CD, GVR.GLINE_VER_NO,          
            GVR.CRE_OFC_CD, GTR.TRD_CD, GTR.DIR_CD, GVR.QTA_MST_VER_NO			]]></sql>
			<params>
				<param name="user_id" type="12" value="" out="N"/>
				<param name="year" type="12" value="" out="N"/>
				<param name="bse_qtr_cd" type="12" value="" out="N"/>
				<param name="target_grp" type="12" value="" out="N"/>
				<param name="version" type="12" value="" out="N"/>
			</params>
		</query>
	</querys>
</sqls>
