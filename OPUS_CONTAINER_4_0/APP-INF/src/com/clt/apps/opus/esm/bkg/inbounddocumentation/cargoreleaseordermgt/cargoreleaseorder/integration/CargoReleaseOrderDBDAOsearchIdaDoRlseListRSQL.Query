<?xml version="1.0" encoding="UTF-8"?>
<sqls>
	<querys>
		<query name="CargoReleaseOrderDBDAOsearchIdaDoRlseListRSQL">
			<desc><![CDATA[Indian Office의 DMDT Payment Type별로  D/O 발행 실적을 조회한다.]]></desc>
			<sql><![CDATA[
SELECT BKDO.IDA_DO_DMDT_PAY_TP_CD AS DMDT_PAY_TP_CD
     , CDTL.INTG_CD_VAL_DP_DESC AS DMDT_PAY_TP_CD_DESC
     , BKGM.BL_NO
     , DCNT.CNTR_NO
     , BKGM.POD_CD
     , BKGM.DEL_CD
     , BKDO.DO_NO || DECODE(BKDO.DO_NO_SPLIT, '00', '' , BKDO.DO_NO_SPLIT) AS DO_NO
     , TO_CHAR(DOTL.EVNT_DT, 'YYYYMMDD') EVNT_DT
     , DOTL.EVNT_OFC_CD
     , DOTL.EVNT_USR_ID 
FROM BKG_DO_DTL DOTL
   , BKG_DO BKDO
   , BKG_BOOKING BKGM
   , BKG_DO_CNTR DCNT
   , (SELECT INTG_CD_VAL_CTNT
           , INTG_CD_VAL_DP_DESC
        FROM COM_INTG_CD_DTL
       WHERE INTG_CD_ID = 'CD02209' ) CDTL -- D/O DEM/DET PAYMENT TYPE CODE
WHERE  DOTL.EVNT_OFC_CD = @[evnt_ofc_cd] --- RELEASE OFFICE 
#if (${rd_flag} == 'F')
AND TRIM(DOTL.EVNT_DT) >= TO_DATE(@[evnt_dt_fm], 'YYYYMMDD')  -- RELEASE DATE
AND TRIM(DOTL.EVNT_DT) < TO_DATE(@[evnt_dt_to], 'YYYYMMDD') + 1 -- RELEASE DATE
#end
#if (${rd_flag} == 'S')
AND TRIM(DOTL.EVNT_DT) >= TO_DATE(@[evnt_dt_ym], 'YYYYMM')      -- RELEASE DATE YM
AND TRIM(DOTL.EVNT_DT) < ADD_MONTHS(TO_DATE(@[evnt_dt_ym], 'YYYYMM'), 1) -- RELEASE DATE YM
#end
AND BKDO.BKG_NO = DOTL.BKG_NO
AND BKDO.RLSE_SEQ = DOTL.RLSE_SEQ
AND BKDO.IDA_DO_DMDT_PAY_TP_CD IS NOT NULL
#if (${dmdt_pay_tp_cd} != '')
AND BKDO.IDA_DO_DMDT_PAY_TP_CD = @[dmdt_pay_tp_cd]  -- DMDT PAYMENT TYPE
#end
AND BKGM.BKG_NO = DOTL.BKG_NO
AND SUBSTR(BKGM.POD_CD, 1,2) = 'IN'
#if (${bl_no} != '')
AND BKGM.BL_NO = @[bl_no]  -- BL NO
#end
AND DCNT.BKG_NO = DOTL.BKG_NO
AND DCNT.RLSE_SEQ = DOTL.RLSE_SEQ
#if (${cntr_no} != '')
AND DCNT.CNTR_NO = @[cntr_no] -- CNTR NO
#end
AND CDTL.INTG_CD_VAL_CTNT = BKDO.IDA_DO_DMDT_PAY_TP_CD
ORDER BY DOTL.EVNT_DT			]]></sql>
			<params>
				<param name="evnt_ofc_cd" type="12" value="" out="N"/>
				<param name="evnt_dt_fm" type="12" value="" out="N"/>
				<param name="evnt_dt_to" type="12" value="" out="N"/>
				<param name="evnt_dt_ym" type="12" value="" out="N"/>
				<param name="dmdt_pay_tp_cd" type="12" value="" out="N"/>
				<param name="bl_no" type="12" value="" out="N"/>
				<param name="cntr_no" type="12" value="" out="N"/>
			</params>
		</query>
	</querys>
</sqls>
