<?xml version="1.0" encoding="UTF-8"?>
<sqls>
	<querys>
		<query name="AGNCommApprovalDBDAOSearchAGNCommApprovalDetailListRSQL">
			<desc><![CDATA[]]></desc>
			<sql><![CDATA[
SELECT A.AC_VSL_CD||A.AC_SKD_VOY_NO||A.AC_SKD_DIR_CD||A.AC_REV_DIR_CD AS VVD,
       NVL(B.BL_NO, 'OTHERS') AS BL_NO,
       A.BKG_NO BKG_NO,
       A.AGN_CD,
       DECODE(A.AC_TP_CD, 'G', 1, 'K', 2, 'H', 3, 'N', 4, 'R', 5, 'S', 6, 'C',  7, 8) AS AC_TP_CD_SEQ,
       DECODE(A.AC_TP_CD, 'G', 'General', 'K', 'Brokerage', 'H', 'CHF', 'N', 'CSF', 'R', 'RCSF', 'S', 'T/S', 'C', 'Cross', 'Others') AS AC_TP_CD,
       A.AR_OFC_CD,
       A.AP_OFC_CD,
       C.BKG_STS_CD,
       A.PAY_IF_AMT,
       ROUND((A.PAY_IF_AMT * DECODE(A.INV_TAX_RT,'',0,A.INV_TAX_RT) / 100) + A.PAY_IF_AMT,2) AS IF_AMT
  FROM ACM_AGN_COMM A,
       ACM_AGN_BKG_INFO B,
       BKG_BOOKING C
 WHERE 1=1
   AND A.AGN_CD = @[agn_cd]
#if(${aud_no} != '')
   AND A.AUD_NO = @[aud_no]
#end
#if(${csr_no} != '')
   AND A.CSR_NO = @[csr_no]
#end
#if(${ac_sts_cd} == 'AS')
   AND A.AC_STS_CD = 'AS'
#elseif(${ac_sts_cd} == 'PS')
   AND A.AC_STS_CD IN ( 'PS', 'IF' )
#elseif(${ac_sts_cd} == 'IC')
   AND A.AC_STS_CD = @[ac_sts_cd]
#end
   AND A.CRE_USR_ID != 'COST'
   AND A.BKG_NO = B.BKG_NO
   AND A.BKG_NO = C.BKG_NO(+)
 UNION ALL
SELECT A.AC_VSL_CD||A.AC_SKD_VOY_NO||A.AC_SKD_DIR_CD||A.AC_REV_DIR_CD AS VVD,
       NVL(A.OTR_COMM_NO, 'OTHERS') AS BL_NO,
       A.OTR_COMM_NO BKG_NO,
       A.AGN_CD,
       DECODE(A.AC_TP_CD, 'G', 1, 'K', 2, 'H', 3, 'N', 4, 'R', 5, 'S', 6, 'C',  7, 8) AS AC_TP_CD_SEQ,
       DECODE(A.AC_TP_CD, 'G', 'General', 'K', 'Brokerage', 'H', 'CHF', 'N', 'CSF', 'R', 'RCSF', 'S', 'T/S', 'C', 'Cross', 'Others') AS AC_TP_CD,
       A.AR_OFC_CD,
       A.AP_OFC_CD,
       C.BKG_STS_CD,
       A.PAY_IF_AMT,
       ROUND((A.PAY_IF_AMT * DECODE(A.INV_TAX_RT,'',0,A.INV_TAX_RT) / 100) + A.PAY_IF_AMT,2) AS IF_AMT
  FROM ACM_AGN_OTR_COMM A,
       BKG_BOOKING C
 WHERE 1=1
   AND A.AGN_CD = @[agn_cd]
#if(${aud_no} != '')
   AND A.AUD_NO = @[aud_no]
#end
#if(${csr_no} != '')
   AND A.CSR_NO = @[csr_no]
#end
#if(${ac_sts_cd} == 'AS')
   AND A.AC_STS_CD = 'AS'
#elseif(${ac_sts_cd} == 'PS')
   AND A.AC_STS_CD IN ( 'PS', 'IF' )
#elseif(${ac_sts_cd} == 'IC')
   AND A.AC_STS_CD = @[ac_sts_cd]
#end
   AND A.CRE_USR_ID != 'COST'
   AND A.OTR_COMM_NO = C.BKG_NO(+)
 ORDER BY VVD, BL_NO, BKG_NO, AGN_CD, AC_TP_CD_SEQ			]]></sql>
			<params>
				<param name="agn_cd" type="12" value="" out="N"/>
				<param name="aud_no" type="12" value="" out="N"/>
				<param name="csr_no" type="12" value="" out="N"/>
				<param name="ac_sts_cd" type="12" value="" out="N"/>
			</params>
		</query>
	</querys>
</sqls>
