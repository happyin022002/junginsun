<?xml version="1.0" encoding="UTF-8"?>
<sqls>
	<querys>
		<query name="CargoReleaseOrderDBDAOmodifyUsCgoRlsInlndRsltUSQL">
			<desc><![CDATA[Inland 전송 후 BKG cargo release 테이블에 업데이트]]></desc>
			<sql><![CDATA[
UPDATE BKG_CGO_RLSE RMST
   SET RMST.INLND_YD_EDI_SND_FLG     = 'Y',        
       RMST.INLND_YD_EDI_SND_CD      = 
                                   CASE WHEN 'CR1' = @[edi_knd] THEN 'J'
                                        WHEN 'CR2' = @[edi_knd] THEN 'R'
                                        WHEN 'CR3' = @[edi_knd] THEN 'R'
                                        WHEN 'CR4' = @[edi_knd] THEN 'R'
                                        WHEN 'CA1' = @[edi_knd] THEN 'A'
                                        WHEN 'CA2' = @[edi_knd] THEN 'A'
                                        WHEN 'PA1' = @[edi_knd] THEN 'H'
                                        WHEN 'PQ1' = @[edi_knd] THEN 'H'
                                        WHEN 'CT1' = @[edi_knd] THEN 'T'
                                   END,
       RMST.INLND_YD_EDI_LST_SND_DT  = GLOBALDATE_PKG.TIME_CONV_FNC(COM_ConstantMgr_PKG.COM_getBaseLocationCode_FNC,SYSDATE,'USNYC'),
       RMST.INLND_YD_EDI_LST_SND_GDT = GLOBALDATE_PKG.TIME_CONV_FNC(COM_ConstantMgr_PKG.COM_getBaseLocationCode_FNC,SYSDATE,'GMT' ), 
       RMST.INLND_YD_EDI_RCV_ID      = @[edi_snp_rcv_id],
       RMST.INLND_YD_EDI_LST_MSG_ID  = @[edi_msg_id],  
       RMST.UPD_DT                   = SYSDATE
 WHERE RMST.BL_NO                    = @[bl_no]
   AND EXISTS (SELECT 'X' 
                 FROM BKG_CGO_RLSE_HIS HIS
                WHERE HIS.BL_NO       = @[bl_no]
                  AND HIS.HIS_SEQ     = @[his_seq]
                  AND HIS.BL_NO       = RMST.BL_NO
                  AND HIS.INLND_YD_EDI_SND_CD IS NOT NULL)			]]></sql>
			<params>
				<param name="edi_knd" type="12" value="" out="N"/>
				<param name="edi_snp_rcv_id" type="12" value="" out="N"/>
				<param name="edi_msg_id" type="12" value="" out="N"/>
				<param name="bl_no" type="12" value="" out="N"/>
				<param name="his_seq" type="12" value="" out="N"/>
			</params>
		</query>
	</querys>
</sqls>
