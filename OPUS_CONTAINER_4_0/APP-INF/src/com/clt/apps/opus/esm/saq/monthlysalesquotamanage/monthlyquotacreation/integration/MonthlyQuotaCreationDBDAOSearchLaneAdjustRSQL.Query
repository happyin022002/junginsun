<?xml version="1.0" encoding="UTF-8"?>
<sqls>
	<querys>
		<query name="MonthlyQuotaCreationDBDAOSearchLaneAdjustRSQL">
			<desc><![CDATA[해당 버전의 Lane Adjust Data를 조회한다.]]></desc>
			<sql><![CDATA[
SELECT MQTA_MDL_VER_NO 
     , TRD_CD 
     , SUB_TRD_CD 
     , ORG_RLANE_CD 
     , '' AS RLANE_CD 
     , ROW_CLR 
  FROM 
       (SELECT NVL(T1.MQTA_MDL_VER_NO, SUBSTR(T2.BSE_YR, 3,2)||BSE_QTR_CD||'01') AS MQTA_MDL_VER_NO 
            , NVL(T1.TRD_CD, T2.TRD_CD) AS TRD_CD 
            , NVL(T1.SUB_TRD_CD, T2.SUB_TRD_CD) AS SUB_TRD_CD 
            , NVL(T1.RLANE_CD, T2.RLANE_CD) AS ORG_RLANE_CD 
            , NVL(T1.RLANE_CD, T2.RLANE_CD) AS RLANE_CD 
            , DECODE(T1.RLANE_CD, NULL, 'BLUE', DECODE(T2.RLANE_CD, NULL, 'RED', 'ALL')) AS ROW_CLR 
         FROM 
              (SELECT MQTA_MDL_VER_NO 
                   , TRD_CD 
                   , SUB_TRD_CD 
                   , IOC_CD 
                   , RLANE_CD 
                   , RLANE_CD AS ORG_RLANE_CD 
                FROM SAQ_MON_FCAST_TRNS 
               WHERE 1=1 
                     AND MQTA_MDL_VER_NO = @[mqta_mdl_ver_no]  
					 #if(${trd_cd} != '')                     
					 AND TRD_CD = @[trd_cd]
					 #end
	   				 #if(${bound} != '')
       				 AND DIR_CD = @[bound] 
       				 #end
                     AND (FCAST_TRNS_STS_CD = '0' OR FCAST_TRNS_STS_CD IS NULL) 
               GROUP BY MQTA_MDL_VER_NO 
                   , TRD_CD 
                   , SUB_TRD_CD 
                   , IOC_CD 
                   , RLANE_CD 
              ) T1 
          FULL OUTER JOIN 
              (SELECT BSE_YR 
                   , BSE_QTR_CD 
                   , TRD_CD 
                   , SUB_TRD_CD 
                   , RLANE_CD 
                FROM SAQ_MON_TGT_VVD 
               WHERE 1=1 
                     AND DELT_FLG = 'N' 
                     AND TGT_VVD_STS_CD = 'N'
                     AND BSE_YR = @[year]
                     AND BSE_QTR_CD = @[bse_qtr_cd]
				     #if(${trd_cd} != '')                     
					 AND TRD_CD = @[trd_cd]
					 #end
	   				 #if(${bound} != '')
       				 AND DIR_CD = @[bound] 
       				 #end
               GROUP BY BSE_YR 
                   , BSE_QTR_CD 
                   , TRD_CD 
                   , SUB_TRD_CD 
                   , RLANE_CD 
              ) T2 
              ON ( 
                  T1.MQTA_MDL_VER_NO = SUBSTR(T2.BSE_YR, 3,2)||BSE_QTR_CD||'01' 
                  AND T1.TRD_CD = T2.TRD_CD 
                  AND T1.SUB_TRD_CD = T2.SUB_TRD_CD 
                  AND T1.RLANE_CD = T2.RLANE_CD 
              ) 
       ) 
 WHERE 1=1 
       AND ROW_CLR IN ('BLUE', 'RED') 
ORDER BY ROW_CLR 
     , TRD_CD 
     , SUB_TRD_CD  
     , RLANE_CD			]]></sql>
			<params>
				<param name="mqta_mdl_ver_no" type="12" value="" out="N"/>
				<param name="trd_cd" type="12" value="" out="N"/>
				<param name="bound" type="12" value="" out="N"/>
				<param name="year" type="12" value="" out="N"/>
				<param name="bse_qtr_cd" type="12" value="" out="N"/>
			</params>
		</query>
	</querys>
</sqls>
