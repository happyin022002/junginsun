<?xml version="1.0" encoding="UTF-8"?>
<sqls>
	<querys>
		<query name="AGTAuditDBDAOSearchAPActualInterfaceDetailRSQL">
			<desc><![CDATA[SearchAPActualInterfaceDetail]]></desc>
			<sql><![CDATA[
SELECT 
		   A.COMM_VSL_CD||A.COMM_SKD_VOY_NO||A.COMM_SKD_DIR_CD||A.COMM_REV_DIR_CD AS VVD,
           NVL(B.BL_NO, 'OTHERS') AS BL_NO,
           A.BKG_NO BKG_NO,
           A.AGN_CD,
           --DECODE(A.AC_TP_CD,'G',1,'N',2,'K',3,'H',4,'S',5,'R',6,'O',7,'C',8,'D',9,10) AS SEQ,
           (	
				SELECT INTG_CD_VAL_DESC 
                  FROM COM_INTG_CD_DTL
                 WHERE INTG_CD_ID = 'CD20039' 
                   AND INTG_CD_VAL_CTNT = A.AC_TP_CD     
						--'Common1','Common2','Brokerage','T/S','T/R','SOC','Cross','Doc','OTHERS'     
           )             		  AS TP,
           A.AR_OFC_CD,
           A.AP_OFC_CD,
		   C.BKG_STS_CD,
           A.ACT_IF_LOCL_COMM_AMT AS IF_AMT
      FROM AGT_AGN_COMM A,
           AGT_COMM_BKG_INFO B,
		   BKG_BOOKING C
     WHERE A.COMM_APRO_NO     = @[comm_apro_no]
       AND A.COMM_PROC_STS_CD = @[if_option]
       AND A.CRE_USR_ID != 'COST'
       AND A.BKG_NO = B.BKG_NO
	   AND A.BKG_NO = C.BKG_NO(+)
#if(${exp_type} == 'G')
	  AND A.COMM_STND_COST_CD NOT IN ('512692','512693')
#else
	  AND A.COMM_STND_COST_CD IN ('512692','512693')
#end
 UNION ALL
    SELECT 'VAT' AS VVD,
           '' AS BL_NO,
           '' AS BKG_NO,
           '' AS AGN_CD,
           --NULL AS SEQ,
           '' AS TP,
           '' AS AR_OFC_CD,
           '' AS AP_OFC_CD,
		   '' AS BKG_STS_CD,
           ROUND(SUM(A.ACT_IF_LOCL_COMM_AMT * NVL(A.INV_TAX_RT, 0) / 100), 2) AS IF_AMT
      FROM AGT_AGN_COMM A,
           AGT_COMM_BKG_INFO B
     WHERE A.COMM_APRO_NO     = @[comm_apro_no]
       AND A.COMM_PROC_STS_CD = @[if_option]
       AND A.CRE_USR_ID != 'COST'
       AND A.BKG_NO = B.BKG_NO
#if(${exp_type} == 'G')
	  AND A.COMM_STND_COST_CD NOT IN('512692','512693')
#else
	  AND A.COMM_STND_COST_CD IN('512692','512693')
#end			]]></sql>
			<params>
				<param name="comm_apro_no" type="12" value="" out="Y"/>
				<param name="if_option" type="12" value="" out="Y"/>
			</params>
		</query>
	</querys>
</sqls>
