<?xml version="1.0" encoding="UTF-8"?>
<sqls>
	<querys>
		<query name="IsraelCustomsTransmissionDBDAOsearchBlCMinfoRSQL">
			<desc><![CDATA[searchBlCMinfo]]></desc>
			<sql><![CDATA[
SELECT
   ROW_NUMBER() OVER (ORDER BY MF.CNTR_NO, MF.CNTR_MF_SEQ)  AS GOODS_ITEM_NO
 , 'A'  AS CM_FLAG
 , ''   AS PIECE_COUNT
 , MF.PCK_QTY       AS PKG_COUNT
 , MF.PCK_TP_CD     AS PKG_TYPE
 , BKG_SPCLCHAR_CONV_FNC(MF.CNTR_MF_GDS_DESC,'X') AS GOODS_DESC
 , MF.CNTR_MF_WGT   AS ITEM_GROSS_WGT
 , MF.CMDT_HS_CD    AS TARIFF_CD
 , (SELECT IMDG_UN_NO
      FROM BKG_DG_CGO DG
     WHERE 1=1
       AND DG.BKG_NO       = BK.BKG_NO        
       AND DG.CNTR_NO      = MF.CNTR_NO
       AND DG.DCGO_SEQ     = NVL(MF.DCGO_SEQ,DCGO_SEQ)
       AND ROWNUM=1
   ) AS UNDG_NO
  , ''          AS HANDLE_CD
  , ''          AS HANDLE_INFO
  , MF.CNTR_NO  AS CM_CNTR_NO
  , MF.PCK_QTY  AS CM_CNTR_PKG
  
  , BKG_SPCLCHAR_CONV_FNC(MF.CNTR_MF_MK_DESC,'X') AS CM_SHIP_MARK
  , BK.VSL_CD,      BK.SKD_VOY_NO,      BK.SKD_DIR_CD,      BK.BL_NO,  BK.POL_CD
  , MF.CNTR_NO,     MF.CNTR_MF_SEQ
  , MF.PCK_QTY,     MF.CNTR_MF_MK_DESC, MF.CNTR_MF_GDS_DESC
  , MF.PCK_TP_CD,   MF.MEAS_QTY
  , MF.CNTR_MF_WGT, MF.WGT_UT_CD,   MF.MEAS_UT_CD,  MF.CMDT_HS_CD,  MF.DCGO_SEQ 
  , BK.CRE_USR_ID,  BK.CRE_DT,      BK.UPD_USR_ID,  BK.UPD_DT
FROM BKG_BOOKING BK
   , BKG_CNTR_MF_DESC MF 
WHERE 1=1
AND BK.BKG_NO = MF.BKG_NO
AND BK.BL_NO      = @[bl_no]
AND EXISTS ( SELECT 'X' FROM BKG_CONTAINER C
             WHERE 1=1
             AND C.BKG_NO = BK.BKG_NO
             AND C.CNTR_NO = MF.CNTR_NO)			]]></sql>
			<params>
				<param name="bl_no" type="12" value="" out="N"/>
			</params>
		</query>
	</querys>
</sqls>
