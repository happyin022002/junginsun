<?xml version="1.0" encoding="UTF-8"?>
<sqls>
	<querys>
		<query name="DubaiCustomsTransmissionDBDAOsearchFlatFileBlInfoRSQL">
			<desc><![CDATA[DubaiBlInfoVO]]></desc>
			<sql><![CDATA[
SELECT BL.BL_NO || BKG.BL_TP_CD AS BL_NO
      ,BL.VSL_CD
      ,BL.SKD_VOY_NO
      ,BL.SKD_DIR_CD
      ,BL.DU_ROTN_NO
      ,BL.DU_LINE_ID
      ,BL.DU_VOY_AGN_ID
      ,BL.ORG_PORT_CD
      ,BL.POR_CD
      ,BL.POL_CD
      ,BL.POD_CD
      ,BL.DEL_CD
      ,BL.DU_MF_NO
      ,BL.DU_CGO_CD
      ,C.INTG_CD_VAL_DP_DESC AS DU_CNTR_SVC_TP_CD
      ,BL.DU_TRD_CD
      ,BL.DU_TS_MOD_CD
      ,BL.CNSL_CGO_FLG
      ,BL.ORG_BL_NO
      ,BL.ORG_CNT_CD
      ,BL.ORG_VSL_CD
      ,BL.ORG_SKD_VOY_NO
      ,BL.ORG_SKD_DIR_CD
      ,SUBSTR(BL.VSL_NM,1,30) AS ORG_VSL_NM
      ,DECODE(SUBSTR(BL.DU_CNTR_SVC_TP_CD, 2,1), 'L', NVL(SUBSTR(REPLACE(BL.MK_NO_CTNT, CHR(10), ''),1,200), 'NIL'), 'NIL')
       AS MK_NO_CTNT
      ,BL.DU_CMDT_CD
      ,SUBSTR(REPLACE(BL.CMDT_DESC, CHR(10), ''),1,100) AS CMDT_DESC
      ,BL.PCK_QTY
      ,SUBSTR(BL.DU_PCK_DESC, 1, 30) AS DU_PCK_DESC
      ,BL.DU_PCK_TP_CD
      ,BL.CNTR_NO
      ,SUBSTR(BL.CNTR_NO, LENGTH(BL.CNTR_NO), 1) AS CHECK_DIGIT
      ,LPAD(BL.CNTR_KNT, 2, '0') AS CNTR_KNT
      ,LPAD(BL.BKG_TEU_QTY, 4, '0') AS BKG_TEU_QTY
      ,BL.TARE_WGT
      ,TRIM(TO_CHAR(NVL(BL.CGO_WGT,0), '000000.0')) AS CGO_WGT
      ,TRIM(TO_CHAR(NVL(BL.GRS_WGT,0), '000000.0')) AS GRS_WGT
      ,TRIM(TO_CHAR(NVL(BL.MEAS_QTY,0), '000000.0')) AS MEAS_QTY
      ,NVL(BL.DU_TTL_QTY, 0) AS DU_TTL_QTY
      ,NVL(BL.DU_FRT_WGT, 0) AS DU_FRT_WGT
      ,BL.PLT_QTY
      ,CS.CUST_CNT_CD     AS S_CUST_CNT_CD
      ,SUBSTR(REPLACE(REPLACE(CS.CUST_NM , CHR(10), ''), CHR(13), ''),1,30)         AS S_CUST_NM
      ,SUBSTR(REPLACE(REPLACE(CS.CUST_ADDR , CHR(10), ''), CHR(13), ''),1,240)      AS S_CUST_ADDR
      ,SUBSTR(REPLACE(REPLACE(CS.ORG_CUST_NM , CHR(10), ''), CHR(13), ''),1,30)     AS S_ORG_CUST_NM
      ,SUBSTR(REPLACE(REPLACE(CS.ORG_CUST_ADDR , CHR(10), ''), CHR(13), ''),1,240)  AS S_ORG_CUST_ADDR
      ,CC.CUST_CNT_CD     AS C_CUST_CNT_CD
      ,CC.DU_CUST_ID      AS C_DU_CUST_ID
      ,SUBSTR(REPLACE(REPLACE(CC.CUST_NM , CHR(10), ''), CHR(13), ''),1,48)         AS C_CUST_NM
      ,SUBSTR(REPLACE(REPLACE(CC.CUST_ADDR , CHR(10), ''), CHR(13), ''),1,240)      AS C_CUST_ADDR
      ,SUBSTR(REPLACE(REPLACE(CC.ORG_CUST_NM , CHR(10), ''), CHR(13), ''),1,30)     AS C_ORG_CUST_NM
      ,SUBSTR(REPLACE(REPLACE(CC.ORG_CUST_ADDR , CHR(10), ''), CHR(13), ''),1,240)  AS C_ORG_CUST_ADDR
      ,CN.CUST_CNT_CD     AS N_CUST_CNT_CD
      ,CN.DU_CUST_ID      AS N_DU_CUST_ID
      ,SUBSTR(REPLACE(REPLACE(CN.CUST_NM , CHR(10), ''), CHR(13), ''),1,48)         AS N_CUST_NM
      ,SUBSTR(REPLACE(REPLACE(CN.CUST_ADDR , CHR(10), ''), CHR(13), ''),1,240)      AS N_CUST_ADDR
  FROM BKG_CSTMS_DU_BL BL
      ,BKG_CSTMS_DU_CUST CS
      ,BKG_CSTMS_DU_CUST CC
      ,BKG_CSTMS_DU_CUST CN
      ,COM_INTG_CD_DTL C
      ,(
        SELECT B.BL_NO
              ,B.BL_TP_CD
              ,B.RC_FLG
          FROM BKG_BOOKING B
         WHERE BL_NO = @[bl_no]
       ) BKG
 WHERE BL.BL_NO = @[bl_no]
   AND BL.POD_CD = @[pod_cd]
   AND BKG.BL_NO = BL.BL_NO
   AND BL.BL_NO = CS.BL_NO(+)
   AND BL.POD_CD = CS.POD_CD(+)
   AND CS.BKG_CUST_TP_CD(+) = 'S'
   AND BL.BL_NO = CC.BL_NO(+)
   AND BL.POD_CD = CC.POD_CD(+)
   AND CC.BKG_CUST_TP_CD(+) = 'C'
   AND BL.BL_NO = CN.BL_NO(+)
   AND BL.POD_CD = CN.POD_CD(+)
   AND CN.BKG_CUST_TP_CD(+) = 'N'
   AND BL.DU_CNTR_SVC_TP_CD = C.INTG_CD_VAL_CTNT(+)
   AND C.INTG_CD_ID(+) = 'CD02560'			]]></sql>
			<params>
				<param name="bl_no" type="12" value="" out="N"/>
				<param name="pod_cd" type="12" value="" out="N"/>
			</params>
		</query>
	</querys>
</sqls>
