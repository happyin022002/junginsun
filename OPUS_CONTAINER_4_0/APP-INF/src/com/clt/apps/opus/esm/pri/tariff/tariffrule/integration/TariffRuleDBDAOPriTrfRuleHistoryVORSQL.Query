<?xml version="1.0" encoding="UTF-8"?>
<sqls>
	<querys>
		<query name="TariffRuleDBDAOPriTrfRuleHistoryVORSQL">
			<desc><![CDATA[Tariff Rule History 정보를 조회한다.]]></desc>
			<sql><![CDATA[
SELECT
       A.RNO,
       A.ORD1,
       A.ORD2,
       A.ORD3,
       A.ORD4,
       A.ORD5,
   
       A.TRF_PFX_CD
     , A.TRF_NO
     , A.TRF_RULE_NO
     , A.AMDT_SEQ
     , A.TRF_RULE_NM
  FROM (
SELECT
      TO_NUMBER(
      CASE 
          WHEN REGEXP_COUNT(A.RNO, '[0-9]{1}') = 1 AND REGEXP_COUNT(A.RNO, '[0-9]{2}') = 0 AND REGEXP_COUNT(A.RNO, '[0-9]{3}') = 0 AND REGEXP_COUNT(A.RNO, '[0-9]{4}') = 0 AND REGEXP_COUNT(A.RNO, '[0-9]{5}') = 0 AND REGEXP_INSTR(A.RNO, '[0-9]{1}', 1, 1, 0) = 1 AND REGEXP_INSTR(A.RNO, '[0-9]{1}', 1, 2, 0) = 0
               THEN SUBSTR(A.RNO,1,1)
          WHEN REGEXP_COUNT(A.RNO, '[0-9]{1}') = 1 AND REGEXP_COUNT(A.RNO, '[0-9]{2}') = 0 AND REGEXP_COUNT(A.RNO, '[0-9]{3}') = 0 AND REGEXP_COUNT(A.RNO, '[0-9]{4}') = 0 AND REGEXP_COUNT(A.RNO, '[0-9]{5}') = 0 AND REGEXP_INSTR(A.RNO, '[0-9]{1}', 1, 1, 0) = 2 AND REGEXP_INSTR(A.RNO, '[0-9]{1}', 1, 2, 0) = 0
               THEN LPAD(ASCII(SUBSTR(A.RNO,1,1)),8,'9')
          WHEN REGEXP_COUNT(A.RNO, '[0-9]{1}') = 1 AND REGEXP_COUNT(A.RNO, '[0-9]{2}') = 0 AND REGEXP_COUNT(A.RNO, '[0-9]{3}') = 0 AND REGEXP_COUNT(A.RNO, '[0-9]{4}') = 0 AND REGEXP_COUNT(A.RNO, '[0-9]{5}') = 0 AND REGEXP_INSTR(A.RNO, '[0-9]{1}', 1, 1, 0) = 3 AND REGEXP_INSTR(A.RNO, '[0-9]{1}', 1, 2, 0) = 0
               THEN LPAD(ASCII(SUBSTR(A.RNO,1,1)),8,'9')
          WHEN REGEXP_COUNT(A.RNO, '[0-9]{1}') = 1 AND REGEXP_COUNT(A.RNO, '[0-9]{2}') = 0 AND REGEXP_COUNT(A.RNO, '[0-9]{3}') = 0 AND REGEXP_COUNT(A.RNO, '[0-9]{4}') = 0 AND REGEXP_COUNT(A.RNO, '[0-9]{5}') = 0 AND REGEXP_INSTR(A.RNO, '[0-9]{1}', 1, 1, 0) = 4 AND REGEXP_INSTR(A.RNO, '[0-9]{1}', 1, 2, 0) = 0
               THEN LPAD(ASCII(SUBSTR(A.RNO,1,1)),8,'9')
          WHEN REGEXP_COUNT(A.RNO, '[0-9]{1}') = 1 AND REGEXP_COUNT(A.RNO, '[0-9]{2}') = 0 AND REGEXP_COUNT(A.RNO, '[0-9]{3}') = 0 AND REGEXP_COUNT(A.RNO, '[0-9]{4}') = 0 AND REGEXP_COUNT(A.RNO, '[0-9]{5}') = 0 AND REGEXP_INSTR(A.RNO, '[0-9]{1}', 1, 1, 0) = 5 AND REGEXP_INSTR(A.RNO, '[0-9]{1}', 1, 2, 0) = 0
               THEN LPAD(ASCII(SUBSTR(A.RNO,1,1)),8,'9')
          
          WHEN REGEXP_COUNT(A.RNO, '[0-9]{1}') = 2 AND REGEXP_COUNT(A.RNO, '[0-9]{2}') = 0 AND REGEXP_COUNT(A.RNO, '[0-9]{3}') = 0 AND REGEXP_COUNT(A.RNO, '[0-9]{4}') = 0 AND REGEXP_COUNT(A.RNO, '[0-9]{5}') = 0 AND REGEXP_INSTR(A.RNO, '[0-9]{1}', 1, 1, 0) = 1 AND REGEXP_INSTR(A.RNO, '[0-9]{1}', 1, 2, 0) = 3
               THEN SUBSTR(A.RNO,1,1)
          WHEN REGEXP_COUNT(A.RNO, '[0-9]{1}') = 2 AND REGEXP_COUNT(A.RNO, '[0-9]{2}') = 0 AND REGEXP_COUNT(A.RNO, '[0-9]{3}') = 0 AND REGEXP_COUNT(A.RNO, '[0-9]{4}') = 0 AND REGEXP_COUNT(A.RNO, '[0-9]{5}') = 0 AND REGEXP_INSTR(A.RNO, '[0-9]{1}', 1, 1, 0) = 1 AND REGEXP_INSTR(A.RNO, '[0-9]{1}', 1, 2, 0) = 4
               THEN SUBSTR(A.RNO,1,1)
          WHEN REGEXP_COUNT(A.RNO, '[0-9]{1}') = 2 AND REGEXP_COUNT(A.RNO, '[0-9]{2}') = 0 AND REGEXP_COUNT(A.RNO, '[0-9]{3}') = 0 AND REGEXP_COUNT(A.RNO, '[0-9]{4}') = 0 AND REGEXP_COUNT(A.RNO, '[0-9]{5}') = 0 AND REGEXP_INSTR(A.RNO, '[0-9]{1}', 1, 1, 0) = 1 AND REGEXP_INSTR(A.RNO, '[0-9]{1}', 1, 2, 0) = 5
               THEN SUBSTR(A.RNO,1,1)
               
          WHEN REGEXP_COUNT(A.RNO, '[0-9]{1}') = 2 AND REGEXP_COUNT(A.RNO, '[0-9]{2}') = 0 AND REGEXP_COUNT(A.RNO, '[0-9]{3}') = 0 AND REGEXP_COUNT(A.RNO, '[0-9]{4}') = 0 AND REGEXP_COUNT(A.RNO, '[0-9]{5}') = 0 AND REGEXP_INSTR(A.RNO, '[0-9]{1}', 1, 1, 0) = 2 AND REGEXP_INSTR(A.RNO, '[0-9]{1}', 1, 2, 0) = 4
               THEN LPAD(ASCII(SUBSTR(A.RNO,1,1)),8,'9')
          WHEN REGEXP_COUNT(A.RNO, '[0-9]{1}') = 2 AND REGEXP_COUNT(A.RNO, '[0-9]{2}') = 0 AND REGEXP_COUNT(A.RNO, '[0-9]{3}') = 0 AND REGEXP_COUNT(A.RNO, '[0-9]{4}') = 0 AND REGEXP_COUNT(A.RNO, '[0-9]{5}') = 0 AND REGEXP_INSTR(A.RNO, '[0-9]{1}', 1, 1, 0) = 2 AND REGEXP_INSTR(A.RNO, '[0-9]{1}', 1, 2, 0) = 5
               THEN LPAD(ASCII(SUBSTR(A.RNO,1,1)),8,'9')
          
          WHEN REGEXP_COUNT(A.RNO, '[0-9]{1}') = 2 AND REGEXP_COUNT(A.RNO, '[0-9]{2}') = 0 AND REGEXP_COUNT(A.RNO, '[0-9]{3}') = 0 AND REGEXP_COUNT(A.RNO, '[0-9]{4}') = 0 AND REGEXP_COUNT(A.RNO, '[0-9]{5}') = 0 AND REGEXP_INSTR(A.RNO, '[0-9]{1}', 1, 1, 0) = 3 AND REGEXP_INSTR(A.RNO, '[0-9]{1}', 1, 2, 0) = 5
               THEN LPAD(ASCII(SUBSTR(A.RNO,1,1)),8,'9')  
               
          WHEN REGEXP_COUNT(A.RNO, '[0-9]{1}') = 3 AND REGEXP_COUNT(A.RNO, '[0-9]{2}') = 0 AND REGEXP_COUNT(A.RNO, '[0-9]{3}') = 0 AND REGEXP_COUNT(A.RNO, '[0-9]{4}') = 0 AND REGEXP_COUNT(A.RNO, '[0-9]{5}') = 0 AND REGEXP_INSTR(A.RNO, '[0-9]{1}', 1, 1, 0) = 1 AND REGEXP_INSTR(A.RNO, '[0-9]{1}', 1, 2, 0) = 3
               THEN SUBSTR(A.RNO,1,1)
            
               
          WHEN REGEXP_COUNT(A.RNO, '[0-9]{2}') = 1 AND REGEXP_COUNT(A.RNO, '[0-9]{3}') = 0 AND REGEXP_COUNT(A.RNO, '[0-9]{4}') = 0 AND REGEXP_COUNT(A.RNO, '[0-9]{5}') = 0 AND REGEXP_INSTR(A.RNO, '[0-9]{2}', 1, 1, 0) = 1
               THEN SUBSTR(A.RNO,1,2)
          WHEN REGEXP_COUNT(A.RNO, '[0-9]{2}') = 1 AND REGEXP_COUNT(A.RNO, '[0-9]{3}') = 0 AND REGEXP_COUNT(A.RNO, '[0-9]{4}') = 0 AND REGEXP_COUNT(A.RNO, '[0-9]{5}') = 0 AND REGEXP_INSTR(A.RNO, '[0-9]{2}', 1, 1, 0) = 2
               THEN LPAD(ASCII(SUBSTR(A.RNO,1,1)),8,'9')
          WHEN REGEXP_COUNT(A.RNO, '[0-9]{2}') = 1 AND REGEXP_COUNT(A.RNO, '[0-9]{3}') = 0 AND REGEXP_COUNT(A.RNO, '[0-9]{4}') = 0 AND REGEXP_COUNT(A.RNO, '[0-9]{5}') = 0 AND REGEXP_INSTR(A.RNO, '[0-9]{2}', 1, 1, 0) = 3
               THEN DECODE( REGEXP_INSTR( SUBSTR(A.RNO,1,1), '[0-9]'), 1, SUBSTR(A.RNO,1,1), LPAD(ASCII(SUBSTR(A.RNO,1,1)),8,'9'))
          WHEN REGEXP_COUNT(A.RNO, '[0-9]{2}') = 1 AND REGEXP_COUNT(A.RNO, '[0-9]{3}') = 0 AND REGEXP_COUNT(A.RNO, '[0-9]{4}') = 0 AND REGEXP_COUNT(A.RNO, '[0-9]{5}') = 0 AND REGEXP_INSTR(A.RNO, '[0-9]{2}', 1, 1, 0) = 4
               THEN DECODE( REGEXP_INSTR( SUBSTR(A.RNO,1,1), '[0-9]'), 1, SUBSTR(A.RNO,1,1), LPAD(ASCII(SUBSTR(A.RNO,1,1)),8,'9'))
  
          WHEN REGEXP_COUNT(A.RNO, '[0-9]{2}') = 2 AND REGEXP_COUNT(A.RNO, '[0-9]{3}') = 0 AND REGEXP_COUNT(A.RNO, '[0-9]{4}') = 0 AND REGEXP_COUNT(A.RNO, '[0-9]{5}') = 0 AND REGEXP_INSTR(A.RNO, '[0-9]{2}', 1, 1, 0) = 1
               THEN SUBSTR(A.RNO,1,2)
               
          WHEN REGEXP_COUNT(A.RNO, '[0-9]{3}') = 1 AND REGEXP_COUNT(A.RNO, '[0-9]{4}') = 0 AND REGEXP_COUNT(A.RNO, '[0-9]{5}') = 0 AND REGEXP_INSTR(A.RNO, '[0-9]{3}', 1, 1, 0) = 1
               THEN SUBSTR(A.RNO,1,3)
          WHEN REGEXP_COUNT(A.RNO, '[0-9]{3}') = 1 AND REGEXP_COUNT(A.RNO, '[0-9]{4}') = 0 AND REGEXP_COUNT(A.RNO, '[0-9]{5}') = 0 AND REGEXP_INSTR(A.RNO, '[0-9]{3}', 1, 1, 0) = 2
               THEN LPAD(ASCII(SUBSTR(A.RNO,1,1)),8,'9')
          WHEN REGEXP_COUNT(A.RNO, '[0-9]{3}') = 1 AND REGEXP_COUNT(A.RNO, '[0-9]{4}') = 0 AND REGEXP_COUNT(A.RNO, '[0-9]{5}') = 0 AND REGEXP_INSTR(A.RNO, '[0-9]{3}', 1, 1, 0) = 3
               THEN DECODE( REGEXP_INSTR( SUBSTR(A.RNO,1,1), '[0-9]'), 1, SUBSTR(A.RNO,1,1), LPAD(ASCII(SUBSTR(A.RNO,1,1)),8,'9'))
          
          WHEN REGEXP_COUNT(A.RNO, '[0-9]{4}') = 1 AND REGEXP_COUNT(A.RNO, '[0-9]{5}') = 0 AND REGEXP_INSTR(A.RNO, '[0-9]{4}', 1, 1, 0) = 1
               THEN SUBSTR(A.RNO,1,4)
          WHEN REGEXP_COUNT(A.RNO, '[0-9]{4}') = 1 AND REGEXP_COUNT(A.RNO, '[0-9]{5}') = 0 AND REGEXP_INSTR(A.RNO, '[0-9]{4}', 1, 1, 0) = 2
               THEN LPAD(ASCII(SUBSTR(A.RNO,1,1)),8,'9')

          WHEN REGEXP_COUNT(A.RNO, '[0-9]{5}') = 1 
               THEN SUBSTR(A.RNO,1,5)   
          
      END) ORD1,
     
     TO_NUMBER(
     CASE 
          WHEN REGEXP_COUNT(A.RNO, '[0-9]{1}') = 1 AND REGEXP_COUNT(A.RNO, '[0-9]{2}') = 0 AND REGEXP_COUNT(A.RNO, '[0-9]{3}') = 0 AND REGEXP_COUNT(A.RNO, '[0-9]{4}') = 0 AND REGEXP_COUNT(A.RNO, '[0-9]{5}') = 0 AND REGEXP_INSTR(A.RNO, '[0-9]{1}', 1, 1, 0) = 1 AND REGEXP_INSTR(A.RNO, '[0-9]{1}', 1, 2, 0) = 0
               THEN LPAD(ASCII(SUBSTR(A.RNO,2,1)),8,'9')
          WHEN REGEXP_COUNT(A.RNO, '[0-9]{1}') = 1 AND REGEXP_COUNT(A.RNO, '[0-9]{2}') = 0 AND REGEXP_COUNT(A.RNO, '[0-9]{3}') = 0 AND REGEXP_COUNT(A.RNO, '[0-9]{4}') = 0 AND REGEXP_COUNT(A.RNO, '[0-9]{5}') = 0 AND REGEXP_INSTR(A.RNO, '[0-9]{1}', 1, 1, 0) = 2 AND REGEXP_INSTR(A.RNO, '[0-9]{1}', 1, 2, 0) = 0
               THEN SUBSTR(A.RNO,2,1)
          WHEN REGEXP_COUNT(A.RNO, '[0-9]{1}') = 1 AND REGEXP_COUNT(A.RNO, '[0-9]{2}') = 0 AND REGEXP_COUNT(A.RNO, '[0-9]{3}') = 0 AND REGEXP_COUNT(A.RNO, '[0-9]{4}') = 0 AND REGEXP_COUNT(A.RNO, '[0-9]{5}') = 0 AND REGEXP_INSTR(A.RNO, '[0-9]{1}', 1, 1, 0) = 3 AND REGEXP_INSTR(A.RNO, '[0-9]{1}', 1, 2, 0) = 0
               THEN LPAD(ASCII(SUBSTR(A.RNO,2,1)),8,'9')
          WHEN REGEXP_COUNT(A.RNO, '[0-9]{1}') = 1 AND REGEXP_COUNT(A.RNO, '[0-9]{2}') = 0 AND REGEXP_COUNT(A.RNO, '[0-9]{3}') = 0 AND REGEXP_COUNT(A.RNO, '[0-9]{4}') = 0 AND REGEXP_COUNT(A.RNO, '[0-9]{5}') = 0 AND REGEXP_INSTR(A.RNO, '[0-9]{1}', 1, 1, 0) = 4 AND REGEXP_INSTR(A.RNO, '[0-9]{1}', 1, 2, 0) = 0
               THEN LPAD(ASCII(SUBSTR(A.RNO,2,1)),8,'9')
          WHEN REGEXP_COUNT(A.RNO, '[0-9]{1}') = 1 AND REGEXP_COUNT(A.RNO, '[0-9]{2}') = 0 AND REGEXP_COUNT(A.RNO, '[0-9]{3}') = 0 AND REGEXP_COUNT(A.RNO, '[0-9]{4}') = 0 AND REGEXP_COUNT(A.RNO, '[0-9]{5}') = 0 AND REGEXP_INSTR(A.RNO, '[0-9]{1}', 1, 1, 0) = 5 AND REGEXP_INSTR(A.RNO, '[0-9]{1}', 1, 2, 0) = 0
               THEN LPAD(ASCII(SUBSTR(A.RNO,2,1)),8,'9')
          
          WHEN REGEXP_COUNT(A.RNO, '[0-9]{1}') = 2 AND REGEXP_COUNT(A.RNO, '[0-9]{2}') = 0 AND REGEXP_COUNT(A.RNO, '[0-9]{3}') = 0 AND REGEXP_COUNT(A.RNO, '[0-9]{4}') = 0 AND REGEXP_COUNT(A.RNO, '[0-9]{5}') = 0 AND REGEXP_INSTR(A.RNO, '[0-9]{1}', 1, 1, 0) = 1 AND REGEXP_INSTR(A.RNO, '[0-9]{1}', 1, 2, 0) = 3
               THEN LPAD(ASCII(SUBSTR(A.RNO,2,1)),8,'9')
          WHEN REGEXP_COUNT(A.RNO, '[0-9]{1}') = 2 AND REGEXP_COUNT(A.RNO, '[0-9]{2}') = 0 AND REGEXP_COUNT(A.RNO, '[0-9]{3}') = 0 AND REGEXP_COUNT(A.RNO, '[0-9]{4}') = 0 AND REGEXP_COUNT(A.RNO, '[0-9]{5}') = 0 AND REGEXP_INSTR(A.RNO, '[0-9]{1}', 1, 1, 0) = 1 AND REGEXP_INSTR(A.RNO, '[0-9]{1}', 1, 2, 0) = 4
               THEN LPAD(ASCII(SUBSTR(A.RNO,2,1)),8,'9')
          WHEN REGEXP_COUNT(A.RNO, '[0-9]{1}') = 2 AND REGEXP_COUNT(A.RNO, '[0-9]{2}') = 0 AND REGEXP_COUNT(A.RNO, '[0-9]{3}') = 0 AND REGEXP_COUNT(A.RNO, '[0-9]{4}') = 0 AND REGEXP_COUNT(A.RNO, '[0-9]{5}') = 0 AND REGEXP_INSTR(A.RNO, '[0-9]{1}', 1, 1, 0) = 1 AND REGEXP_INSTR(A.RNO, '[0-9]{1}', 1, 2, 0) = 5
               THEN LPAD(ASCII(SUBSTR(A.RNO,2,1)),8,'9')
               
          WHEN REGEXP_COUNT(A.RNO, '[0-9]{1}') = 2 AND REGEXP_COUNT(A.RNO, '[0-9]{2}') = 0 AND REGEXP_COUNT(A.RNO, '[0-9]{3}') = 0 AND REGEXP_COUNT(A.RNO, '[0-9]{4}') = 0 AND REGEXP_COUNT(A.RNO, '[0-9]{5}') = 0 AND REGEXP_INSTR(A.RNO, '[0-9]{1}', 1, 1, 0) = 2 AND REGEXP_INSTR(A.RNO, '[0-9]{1}', 1, 2, 0) = 4
               THEN SUBSTR(A.RNO,2,1)
          WHEN REGEXP_COUNT(A.RNO, '[0-9]{1}') = 2 AND REGEXP_COUNT(A.RNO, '[0-9]{2}') = 0 AND REGEXP_COUNT(A.RNO, '[0-9]{3}') = 0 AND REGEXP_COUNT(A.RNO, '[0-9]{4}') = 0 AND REGEXP_COUNT(A.RNO, '[0-9]{5}') = 0 AND REGEXP_INSTR(A.RNO, '[0-9]{1}', 1, 1, 0) = 2 AND REGEXP_INSTR(A.RNO, '[0-9]{1}', 1, 2, 0) = 5
               THEN SUBSTR(A.RNO,2,1)
          
          WHEN REGEXP_COUNT(A.RNO, '[0-9]{1}') = 2 AND REGEXP_COUNT(A.RNO, '[0-9]{2}') = 0 AND REGEXP_COUNT(A.RNO, '[0-9]{3}') = 0 AND REGEXP_COUNT(A.RNO, '[0-9]{4}') = 0 AND REGEXP_COUNT(A.RNO, '[0-9]{5}') = 0 AND REGEXP_INSTR(A.RNO, '[0-9]{1}', 1, 1, 0) = 3 AND REGEXP_INSTR(A.RNO, '[0-9]{1}', 1, 2, 0) = 5
               THEN LPAD(ASCII(SUBSTR(A.RNO,2,1)),8,'9')     
               
          WHEN REGEXP_COUNT(A.RNO, '[0-9]{1}') = 3 AND REGEXP_COUNT(A.RNO, '[0-9]{2}') = 0 AND REGEXP_COUNT(A.RNO, '[0-9]{3}') = 0 AND REGEXP_COUNT(A.RNO, '[0-9]{4}') = 0 AND REGEXP_COUNT(A.RNO, '[0-9]{5}') = 0 AND REGEXP_INSTR(A.RNO, '[0-9]{1}', 1, 1, 0) = 1 AND REGEXP_INSTR(A.RNO, '[0-9]{1}', 1, 2, 0) = 3
               THEN LPAD(ASCII(SUBSTR(A.RNO,2,1)),8,'9')     
            
               
          WHEN REGEXP_COUNT(A.RNO, '[0-9]{2}') = 1 AND REGEXP_COUNT(A.RNO, '[0-9]{3}') = 0 AND REGEXP_COUNT(A.RNO, '[0-9]{4}') = 0 AND REGEXP_COUNT(A.RNO, '[0-9]{5}') = 0 AND REGEXP_INSTR(A.RNO, '[0-9]{2}', 1, 1, 0) = 1
               THEN DECODE( REGEXP_INSTR( SUBSTR(A.RNO,3,1), '[0-9]'), 1, SUBSTR(A.RNO,3,1), LPAD(ASCII(SUBSTR(A.RNO,3,1)),8,'9'))
          WHEN REGEXP_COUNT(A.RNO, '[0-9]{2}') = 1 AND REGEXP_COUNT(A.RNO, '[0-9]{3}') = 0 AND REGEXP_COUNT(A.RNO, '[0-9]{4}') = 0 AND REGEXP_COUNT(A.RNO, '[0-9]{5}') = 0 AND REGEXP_INSTR(A.RNO, '[0-9]{2}', 1, 1, 0) = 2
               THEN SUBSTR(A.RNO,2,2)
          WHEN REGEXP_COUNT(A.RNO, '[0-9]{2}') = 1 AND REGEXP_COUNT(A.RNO, '[0-9]{3}') = 0 AND REGEXP_COUNT(A.RNO, '[0-9]{4}') = 0 AND REGEXP_COUNT(A.RNO, '[0-9]{5}') = 0 AND REGEXP_INSTR(A.RNO, '[0-9]{2}', 1, 1, 0) = 3
               THEN DECODE( REGEXP_INSTR( SUBSTR(A.RNO,2,1), '[0-9]'), 1, SUBSTR(A.RNO,2,1), LPAD(ASCII(SUBSTR(A.RNO,2,1)),8,'9'))
          WHEN REGEXP_COUNT(A.RNO, '[0-9]{2}') = 1 AND REGEXP_COUNT(A.RNO, '[0-9]{3}') = 0 AND REGEXP_COUNT(A.RNO, '[0-9]{4}') = 0 AND REGEXP_COUNT(A.RNO, '[0-9]{5}') = 0 AND REGEXP_INSTR(A.RNO, '[0-9]{2}', 1, 1, 0) = 4
               THEN DECODE( REGEXP_INSTR( SUBSTR(A.RNO,2,1), '[0-9]'), 1, SUBSTR(A.RNO,2,1), LPAD(ASCII(SUBSTR(A.RNO,2,1)),8,'9'))
  
          WHEN REGEXP_COUNT(A.RNO, '[0-9]{2}') = 2 AND REGEXP_COUNT(A.RNO, '[0-9]{3}') = 0 AND REGEXP_COUNT(A.RNO, '[0-9]{4}') = 0 AND REGEXP_COUNT(A.RNO, '[0-9]{5}') = 0 AND REGEXP_INSTR(A.RNO, '[0-9]{2}', 1, 1, 0) = 1
               THEN LPAD(ASCII(SUBSTR(A.RNO,3,1)),8,'9')
               
          WHEN REGEXP_COUNT(A.RNO, '[0-9]{3}') = 1 AND REGEXP_COUNT(A.RNO, '[0-9]{4}') = 0 AND REGEXP_COUNT(A.RNO, '[0-9]{5}') = 0 AND REGEXP_INSTR(A.RNO, '[0-9]{3}', 1, 1, 0) = 1
               THEN DECODE( REGEXP_INSTR( SUBSTR(A.RNO,4,1), '[0-9]'), 1, SUBSTR(A.RNO,4,1), LPAD(ASCII(SUBSTR(A.RNO,4,1)),8,'9'))
          WHEN REGEXP_COUNT(A.RNO, '[0-9]{3}') = 1 AND REGEXP_COUNT(A.RNO, '[0-9]{4}') = 0 AND REGEXP_COUNT(A.RNO, '[0-9]{5}') = 0 AND REGEXP_INSTR(A.RNO, '[0-9]{3}', 1, 1, 0) = 2
               THEN SUBSTR(A.RNO,2,3)
          WHEN REGEXP_COUNT(A.RNO, '[0-9]{3}') = 1 AND REGEXP_COUNT(A.RNO, '[0-9]{4}') = 0 AND REGEXP_COUNT(A.RNO, '[0-9]{5}') = 0 AND REGEXP_INSTR(A.RNO, '[0-9]{3}', 1, 1, 0) = 3
               THEN DECODE( REGEXP_INSTR( SUBSTR(A.RNO,2,1), '[0-9]'), 1, SUBSTR(A.RNO,2,1), LPAD(ASCII(SUBSTR(A.RNO,2,1)),8,'9'))
          
          WHEN REGEXP_COUNT(A.RNO, '[0-9]{4}') = 1 AND REGEXP_COUNT(A.RNO, '[0-9]{5}') = 0 AND REGEXP_INSTR(A.RNO, '[0-9]{4}', 1, 1, 0) = 1
               THEN LPAD(ASCII(SUBSTR(A.RNO,5,1)),8,'9')
          WHEN REGEXP_COUNT(A.RNO, '[0-9]{4}') = 1 AND REGEXP_COUNT(A.RNO, '[0-9]{5}') = 0 AND REGEXP_INSTR(A.RNO, '[0-9]{4}', 1, 1, 0) = 2
               THEN SUBSTR(A.RNO,2,4)

          WHEN REGEXP_COUNT(A.RNO, '[0-9]{5}') = 1 
               THEN '0'   
          
      END) ORD2,
     
     TO_NUMBER(
     CASE 
          WHEN REGEXP_COUNT(A.RNO, '[0-9]{1}') = 1 AND REGEXP_COUNT(A.RNO, '[0-9]{2}') = 0 AND REGEXP_COUNT(A.RNO, '[0-9]{3}') = 0 AND REGEXP_COUNT(A.RNO, '[0-9]{4}') = 0 AND REGEXP_COUNT(A.RNO, '[0-9]{5}') = 0 AND REGEXP_INSTR(A.RNO, '[0-9]{1}', 1, 1, 0) = 1 AND REGEXP_INSTR(A.RNO, '[0-9]{1}', 1, 2, 0) = 0
               THEN LPAD(ASCII(SUBSTR(A.RNO,3,1)),8,'9')
          WHEN REGEXP_COUNT(A.RNO, '[0-9]{1}') = 1 AND REGEXP_COUNT(A.RNO, '[0-9]{2}') = 0 AND REGEXP_COUNT(A.RNO, '[0-9]{3}') = 0 AND REGEXP_COUNT(A.RNO, '[0-9]{4}') = 0 AND REGEXP_COUNT(A.RNO, '[0-9]{5}') = 0 AND REGEXP_INSTR(A.RNO, '[0-9]{1}', 1, 1, 0) = 2 AND REGEXP_INSTR(A.RNO, '[0-9]{1}', 1, 2, 0) = 0
               THEN LPAD(ASCII(SUBSTR(A.RNO,3,1)),8,'9')
          WHEN REGEXP_COUNT(A.RNO, '[0-9]{1}') = 1 AND REGEXP_COUNT(A.RNO, '[0-9]{2}') = 0 AND REGEXP_COUNT(A.RNO, '[0-9]{3}') = 0 AND REGEXP_COUNT(A.RNO, '[0-9]{4}') = 0 AND REGEXP_COUNT(A.RNO, '[0-9]{5}') = 0 AND REGEXP_INSTR(A.RNO, '[0-9]{1}', 1, 1, 0) = 3 AND REGEXP_INSTR(A.RNO, '[0-9]{1}', 1, 2, 0) = 0
               THEN SUBSTR(A.RNO,3,1)
          WHEN REGEXP_COUNT(A.RNO, '[0-9]{1}') = 1 AND REGEXP_COUNT(A.RNO, '[0-9]{2}') = 0 AND REGEXP_COUNT(A.RNO, '[0-9]{3}') = 0 AND REGEXP_COUNT(A.RNO, '[0-9]{4}') = 0 AND REGEXP_COUNT(A.RNO, '[0-9]{5}') = 0 AND REGEXP_INSTR(A.RNO, '[0-9]{1}', 1, 1, 0) = 4 AND REGEXP_INSTR(A.RNO, '[0-9]{1}', 1, 2, 0) = 0
               THEN LPAD(ASCII(SUBSTR(A.RNO,3,1)),8,'9')
          WHEN REGEXP_COUNT(A.RNO, '[0-9]{1}') = 1 AND REGEXP_COUNT(A.RNO, '[0-9]{2}') = 0 AND REGEXP_COUNT(A.RNO, '[0-9]{3}') = 0 AND REGEXP_COUNT(A.RNO, '[0-9]{4}') = 0 AND REGEXP_COUNT(A.RNO, '[0-9]{5}') = 0 AND REGEXP_INSTR(A.RNO, '[0-9]{1}', 1, 1, 0) = 5 AND REGEXP_INSTR(A.RNO, '[0-9]{1}', 1, 2, 0) = 0
               THEN LPAD(ASCII(SUBSTR(A.RNO,3,1)),8,'9')
          
          WHEN REGEXP_COUNT(A.RNO, '[0-9]{1}') = 2 AND REGEXP_COUNT(A.RNO, '[0-9]{2}') = 0 AND REGEXP_COUNT(A.RNO, '[0-9]{3}') = 0 AND REGEXP_COUNT(A.RNO, '[0-9]{4}') = 0 AND REGEXP_COUNT(A.RNO, '[0-9]{5}') = 0 AND REGEXP_INSTR(A.RNO, '[0-9]{1}', 1, 1, 0) = 1 AND REGEXP_INSTR(A.RNO, '[0-9]{1}', 1, 2, 0) = 3
               THEN SUBSTR(A.RNO,3,1)
          WHEN REGEXP_COUNT(A.RNO, '[0-9]{1}') = 2 AND REGEXP_COUNT(A.RNO, '[0-9]{2}') = 0 AND REGEXP_COUNT(A.RNO, '[0-9]{3}') = 0 AND REGEXP_COUNT(A.RNO, '[0-9]{4}') = 0 AND REGEXP_COUNT(A.RNO, '[0-9]{5}') = 0 AND REGEXP_INSTR(A.RNO, '[0-9]{1}', 1, 1, 0) = 1 AND REGEXP_INSTR(A.RNO, '[0-9]{1}', 1, 2, 0) = 4
               THEN LPAD(ASCII(SUBSTR(A.RNO,3,1)),8,'9')
          WHEN REGEXP_COUNT(A.RNO, '[0-9]{1}') = 2 AND REGEXP_COUNT(A.RNO, '[0-9]{2}') = 0 AND REGEXP_COUNT(A.RNO, '[0-9]{3}') = 0 AND REGEXP_COUNT(A.RNO, '[0-9]{4}') = 0 AND REGEXP_COUNT(A.RNO, '[0-9]{5}') = 0 AND REGEXP_INSTR(A.RNO, '[0-9]{1}', 1, 1, 0) = 1 AND REGEXP_INSTR(A.RNO, '[0-9]{1}', 1, 2, 0) = 5
               THEN LPAD(ASCII(SUBSTR(A.RNO,3,1)),8,'9')
               
          WHEN REGEXP_COUNT(A.RNO, '[0-9]{1}') = 2 AND REGEXP_COUNT(A.RNO, '[0-9]{2}') = 0 AND REGEXP_COUNT(A.RNO, '[0-9]{3}') = 0 AND REGEXP_COUNT(A.RNO, '[0-9]{4}') = 0 AND REGEXP_COUNT(A.RNO, '[0-9]{5}') = 0 AND REGEXP_INSTR(A.RNO, '[0-9]{1}', 1, 1, 0) = 2 AND REGEXP_INSTR(A.RNO, '[0-9]{1}', 1, 2, 0) = 4
               THEN LPAD(ASCII(SUBSTR(A.RNO,3,1)),8,'9')
          WHEN REGEXP_COUNT(A.RNO, '[0-9]{1}') = 2 AND REGEXP_COUNT(A.RNO, '[0-9]{2}') = 0 AND REGEXP_COUNT(A.RNO, '[0-9]{3}') = 0 AND REGEXP_COUNT(A.RNO, '[0-9]{4}') = 0 AND REGEXP_COUNT(A.RNO, '[0-9]{5}') = 0 AND REGEXP_INSTR(A.RNO, '[0-9]{1}', 1, 1, 0) = 2 AND REGEXP_INSTR(A.RNO, '[0-9]{1}', 1, 2, 0) = 5
               THEN LPAD(ASCII(SUBSTR(A.RNO,3,1)),8,'9')
          
          WHEN REGEXP_COUNT(A.RNO, '[0-9]{1}') = 2 AND REGEXP_COUNT(A.RNO, '[0-9]{2}') = 0 AND REGEXP_COUNT(A.RNO, '[0-9]{3}') = 0 AND REGEXP_COUNT(A.RNO, '[0-9]{4}') = 0 AND REGEXP_COUNT(A.RNO, '[0-9]{5}') = 0 AND REGEXP_INSTR(A.RNO, '[0-9]{1}', 1, 1, 0) = 3 AND REGEXP_INSTR(A.RNO, '[0-9]{1}', 1, 2, 0) = 5
               THEN SUBSTR(A.RNO,3,1)
               
          WHEN REGEXP_COUNT(A.RNO, '[0-9]{1}') = 3 AND REGEXP_COUNT(A.RNO, '[0-9]{2}') = 0 AND REGEXP_COUNT(A.RNO, '[0-9]{3}') = 0 AND REGEXP_COUNT(A.RNO, '[0-9]{4}') = 0 AND REGEXP_COUNT(A.RNO, '[0-9]{5}') = 0 AND REGEXP_INSTR(A.RNO, '[0-9]{1}', 1, 1, 0) = 1 AND REGEXP_INSTR(A.RNO, '[0-9]{1}', 1, 2, 0) = 3
               THEN SUBSTR(A.RNO,3,1)
            
               
          WHEN REGEXP_COUNT(A.RNO, '[0-9]{2}') = 1 AND REGEXP_COUNT(A.RNO, '[0-9]{3}') = 0 AND REGEXP_COUNT(A.RNO, '[0-9]{4}') = 0 AND REGEXP_COUNT(A.RNO, '[0-9]{5}') = 0 AND REGEXP_INSTR(A.RNO, '[0-9]{2}', 1, 1, 0) = 1
               THEN DECODE( REGEXP_INSTR( SUBSTR(A.RNO,4,1), '[0-9]'), 1, SUBSTR(A.RNO,4,1), LPAD(ASCII(SUBSTR(A.RNO,4,1)),8,'9'))
          WHEN REGEXP_COUNT(A.RNO, '[0-9]{2}') = 1 AND REGEXP_COUNT(A.RNO, '[0-9]{3}') = 0 AND REGEXP_COUNT(A.RNO, '[0-9]{4}') = 0 AND REGEXP_COUNT(A.RNO, '[0-9]{5}') = 0 AND REGEXP_INSTR(A.RNO, '[0-9]{2}', 1, 1, 0) = 2
               THEN DECODE( REGEXP_INSTR( SUBSTR(A.RNO,4,1), '[0-9]'), 1, SUBSTR(A.RNO,4,1), LPAD(ASCII(SUBSTR(A.RNO,4,1)),8,'9'))
          WHEN REGEXP_COUNT(A.RNO, '[0-9]{2}') = 1 AND REGEXP_COUNT(A.RNO, '[0-9]{3}') = 0 AND REGEXP_COUNT(A.RNO, '[0-9]{4}') = 0 AND REGEXP_COUNT(A.RNO, '[0-9]{5}') = 0 AND REGEXP_INSTR(A.RNO, '[0-9]{2}', 1, 1, 0) = 3
               THEN SUBSTR(A.RNO,3,2)
          WHEN REGEXP_COUNT(A.RNO, '[0-9]{2}') = 1 AND REGEXP_COUNT(A.RNO, '[0-9]{3}') = 0 AND REGEXP_COUNT(A.RNO, '[0-9]{4}') = 0 AND REGEXP_COUNT(A.RNO, '[0-9]{5}') = 0 AND REGEXP_INSTR(A.RNO, '[0-9]{2}', 1, 1, 0) = 4
               THEN DECODE( REGEXP_INSTR( SUBSTR(A.RNO,3,1), '[0-9]'), 1, SUBSTR(A.RNO,3,1), LPAD(ASCII(SUBSTR(A.RNO,3,1)),8,'9'))
  
          WHEN REGEXP_COUNT(A.RNO, '[0-9]{2}') = 2 AND REGEXP_COUNT(A.RNO, '[0-9]{3}') = 0 AND REGEXP_COUNT(A.RNO, '[0-9]{4}') = 0 AND REGEXP_COUNT(A.RNO, '[0-9]{5}') = 0 AND REGEXP_INSTR(A.RNO, '[0-9]{2}', 1, 1, 0) = 1
               THEN SUBSTR(A.RNO,4,2)
               
          WHEN REGEXP_COUNT(A.RNO, '[0-9]{3}') = 1 AND REGEXP_COUNT(A.RNO, '[0-9]{4}') = 0 AND REGEXP_COUNT(A.RNO, '[0-9]{5}') = 0 AND REGEXP_INSTR(A.RNO, '[0-9]{3}', 1, 1, 0) = 1
               THEN DECODE( REGEXP_INSTR( SUBSTR(A.RNO,5,1), '[0-9]'), 1, SUBSTR(A.RNO,5,1), LPAD(ASCII(SUBSTR(A.RNO,5,1)),8,'9'))
          WHEN REGEXP_COUNT(A.RNO, '[0-9]{3}') = 1 AND REGEXP_COUNT(A.RNO, '[0-9]{4}') = 0 AND REGEXP_COUNT(A.RNO, '[0-9]{5}') = 0 AND REGEXP_INSTR(A.RNO, '[0-9]{3}', 1, 1, 0) = 2
               THEN DECODE( REGEXP_INSTR( SUBSTR(A.RNO,5,1), '[0-9]'), 1, SUBSTR(A.RNO,5,1), LPAD(ASCII(SUBSTR(A.RNO,5,1)),8,'9'))
          WHEN REGEXP_COUNT(A.RNO, '[0-9]{3}') = 1 AND REGEXP_COUNT(A.RNO, '[0-9]{4}') = 0 AND REGEXP_COUNT(A.RNO, '[0-9]{5}') = 0 AND REGEXP_INSTR(A.RNO, '[0-9]{3}', 1, 1, 0) = 3
               THEN SUBSTR(A.RNO,3,3)
          
          WHEN REGEXP_COUNT(A.RNO, '[0-9]{4}') = 1 AND REGEXP_COUNT(A.RNO, '[0-9]{5}') = 0 AND REGEXP_INSTR(A.RNO, '[0-9]{4}', 1, 1, 0) = 1
               THEN '0'
          WHEN REGEXP_COUNT(A.RNO, '[0-9]{4}') = 1 AND REGEXP_COUNT(A.RNO, '[0-9]{5}') = 0 AND REGEXP_INSTR(A.RNO, '[0-9]{4}', 1, 1, 0) = 2
               THEN '0'

          WHEN REGEXP_COUNT(A.RNO, '[0-9]{5}') = 1 
               THEN '0'   
          
      END) ORD3,
      
      TO_NUMBER(
      CASE 
          WHEN REGEXP_COUNT(A.RNO, '[0-9]{1}') = 1 AND REGEXP_COUNT(A.RNO, '[0-9]{2}') = 0 AND REGEXP_COUNT(A.RNO, '[0-9]{3}') = 0 AND REGEXP_COUNT(A.RNO, '[0-9]{4}') = 0 AND REGEXP_COUNT(A.RNO, '[0-9]{5}') = 0 AND REGEXP_INSTR(A.RNO, '[0-9]{1}', 1, 1, 0) = 1 AND REGEXP_INSTR(A.RNO, '[0-9]{1}', 1, 2, 0) = 0
               THEN LPAD(ASCII(SUBSTR(A.RNO,4,1)),8,'9')
          WHEN REGEXP_COUNT(A.RNO, '[0-9]{1}') = 1 AND REGEXP_COUNT(A.RNO, '[0-9]{2}') = 0 AND REGEXP_COUNT(A.RNO, '[0-9]{3}') = 0 AND REGEXP_COUNT(A.RNO, '[0-9]{4}') = 0 AND REGEXP_COUNT(A.RNO, '[0-9]{5}') = 0 AND REGEXP_INSTR(A.RNO, '[0-9]{1}', 1, 1, 0) = 2 AND REGEXP_INSTR(A.RNO, '[0-9]{1}', 1, 2, 0) = 0
               THEN LPAD(ASCII(SUBSTR(A.RNO,4,1)),8,'9')
          WHEN REGEXP_COUNT(A.RNO, '[0-9]{1}') = 1 AND REGEXP_COUNT(A.RNO, '[0-9]{2}') = 0 AND REGEXP_COUNT(A.RNO, '[0-9]{3}') = 0 AND REGEXP_COUNT(A.RNO, '[0-9]{4}') = 0 AND REGEXP_COUNT(A.RNO, '[0-9]{5}') = 0 AND REGEXP_INSTR(A.RNO, '[0-9]{1}', 1, 1, 0) = 3 AND REGEXP_INSTR(A.RNO, '[0-9]{1}', 1, 2, 0) = 0
               THEN LPAD(ASCII(SUBSTR(A.RNO,4,1)),8,'9')
          WHEN REGEXP_COUNT(A.RNO, '[0-9]{1}') = 1 AND REGEXP_COUNT(A.RNO, '[0-9]{2}') = 0 AND REGEXP_COUNT(A.RNO, '[0-9]{3}') = 0 AND REGEXP_COUNT(A.RNO, '[0-9]{4}') = 0 AND REGEXP_COUNT(A.RNO, '[0-9]{5}') = 0 AND REGEXP_INSTR(A.RNO, '[0-9]{1}', 1, 1, 0) = 4 AND REGEXP_INSTR(A.RNO, '[0-9]{1}', 1, 2, 0) = 0
               THEN SUBSTR(A.RNO,4,1)
          WHEN REGEXP_COUNT(A.RNO, '[0-9]{1}') = 1 AND REGEXP_COUNT(A.RNO, '[0-9]{2}') = 0 AND REGEXP_COUNT(A.RNO, '[0-9]{3}') = 0 AND REGEXP_COUNT(A.RNO, '[0-9]{4}') = 0 AND REGEXP_COUNT(A.RNO, '[0-9]{5}') = 0 AND REGEXP_INSTR(A.RNO, '[0-9]{1}', 1, 1, 0) = 5 AND REGEXP_INSTR(A.RNO, '[0-9]{1}', 1, 2, 0) = 0
               THEN LPAD(ASCII(SUBSTR(A.RNO,4,1)),8,'9')
          
          WHEN REGEXP_COUNT(A.RNO, '[0-9]{1}') = 2 AND REGEXP_COUNT(A.RNO, '[0-9]{2}') = 0 AND REGEXP_COUNT(A.RNO, '[0-9]{3}') = 0 AND REGEXP_COUNT(A.RNO, '[0-9]{4}') = 0 AND REGEXP_COUNT(A.RNO, '[0-9]{5}') = 0 AND REGEXP_INSTR(A.RNO, '[0-9]{1}', 1, 1, 0) = 1 AND REGEXP_INSTR(A.RNO, '[0-9]{1}', 1, 2, 0) = 3
               THEN LPAD(ASCII(SUBSTR(A.RNO,4,1)),8,'9')
          WHEN REGEXP_COUNT(A.RNO, '[0-9]{1}') = 2 AND REGEXP_COUNT(A.RNO, '[0-9]{2}') = 0 AND REGEXP_COUNT(A.RNO, '[0-9]{3}') = 0 AND REGEXP_COUNT(A.RNO, '[0-9]{4}') = 0 AND REGEXP_COUNT(A.RNO, '[0-9]{5}') = 0 AND REGEXP_INSTR(A.RNO, '[0-9]{1}', 1, 1, 0) = 1 AND REGEXP_INSTR(A.RNO, '[0-9]{1}', 1, 2, 0) = 4
               THEN SUBSTR(A.RNO,4,1)
          WHEN REGEXP_COUNT(A.RNO, '[0-9]{1}') = 2 AND REGEXP_COUNT(A.RNO, '[0-9]{2}') = 0 AND REGEXP_COUNT(A.RNO, '[0-9]{3}') = 0 AND REGEXP_COUNT(A.RNO, '[0-9]{4}') = 0 AND REGEXP_COUNT(A.RNO, '[0-9]{5}') = 0 AND REGEXP_INSTR(A.RNO, '[0-9]{1}', 1, 1, 0) = 1 AND REGEXP_INSTR(A.RNO, '[0-9]{1}', 1, 2, 0) = 5
               THEN LPAD(ASCII(SUBSTR(A.RNO,4,1)),8,'9')
               
          WHEN REGEXP_COUNT(A.RNO, '[0-9]{1}') = 2 AND REGEXP_COUNT(A.RNO, '[0-9]{2}') = 0 AND REGEXP_COUNT(A.RNO, '[0-9]{3}') = 0 AND REGEXP_COUNT(A.RNO, '[0-9]{4}') = 0 AND REGEXP_COUNT(A.RNO, '[0-9]{5}') = 0 AND REGEXP_INSTR(A.RNO, '[0-9]{1}', 1, 1, 0) = 2 AND REGEXP_INSTR(A.RNO, '[0-9]{1}', 1, 2, 0) = 4
               THEN SUBSTR(A.RNO,4,1)
          WHEN REGEXP_COUNT(A.RNO, '[0-9]{1}') = 2 AND REGEXP_COUNT(A.RNO, '[0-9]{2}') = 0 AND REGEXP_COUNT(A.RNO, '[0-9]{3}') = 0 AND REGEXP_COUNT(A.RNO, '[0-9]{4}') = 0 AND REGEXP_COUNT(A.RNO, '[0-9]{5}') = 0 AND REGEXP_INSTR(A.RNO, '[0-9]{1}', 1, 1, 0) = 2 AND REGEXP_INSTR(A.RNO, '[0-9]{1}', 1, 2, 0) = 5
               THEN LPAD(ASCII(SUBSTR(A.RNO,4,1)),8,'9')
          
          WHEN REGEXP_COUNT(A.RNO, '[0-9]{1}') = 2 AND REGEXP_COUNT(A.RNO, '[0-9]{2}') = 0 AND REGEXP_COUNT(A.RNO, '[0-9]{3}') = 0 AND REGEXP_COUNT(A.RNO, '[0-9]{4}') = 0 AND REGEXP_COUNT(A.RNO, '[0-9]{5}') = 0 AND REGEXP_INSTR(A.RNO, '[0-9]{1}', 1, 1, 0) = 3 AND REGEXP_INSTR(A.RNO, '[0-9]{1}', 1, 2, 0) = 5
               THEN LPAD(ASCII(SUBSTR(A.RNO,4,1)),8,'9')
          
          WHEN REGEXP_COUNT(A.RNO, '[0-9]{1}') = 3 AND REGEXP_COUNT(A.RNO, '[0-9]{2}') = 0 AND REGEXP_COUNT(A.RNO, '[0-9]{3}') = 0 AND REGEXP_COUNT(A.RNO, '[0-9]{4}') = 0 AND REGEXP_COUNT(A.RNO, '[0-9]{5}') = 0 AND REGEXP_INSTR(A.RNO, '[0-9]{1}', 1, 1, 0) = 1 AND REGEXP_INSTR(A.RNO, '[0-9]{1}', 1, 2, 0) = 3
               THEN LPAD(ASCII(SUBSTR(A.RNO,4,1)),8,'9')
               
          WHEN REGEXP_COUNT(A.RNO, '[0-9]{2}') = 1 AND REGEXP_COUNT(A.RNO, '[0-9]{3}') = 0 AND REGEXP_COUNT(A.RNO, '[0-9]{4}') = 0 AND REGEXP_COUNT(A.RNO, '[0-9]{5}') = 0 AND REGEXP_INSTR(A.RNO, '[0-9]{2}', 1, 1, 0) = 1
               THEN DECODE( REGEXP_INSTR( SUBSTR(A.RNO,5,1), '[0-9]'), 1, SUBSTR(A.RNO,5,1), LPAD(ASCII(SUBSTR(A.RNO,5,1)),8,'9'))
          WHEN REGEXP_COUNT(A.RNO, '[0-9]{2}') = 1 AND REGEXP_COUNT(A.RNO, '[0-9]{3}') = 0 AND REGEXP_COUNT(A.RNO, '[0-9]{4}') = 0 AND REGEXP_COUNT(A.RNO, '[0-9]{5}') = 0 AND REGEXP_INSTR(A.RNO, '[0-9]{2}', 1, 1, 0) = 2
               THEN DECODE( REGEXP_INSTR( SUBSTR(A.RNO,5,1), '[0-9]'), 1, SUBSTR(A.RNO,5,1), LPAD(ASCII(SUBSTR(A.RNO,5,1)),8,'9'))
          WHEN REGEXP_COUNT(A.RNO, '[0-9]{2}') = 1 AND REGEXP_COUNT(A.RNO, '[0-9]{3}') = 0 AND REGEXP_COUNT(A.RNO, '[0-9]{4}') = 0 AND REGEXP_COUNT(A.RNO, '[0-9]{5}') = 0 AND REGEXP_INSTR(A.RNO, '[0-9]{2}', 1, 1, 0) = 3
               THEN DECODE( REGEXP_INSTR( SUBSTR(A.RNO,5,1), '[0-9]'), 1, SUBSTR(A.RNO,5,1), LPAD(ASCII(SUBSTR(A.RNO,5,1)),8,'9'))
          WHEN REGEXP_COUNT(A.RNO, '[0-9]{2}') = 1 AND REGEXP_COUNT(A.RNO, '[0-9]{3}') = 0 AND REGEXP_COUNT(A.RNO, '[0-9]{4}') = 0 AND REGEXP_COUNT(A.RNO, '[0-9]{5}') = 0 AND REGEXP_INSTR(A.RNO, '[0-9]{2}', 1, 1, 0) = 4
               THEN SUBSTR(A.RNO,4,2)
  
          WHEN REGEXP_COUNT(A.RNO, '[0-9]{2}') = 2 AND REGEXP_COUNT(A.RNO, '[0-9]{3}') = 0 AND REGEXP_COUNT(A.RNO, '[0-9]{4}') = 0 AND REGEXP_COUNT(A.RNO, '[0-9]{5}') = 0 AND REGEXP_INSTR(A.RNO, '[0-9]{2}', 1, 1, 0) = 1
               THEN '0'
               
          WHEN REGEXP_COUNT(A.RNO, '[0-9]{3}') = 1 AND REGEXP_COUNT(A.RNO, '[0-9]{4}') = 0 AND REGEXP_COUNT(A.RNO, '[0-9]{5}') = 0 AND REGEXP_INSTR(A.RNO, '[0-9]{3}', 1, 1, 0) = 1
               THEN '0'
          WHEN REGEXP_COUNT(A.RNO, '[0-9]{3}') = 1 AND REGEXP_COUNT(A.RNO, '[0-9]{4}') = 0 AND REGEXP_COUNT(A.RNO, '[0-9]{5}') = 0 AND REGEXP_INSTR(A.RNO, '[0-9]{3}', 1, 1, 0) = 2
               THEN '0'
          WHEN REGEXP_COUNT(A.RNO, '[0-9]{3}') = 1 AND REGEXP_COUNT(A.RNO, '[0-9]{4}') = 0 AND REGEXP_COUNT(A.RNO, '[0-9]{5}') = 0 AND REGEXP_INSTR(A.RNO, '[0-9]{3}', 1, 1, 0) = 3
               THEN '0'
          
          WHEN REGEXP_COUNT(A.RNO, '[0-9]{4}') = 1 AND REGEXP_COUNT(A.RNO, '[0-9]{5}') = 0 AND REGEXP_INSTR(A.RNO, '[0-9]{4}', 1, 1, 0) = 1
               THEN '0'
          WHEN REGEXP_COUNT(A.RNO, '[0-9]{4}') = 1 AND REGEXP_COUNT(A.RNO, '[0-9]{5}') = 0 AND REGEXP_INSTR(A.RNO, '[0-9]{4}', 1, 1, 0) = 2
               THEN '0'

          WHEN REGEXP_COUNT(A.RNO, '[0-9]{5}') = 1 
               THEN '0'   
          
      END) ORD4,
     
     TO_NUMBER(
     CASE 
          WHEN REGEXP_COUNT(A.RNO, '[0-9]{1}') = 1 AND REGEXP_COUNT(A.RNO, '[0-9]{2}') = 0 AND REGEXP_COUNT(A.RNO, '[0-9]{3}') = 0 AND REGEXP_COUNT(A.RNO, '[0-9]{4}') = 0 AND REGEXP_COUNT(A.RNO, '[0-9]{5}') = 0 AND REGEXP_INSTR(A.RNO, '[0-9]{1}', 1, 1, 0) = 1 AND REGEXP_INSTR(A.RNO, '[0-9]{1}', 1, 2, 0) = 0
               THEN LPAD(ASCII(SUBSTR(A.RNO,5,1)),8,'9')
          WHEN REGEXP_COUNT(A.RNO, '[0-9]{1}') = 1 AND REGEXP_COUNT(A.RNO, '[0-9]{2}') = 0 AND REGEXP_COUNT(A.RNO, '[0-9]{3}') = 0 AND REGEXP_COUNT(A.RNO, '[0-9]{4}') = 0 AND REGEXP_COUNT(A.RNO, '[0-9]{5}') = 0 AND REGEXP_INSTR(A.RNO, '[0-9]{1}', 1, 1, 0) = 2 AND REGEXP_INSTR(A.RNO, '[0-9]{1}', 1, 2, 0) = 0
               THEN LPAD(ASCII(SUBSTR(A.RNO,5,1)),8,'9')
          WHEN REGEXP_COUNT(A.RNO, '[0-9]{1}') = 1 AND REGEXP_COUNT(A.RNO, '[0-9]{2}') = 0 AND REGEXP_COUNT(A.RNO, '[0-9]{3}') = 0 AND REGEXP_COUNT(A.RNO, '[0-9]{4}') = 0 AND REGEXP_COUNT(A.RNO, '[0-9]{5}') = 0 AND REGEXP_INSTR(A.RNO, '[0-9]{1}', 1, 1, 0) = 3 AND REGEXP_INSTR(A.RNO, '[0-9]{1}', 1, 2, 0) = 0
               THEN LPAD(ASCII(SUBSTR(A.RNO,5,1)),8,'9')
          WHEN REGEXP_COUNT(A.RNO, '[0-9]{1}') = 1 AND REGEXP_COUNT(A.RNO, '[0-9]{2}') = 0 AND REGEXP_COUNT(A.RNO, '[0-9]{3}') = 0 AND REGEXP_COUNT(A.RNO, '[0-9]{4}') = 0 AND REGEXP_COUNT(A.RNO, '[0-9]{5}') = 0 AND REGEXP_INSTR(A.RNO, '[0-9]{1}', 1, 1, 0) = 4 AND REGEXP_INSTR(A.RNO, '[0-9]{1}', 1, 2, 0) = 0
               THEN LPAD(ASCII(SUBSTR(A.RNO,5,1)),8,'9')
          WHEN REGEXP_COUNT(A.RNO, '[0-9]{1}') = 1 AND REGEXP_COUNT(A.RNO, '[0-9]{2}') = 0 AND REGEXP_COUNT(A.RNO, '[0-9]{3}') = 0 AND REGEXP_COUNT(A.RNO, '[0-9]{4}') = 0 AND REGEXP_COUNT(A.RNO, '[0-9]{5}') = 0 AND REGEXP_INSTR(A.RNO, '[0-9]{1}', 1, 1, 0) = 5 AND REGEXP_INSTR(A.RNO, '[0-9]{1}', 1, 2, 0) = 0
               THEN SUBSTR(A.RNO,5,1)
          
          WHEN REGEXP_COUNT(A.RNO, '[0-9]{1}') = 2 AND REGEXP_COUNT(A.RNO, '[0-9]{2}') = 0 AND REGEXP_COUNT(A.RNO, '[0-9]{3}') = 0 AND REGEXP_COUNT(A.RNO, '[0-9]{4}') = 0 AND REGEXP_COUNT(A.RNO, '[0-9]{5}') = 0 AND REGEXP_INSTR(A.RNO, '[0-9]{1}', 1, 1, 0) = 1 AND REGEXP_INSTR(A.RNO, '[0-9]{1}', 1, 2, 0) = 3
               THEN LPAD(ASCII(SUBSTR(A.RNO,5,1)),8,'9')
          WHEN REGEXP_COUNT(A.RNO, '[0-9]{1}') = 2 AND REGEXP_COUNT(A.RNO, '[0-9]{2}') = 0 AND REGEXP_COUNT(A.RNO, '[0-9]{3}') = 0 AND REGEXP_COUNT(A.RNO, '[0-9]{4}') = 0 AND REGEXP_COUNT(A.RNO, '[0-9]{5}') = 0 AND REGEXP_INSTR(A.RNO, '[0-9]{1}', 1, 1, 0) = 1 AND REGEXP_INSTR(A.RNO, '[0-9]{1}', 1, 2, 0) = 4
               THEN LPAD(ASCII(SUBSTR(A.RNO,5,1)),8,'9')
          WHEN REGEXP_COUNT(A.RNO, '[0-9]{1}') = 2 AND REGEXP_COUNT(A.RNO, '[0-9]{2}') = 0 AND REGEXP_COUNT(A.RNO, '[0-9]{3}') = 0 AND REGEXP_COUNT(A.RNO, '[0-9]{4}') = 0 AND REGEXP_COUNT(A.RNO, '[0-9]{5}') = 0 AND REGEXP_INSTR(A.RNO, '[0-9]{1}', 1, 1, 0) = 1 AND REGEXP_INSTR(A.RNO, '[0-9]{1}', 1, 2, 0) = 5
               THEN SUBSTR(A.RNO,5,1)
               
          WHEN REGEXP_COUNT(A.RNO, '[0-9]{1}') = 2 AND REGEXP_COUNT(A.RNO, '[0-9]{2}') = 0 AND REGEXP_COUNT(A.RNO, '[0-9]{3}') = 0 AND REGEXP_COUNT(A.RNO, '[0-9]{4}') = 0 AND REGEXP_COUNT(A.RNO, '[0-9]{5}') = 0 AND REGEXP_INSTR(A.RNO, '[0-9]{1}', 1, 1, 0) = 2 AND REGEXP_INSTR(A.RNO, '[0-9]{1}', 1, 2, 0) = 4
               THEN LPAD(ASCII(SUBSTR(A.RNO,5,1)),8,'9')
          WHEN REGEXP_COUNT(A.RNO, '[0-9]{1}') = 2 AND REGEXP_COUNT(A.RNO, '[0-9]{2}') = 0 AND REGEXP_COUNT(A.RNO, '[0-9]{3}') = 0 AND REGEXP_COUNT(A.RNO, '[0-9]{4}') = 0 AND REGEXP_COUNT(A.RNO, '[0-9]{5}') = 0 AND REGEXP_INSTR(A.RNO, '[0-9]{1}', 1, 1, 0) = 2 AND REGEXP_INSTR(A.RNO, '[0-9]{1}', 1, 2, 0) = 5
               THEN SUBSTR(A.RNO,5,1)
          
          WHEN REGEXP_COUNT(A.RNO, '[0-9]{1}') = 2 AND REGEXP_COUNT(A.RNO, '[0-9]{2}') = 0 AND REGEXP_COUNT(A.RNO, '[0-9]{3}') = 0 AND REGEXP_COUNT(A.RNO, '[0-9]{4}') = 0 AND REGEXP_COUNT(A.RNO, '[0-9]{5}') = 0 AND REGEXP_INSTR(A.RNO, '[0-9]{1}', 1, 1, 0) = 3 AND REGEXP_INSTR(A.RNO, '[0-9]{1}', 1, 2, 0) = 5
               THEN SUBSTR(A.RNO,5,1)
               
          WHEN REGEXP_COUNT(A.RNO, '[0-9]{1}') = 3 AND REGEXP_COUNT(A.RNO, '[0-9]{2}') = 0 AND REGEXP_COUNT(A.RNO, '[0-9]{3}') = 0 AND REGEXP_COUNT(A.RNO, '[0-9]{4}') = 0 AND REGEXP_COUNT(A.RNO, '[0-9]{5}') = 0 AND REGEXP_INSTR(A.RNO, '[0-9]{1}', 1, 1, 0) = 1 AND REGEXP_INSTR(A.RNO, '[0-9]{1}', 1, 2, 0) = 3
               THEN SUBSTR(A.RNO,5,1)
            
               
          WHEN REGEXP_COUNT(A.RNO, '[0-9]{2}') = 1 AND REGEXP_COUNT(A.RNO, '[0-9]{3}') = 0 AND REGEXP_COUNT(A.RNO, '[0-9]{4}') = 0 AND REGEXP_COUNT(A.RNO, '[0-9]{5}') = 0 AND REGEXP_INSTR(A.RNO, '[0-9]{2}', 1, 1, 0) = 1
               THEN '0'
          WHEN REGEXP_COUNT(A.RNO, '[0-9]{2}') = 1 AND REGEXP_COUNT(A.RNO, '[0-9]{3}') = 0 AND REGEXP_COUNT(A.RNO, '[0-9]{4}') = 0 AND REGEXP_COUNT(A.RNO, '[0-9]{5}') = 0 AND REGEXP_INSTR(A.RNO, '[0-9]{2}', 1, 1, 0) = 2
               THEN '0'
          WHEN REGEXP_COUNT(A.RNO, '[0-9]{2}') = 1 AND REGEXP_COUNT(A.RNO, '[0-9]{3}') = 0 AND REGEXP_COUNT(A.RNO, '[0-9]{4}') = 0 AND REGEXP_COUNT(A.RNO, '[0-9]{5}') = 0 AND REGEXP_INSTR(A.RNO, '[0-9]{2}', 1, 1, 0) = 3
               THEN '0'
          WHEN REGEXP_COUNT(A.RNO, '[0-9]{2}') = 1 AND REGEXP_COUNT(A.RNO, '[0-9]{3}') = 0 AND REGEXP_COUNT(A.RNO, '[0-9]{4}') = 0 AND REGEXP_COUNT(A.RNO, '[0-9]{5}') = 0 AND REGEXP_INSTR(A.RNO, '[0-9]{2}', 1, 1, 0) = 4
               THEN '0'
  
          WHEN REGEXP_COUNT(A.RNO, '[0-9]{2}') = 2 AND REGEXP_COUNT(A.RNO, '[0-9]{3}') = 0 AND REGEXP_COUNT(A.RNO, '[0-9]{4}') = 0 AND REGEXP_COUNT(A.RNO, '[0-9]{5}') = 0 AND REGEXP_INSTR(A.RNO, '[0-9]{2}', 1, 1, 0) = 1
               THEN '0'
               
          WHEN REGEXP_COUNT(A.RNO, '[0-9]{3}') = 1 AND REGEXP_COUNT(A.RNO, '[0-9]{4}') = 0 AND REGEXP_COUNT(A.RNO, '[0-9]{5}') = 0 AND REGEXP_INSTR(A.RNO, '[0-9]{3}', 1, 1, 0) = 1
               THEN '0'
          WHEN REGEXP_COUNT(A.RNO, '[0-9]{3}') = 1 AND REGEXP_COUNT(A.RNO, '[0-9]{4}') = 0 AND REGEXP_COUNT(A.RNO, '[0-9]{5}') = 0 AND REGEXP_INSTR(A.RNO, '[0-9]{3}', 1, 1, 0) = 2
               THEN '0'
          WHEN REGEXP_COUNT(A.RNO, '[0-9]{3}') = 1 AND REGEXP_COUNT(A.RNO, '[0-9]{4}') = 0 AND REGEXP_COUNT(A.RNO, '[0-9]{5}') = 0 AND REGEXP_INSTR(A.RNO, '[0-9]{3}', 1, 1, 0) = 3
               THEN '0'
          
          WHEN REGEXP_COUNT(A.RNO, '[0-9]{4}') = 1 AND REGEXP_COUNT(A.RNO, '[0-9]{5}') = 0 AND REGEXP_INSTR(A.RNO, '[0-9]{4}', 1, 1, 0) = 1
               THEN '0'
          WHEN REGEXP_COUNT(A.RNO, '[0-9]{4}') = 1 AND REGEXP_COUNT(A.RNO, '[0-9]{5}') = 0 AND REGEXP_INSTR(A.RNO, '[0-9]{4}', 1, 1, 0) = 2
               THEN '0'

          WHEN REGEXP_COUNT(A.RNO, '[0-9]{5}') = 1 
               THEN '0'   
          
      END) ORD5,
     LENGTH(SUBSTR(A.TRF_RULE_NO, 1, 5)) AS TRF_RULE_NO_CNT, 
     A.*
  FROM (

SELECT 
       LPAD(REGEXP_REPLACE(TRIM(A.TRF_RULE_NO),'[^a-z,A-Z,0-9]','.'),5,'0') AS RNO,
       A.TRF_PFX_CD
     , A.TRF_NO
     , A.TRF_RULE_NO
     , A.AMDT_SEQ
     , A.TRF_RULE_NM
 FROM PRI_TRF_RULE A
     , (SELECT TRF_PFX_CD
            , TRF_NO
            , TRF_RULE_NO
            , MAX(AMDT_SEQ) AMDT_SEQ
  	     FROM PRI_TRF_RULE
 	    WHERE TRF_PFX_CD 		= @[trf_pfx_cd]
   	      AND TRF_NO 			= @[trf_no]
   	      AND TRF_RULE_STS_CD 	= 'F' 
 	    GROUP 
           BY TRF_PFX_CD, TRF_NO, TRF_RULE_NO) B
 WHERE A.TRF_PFX_CD     = B.TRF_PFX_CD
   AND A.TRF_NO 	    = B.TRF_NO
   AND A.AMDT_SEQ 	    = B.AMDT_SEQ
   AND A.TRF_RULE_NO 	= B.TRF_RULE_NO
   AND A.TRF_PFX_CD 	= @[trf_pfx_cd]
   AND A.TRF_NO 		= @[trf_no]
   AND A.TRF_RULE_STS_CD = 'F'

#if (${rule_no} != '') 
   AND A.TRF_RULE_NO LIKE UPPER(@[rule_no] || '%')
#end
#if (${rule_nm} != '') 
   AND ( REGEXP_LIKE( A.TRF_RULE_NM , '('||@[rule_nm]||')','i') 
		OR REGEXP_LIKE( A.TRF_RULE_CTNT , '('||@[rule_nm]||')','i')) 
#end 
#if (${access_dt} != '') 
   AND A.EFF_DT <= TO_DATE(@[access_dt], 'YYYY-MM-DD')
   AND NVL(A.EXP_DT, TO_DATE('9999-12-31','YYYY-MM-DD')) >= TO_DATE(@[access_dt], 'YYYY-MM-DD')
#end
) A ) A
 ORDER BY A.ORD1
            , TO_NUMBER(A.ORD1||A.ORD2)
            , TO_NUMBER(A.ORD1||A.ORD2||A.ORD3)
            , TO_NUMBER(A.TRF_RULE_NO_CNT||A.ORD4)
            , TO_NUMBER(A.TRF_RULE_NO_CNT||A.ORD5)			]]></sql>
			<params>
				<param name="trf_pfx_cd" type="12" value="" out="N"/>
				<param name="trf_no" type="12" value="" out="N"/>
				<param name="rule_no" type="12" value="" out="N"/>
				<param name="rule_nm" type="12" value="" out="N"/>
				<param name="access_dt" type="12" value="" out="N"/>
			</params>
		</query>
	</querys>
</sqls>
