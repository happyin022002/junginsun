<?xml version="1.0" encoding="UTF-8"?>
<sqls>
	<querys>
		<query name="PSAManifestDBDAOsearchPsaBkgVslInfoForUnchgRSQL">
			<desc><![CDATA[]]></desc>
			<sql><![CDATA[
SELECT NVL(SUBSTR( PV.PSA_VSL_NM, 1, 12 ), '') AS PV_VSL_NM,
       NVL(PV.VSL_CD||PV.SKD_VOY_NO||PV.SKD_DIR_CD, '') AS PV_VOY_DIR,
       NVL(PV.PSA_VOY_DIR_CD, '') AS PV_CON_VOY_DIR, 
       PB.PSA_IF_CD BKG_FI,
       COM_CONSTANTMGR_PKG.COM_GETSCACCODE_FNC()||PB.BKG_NO AS UCR_NO,
       PB.N1ST_SHPR_NM AS SHPR_NM1,
       PB.N2ND_SHPR_NM AS SHPR_NM2,
       'NY' AS OP_CD,
       'NY' AS SO_CD,
       (SELECT DECODE(PT2.PSA_LOC_CD, NULL, DECODE(PT1.PSA_LOC_CD, NULL, NVL(MDM.UN_LOC_CD, MDM.LOC_CD), PT1.PSA_LOC_CD), PT2.PSA_LOC_CD)
          FROM BKG_CSTMS_PSA_PORT PT1,
               BKG_CSTMS_PSA_PORT PT2,
               BKG_BOOKING BK,
               MDM_LOCATION MDM
         WHERE BK.BKG_NO = PB.BKG_NO
           AND BK.POD_CD = PT1.LOC_CD(+)
           AND LENGTH(PT1.TML_CD(+)) = 5
           AND BK.POD_CD = PT2.LOC_CD(+)
           AND BK.POD_NOD_CD = PT2.TML_CD(+)
           AND BK.POD_CD = MDM.LOC_CD(+)
           AND ROWNUM = 1) AS BKG_POD,
       (SELECT DECODE(PT2.PSA_LOC_CD, NULL, DECODE(PT1.PSA_LOC_CD, NULL, NVL(MDM.UN_LOC_CD, MDM.LOC_CD), PT1.PSA_LOC_CD), PT2.PSA_LOC_CD)
          FROM BKG_CSTMS_PSA_PORT PT1,
               BKG_CSTMS_PSA_PORT PT2,
               BKG_VVD BV,
               MDM_LOCATION MDM
         WHERE BV.BKG_NO = PB.BKG_NO
           AND BV.POD_CD = PB.N1ST_POD_CD
           AND BV.POD_CD = PT1.LOC_CD(+)
           AND LENGTH(PT1.TML_CD(+)) = 5
           AND BV.POD_CD = PT2.LOC_CD(+)
           AND BV.POD_YD_CD = PT2.TML_CD(+)
           AND PB.N1ST_POD_CD = MDM.LOC_CD(+)
           AND ROWNUM = 1) AS POD_LOC1,
       (SELECT DECODE(PT2.PSA_LOC_CD, NULL, DECODE(PT1.PSA_LOC_CD, NULL, NVL(MDM.UN_LOC_CD, MDM.LOC_CD), PT1.PSA_LOC_CD), PT2.PSA_LOC_CD)
          FROM BKG_CSTMS_PSA_PORT PT1,
               BKG_CSTMS_PSA_PORT PT2,
               BKG_VVD BV,
               MDM_LOCATION MDM
         WHERE BV.BKG_NO = PB.BKG_NO
           AND BV.POD_CD = PB.N2ND_POD_CD
           AND BV.POD_CD = PT1.LOC_CD(+)
           AND LENGTH(PT1.TML_CD(+)) = 5
           AND BV.POD_CD = PT2.LOC_CD(+)
           AND BV.POD_YD_CD = PT2.TML_CD(+)
           AND PB.N2ND_POD_CD = MDM.LOC_CD(+)
           AND ROWNUM = 1) AS POD_LOC2,
       (SELECT DECODE(PT2.PSA_LOC_CD, NULL, DECODE(PT1.PSA_LOC_CD, NULL, NVL(MDM.UN_LOC_CD, MDM.LOC_CD), PT1.PSA_LOC_CD), PT2.PSA_LOC_CD)
          FROM BKG_CSTMS_PSA_PORT PT1,
               BKG_CSTMS_PSA_PORT PT2,
               BKG_VVD BV,
               MDM_LOCATION MDM
         WHERE BV.BKG_NO = PB.BKG_NO
           AND BV.POD_CD = PB.N3RD_POD_CD
           AND BV.POD_CD = PT1.LOC_CD(+)
           AND LENGTH(PT1.TML_CD(+)) = 5
           AND BV.POD_CD = PT2.LOC_CD(+)
           AND BV.POD_YD_CD = PT2.TML_CD(+)
           AND PB.N3RD_POD_CD = MDM.LOC_CD(+)
           AND ROWNUM = 1) AS POD_LOC3

  FROM BKG_CSTMS_PSA_BKG PB,
       BKG_CSTMS_PSA_VVD PV

 WHERE PV.VSL_CD = PB.VSL_CD
   AND PV.SKD_VOY_NO = PB.SKD_VOY_NO
   AND PV.SKD_DIR_CD = PB.SKD_DIR_CD
   AND PB.BKG_NO = @[bkg_no]
   AND PB.BKG_SEQ = @[bkg_seq]
			]]></sql>
			<params>
				<param name="bkg_no" type="12" value="" out="N"/>
				<param name="bkg_seq" type="12" value="" out="N"/>
			</params>
		</query>
	</querys>
</sqls>
