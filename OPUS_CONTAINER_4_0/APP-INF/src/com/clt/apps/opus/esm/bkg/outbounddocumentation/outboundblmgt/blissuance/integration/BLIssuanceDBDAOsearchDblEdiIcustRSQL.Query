<?xml version="1.0" encoding="UTF-8"?>
<sqls>
	<querys>
		<query name="BLIssuanceDBDAOsearchDblEdiIcustRSQL">
			<desc><![CDATA[select]]></desc>
			<sql><![CDATA[
SELECT FF
FROM (
SELECT '{I_BKG_CUST' || CHR(10) ||
       'IBCS_TP:' || BC.XTER_CUST_TP_CD || CHR(10) ||
       'IBCS_NM1:' || BKG_TOKEN_NL_FNC(NVL(CUST_NM, ''), 1, '') || CHR(10) ||
       'IBCS_NM2:' || BKG_TOKEN_NL_FNC(NVL(CUST_NM, ''), 2, '') || CHR(10) ||
       'IBCS_ADDR1:' || BKG_TOKEN_NL_FNC(NVL(BC.CUST_ADDR, ''), 1, '') || CHR(10) ||
       'IBCS_ADDR2:' || BKG_TOKEN_NL_FNC(NVL(BC.CUST_ADDR, ''), 2, '') || CHR(10) ||
       'IBCS_ADDR3:' || BKG_TOKEN_NL_FNC(NVL(BC.CUST_ADDR, ''), 3, '') || CHR(10) ||
       'IBCS_ADDR4:' || BKG_TOKEN_NL_FNC(NVL(BC.CUST_ADDR, ''), 4, '') || CHR(10) ||
       'IBCS_ADDR5:' || BKG_TOKEN_NL_FNC(NVL(BC.CUST_ADDR, ''), 5, '') || CHR(10) ||
       'IBCS_C_NM1:' || BKG_TOKEN_NL_FNC(NVL(BC.CNTC_NM, ''), 1, '') || CHR(10) ||
       'IBCS_C_NM2:' || BKG_TOKEN_NL_FNC(NVL(BC.CNTC_NM, ''), 2, '') || CHR(10) ||
       'CNT_CD:' || BC.CNT_CD || CHR(10)  ||
       'CUST_CD:' || BC.CUST_SEQ || CHR(10)  ||
       'UN_CUST_CD:' || BC.UN_LOC_CD || CHR(10)  ||
       'PCC_CUST_CD:' || BC.PRNR_CUST_CD || CHR(10)  ||
       'PARTNER_REF_NO:' || BC.PRNR_REF_NO || CHR(10)  ||
       'IBCS_CUST_LOC:' || BC.LOC_CTNT || CHR(10) ||
       'IBCS_STREET:' || BC.ST_NM || CHR(10) ||
       'IBCS_LOC_CD:' || BC.LOC_CD || CHR(10) ||
       'IBCS_LOC_NM:' || BC.LOC_NM || CHR(10) ||
       'IBCS_STAT_CD:' || BC.STE_CD || CHR(10) ||
       'IBCS_ZIP_CD:' || BC.PST_CTNT || CHR(10) ||
       'IBCS_CNT_CD:' || BC.CNT_CD || CHR(10) ||
       'IBCS_C_TP:' || BC.XTER_CUST_CNTC_TP_CD || CHR(10) ||
       'IBCS_C_NM::' || BC.CNTC_NM || CHR(10) ||
       'IBCS_C_TEL:' || BC.CNTC_PHN_NO_CTNT || CHR(10) ||
       'IBCS_C_FAX:' || BC.CNTC_FAX_NO || CHR(10) ||
       'IBCS_C_EMAIL:' || BC.CNTC_EML || CHR(10) ||
       '}I_BKG_CUST' || CHR(10) AS FF
        ,ROW_NUMBER() OVER(PARTITION BY BK.XTER_SNDR_ID,BK.XTER_RQST_NO,BC.XTER_CUST_TP_CD ORDER BY BK.UPLD_DT DESC) RNUM 
FROM BKG_XTER_RQST_MST BK, BKG_XTER_CUST BC
WHERE BK.BKG_NO = @[bkg_no]
  AND BK.XTER_RQST_NO = BC.XTER_RQST_NO
  AND BK.XTER_RQST_SEQ = BC.XTER_RQST_SEQ
  AND BK.XTER_SNDR_ID = BC.XTER_SNDR_ID
  --AND BC.XTER_CUST_TP_CD IN ('S','C','F','N','A','MS')
  AND BKG_UPLD_STS_CD = 'F'
  AND BK.UPLD_GDT = (SELECT MAX(BXRM.UPLD_GDT) 
                       FROM BKG_XTER_RQST_MST BXRM
                       WHERE BXRM.BKG_NO =  @[bkg_no]
                         AND BXRM.BKG_UPLD_STS_CD = 'F') 
) FF
WHERE RNUM =1				]]></sql>
			<params>
				<param name="bkg_no" type="12" value="" out="N"/>
			</params>
		</query>
	</querys>
</sqls>
