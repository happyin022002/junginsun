<?xml version="1.0" encoding="UTF-8"?>
<sqls>
	<querys>
		<query name="KorManifestListDBDAOsearchIBMSNInfoRSQL">
			<desc><![CDATA[LOCAL Manifest 신고 리스트 조회]]></desc>
			<sql><![CDATA[
SELECT BLTS LOCAL_TS
     , VSL || VOYNO || DIR VVD
     , VSL VSL_CD
     , VOYNO SKD_VOYAGE_NO
     , DIR SKD_DIR_CD
     , POL POL_CD
     , POD POD_CD
     , YD POD_YD_CD
     , ETD VPS_ETD_DT
     , MIN(ETA) VPS_ETA_DT
     , COUNT(BL) CNT_BL_NO
FROM (
    SELECT DISTINCT SEQ.MRN_BL_TS_CD BLTS,
      VVD.VSL_CD VSL,
      VVD.SKD_VOY_NO VOYNO,
      VVD.SKD_DIR_CD DIR,
      VVD.POL_CD POL,
      VVD.POD_CD POD,
      NVL(SUBSTR(VVD.POD_YD_CD, 6, 2), ' ') YD,
      NVL(TO_CHAR(VSL1.VPS_ETD_DT, 'YYYY-MM-DD'), ' ') ETD,
      NVL(TO_CHAR(VSL2.VPS_ETA_DT, 'YYYY-MM-DD'), ' ') ETA,
      VVD.BKG_NO BL
    FROM BKG_VVD VVD,
      VSK_VSL_PORT_SKD VSL1,
      BKG_CSTMS_KR_MF_SEQ_NO SEQ,
      VSK_VSL_PORT_SKD VSL2,
      BKG_BOOKING BKG
    WHERE VVD.VSL_CD = @[vsl_cd]
      AND VVD.SKD_VOY_NO = @[skd_voyage_no]
      AND VVD.SKD_DIR_CD = @[skd_dir_cd]
      AND VVD.POD_CD = @[pod_cd]
      AND VVD.BKG_NO = SEQ.BKG_NO
      AND VVD.BKG_NO = BKG.BKG_NO
      AND SEQ.MF_REF_NO = @[mrn_nbr]
      AND VVD.VSL_CD = VSL1.VSL_CD
      AND VVD.SKD_VOY_NO = VSL1.SKD_VOY_NO
      AND VVD.SKD_DIR_CD = VSL1.SKD_DIR_CD
      AND VVD.POL_CD = VSL1.VPS_PORT_CD
      AND VSL1.CLPT_IND_SEQ = '1'
      AND VVD.VSL_CD = VSL2.VSL_CD
      AND VVD.SKD_VOY_NO = VSL2.SKD_VOY_NO
      AND VVD.SKD_DIR_CD = VSL2.SKD_DIR_CD
      AND VVD.POD_CD = VSL2.VPS_PORT_CD
      AND VSL2.VPS_ETA_DT > VSL1.VPS_ETD_DT)
GROUP BY BLTS, VSL, VOYNO, DIR, POL, ETD, YD, POD			]]></sql>
			<params>
				<param name="vsl_cd" type="12" value="" out="N"/>
				<param name="skd_voyage_no" type="12" value="" out="N"/>
				<param name="skd_dir_cd" type="12" value="" out="N"/>
				<param name="pod_cd" type="12" value="" out="N"/>
				<param name="mrn_nbr" type="12" value="" out="N"/>
			</params>
		</query>
	</querys>
</sqls>
