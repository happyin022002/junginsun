<?xml version="1.0" encoding="UTF-8"?>
<sqls>
	<querys>
		<query name="SpecialCargoReceiptDBDAOSearchBkgVvdCaRSQL">
			<desc><![CDATA[c/a 화면에서 vvd 재지정시 special cargo 재 request를 위한 vvd를 조회한다.]]></desc>
			<sql><![CDATA[
SELECT a4.BKG_NO
      ,a4.VSL_PRE_PST_CD
      ,a4.VSL_SEQ
      ,a4.VSL_CD
      ,a4.SKD_VOY_NO
      ,a4.SKD_DIR_CD
      ,a4.POL_CLPT_IND_SEQ
      ,a4.POL_CD
      ,a4.POD_CD
      ,a4.CRE_USR_ID
      ,a4.CRE_DT
      ,a4.UPD_USR_ID
      ,a4.UPD_DT
      ,a4.POD_CLPT_IND_SEQ
      ,a4.POL_YD_CD
      ,a4.POD_YD_CD
      ,a4.SLAN_CD
FROM (SELECT BKG_NO
      , VSL_PRE_PST_CD
      , VSL_SEQ
      , VSL_CD
      , SKD_VOY_NO
      , SKD_DIR_CD
      , POL_CLPT_IND_SEQ
      , POL_CD
      , POD_CD
      , POD_CLPT_IND_SEQ
      , POL_YD_CD
      , POD_YD_CD
      , SLAN_CD
		FROM BKG_VVD_HIS
	   WHERE BKG_NO = @[bkg_no]
		 AND CORR_NO = 'TMP0000001'
      MINUS
	  SELECT BKG_NO
      , VSL_PRE_PST_CD
      , VSL_SEQ
      , VSL_CD
      , SKD_VOY_NO
      , SKD_DIR_CD
      , POL_CLPT_IND_SEQ
      , POL_CD
      , POD_CD
      , POD_CLPT_IND_SEQ
      , POL_YD_CD
      , POD_YD_CD
      , SLAN_CD
		FROM BKG_VVD 	
	   WHERE BKG_NO = @[bkg_no]		
	 ) A1
,MDM_VSL_SVC_LANE A3, bkg_vvd_his a4
WHERE A1.BKG_NO = @[bkg_no]
and a1.bkg_no           = a4.bkg_no
and a4.CORR_NO 			= 'TMP0000001'
and a1.VSL_PRE_PST_CD   = a4.vsl_pre_pst_cd
and a1.vsl_seq          = a4.VSL_SEQ
AND A1.SLAN_CD                    = A3.VSL_SLAN_CD
AND A3.SPCL_CGO_RQST_TGT_LANE_FLG = 'Y'
AND A3.VSL_SVC_TP_CD              <> 'O' 
AND A3.DELT_FLG                   = 'N'
AND A1.VSL_CD                     IS NOT NULL			]]></sql>
			<params>
				<param name="bkg_no" type="12" value="BRE001080700" out="N"/>
			</params>
		</query>
	</querys>
</sqls>
