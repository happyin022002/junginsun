<?xml version="1.0" encoding="UTF-8"?>
<sqls>
	<querys>
		<query name="FACCommCalculationDBDAOAddFACMasterCSQL">
			<desc><![CDATA[FACCommCalculationDBDAOAddFACMasterCSQL]]></desc>
			<sql><![CDATA[
INSERT INTO ACM_FAC_COMM
(BKG_NO, SLS_OFC_CD, FAC_SEQ, FAC_STS_CD, PPD_AMT, CRNT_AMT, IF_AMT, VSL_DEP_DT, LOC_DIV_CD, LOC_CD, AR_OFC_CD, AP_OFC_CD, AP_CTR_CD, COMM_STND_COST_CD, FAC_OCCR_INFO_CD, FAC_SLAN_CD, FAC_RLANE_CD, FAC_VSL_CD, FAC_SKD_VOY_NO, FAC_SKD_DIR_CD, FAC_REV_DIR_CD, BKG_FF_CNT_CD, BKG_FF_SEQ, VNDR_CNT_CD, VNDR_SEQ, FAC_DIV_CD, FAC_SPCL_CNTR_TP_CTNT1, FAC_SPCL_CNTR_RT1, FAC_SPCL_CNTR_TP_CTNT2, FAC_SPCL_CNTR_RT2, FAC_BKG_RT, FAC_BKG_AMT, BKG_BX_QTY, FAC_BX_AMT, BKG_DRY_TEU_QTY, FAC_DRY_TEU_AMT, BKG_DRY_FEU_QTY, FAC_DRY_FEU_AMT, BKG_RF_TEU_QTY, FAC_RF_TEU_AMT, BKG_RF_FEU_QTY, FAC_RF_FEU_AMT, BKG_SPCL_TEU_QTY, FAC_SPCL_TEU_AMT, BKG_SPCL_FEU_QTY, FAC_SPCL_FEU_AMT, FAC_CHG_CTNT, CURR_CD, MON_XCH_RT, PAY_PPD_AMT, PAY_CRNT_AMT, PAY_IF_AMT, CMDT_TP_CD, CMDT_CD, OFC_CHR_CD, ACCL_FLG, INV_TAX_RT, GL_DT, CSR_NO, APRO_USR_ID, APRO_DT, APRO_GDT, IF_USR_ID, IF_DT, IF_GDT, FAC_OFC_CD, FF_CNT_CD, FF_SEQ, FAC_AGMT_SEQ, FAC_RMK, CRE_USR_ID, CRE_DT, UPD_USR_ID, UPD_DT)
SELECT
 @[bkg_no] -- BKG_NO
, CASE WHEN @[ppd_ofc_cd_chg_yn] = 'Y' THEN NVL(@[chg_ppd_ofc_cd],'HAMBB') ELSE NVL(@[ppd_ofc_cd],'HAMBB') END AS SLS_OFC_CD
, @[fac_seq]                    FAC_SEQ
, 'CS'		                    FAC_STS_CD
, NVL((SELECT ROUND (NVL (CRNT_AMT, 0), 2)
  FROM ACM_FAC_COMM 
 WHERE BKG_NO = @[bkg_no]  
	AND FAC_SEQ = @[fac_seq] - 1 ),0) AS PPD_AMT
, @[crnt_amt]               CRNT_AMT
, ( @[crnt_amt] -
NVL((SELECT ROUND (NVL (CRNT_AMT, 0), 2)
  FROM ACM_FAC_COMM 
 WHERE BKG_NO = @[bkg_no]  
	AND FAC_SEQ = @[fac_seq] - 1 ),0)
)   AS IF_AMT
, TO_DATE (@[vps_etd_dt], 'yyyyMMddHH24miss')               VSL_DEP_DT
, @[loc_div_cd]                 LOC_DIV_CD
, @[loc_cd]                     LOC_CD
, CASE WHEN @[ppd_ofc_cd_chg_yn] = 'Y' THEN @[chg_ar_ofc_cd] ELSE @[bkg_ar_ofc_cd] END AS AR_OFC_CD
, CASE WHEN @[ppd_ofc_cd_chg_yn] = 'Y' THEN @[chg_ap_ofc_cd] ELSE @[ap_ofc_cd] END AS AP_OFC_CD
, @[ap_ctr_cd]                  AP_CTR_CD
, '512641'                      COMM_STND_COST_CD
, @[por_cd]          			FAC_OCCR_INFO_CD
, @[slan_cd]                	FAC_SLAN_CD
, @[rlane_cd]               	FAC_RLANE_CD
, @[vsl_cd]                 	FAC_VSL_CD
, @[skd_voy_no]             	FAC_SKD_VOY_NO
, @[skd_dir_cd]             	FAC_SKD_DIR_CD
, @[rlane_dir_cd]               FAC_REV_DIR_CD
, @[bkg_ff_cnt_cd]              BKG_FF_CNT_CD
, @[bkg_ff_seq]                 BKG_FF_SEQ
, @[vndr_cnt_cd]                VNDR_CNT_CD --
, NVL(@[vndr_seq],0)            VNDR_SEQ --
, @[fac_div_cd]                 FAC_DIV_CD
, @[fac_spcl_cntr_tp_ctnt1]     FAC_SPCL_CNTR_TP_CTNT1
, @[fac_spcl_cntr_rt1]          FAC_SPCL_CNTR_RT1
, @[fac_spcl_cntr_tp_ctnt2]     FAC_SPCL_CNTR_TP_CTNT2
, @[fac_spcl_cntr_rt2]          FAC_SPCL_CNTR_RT2
, @[fac_bkg_rt]                 FAC_BKG_RT
, @[fac_bkg_amt]                FAC_BKG_AMT
, @[bkg_bx_qty]                 BKG_BX_QTY
, @[fac_bx_amt]                 FAC_BX_AMT
, @[bkg_dry_teu_qty]            BKG_DRY_TEU_QTY
, @[fac_dry_teu_amt]            FAC_DRY_TEU_AMT
, @[bkg_dry_feu_qty]            BKG_DRY_FEU_QTY
, @[fac_dry_feu_amt]            FAC_DRY_FEU_AMT
, @[bkg_rf_teu_qty]             BKG_RF_TEU_QTY
, @[fac_rf_teu_amt]             FAC_RF_TEU_AMT
, @[bkg_rf_feu_qty]             BKG_RF_FEU_QTY
, @[fac_rf_feu_amt]             FAC_RF_FEU_AMT
, @[bkg_spcl_teu_qty]           BKG_SPCL_TEU_QTY
, @[fac_spcl_teu_amt]           FAC_SPCL_TEU_AMT
, @[bkg_spcl_feu_qty]           BKG_SPCL_FEU_QTY
, @[fac_spcl_feu_amt]           FAC_SPCL_FEU_AMT
, @[fac_chg_ctnt]               FAC_CHG_CTNT
, @[curr_cd]                    CURR_CD
, 0			                    MON_XCH_RT
, NVL((SELECT ROUND (NVL (CRNT_AMT, 0), 2)
  FROM ACM_FAC_COMM 
 WHERE BKG_NO = @[bkg_no]  
	AND FAC_SEQ = @[fac_seq] - 1 ),0) AS PAY_PPD_AMT -- 
, @[crnt_amt]               PAY_CRNT_AMT -- 
, ( @[crnt_amt] -
NVL((SELECT ROUND (NVL (CRNT_AMT, 0), 2)
  FROM ACM_FAC_COMM 
 WHERE BKG_NO = @[bkg_no]  
	AND FAC_SEQ = @[fac_seq] - 1 ),0)
) AS PAY_IF_AMT -- 
, @[cmdt_tp_cd]                 CMDT_TP_CD --
, @[cmdt_cd]                    CMDT_CD
, (SELECT OFC_CHR_CD FROM ACM_OFC_INFO WHERE AGN_CD = @[fac_ofc_cd] AND ROWNUM = 1) AS OFC_CHR_CD
, 'Y'		                    ACCL_FLG
, @[inv_tax_rt]                 INV_TAX_RT --
, TO_CHAR(GLOBALDATE_PKG.TIME_CONV_OFC_FNC('SINHO',SYSDATE,'GMT'),'YYYYMMDD') AS GL_DT
, @[csr_no]                     CSR_NO --
, @[apro_usr_id]                APRO_USR_ID --
, TO_DATE (@[apro_dt], 'YYYYMMDDHH24MISS') APRO_DT --
, GLOBALDATE_PKG.TIME_CONV_OFC_FNC('SINHO',TO_DATE (@[apro_dt], 'YYYYMMDDHH24MISS'),'GMT') APRO_GDT --
, @[if_usr_id]                  IF_USR_ID --
, TO_DATE (@[if_dt], 'YYYYMMDDHH24MISS') IF_DT --
, GLOBALDATE_PKG.TIME_CONV_OFC_FNC('SINHO',TO_DATE (@[if_dt], 'YYYYMMDDHH24MISS'),'GMT') IF_GDT --
, @[fac_ofc_cd]                 FAC_OFC_CD
, @[ff_cnt_cd]                  FF_CNT_CD
, @[ff_cust_seq]                FF_SEQ
, @[fac_agmt_seq]               FAC_AGMT_SEQ
, 'Calculation Success!'        FAC_RMK
, @[user_id]                 CRE_USR_ID
, SYSDATE	                    CRE_DT
, @[user_id]                 UPD_USR_ID
, SYSDATE                     	UPD_DT
FROM DUAL			]]></sql>
			<params>
				<param name="bkg_no" type="12" value="" out="N"/>
				<param name="ppd_ofc_cd_chg_yn" type="12" value="" out="N"/>
				<param name="chg_ppd_ofc_cd" type="12" value="" out="N"/>
				<param name="ppd_ofc_cd" type="12" value="" out="N"/>
				<param name="fac_seq" type="12" value="" out="N"/>
				<param name="crnt_amt" type="12" value="" out="N"/>
				<param name="vps_etd_dt" type="12" value="" out="N"/>
				<param name="loc_div_cd" type="12" value="" out="N"/>
				<param name="loc_cd" type="12" value="" out="N"/>
				<param name="chg_ar_ofc_cd" type="12" value="" out="N"/>
				<param name="bkg_ar_ofc_cd" type="12" value="" out="N"/>
				<param name="chg_ap_ofc_cd" type="12" value="" out="N"/>
				<param name="ap_ofc_cd" type="12" value="" out="N"/>
				<param name="ap_ctr_cd" type="12" value="" out="N"/>
				<param name="por_cd" type="12" value="" out="N"/>
				<param name="slan_cd" type="12" value="" out="N"/>
				<param name="rlane_cd" type="12" value="" out="N"/>
				<param name="vsl_cd" type="12" value="" out="N"/>
				<param name="skd_voy_no" type="12" value="" out="N"/>
				<param name="skd_dir_cd" type="12" value="" out="N"/>
				<param name="rlane_dir_cd" type="12" value="" out="N"/>
				<param name="bkg_ff_cnt_cd" type="12" value="" out="N"/>
				<param name="bkg_ff_seq" type="12" value="" out="N"/>
				<param name="vndr_cnt_cd" type="12" value="" out="N"/>
				<param name="vndr_seq" type="12" value="" out="N"/>
				<param name="fac_div_cd" type="12" value="" out="N"/>
				<param name="fac_spcl_cntr_tp_ctnt1" type="12" value="" out="N"/>
				<param name="fac_spcl_cntr_rt1" type="12" value="" out="N"/>
				<param name="fac_spcl_cntr_tp_ctnt2" type="12" value="" out="N"/>
				<param name="fac_spcl_cntr_rt2" type="12" value="" out="N"/>
				<param name="fac_bkg_rt" type="12" value="" out="N"/>
				<param name="fac_bkg_amt" type="12" value="" out="N"/>
				<param name="bkg_bx_qty" type="12" value="" out="N"/>
				<param name="fac_bx_amt" type="12" value="" out="N"/>
				<param name="bkg_dry_teu_qty" type="12" value="" out="N"/>
				<param name="fac_dry_teu_amt" type="12" value="" out="N"/>
				<param name="bkg_dry_feu_qty" type="12" value="" out="N"/>
				<param name="fac_dry_feu_amt" type="12" value="" out="N"/>
				<param name="bkg_rf_teu_qty" type="12" value="" out="N"/>
				<param name="fac_rf_teu_amt" type="12" value="" out="N"/>
				<param name="bkg_rf_feu_qty" type="12" value="" out="N"/>
				<param name="fac_rf_feu_amt" type="12" value="" out="N"/>
				<param name="bkg_spcl_teu_qty" type="12" value="" out="N"/>
				<param name="fac_spcl_teu_amt" type="12" value="" out="N"/>
				<param name="bkg_spcl_feu_qty" type="12" value="" out="N"/>
				<param name="fac_spcl_feu_amt" type="12" value="" out="N"/>
				<param name="fac_chg_ctnt" type="12" value="" out="N"/>
				<param name="curr_cd" type="12" value="" out="N"/>
				<param name="cmdt_tp_cd" type="12" value="" out="N"/>
				<param name="cmdt_cd" type="12" value="" out="N"/>
				<param name="fac_ofc_cd" type="12" value="" out="N"/>
				<param name="inv_tax_rt" type="12" value="" out="N"/>
				<param name="csr_no" type="12" value="" out="N"/>
				<param name="apro_usr_id" type="12" value="" out="N"/>
				<param name="apro_dt" type="12" value="" out="N"/>
				<param name="if_usr_id" type="12" value="" out="N"/>
				<param name="if_dt" type="12" value="" out="N"/>
				<param name="ff_cnt_cd" type="12" value="" out="N"/>
				<param name="ff_cust_seq" type="12" value="" out="N"/>
				<param name="fac_agmt_seq" type="12" value="" out="N"/>
				<param name="user_id" type="12" value="" out="N"/>
			</params>
		</query>
	</querys>
</sqls>
