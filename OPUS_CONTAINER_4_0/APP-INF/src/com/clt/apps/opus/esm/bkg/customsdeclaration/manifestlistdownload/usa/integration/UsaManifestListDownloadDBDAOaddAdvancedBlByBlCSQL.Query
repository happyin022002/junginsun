<?xml version="1.0" encoding="UTF-8"?>
<sqls>
	<querys>
		<query name="UsaManifestListDownloadDBDAOaddAdvancedBlByBlCSQL">
			<desc><![CDATA[addAdvancedBlByBl]]></desc>
			<sql><![CDATA[
INSERT
  INTO BKG_CSTMS_ADV_BL
      (CNT_CD
      ,BL_NO
      ,BKG_NO
      ,VSL_CD
      ,SKD_VOY_NO
      ,SKD_DIR_CD
      ,SLAN_CD
      ,VSL_ARR_DT
      ,CSTMS_PORT_CD
      ,CSTMS_POL_CD
      ,CSTMS_POD_CD
      ,CSTMS_LOC_CD
      ,FROB_FLG
      ,POR_CD
      ,POL_CD
      ,POD_CD
      ,DEL_CD
      ,POD_NOD_CD
      ,DEL_NOD_CD
      ,CUST_TO_ORD_FLG
      ,USA_LST_LOC_CD
      ,HUB_LOC_CD
      ,PCK_QTY
      ,AMS_PCK_TP_CD
      ,CGO_WGT
      ,WGT_UT_CD
      ,MEAS_QTY
      ,MEAS_UT_CD
      ,RCV_TERM_CD
      ,DE_TERM_CD
      ,BDR_FLG
      ,BDR_DT
      ,BDR_OFC_CD
      ,CA_FLG
      ,CA_ISS_DT
      ,CA_NO
      ,SCAC_CD
      ,FULL_MTY_CD
      ,MF_STS_CD
      ,IF_FLG
      ,IF_DT
      ,MF_NO
      ,PRE_MF_NO
      ,CSTMS_FILE_TP_CD
      ,ACT_FILE_SKD_DIR_CD
      ,CRE_USR_ID
      ,CRE_DT
      ,UPD_USR_ID
      ,UPD_DT
     )
VALUES
      ( 'US'
       ,@[bl_no]
       ,@[bkg_no]
       ,@[vsl_cd]
       ,@[skd_voy_no]
       ,@[skd_dir_cd]
       ,@[slan_cd]
       ,TO_DATE(@[vsl_arr_dt],'YYYYMMDDHH24MISS')
       ,@[cstms_port_cd]
       ,@[cstms_pol_cd]
       ,@[cstms_pod_cd]
       ,DECODE(@[cstms_loc_cd], NULL, @[hub_loc_cd], @[cstms_loc_cd])
       ,@[frob_flg]
       ,@[por_cd]
       ,@[pol_cd]
       ,@[pod_cd]
       ,@[del_cd]
       ,@[pod_nod_cd]
       ,@[del_nod_cd]
       ,NVL(@[cust_to_ord_flg], 'N')
       ,@[usa_lst_loc_cd]
       ,@[hub_loc_cd]
       ,NVL(@[pck_qty],0)
       ,@[ams_pck_tp_cd]
       ,NVL(@[cgo_wgt],0)
       ,@[wgt_ut_cd]
       ,NVL(@[meas_qty],0)
       ,@[meas_ut_cd]
       ,@[rcv_term_cd]
       ,@[de_term_cd]
       ,NVL(@[bdr_flg],'N')
       ,TO_DATE(@[bdr_dt],'YYYYMMDDHH24MISS')
       ,@[bdr_ofc_cd]
       ,NVL(@[ca_flg],'N')
       ,TO_DATE(@[ca_iss_dt],'YYYYMMDDHH24MISS')
       ,@[ca_no]
       ,@[scac_cd]
       ,DECODE(@[full_mty_cd], 'P', 'M', 'F')
       ,'A'
       ,'Y'
       ,GLOBALDATE_PKG.TIME_CONV_FNC('KRPUS', SYSDATE, 'USNYC')
       ,@[mf_no]
       ,@[pre_mf_no]
       ,@[cstms_file_tp_cd]
       ,CASE WHEN SUBSTR(@[cstms_pol_cd],1,2) = 'CA' AND @[act_file_skd_dir_cd] IS NOT NULL THEN @[act_file_skd_dir_cd]
             WHEN SUBSTR(@[cstms_pol_cd],1,2) = 'CA' AND @[skd_dir_cd] = 'W' THEN 'E'
             WHEN SUBSTR(@[cstms_pol_cd],1,2) = 'CA' AND @[skd_dir_cd] = 'E' THEN 'W'
             ELSE ''
         END
       ,@[cre_usr_id]
       ,SYSDATE
       ,@[upd_usr_id]
       ,SYSDATE
      )
			]]></sql>
			<params>
				<param name="bl_no" type="12" value="" out="N"/>
				<param name="bkg_no" type="12" value="" out="N"/>
				<param name="vsl_cd" type="12" value="" out="N"/>
				<param name="skd_voy_no" type="12" value="" out="N"/>
				<param name="skd_dir_cd" type="12" value="" out="N"/>
				<param name="slan_cd" type="12" value="" out="N"/>
				<param name="vsl_arr_dt" type="12" value="" out="N"/>
				<param name="cstms_port_cd" type="12" value="" out="N"/>
				<param name="cstms_pol_cd" type="12" value="" out="N"/>
				<param name="cstms_pod_cd" type="12" value="" out="N"/>
				<param name="cstms_loc_cd" type="12" value="" out="N"/>
				<param name="hub_loc_cd" type="12" value="" out="N"/>
				<param name="frob_flg" type="12" value="" out="N"/>
				<param name="por_cd" type="12" value="" out="N"/>
				<param name="pol_cd" type="12" value="" out="N"/>
				<param name="pod_cd" type="12" value="" out="N"/>
				<param name="del_cd" type="12" value="" out="N"/>
				<param name="pod_nod_cd" type="12" value="" out="N"/>
				<param name="del_nod_cd" type="12" value="" out="N"/>
				<param name="cust_to_ord_flg" type="12" value="" out="N"/>
				<param name="usa_lst_loc_cd" type="12" value="" out="N"/>
				<param name="pck_qty" type="6" value="" out="N"/>
				<param name="ams_pck_tp_cd" type="12" value="" out="N"/>
				<param name="cgo_wgt" type="6" value="" out="N"/>
				<param name="wgt_ut_cd" type="12" value="" out="N"/>
				<param name="meas_qty" type="6" value="" out="N"/>
				<param name="meas_ut_cd" type="12" value="" out="N"/>
				<param name="rcv_term_cd" type="12" value="" out="N"/>
				<param name="de_term_cd" type="12" value="" out="N"/>
				<param name="bdr_flg" type="12" value="" out="N"/>
				<param name="bdr_dt" type="12" value="" out="N"/>
				<param name="bdr_ofc_cd" type="12" value="" out="N"/>
				<param name="ca_flg" type="12" value="" out="N"/>
				<param name="ca_iss_dt" type="12" value="" out="N"/>
				<param name="ca_no" type="12" value="" out="N"/>
				<param name="scac_cd" type="12" value="" out="N"/>
				<param name="full_mty_cd" type="12" value="" out="N"/>
				<param name="mf_no" type="12" value="" out="N"/>
				<param name="pre_mf_no" type="12" value="" out="N"/>
				<param name="cstms_file_tp_cd" type="12" value="" out="N"/>
				<param name="act_file_skd_dir_cd" type="12" value="" out="N"/>
				<param name="cre_usr_id" type="12" value="" out="N"/>
				<param name="upd_usr_id" type="12" value="" out="N"/>
			</params>
		</query>
	</querys>
</sqls>
