<?xml version="1.0" encoding="UTF-8"?>
<sqls>
	<querys>
		<query name="StatusReportDBDAOBkgRptDownExcel1702RSQL">
			<desc><![CDATA[BkgRptDownExcel1702]]></desc>
			<sql><![CDATA[
#if (${sel_cols} != '')  
SELECT ${sel_cols}
#else 
SELECT *
#end
FROM (
    SELECT
     '1' AS TEMP
    ,'Route & Schedule' AS	TS_PORT_1
    ,'Route & Schedule' AS	TS_PORT_2
    ,'Route & Schedule' AS	TS_PORT_3
    ,'Route & Schedule' AS	TS_PORT_4
    ,'BKG & B/L Info' AS	CGO_RLSE_STS
    ,'BKG & B/L Info' AS	DO_ISSUE_BY
    ,'BKG & B/L Info' AS	DO_ISSUE_DT
    ,'Cargo & Commodity' AS	GRS_WGT
    ,'Cargo & Commodity' AS	GRS_WGT_UT
    ,'BKG & B/L Info' AS	DOC_USR_ID
    ,'BKG & B/L Info' AS	BL_NO
    ,'BKG & B/L Info' AS	BL_TP_CD
    ,'BKG & B/L Info' AS	KR_CSTMS_CUST_TP_CD
    ,'BKG & B/L Info' AS	BKG_NO
    ,'BKG & B/L Info' AS	BKG_STS_CD
    ,'BKG & B/L Info' AS	BKG_KND
    ,'BKG & B/L Info' AS	CRD
    ,'' AS	CGO_RLSE
    ,'BKG & B/L Info' AS	CARRIER
    ,'BKG & B/L Info' AS	OBL_INET_PRN_DT
    ,'BKG & B/L Info' AS	HBL_NO
    ,'BKG & B/L Info' AS	BL_OBRD_DT
    ,'BKG & B/L Info' AS	OBL_ISS_FLG
    ,'BKG & B/L Info' AS	OBL_ISS_DT
    ,'BKG & B/L Info' AS	BKG_ISS_OFC_CD
    ,'BKG & B/L Info' AS	OBL_PRN_FLG
    ,'BKG & B/L Info' AS	BL_PRT_DT
    ,'BKG & B/L Info' AS	OBL_RLSE_FLG
    ,'BKG & B/L Info' AS	OBL_RLSE_DT
    ,'BKG & B/L Info' AS	BL_RLSE_OFC
    ,'BKG & B/L Info' AS	SRD_DT
    ,'BKG & B/L Info' AS	SRD_OFC
    ,'BKG & B/L Info' AS	SPLIT_FLG
    ,'BKG & B/L Info' AS	OB_SLS_OFC_CD
    ,'BKG & B/L Info' AS	OB_SLS_RGN_CD
    ,'BKG & B/L Info' AS	OB_SREP_CD
    ,'BKG & B/L Info' AS	SCAC_CD
    ,'BKG & B/L Info' AS	SI_DT
    ,'BKG & B/L Info' AS	CNTR_VOL
    ,'Cargo & Commodity' AS	CGO_DESC
    ,'Cargo & Commodity' AS	CGO_NATURE
    ,'' AS	CNTR_WGT
    ,'' AS	CNTR_WGT_UT
    ,'Cargo & Commodity' AS	CGO_WGT
    ,'Cargo & Commodity' AS	CGO_WGT_UT
    ,'Cargo & Commodity' AS	CM_MEAS
    ,'Cargo & Commodity' AS	CM_MEAS_UT
    ,'Cargo & Commodity' AS	TARE_WGT
    ,'Cargo & Commodity' AS	TARE_WGT_UT
    ,'Cargo & Commodity' AS	PCK_QTY
    ,'Cargo & Commodity' AS	PCK_TP_CD
    ,'Cargo & Commodity' AS	CMDT_HS_CD
    ,'Cargo & Commodity' AS	HAMO_CD_DESC
    ,'Charge' AS	C_1_CURR
    ,'Charge' AS	C_1_AMT
    ,'Charge' AS	C_2_CURR
    ,'Charge' AS	C_2_AMT
    ,'Charge' AS	C_3_CURR
    ,'Charge' AS	C_3_AMT
    ,'Charge' AS	C_4_CURR
    ,'Charge' AS	C_4_AMT
    ,'Charge' AS	P_1_CURR
    ,'Charge' AS	P_1_AMT
    ,'Charge' AS	P_2_CURR
    ,'Charge' AS	P_2_AMT
    ,'Charge' AS	P_3_CURR
    ,'Charge' AS	P_3_AMT
    ,'Charge' AS	P_4_CURR
    ,'Charge' AS	P_4_AMT
    ,'Container' AS	CNTR_NO
    ,'Container' AS	CNTR_SZ
    ,'Container' AS	CNMV_STS_CD
    ,'Container' AS	CNMV_STS_NMK
    ,'Container' AS	CNTR_SEAL_NO
    ,'Container' AS	CNTR_VOL_QTY
    ,'Container' AS	TEU
    ,'Container' AS	FEU
	,'Container' AS	VGM
    ,'Customer' AS	NF_CUST_NM
    ,'Customer' AS	AN_CUST_NM
    ,'Customer' AS	SH_CUST_NM
    ,'Customer' AS	SH_CNTC_PSON_NM
    ,'Customer' AS	SH_CNTC_NUM
    ,'Customer' AS	CN_CUST_NM
    ,'Customer' AS	FF_CUST_NM
    ,'Customer' AS	FF_CNTC_PSON_NM
    ,'Customer' AS	FW_CNTC_NUM
    ,'Customer' AS	OBL_INET_FLG
    ,'Customer' AS	CTRT_PTY_CD
    ,'Customer' AS	CTRT_PTY_NM
    ,'Inbound Info' AS	IB_CTRL_OFC
    ,'Inbound Info' AS	TROI
    ,'Inbound Info' AS	IB_FRH_FLG
    ,'Rate & Invoice' AS	ACM_AMT
    ,'Rate & Invoice' AS	ACM_PTY
    ,'Rate & Invoice' AS	TRF_CD
    ,'Reference No' AS	IBD_TRSP_TP_CD
    ,'Reference No' AS	CRN
    ,'Reference No' AS	ENS_MRN
    ,'Reference No' AS	EXS_MRN
    ,'Reference No' AS	CMRN_REF_NO
    ,'Reference No' AS	ACT_CSTMS_SMT_DT
    ,'Reference No' AS	XPT_LIC_NO
    ,'Reference No' AS	IBD_TRSP_NO
    ,'Route & Schedule' AS	BLCK_STWG_CD
    ,'Route & Schedule' AS	RCV_TERM_CD
    ,'Route & Schedule' AS	DE_TERM_CD
    ,'Route & Schedule' AS	TRAF_MOD_OB
    ,'Route & Schedule' AS	TRAF_MOD_IB
    ,'Route & Schedule' AS	TRUNK_SLAN_CD
    ,'Route & Schedule' AS	TRUNK_POL_CD
    ,'Route & Schedule' AS	TRUNK_POD_CD
    ,'Route & Schedule' AS	TRUNK_VVD
    ,'Route & Schedule' AS	VSL_NM
    ,'Route & Schedule' AS	BL_VVD
    ,'Route & Schedule' AS	BL_SLAN_CD
    ,'Route & Schedule' AS	TRD_CD
    ,'Route & Schedule' AS	SVC_SCP_CD
    ,'Route & Schedule' AS	POR_CNT_CD
    ,'Route & Schedule' AS	POR_CD
    ,'Route & Schedule' AS	POR_NM
    ,'Route & Schedule' AS	PRE1_POL_CD
    ,'Route & Schedule' AS	PRE1_POL_NM
    ,'Route & Schedule' AS	PRE2_POL_CD
    ,'Route & Schedule' AS	PRE2_POL_NM
    ,'Route & Schedule' AS	PRE3_POL_CD
    ,'Route & Schedule' AS	PRE3_POL_NM
    ,'Route & Schedule' AS	PRE4_POL_CD
    ,'Route & Schedule' AS	PRE4_POL_NM
    ,'Route & Schedule' AS	POST1_POL_CD
    ,'Route & Schedule' AS	POST1_POL_NM
    ,'Route & Schedule' AS	POST2_POL_CD
    ,'Route & Schedule' AS	POST2_POL_NM
    ,'Route & Schedule' AS	POST3_POL_CD
    ,'Route & Schedule' AS	POST3_POL_NM
    ,'Route & Schedule' AS	POST4_POL_CD
    ,'Route & Schedule' AS	POST4_POL_NM
    ,'Route & Schedule' AS	PRE1_POD_CD
    ,'Route & Schedule' AS	PRE1_POD_NM
    ,'Route & Schedule' AS	PRE2_POD_CD
    ,'Route & Schedule' AS	PRE2_POD_NM
    ,'Route & Schedule' AS	PRE3_POD_CD
    ,'Route & Schedule' AS	PRE3_POD_NM
    ,'Route & Schedule' AS	PRE4_POD_CD
    ,'Route & Schedule' AS	PRE4_POD_NM
    ,'Route & Schedule' AS	POST1_POD_CD
    ,'Route & Schedule' AS	POST1_POD_NM
    ,'Route & Schedule' AS	POST2_POD_CD
    ,'Route & Schedule' AS	POST2_POD_NM
    ,'Route & Schedule' AS	POST3_POD_CD
    ,'Route & Schedule' AS	POST3_POD_NM
    ,'Route & Schedule' AS	POST4_POD_CD
    ,'Route & Schedule' AS	POST4_POD_NM
    ,'Route & Schedule' AS	LAST_POD_CD
    ,'Route & Schedule' AS	LAST_POD_NM
    ,'Route & Schedule' AS	DEL_CNT_CD
    ,'Route & Schedule' AS	DEL_CD
    ,'Route & Schedule' AS	DEL_NM
    ,'Route & Schedule' AS	PRE1_VVD
    ,'Route & Schedule' AS	PRE2_VVD
    ,'Route & Schedule' AS	PRE3_VVD
    ,'Route & Schedule' AS	PRE4_VVD
    ,'Route & Schedule' AS	POST1_VVD
    ,'Route & Schedule' AS	POST2_VVD
    ,'Route & Schedule' AS	POST3_VVD
    ,'Route & Schedule' AS	POST4_VVD
    ,'Routing details' AS	FIRST_VVD
    ,'Routing details' AS	LAST_VVD
    ,'Route & Schedule' AS	FIRST_POL_ETD
    ,'Route & Schedule' AS	FIRST_POL_ATD
    ,'Route & Schedule' AS	LAST_POD_ETA
    ,'Route & Schedule' AS	LAST_POD_ATA
    ,'Route & Schedule' AS	TRSP_MOD_IB
    ,'Route & Schedule' AS	TRSP_MOD_OB
    ,'Route & Schedule' AS	FIRST_POL_CUTOFF_DT
    ,'Route & Schedule' AS	FIRST_POL_ETB
    ,'Route & Schedule' AS	LAST_POD_ETB
    ,'' AS	TS_POD
    FROM DUAL
UNION ALL
    SELECT
     '2' AS TEMP
    ,'T/S Port 1' AS	TS_PORT_1
    ,'T/S Port 2' AS	TS_PORT_2
    ,'T/S Port 3' AS	TS_PORT_3
    ,'T/S Port 4' AS	TS_PORT_4
    ,'Cargo Release Status' AS	CGO_RLSE_STS
    ,'Cleared By' AS	DO_ISSUE_BY
    ,'D/O Issue Date' AS	DO_ISSUE_DT
    ,'Gross Weight' AS	GRS_WGT
    ,'Gross Weight Unit' AS	GRS_WGT_UT
    ,'B/L Creator' AS	DOC_USR_ID
    ,'B/L No.' AS	BL_NO
    ,'B/L Type' AS	BL_TP_CD
    ,'B/L Type (KOR)' AS	KR_CSTMS_CUST_TP_CD
    ,'Booking No.' AS	BKG_NO
    ,'Booking Status' AS	BKG_STS_CD
    ,'Booking Kind' AS	BKG_KND
    ,'Cargo Received Date' AS	CRD
    ,'' AS	CGO_RLSE
    ,'Carrier' AS	CARRIER
    ,'Date Final B/L released to internet' AS	OBL_INET_PRN_DT
    ,'House B/L No.' AS	HBL_NO
    ,'On Board Date' AS	BL_OBRD_DT
    ,'B/L Issued' AS	OBL_ISS_FLG
    ,'B/L Issue Date' AS	OBL_ISS_DT
    ,'B/L Issue Office' AS	BKG_ISS_OFC_CD
    ,'O.B/L Printed' AS	OBL_PRN_FLG
    ,'B/L Print Date' AS	BL_PRT_DT
    ,'O.B/L Release Status' AS	OBL_RLSE_FLG
    ,'O.B/L Release Date' AS	OBL_RLSE_DT
    ,'Release OFC' AS	BL_RLSE_OFC
    ,'B/L Surrender Date' AS	SRD_DT
    ,'Surrender OFC' AS	SRD_OFC
    ,'Partial Shipment' AS	SPLIT_FLG
    ,'Sales OFC' AS	OB_SLS_OFC_CD
    ,'Sales Region' AS	OB_SLS_RGN_CD
    ,'Sales Rep' AS	OB_SREP_CD
    ,'SCAC Code' AS	SCAC_CD
    ,'SI Received Date/Time' AS	SI_DT
    ,'Booking Quantity' AS	CNTR_VOL
    ,'Cargo Description' AS	CGO_DESC
    ,'Cargo Nature' AS	CGO_NATURE
    ,'' AS	CNTR_WGT
    ,'' AS	CNTR_WGT_UT
    ,'Cargo Weight' AS	CGO_WGT
    ,'Cargo Weight Unit' AS	CGO_WGT_UT
    ,'Gross Measurement' AS	CM_MEAS
    ,'Gross Measurement Unit' AS	CM_MEAS_UT
    ,'Tare Weight' AS	TARE_WGT
    ,'Tare Weight Unit' AS	TARE_WGT_UT
    ,'No. of Package' AS	PCK_QTY
    ,'Package Type' AS	PCK_TP_CD
    ,'HS Code' AS	CMDT_HS_CD
    ,'HS Description' AS	HAMO_CD_DESC
    ,'Collect Freight Currency_1' AS	C_1_CURR
    ,'Collect Freight Total_1' AS	C_1_AMT
    ,'Collect Freight Currency_2' AS	C_2_CURR
    ,'Collect Freight Total_2' AS	C_2_AMT
    ,'Collect Freight Currency_3' AS	C_3_CURR
    ,'Collect Freight Total_3' AS	C_3_AMT
    ,'Collect Freight Currency_4' AS	C_4_CURR
    ,'Collect Freight Total_4' AS	C_4_AMT
    ,'Prepaid Freight Currency_1' AS	P_1_CURR
    ,'Prepaid Freight Total_1' AS	P_1_AMT
    ,'Prepaid Freight Currency_2' AS	P_2_CURR
    ,'Prepaid Freight Total_2' AS	P_2_AMT
    ,'Prepaid Freight Currency_3' AS	P_3_CURR
    ,'Prepaid Freight Total_3' AS	P_3_AMT
    ,'Prepaid Freight Currency_4' AS	P_4_CURR
    ,'Prepaid Freight Total_4' AS	P_4_AMT
    ,'Container Number' AS	CNTR_NO
    ,'Container Size Type' AS	CNTR_SZ
    ,'Container Movement Status' AS	CNMV_STS_CD
    ,'Container Movement Status Description' AS	CNMV_STS_NMK
    ,'Seal Number' AS	CNTR_SEAL_NO
    ,'Container Quantity' AS	CNTR_VOL_QTY
    ,'TEU' AS	TEU
    ,'FEU' AS	FEU
	,'VGM' AS 	VGM
    ,'1st Notify Party' AS	NF_CUST_NM
    ,'2nd Notify Party' AS	AN_CUST_NM
    ,'Shipper' AS	SH_CUST_NM
    ,'Shipper Contact Name' AS	SH_CNTC_PSON_NM
    ,'Shipper Contact Number' AS	SH_CNTC_NUM
    ,'Consignee' AS	CN_CUST_NM
    ,'Forwarder' AS	FF_CUST_NM
    ,'Forwarder Contact Name' AS	FF_CNTC_PSON_NM
    ,'Forwarder Contact Number' AS	FW_CNTC_NUM
    ,'Internet BL Flag' AS	OBL_INET_FLG
    ,'Contract Party Code' AS	CTRT_PTY_CD
    ,'Contract Party Name' AS	CTRT_PTY_NM
    ,'IB Control Office ' AS	IB_CTRL_OFC
    ,'IB Door Delivery Setup' AS	TROI
    ,'IB Freighting Setup' AS	IB_FRH_FLG
    ,'Brokerage Commission Amount' AS	ACM_AMT
    ,'Brokerage Commission Party' AS	ACM_PTY
    ,'Tariff Code' AS	TRF_CD
    ,'Customs IT/TE/IE #' AS	IBD_TRSP_TP_CD
    ,'Customs Reference Number' AS	CRN
    ,'ENS MRN' AS	ENS_MRN
    ,'EXS MRN' AS	EXS_MRN
    ,'Export MRN No. ' AS	CMRN_REF_NO
    ,'Actual Submission Date' AS	ACT_CSTMS_SMT_DT
    ,'Export License #' AS	XPT_LIC_NO
    ,'Status Remarks / I.T. #' AS	IBD_TRSP_NO
    ,'Block Stowage' AS	BLCK_STWG_CD
    ,'Receiving Term' AS	RCV_TERM_CD
    ,'Delivery Term' AS	DE_TERM_CD
    ,'Traffic Mode OB' AS	TRAF_MOD_OB
    ,'Traffic Mode IB' AS	TRAF_MOD_IB
    ,'Trunk Lane' AS	TRUNK_SLAN_CD
    ,'Trunk POL' AS	TRUNK_POL_CD
    ,'Trunk POD' AS	TRUNK_POD_CD
    ,'Trunk VVD' AS	TRUNK_VVD
    ,'Trunk Vessel' AS	VSL_NM
    ,'B/L VVD' AS	BL_VVD
    ,'B/L Service' AS	BL_SLAN_CD
    ,'Trade Code' AS	TRD_CD
    ,'Service Scope Code' AS	SVC_SCP_CD
    ,'POR Country' AS	POR_CNT_CD
    ,'POR Code' AS	POR_CD
    ,'POR Name' AS	POR_NM
    ,'Pre 1. POL Code' AS	PRE1_POL_CD
    ,'Pre 1. POL Name' AS	PRE1_POL_NM
    ,'Pre 2. POL Code' AS	PRE2_POL_CD
    ,'Pre 2. POL Name' AS	PRE2_POL_NM
    ,'Pre 3. POL Code' AS	PRE3_POL_CD
    ,'Pre 3. POL Name' AS	PRE3_POL_NM
    ,'Pre 4. POL Code' AS	PRE4_POL_CD
    ,'Pre 4. POL Name' AS	PRE4_POL_NM
    ,'Post 1. POL Code' AS	POST1_POL_CD
    ,'Post 1. POL Name' AS	POST1_POL_NM
    ,'Post 2. POL Code' AS	POST2_POL_CD
    ,'Post 2. POL Name' AS	POST2_POL_NM
    ,'Post 3. POL Code' AS	POST3_POL_CD
    ,'Post 3. POL Name' AS	POST3_POL_NM
    ,'Post 4. POL Code' AS	POST4_POL_CD
    ,'Post 4. POL Name' AS	POST4_POL_NM
    ,'Pre 1. POD Code' AS	PRE1_POD_CD
    ,'Pre 1. POD Name' AS	PRE1_POD_NM
    ,'Pre 2. POD Code' AS	PRE2_POD_CD
    ,'Pre 2. POD Name' AS	PRE2_POD_NM
    ,'Pre 3. POD Code' AS	PRE3_POD_CD
    ,'Pre 3. POD Name' AS	PRE3_POD_NM
    ,'Pre 4. POD Code' AS	PRE4_POD_CD
    ,'Pre 4. POD Name' AS	PRE4_POD_NM
    ,'Post 1. POD Code' AS	POST1_POD_CD
    ,'Post 1. POD Name' AS	POST1_POD_NM
    ,'Post 2. POD Code' AS	POST2_POD_CD
    ,'Post 2. POD Name' AS	POST2_POD_NM
    ,'Post 3. POD Code' AS	POST3_POD_CD
    ,'Post 3. POD Name' AS	POST3_POD_NM
    ,'Post 4. POD Code' AS	POST4_POD_CD
    ,'Post 4. POD Name' AS	POST4_POD_NM
    ,'Last POD Code' AS	LAST_POD_CD
    ,'Last POD Name' AS	LAST_POD_NM
    ,'DEL Country' AS	DEL_CNT_CD
    ,'DEL Code' AS	DEL_CD
    ,'DEL Name' AS	DEL_NM
    ,'Pre 1.VVD' AS	PRE1_VVD
    ,'Pre 2.VVD' AS	PRE2_VVD
    ,'Pre 3.VVD' AS	PRE3_VVD
    ,'Pre 4.VVD' AS	PRE4_VVD
    ,'Post 1.VVD' AS	POST1_VVD
    ,'Post 2.VVD' AS	POST2_VVD
    ,'Post 3.VVD' AS	POST3_VVD
    ,'Post 4.VVD' AS	POST4_VVD
    ,'OB Voyage Control' AS	FIRST_VVD
    ,'IB Voyage Control' AS	LAST_VVD
    ,'ETD from First POL' AS	FIRST_POL_ETD
    ,'ATD from First POL' AS	FIRST_POL_ATD
    ,'ETA at Last POD' AS	LAST_POD_ETA
    ,'ATA at Last POD' AS	LAST_POD_ATA
    ,'Transport Mode O/B' AS	TRSP_MOD_IB
    ,'Transport Mode I/B' AS	TRSP_MOD_OB
    ,'POL Cut-Off Date' AS	FIRST_POL_CUTOFF_DT
    ,'Berth at First POL' AS	FIRST_POL_ETB
    ,'Berth at Last POD' AS	LAST_POD_ETB
    ,'' AS	TS_POD
    FROM DUAL
UNION ALL
    SELECT 
         '3' AS TEMP
          ,BKG_GET_TOKEN_FNC(TS_POD,1) AS TS_PORT_1
          ,BKG_GET_TOKEN_FNC(TS_POD,2) AS TS_PORT_2
          ,BKG_GET_TOKEN_FNC(TS_POD,3) AS TS_PORT_3
          ,BKG_GET_TOKEN_FNC(TS_POD,4) AS TS_PORT_4
          ,BKG_GET_TOKEN_FNC(CGO_RLSE,1) AS CGO_RLSE_STS
          ,BKG_GET_TOKEN_FNC(CGO_RLSE,2) AS DO_ISSUE_BY
          ,BKG_GET_TOKEN_FNC(CGO_RLSE,3) AS DO_ISSUE_DT
          ,DECODE(CNTR_WGT_UT,'KGS',
                               TRIM(TO_CHAR(TO_NUMBER(NVL(CNTR_WGT,0),'999,999,999,990.99')+TO_NUMBER(NVL(TARE_WGT,0),'999,999,999,990.99'),'999,999,999,990.99')),
                             'LBS',
                               TRIM(TO_CHAR(TO_NUMBER(NVL(CNTR_WGT,0),'999,999,999,990.99')+ROUND(TO_NUMBER(NVL(TARE_WGT,0),'999,999,999,990.99') / 0.453592,2),'999,999,999,990.99'))
                 ) AS GRS_WGT
          ,CNTR_WGT_UT AS GRS_WGT_UT
          ,Z.*
    FROM (
			SELECT 
			 --BKG & B/L Info
			       ISS.BL_RDY_USR_ID AS DOC_USR_ID
			      ,BKG.BL_NO
			      ,DECODE(BKG.BL_NO_TP,9,'M',NVL(BKG.BL_TP_CD,'O')) AS BL_TP_CD
			      ,BKG.KR_CSTMS_CUST_TP_CD
			      ,BKG.BKG_NO
			      ,BKG.BKG_STS_CD
                  ,(SELECT INTG_CD_VAL_DESC FROM COM_INTG_CD_DTL WHERE INTG_CD_ID = 'CD01619' AND INTG_CD_VAL_CTNT = BKG.XTER_BKG_RQST_CD) AS BKG_KND
			      ,TO_CHAR(MIN(CNTR.CGO_RCV_DT) OVER (PARTITION BY BKG.BKG_NO),'YYYY-MM-DD HH24:MI') AS CRD
                  ,NVL(CASE WHEN SUBSTR(BKG.POD_CD,1,2) = 'KR' OR SUBSTR(BKG.POD_CD,1,2) = 'JP'
                            THEN (SELECT /*+ INDEX_DESC(DOTL XPKBKG_DO_DTL) */DECODE(DOTL.RLSE_STS_CD,'R','CLEAR','D','CLEAR',NULL)||','|| DOTL.EVNT_USR_ID||','||TO_CHAR(DOTL.EVNT_DT,'YYYY-MM-DD HH24:MI')
                                    FROM BKG_DO_DTL DOTL
                                   WHERE DOTL.BKG_NO = BKG.BKG_NO
                                     AND ROWNUM = 1)
                            WHEN SUBSTR(BKG.POD_CD,1,2) = 'US' OR SUBSTR(BKG.DEL_CD,1,2) = 'US'
                            THEN (SELECT DECODE(MRN_TML_EDI_SND_CD,'R','CLEAR','J','CLEAR',NULL) ||','|| RLSE.UPD_USR_ID||','||TO_CHAR(RLSE.MRN_TML_EDI_LST_SND_DT,'YYYY-MM-DD HH24:MI')
                                   FROM  BKG_CGO_RLSE RLSE
                                  WHERE  RLSE.BL_NO = BKG.BL_NO
                                  )
                            ELSE (SELECT DECODE(DOTL.RLSE_STS_CD,'R','CLEAR','D','CLEAR',NULL)||','|| DOTL.EVNT_USR_ID||','||TO_CHAR(DOTL.EVNT_DT,'YYYY-MM-DD HH24:MI')
                                    FROM BKG_DO_DTL DOTL, BKG_DO_CNTR DCNTR
                                   WHERE DCNTR.BKG_NO = BKG.BKG_NO
                                     AND DCNTR.CNTR_NO = CNTR.CNTR_NO
                                     AND DOTL.BKG_NO = DCNTR.BKG_NO
                                     AND DOTL.RLSE_SEQ = DCNTR.RLSE_SEQ
                                     AND ROWNUM = 1
                      ) END ,'HOLD') CGO_RLSE
                  ,'NYK' AS CARRIER
                  ,(SELECT TO_CHAR(MAX(N1ST_PRN_DT),'YYYY-MM-DD HH24:MI')
                      FROM BKG_INET_BL_PRN_AUTH INET
                     WHERE BKG_NO = BKG.BKG_NO
                       AND N1ST_PRN_DT IS NOT NULL) OBL_INET_PRN_DT
			      ,BKG_JOIN_FNC(CURSOR(SELECT HBL.HBL_NO
			                             FROM BKG_HBL HBL
			                            WHERE BKG.BKG_NO = HBL.BKG_NO),';') AS HBL_NO
			      ,TO_CHAR(DOC.BL_OBRD_DT,'YYYY-MM-DD') AS BL_OBRD_DT
			      ,ISS.OBL_ISS_FLG
			      ,TO_CHAR(OBL_ISS_DT,'YYYY-MM-DD') AS OBL_ISS_DT
			      ,OBL_ISS_OFC_CD AS BKG_ISS_OFC_CD
			      ,NVL((SELECT 'Y' FROM BKG_INET_BL_PRN_AUTH WHERE BKG_NO = BKG.BKG_NO AND N1ST_PRN_DT IS NOT NULL AND DELT_FLG = 'N' AND ROWNUM = 1),NVL(ISS.OBL_PRN_FLG,'N')) AS OBL_PRN_FLG
			      ,(SELECT TO_CHAR(GLOBALDATE_PKG.TIME_CONV_FNC(COM_CONSTANTMGR_PKG.COM_GETBASELOCATIONCODE_FNC(),nvl2(MIN(H.CRE_DT), nvl2(MIN(A.N1ST_PRN_DT), least(MIN(H.CRE_DT), MIN(A.N1ST_PRN_DT)), MIN(H.CRE_DT)), MIN(A.N1ST_PRN_DT)),BKG.POL_CD),'YYYY-MM-DD HH24:MI')
                      FROM BKG_BOOKING T, BKG_HIS_DTL H, BKG_INET_BL_PRN_AUTH A
                     WHERE T.BKG_NO = H.BKG_NO(+)
                       AND T.BKG_NO = A.BKG_NO(+)
                       AND T.BKG_NO = BKG.BKG_NO
                       AND H.HIS_CATE_NM(+) = 'O.B/L PRINT'
                       AND A.N1ST_PRN_DT(+) IS NOT NULL
                       AND A.DELT_FLG(+) = 'N' ) AS BL_PRT_DT
			      ,ISS.OBL_RLSE_FLG
			      ,(SELECT TO_CHAR(EVNT_DT,'YYYY-MM-DD HH24:MI') FROM BKG_DOC_PROC_SKD PROC
                     WHERE PROC.BKG_DOC_PROC_TP_CD = 'OBLREL'
                       AND PROC.BKG_NO = BKG.BKG_NO
                       AND PROC.DOC_PERF_DELT_FLG ='N'
                       AND ROWNUM=1) AS OBL_RLSE_DT
                  ,(SELECT USR.OFC_CD FROM BKG_DOC_PROC_SKD PROC, COM_USER USR
                     WHERE PROC.BKG_DOC_PROC_TP_CD = 'OBLREL'
                       AND PROC.BKG_NO = BKG.BKG_NO
                       AND PROC.DOC_PERF_DELT_FLG ='N'
                       AND PROC.EVNT_USR_ID = USR.USR_ID
                       AND ROWNUM=1) AS BL_RLSE_OFC
			      ,TO_CHAR(SRD.EVNT_DT,'YYYY-MM-DD HH24:MI') AS SRD_DT
			      ,USR.OFC_CD AS SRD_OFC
			      ,BKG.SPLIT_FLG
			      ,BKG.OB_SLS_OFC_CD
			      ,SLS_LOC.RGN_CD AS OB_SLS_RGN_CD
			      ,BKG.OB_SREP_CD
			      ,BKG.SCAC_CD
			      ,(SELECT TO_CHAR(MIN(XTER.RQST_DT) OVER (PARTITION BY BKG.BKG_NO),'YYYY-MM-DD HH24:MI')
			          FROM BKG_XTER_RQST_MST XTER
			         WHERE XTER.DOC_TP_CD = 'S'
			           AND BKG.BKG_NO = XTER.BKG_NO
			           AND ROWNUM = 1) AS SI_DT
			      ,BKG_JOIN_FNC(CURSOR(SELECT CNTR_TPSZ_CD||'-'||LTRIM(TO_CHAR(NVL(OP_CNTR_QTY, 0),'990.99'))
                                         FROM BKG_QUANTITY Q
                                        WHERE Q.BKG_NO = BKG.BKG_NO
                                          AND Q.CNTR_TPSZ_CD IS NOT NULL)) CNTR_VOL
			 --Cargo & Commodity
			      ,REPLACE(REPLACE(REPLACE(CM.CNTR_MF_GDS_DESC,CHR(10),' '),CHR(9),' '),CHR(34),'') AS CGO_DESC
			      ,NVL(SUBSTR(DECODE(BKG.DCGO_FLG,'Y',',DG','')||DECODE(BKG.RC_FLG,'Y',',RF','')||DECODE(BKG.AWK_CGO_FLG,'Y',',AW','')||DECODE(BKG.BB_CGO_FLG,'Y',',BB','')||DECODE(BKG.RD_CGO_FLG,'Y',',RD',''),2),'DR') AS CGO_NATURE
			      ,TRIM(TO_CHAR(CNTR.CNTR_WGT,'999,999,999,990.99')) AS CNTR_WGT
			      ,CNTR.WGT_UT_CD AS CNTR_WGT_UT
			      ,TRIM(TO_CHAR(CM.CNTR_MF_WGT,'999,999,999,990.99')) AS CGO_WGT
			      ,CM.WGT_UT_CD AS CGO_WGT_UT
			      ,TO_CHAR(CM.MEAS_QTY) AS CM_MEAS
			      ,CM.MEAS_UT_CD AS CM_MEAS_UT
			      ,NVL((SELECT TRIM(TO_CHAR(ROUND(B.TARE_WGT,1),'999,999,999,990.99'))
                          FROM MST_CONTAINER A
                              ,MST_CNTR_SPEC B
                         WHERE A.CNTR_SPEC_NO = B.CNTR_SPEC_NO
                           AND A.CNTR_NO = CNTR.CNTR_NO)
                     , (SELECT TRIM(TO_CHAR(ROUND(CNTR_TPSZ_TARE_WGT,1),'999,999,999,990.99'))
                          FROM MDM_CNTR_TP_SZ MDM
                         WHERE MDM.CNTR_TPSZ_CD = CNTR.CNTR_TPSZ_CD)
                   ) AS TARE_WGT
                  ,'KGS' AS TARE_WGT_UT
			      ,TO_CHAR(CM.PCK_QTY) AS PCK_QTY
			      ,CM.PCK_TP_CD
				  ,DECODE(SUBSTR(CM.CMDT_HS_CD,1,1),0,'''','')||CM.CMDT_HS_CD AS CMDT_HS_CD
				  ,HS.HAMO_CD_DESC
			 --Charge
                  ,CHG.C_1_CURR
                  ,TRIM(TO_CHAR(CHG.C_1_AMT,'999,999,999,990.99')) AS C_1_AMT
                  ,CHG.C_2_CURR
                  ,TRIM(TO_CHAR(CHG.C_2_AMT,'999,999,999,990.99')) AS C_2_AMT
                  ,CHG.C_3_CURR
                  ,TRIM(TO_CHAR(CHG.C_3_AMT,'999,999,999,990.99')) AS C_3_AMT
                  ,CHG.C_4_CURR
                  ,TRIM(TO_CHAR(CHG.C_4_AMT,'999,999,999,990.99')) AS C_4_AMT
                  ,CHG.P_1_CURR
                  ,TRIM(TO_CHAR(CHG.P_1_AMT,'999,999,999,990.99')) AS P_1_AMT
                  ,CHG.P_2_CURR
                  ,TRIM(TO_CHAR(CHG.P_2_AMT,'999,999,999,990.99')) AS P_2_AMT
                  ,CHG.P_3_CURR
                  ,TRIM(TO_CHAR(CHG.P_3_AMT,'999,999,999,990.99')) AS P_3_AMT
                  ,CHG.P_4_CURR
                  ,TRIM(TO_CHAR(CHG.P_4_AMT,'999,999,999,990.99')) AS P_4_AMT
			 --Container
			      ,CNTR.CNTR_NO
			      ,CNTR.CNTR_TPSZ_CD AS CNTR_SZ
				  ,DECODE(BKG.BKG_STS_CD,'X','',
							DECODE((SELECT COP.COP_STS_CD FROM SCE_COP_HDR COP WHERE COP.BKG_NO = CNTR.BKG_NO AND COP.CNTR_NO = CNTR.CNTR_NO AND COP_STS_CD <> 'X'),'F','MT',
									(SELECT B.CNMV_STS_CD FROM MST_CONTAINER B WHERE B.CNTR_NO = CNTR.CNTR_NO))) CNMV_STS_CD
			      ,(SELECT INTG_CD_VAL_DESC FROM COM_INTG_CD_DTL CD_DTL WHERE CD_DTL.INTG_CD_ID = 'CD00252' 
																		AND CD_DTL.INTG_CD_VAL_CTNT=(DECODE(BKG.BKG_STS_CD,'X','',
							DECODE((SELECT COP.COP_STS_CD FROM SCE_COP_HDR COP WHERE COP.BKG_NO = CNTR.BKG_NO AND COP.CNTR_NO = CNTR.CNTR_NO AND COP_STS_CD <> 'X'),'F','MT',
									(SELECT B.CNMV_STS_CD FROM MST_CONTAINER B WHERE B.CNTR_NO = CNTR.CNTR_NO))))) AS CNMV_STS_NMK
			      ,BKG_JOIN_FNC(CURSOR(SELECT CNTR_SEAL_NO
										 FROM BKG_CNTR_SEAL_NO CNTR_SEAL
										WHERE CNTR.BKG_NO = CNTR_SEAL.BKG_NO
										  AND CNTR.CNTR_NO = CNTR_SEAL.CNTR_NO),';') AS CNTR_SEAL_NO
                  ,TO_CHAR(CNTR.CNTR_VOL_QTY) AS CNTR_VOL_QTY
                  ,(SELECT TO_CHAR(SUM(DECODE(CNTR_SZ_CD, 2, 1, 2) * OP_CNTR_QTY))
                      FROM BKG_QUANTITY QTY,
                           MDM_CNTR_TP_SZ MDM
                     WHERE BKG_NO = BKG.BKG_NO
                       AND QTY.CNTR_TPSZ_CD = MDM.CNTR_TPSZ_CD) AS TEU
                  ,(SELECT TO_CHAR(SUM(DECODE(CNTR_SZ_CD, 2, 0.5, 1) * OP_CNTR_QTY))
                      FROM BKG_QUANTITY QTY,
                           MDM_CNTR_TP_SZ MDM
                     WHERE BKG_NO = BKG.BKG_NO
                       AND QTY.CNTR_TPSZ_CD = MDM.CNTR_TPSZ_CD) AS FEU
				  ,DECODE(NVL(CNTR.VGM_WGT,0),0,'N','Y') AS VGM
			 --Customer
			      ,REPLACE(REPLACE(REPLACE(NF.CUST_NM,CHR(10),' '),CHR(9),' '),CHR(34),'') AS NF_CUST_NM
			      ,REPLACE(REPLACE(REPLACE(AN.CUST_NM,CHR(10),' '),CHR(9),' '),CHR(34),'') AS AN_CUST_NM
			      ,REPLACE(REPLACE(REPLACE(SH.CUST_NM,CHR(10),' '),CHR(9),' '),CHR(34),'') AS SH_CUST_NM
			      ,SH_ADDR.CNTC_PSON_NM AS SH_CNTC_PSON_NM
			      ,(SELECT A.INTL_PHN_NO || A.PHN_NO
			          FROM MDM_CUST_CNTC_PNT A
			              ,BKG_CUSTOMER B
			         WHERE A.CUST_CNT_CD = B.CUST_CNT_CD
			           AND A.CUST_SEQ = B.CUST_SEQ
			           AND B.BKG_CUST_TP_CD = 'S'
			           AND ROWNUM = 1) AS SH_CNTC_NUM
			      ,REPLACE(REPLACE(REPLACE(CN.CUST_NM,CHR(10),' '),CHR(9),' '),CHR(34),'') AS CN_CUST_NM
			      ,REPLACE(REPLACE(REPLACE(FF.CUST_NM,CHR(10),' '),CHR(9),' '),CHR(34),'') AS FF_CUST_NM
			      ,FF_ADDR.CNTC_PSON_NM AS FF_CNTC_PSON_NM
			      ,(SELECT A.INTL_PHN_NO || A.PHN_NO
			          FROM MDM_CUST_CNTC_PNT A
			              ,BKG_CUSTOMER B
			         WHERE A.CUST_CNT_CD = B.CUST_CNT_CD
			           AND A.CUST_SEQ = B.CUST_SEQ
			           AND B.BKG_CUST_TP_CD = 'F'
			           AND ROWNUM = 1) AS FW_CNTC_NUM
			      ,ISS.OBL_INET_FLG
                  ,BKG_CTRL_PTY_CUST_CNT_CD||LPAD(BKG.BKG_CTRL_PTY_CUST_SEQ,6,'0') AS CTRT_PTY_CD
                  ,(SELECT CUST_LGL_ENG_NM FROM MDM_CUSTOMER WHERE CUST_CNT_CD = BKG.BKG_CTRL_PTY_CUST_CNT_CD AND CUST_SEQ = BKG.BKG_CTRL_PTY_CUST_SEQ) AS CTRT_PTY_NM
			 --Inbound Info
                  ,(SELECT SLS_OFC_CD
                      FROM MDM_LOCATION A
                     WHERE A.LOC_CD = BKG.DEL_CD) AS IB_CTRL_OFC
			      ,(SELECT DECODE(COUNT(TROI.BKG_NO) OVER (PARTITION BY TROI.BKG_NO), 0, 'N', 'Y')     
			          FROM BKG_EUR_TRO TROI
			         WHERE BKG.BKG_NO = TROI.BKG_NO
			           AND TROI.IO_BND_CD = 'I'
			           AND ROWNUM = 1) AS TROI
                  ,NVL((SELECT 'Complete' FROM BKG_CHG_RT WHERE BKG_NO = BKG.BKG_NO AND ROWNUM=1),'Incomplete') AS IB_FRH_FLG
			 --Rate & Invoice
			      ,(SELECT /*+ INDEX_DESC(A XPKACM_FF_CMPN) */TO_CHAR(CRNT_AMT)
                      FROM ACM_FF_CMPN A
                     WHERE BKG_NO = BKG.BKG_NO
                       AND ROWNUM = 1
                   ) AS ACM_AMT
			      ,(SELECT /*+ INDEX_DESC(A XPKACM_FF_CMPN) */M.CUST_LGL_ENG_NM
                      FROM ACM_FF_CMPN A, MDM_CUSTOMER M
                     WHERE BKG_NO = BKG.BKG_NO
                       AND A.BKG_FF_CNT_CD = M.CUST_CNT_CD
                       AND A.BKG_FF_SEQ = M.CUST_SEQ
                       AND ROWNUM = 1
                   ) AS ACM_PTY
			      ,NVL(BKG.TAA_NO,NVL(BKG.RFA_NO,BKG.SC_NO)) AS TRF_CD
			 --Reference No
			      ,IBD_TRSP_TP_CD||DECODE(IBD_TRSP_TP_CD,'61','(IT)','62','(T&E)','63','(IE)','') AS IBD_TRSP_TP_CD
			      ,(SELECT CRN_BL.VSL_CALL_REF_NO
			          FROM BKG_VVD CRN_VVD
			              ,BKG_CSTMS_RTM_BL CRN_BL
			              ,BKG_CSTMS_RTM_VSL CRN_VSL
			         WHERE BKG.BKG_NO = CRN_VVD.BKG_NO
			           AND BKG.BKG_NO = CRN_BL.BKG_NO
			           AND CRN_VVD.POD_CD LIKE 'NL%'
			           AND CRN_VVD.VSL_CD = CRN_VSL.VSL_CD
			           AND CRN_VVD.SKD_VOY_NO = CRN_VSL.SKD_VOY_NO
			           AND CRN_VVD.SKD_DIR_CD = CRN_VSL.SKD_DIR_CD
			           AND CRN_VSL.VSL_CALL_REF_NO = CRN_BL.VSL_CALL_REF_NO
                       AND ROWNUM = 1) AS CRN
                  ,BKG_JOIN_FNC(CURSOR(SELECT EUR_BL.MVMT_REF_NO
										 FROM BKG_CSTMS_EUR_BL EUR_BL
										WHERE BKG.BL_NO = EUR_BL.BL_NO),';') AS ENS_MRN
			      ,BKG_JOIN_FNC(CURSOR(SELECT EX_EUR_BL.MVMT_REF_NO
										 FROM BKG_CSTMS_EUR_IO_BL EX_EUR_BL
										WHERE BKG.BL_NO = EX_EUR_BL.BL_NO),';') AS EXS_MRN
                  ,DECODE(CNTR.CNTR_NO, NULL, 
                                          BKG_JOIN_FNC(CURSOR(SELECT CUST_REF_NO_CTNT
                                                                FROM BKG_REFERENCE CMRN
                                                               WHERE CMRN.BKG_NO = BKG.BKG_NO
                                                                 AND CMRN.BKG_REF_TP_CD = 'CMRN'
                                                               ORDER BY CMRN.REF_SEQ
                                                              ),','),
                                          (SELECT CUST_REF_NO_CTNT
                                             FROM BKG_REFERENCE CMRN
                                            WHERE CMRN.BKG_NO = BKG.BKG_NO
                                              AND CMRN.CNTR_NO = CNTR.CNTR_NO
                                              AND CMRN.BKG_REF_TP_CD = 'CMRN')) AS CMRN_REF_NO
			      ,(SELECT TO_CHAR(SND_DT,'YYYY-MM-DD HH24:MI')
			          FROM BKG_CSTMS_EUR_IO_BL IO, 
			               BKG_CSTMS_EUR_IO_SND SND,
			               BKG_VVD IO_VVD
                     WHERE IO.MSG_SND_NO = SND.MSG_SND_NO
                       AND IO.BL_NO = BKG.BL_NO
                       AND IO_VVD.BKG_NO = BKG.BKG_NO
                       AND IO.BND_TP_CD = 'O'
                       AND IO.VSL_CD = IO_VVD.VSL_CD
                       AND IO.SKD_VOY_NO = IO_VVD.SKD_VOY_NO
                       AND IO.SKD_DIR_CD = IO_VVD.SKD_DIR_CD
                       AND ROWNUM = 1
                   ) AS ACT_CSTMS_SMT_DT			
			      ,(SELECT XPT_LIC_NO
			          FROM BKG_XPT_IMP_LIC XIL
			         WHERE BKG.BKG_NO = XIL.BKG_NO
			           AND XPT_LIC_NO IS NOT NULL
			           AND ROWNUM = 1) AS XPT_LIC_NO
			      ,IBD_TRSP_NO
			 --Route & Schedule
			      ,BKG.BLCK_STWG_CD
                  ,DECODE(BKG.RCV_TERM_CD, 'D', 'C', 'M') AS RCV_TERM_CD
                  ,NVL((SELECT DECODE(TRO.HLG_TP_CD, 'C', 'C', 'M')
                            FROM BKG_EUR_TRO TRO
                           WHERE TRO.BKG_NO = BKG.BKG_NO
                             AND TRO.CNTR_NO = CNTR.CNTR_NO
                             AND TRO.IO_BND_CD = 'I'
                             AND TRO.CXL_FLG = 'N'
							 AND ROWNUM = 1), DECODE(BKG.DE_TERM_CD, 'D', 'C', 'M')) AS DE_TERM_CD
                  ,DECODE(NVL(CNTR.RCV_TERM_CD, BKG.RCV_TERM_CD),'S','LCL','FCL') AS TRAF_MOD_OB
                  ,DECODE(NVL(CNTR.DE_TERM_CD, BKG.DE_TERM_CD),'S','LCL','FCL') AS TRAF_MOD_IB
			      ,BKG.SLAN_CD AS TRUNK_SLAN_CD
                  ,TRUNK.POL_CD AS TRUNK_POL_CD
                  ,TRUNK.POD_CD AS TRUNK_POD_CD
			      ,BKG.VSL_CD||BKG.SKD_VOY_NO||BKG.SKD_DIR_CD AS TRUNK_VVD
                  ,(SELECT VSL_ENG_NM FROM MDM_VSL_CNTR M WHERE M.VSL_CD = BKG.VSL_CD) AS VSL_NM
			      ,BKG.VSL_CD||BKG.SKD_VOY_NO||BKG.SKD_DIR_CD AS BL_VVD
			      ,BKG.SLAN_CD AS BL_SLAN_CD
			      ,(SELECT TRD_CD FROM COA_RGST_BKG C WHERE C.BKG_NO = BKG.BKG_NO) AS TRD_CD
			      ,BKG.SVC_SCP_CD AS SVC_SCP_CD
			      ,SUBSTR(BKG.POR_CD,1,2) POR_CNT_CD
			      ,BKG.POR_CD
			      ,(SELECT LOC_NM FROM MDM_LOCATION MDM WHERE MDM.LOC_CD = BKG.POR_CD) AS POR_NM
                  ,VVD5.POL_CD AS PRE1_POL_CD
                  ,(SELECT LOC_NM FROM MDM_LOCATION WHERE LOC_CD = VVD5.POL_CD) AS PRE1_POL_NM
                  ,VVD6.POL_CD AS PRE2_POL_CD
                  ,(SELECT LOC_NM FROM MDM_LOCATION WHERE LOC_CD = VVD6.POL_CD) AS PRE2_POL_NM
                  ,VVD7.POL_CD AS PRE3_POL_CD
                  ,(SELECT LOC_NM FROM MDM_LOCATION WHERE LOC_CD = VVD7.POL_CD) AS PRE3_POL_NM
                  ,VVD8.POL_CD AS PRE4_POL_CD
                  ,(SELECT LOC_NM FROM MDM_LOCATION WHERE LOC_CD = VVD8.POL_CD) AS PRE4_POL_NM
                  ,VVD1.POL_CD AS POST1_POL_CD
                  ,(SELECT LOC_NM FROM MDM_LOCATION WHERE LOC_CD = VVD1.POL_CD) AS POST1_POL_NM
                  ,VVD2.POL_CD AS POST2_POL_CD
                  ,(SELECT LOC_NM FROM MDM_LOCATION WHERE LOC_CD = VVD2.POL_CD) AS POST2_POL_NM
                  ,VVD3.POL_CD AS POST3_POL_CD
                  ,(SELECT LOC_NM FROM MDM_LOCATION WHERE LOC_CD = VVD3.POL_CD) AS POST3_POL_NM
                  ,VVD4.POL_CD AS POST4_POL_CD
                  ,(SELECT LOC_NM FROM MDM_LOCATION WHERE LOC_CD = VVD4.POL_CD) AS POST4_POL_NM
                  ,VVD5.POD_CD AS PRE1_POD_CD
                  ,(SELECT LOC_NM FROM MDM_LOCATION WHERE LOC_CD = VVD5.POD_CD) AS PRE1_POD_NM
                  ,VVD6.POD_CD AS PRE2_POD_CD
                  ,(SELECT LOC_NM FROM MDM_LOCATION WHERE LOC_CD = VVD6.POD_CD) AS PRE2_POD_NM
                  ,VVD7.POD_CD AS PRE3_POD_CD
                  ,(SELECT LOC_NM FROM MDM_LOCATION WHERE LOC_CD = VVD7.POD_CD) AS PRE3_POD_NM
                  ,VVD8.POD_CD AS PRE4_POD_CD
                  ,(SELECT LOC_NM FROM MDM_LOCATION WHERE LOC_CD = VVD8.POD_CD) AS PRE4_POD_NM
                  ,VVD1.POD_CD AS POST1_POD_CD
                  ,(SELECT LOC_NM FROM MDM_LOCATION WHERE LOC_CD = VVD1.POD_CD) AS POST1_POD_NM
                  ,VVD2.POD_CD AS POST2_POD_CD
                  ,(SELECT LOC_NM FROM MDM_LOCATION WHERE LOC_CD = VVD2.POD_CD) AS POST2_POD_NM
                  ,VVD3.POD_CD AS POST3_POD_CD
                  ,(SELECT LOC_NM FROM MDM_LOCATION WHERE LOC_CD = VVD3.POD_CD) AS POST3_POD_NM
                  ,VVD4.POD_CD AS POST4_POD_CD
                  ,(SELECT LOC_NM FROM MDM_LOCATION WHERE LOC_CD = VVD4.POD_CD) AS POST4_POD_NM
                  ,BKG.POD_CD AS LAST_POD_CD
                  ,(SELECT LOC_NM FROM MDM_LOCATION WHERE LOC_CD = BKG.POD_CD) AS LAST_POD_NM
                  ,(SELECT CNT_CD FROM MDM_LOCATION WHERE LOC_CD = BKG.DEL_CD) AS DEL_CNT_CD
                  ,BKG.DEL_CD
                  ,(SELECT LOC_NM FROM MDM_LOCATION WHERE LOC_CD = BKG.DEL_CD) AS DEL_NM
                  ,VVD5.VSL_CD||VVD5.SKD_VOY_NO||VVD5.SKD_DIR_CD AS PRE1_VVD
                  ,VVD6.VSL_CD||VVD6.SKD_VOY_NO||VVD6.SKD_DIR_CD AS PRE2_VVD
                  ,VVD7.VSL_CD||VVD7.SKD_VOY_NO||VVD7.SKD_DIR_CD AS PRE3_VVD
                  ,VVD8.VSL_CD||VVD8.SKD_VOY_NO||VVD8.SKD_DIR_CD AS PRE4_VVD
                  ,VVD1.VSL_CD||VVD1.SKD_VOY_NO||VVD1.SKD_DIR_CD AS POST1_VVD
                  ,VVD2.VSL_CD||VVD2.SKD_VOY_NO||VVD2.SKD_DIR_CD AS POST2_VVD
                  ,VVD3.VSL_CD||VVD3.SKD_VOY_NO||VVD3.SKD_DIR_CD AS POST3_VVD
                  ,VVD4.VSL_CD||VVD4.SKD_VOY_NO||VVD4.SKD_DIR_CD AS POST4_VVD
			      ,N1ST_VVD.VSL_CD||N1ST_VVD.SKD_VOY_NO||N1ST_VVD.SKD_DIR_CD AS FIRST_VVD
			      ,LAST_VVD.VSL_CD||LAST_VVD.SKD_VOY_NO||LAST_VVD.SKD_DIR_CD AS LAST_VVD
			      ,TO_CHAR(N1ST_SKD.VPS_ETD_DT,'YYYY-MM-DD HH24:MI') AS FIRST_POL_ETD
                  ,DECODE(N1ST_SKD.ACT_INP_FLG,'Y',TO_CHAR(N1ST_SKD.VPS_ETD_DT,'YYYY-MM-DD HH24:MI'),'') AS FIRST_POL_ATD
			      ,TO_CHAR(LAST_SKD.VPS_ETA_DT,'YYYY-MM-DD HH24:MI') AS LAST_POD_ETA
                  ,DECODE(LAST_SKD.ACT_INP_FLG,'Y',TO_CHAR(LAST_SKD.VPS_ETA_DT,'YYYY-MM-DD HH24:MI'),'') AS LAST_POD_ATA
                  ,BKG.DEST_TRNS_MOD_CD AS TRSP_MOD_IB
                  ,BKG.ORG_TRNS_MOD_CD AS TRSP_MOD_OB
                  ,(SELECT TO_CHAR(NVL(MNL_SET_DT,SYS_SET_DT),'YYYY-MM-DD HH24:MI') FROM BKG_CLZ_TM WHERE CLZ_TP_CD = 'T' AND BKG_NO=BKG.BKG_NO) AS FIRST_POL_CUTOFF_DT
			      ,TO_CHAR(N1ST_SKD.VPS_ETB_DT,'YYYY-MM-DD HH24:MI') AS FIRST_POL_ETB
			      ,TO_CHAR(LAST_SKD.VPS_ETB_DT,'YYYY-MM-DD HH24:MI') AS LAST_POD_ETB
                  ,BKG_JOIN_FNC(CURSOR(SELECT /*+ INDEX(VV XPKBKG_VVD) */POD_CD
                      FROM BKG_VVD VV
                     WHERE VV.BKG_NO = BKG.BKG_NO
                       AND VV.POD_CD <> BKG.POD_CD--LAST POD는 TS PORT가 아님
                   ),',') AS TS_POD--위에서 GET해서 사용
			  FROM 
                   BKG_VVD VVD,
#if (${sail_from_dt} != '' && ${sail_to_dt} != '') 
                   VSK_VSL_PORT_SKD ETD_VSK,
#end
#if (${arr_from_dt} != '' && ${arr_to_dt} != '') 
                   VSK_VSL_PORT_SKD ETA_VSK,
#end
                   BKG_BOOKING BKG
			      ,BKG_BL_DOC DOC
			      ,BKG_BL_ISS ISS
			      ,BKG_CSTMS_ADV_IBD IBD
			      ,BKG_CONTAINER CNTR
			      ,BKG_CNTR_MF_DESC CM
			      ,BKG_HAMO_TRF HS
			      ,BKG_CUSTOMER SH
			      ,BKG_CUSTOMER FF
			      ,BKG_CUSTOMER NF
			      ,BKG_CUSTOMER AN
			      ,BKG_CUSTOMER CN
			      ,BKG_DOC_PROC_SKD SRD
			      ,COM_USER USR
			      ,MDM_ORGANIZATION SLS_ORG
			      ,MDM_LOCATION SLS_LOC
			      ,MDM_COMMODITY CMDT
                  ,BKG_VVD VVD1
                  ,BKG_VVD VVD2
                  ,BKG_VVD VVD3
                  ,BKG_VVD VVD4
                  ,BKG_VVD VVD5
                  ,BKG_VVD VVD6
                  ,BKG_VVD VVD7
                  ,BKG_VVD VVD8
                  ,BKG_VVD TRUNK
                  ,BKG_VVD N1ST_VVD
                  ,BKG_VVD LAST_VVD
			      ,VSK_VSL_PORT_SKD N1ST_SKD
			      ,VSK_VSL_PORT_SKD LAST_SKD
			      ,MDM_CUST_ADDR FF_ADDR
			      ,MDM_CUST_ADDR SH_ADDR
			      ,(SELECT BKG_NO, 
                           MAX(DECODE(FRT_TERM_CD,'C',DECODE(RNUM,1,CURR_CD,0),0)) AS C_1_CURR, MAX(DECODE(FRT_TERM_CD,'C',DECODE(RNUM,1,AMT,0),0)) AS C_1_AMT,
                           MAX(DECODE(FRT_TERM_CD,'C',DECODE(RNUM,2,CURR_CD,0),0)) AS C_2_CURR, MAX(DECODE(FRT_TERM_CD,'C',DECODE(RNUM,2,AMT,0),0)) AS C_2_AMT,
                           MAX(DECODE(FRT_TERM_CD,'C',DECODE(RNUM,3,CURR_CD,0),0)) AS C_3_CURR, MAX(DECODE(FRT_TERM_CD,'C',DECODE(RNUM,3,AMT,0),0)) AS C_3_AMT,
                           MAX(DECODE(FRT_TERM_CD,'C',DECODE(RNUM,4,CURR_CD,0),0)) AS C_4_CURR, MAX(DECODE(FRT_TERM_CD,'C',DECODE(RNUM,4,AMT,0),0)) AS C_4_AMT,
                           MAX(DECODE(FRT_TERM_CD,'P',DECODE(RNUM,1,CURR_CD,0),0)) AS P_1_CURR, MAX(DECODE(FRT_TERM_CD,'P',DECODE(RNUM,1,AMT,0),0)) AS P_1_AMT,
                           MAX(DECODE(FRT_TERM_CD,'P',DECODE(RNUM,2,CURR_CD,0),0)) AS P_2_CURR, MAX(DECODE(FRT_TERM_CD,'P',DECODE(RNUM,2,AMT,0),0)) AS P_2_AMT,
                           MAX(DECODE(FRT_TERM_CD,'P',DECODE(RNUM,3,CURR_CD,0),0)) AS P_3_CURR, MAX(DECODE(FRT_TERM_CD,'P',DECODE(RNUM,3,AMT,0),0)) AS P_3_AMT,
                           MAX(DECODE(FRT_TERM_CD,'P',DECODE(RNUM,4,CURR_CD,0),0)) AS P_4_CURR, MAX(DECODE(FRT_TERM_CD,'P',DECODE(RNUM,4,AMT,0),0)) AS P_4_AMT
                      FROM (
                            SELECT BKG_NO, FRT_TERM_CD, CURR_CD, SUM(CHG_AMT) AMT, ROW_NUMBER() OVER(PARTITION BY BKG_NO, FRT_TERM_CD ORDER BY DECODE(CURR_CD,'USD',0,1),CURR_CD) AS RNUM
                              FROM BKG_CHG_RT
                             WHERE N3PTY_RCV_OFC_CD IS NULL
                               AND FRT_INCL_XCLD_DIV_CD='N'
                            GROUP BY BKG_NO, FRT_TERM_CD, CURR_CD
                            )
                    GROUP BY BKG_NO
                   ) CHG
			 WHERE BKG.BKG_NO = DOC.BKG_NO
			   AND BKG.BKG_NO = ISS.BKG_NO(+)
			   AND BKG.BL_NO = IBD.BL_NO (+)
			   AND BKG.BKG_NO = CNTR.BKG_NO (+)
			   AND CNTR.BKG_NO = CM.BKG_NO (+)
			   AND CNTR.CNTR_NO = CM.CNTR_NO (+)
			   AND CM.CMDT_HS_CD = HS.HAMO_TRF_CD (+)
			   AND HS.HAMO_TP_CD (+) = 'H'
			   AND BKG.BKG_NO = SH.BKG_NO
			   AND SH.BKG_CUST_TP_CD = 'S'
			   AND BKG.BKG_NO = FF.BKG_NO
			   AND FF.BKG_CUST_TP_CD = 'F'
			   AND BKG.BKG_NO = NF.BKG_NO
			   AND NF.BKG_CUST_TP_CD = 'N'
			   AND BKG.BKG_NO = AN.BKG_NO
			   AND AN.BKG_CUST_TP_CD = 'A'
			   AND BKG.BKG_NO = CN.BKG_NO
			   AND CN.BKG_CUST_TP_CD = 'C'
			   AND BKG.BKG_NO = SRD.BKG_NO (+)
			   AND SRD.BKG_DOC_PROC_TP_CD (+) = 'OBLSRD'
			   AND SRD.DOC_PERF_DELT_FLG (+) = 'N'
			   AND SRD.EVNT_USR_ID = USR.USR_ID (+)
			   AND BKG.OB_SLS_OFC_CD = SLS_ORG.OFC_CD (+)
			   AND SLS_ORG.LOC_CD = SLS_LOC.LOC_CD (+)   
			   AND BKG.CMDT_CD = CMDT.CMDT_CD(+)
			   AND FF.CUST_CNT_CD = FF_ADDR.CUST_CNT_CD (+)
			   AND FF.CUST_SEQ = FF_ADDR.CUST_SEQ (+)
			   AND 'Y' = FF_ADDR.PRMRY_CHK_FLG (+)
			   AND SH.CUST_CNT_CD = SH_ADDR.CUST_CNT_CD (+)
			   AND SH.CUST_SEQ = SH_ADDR.CUST_SEQ (+)
			   AND 'S' = SH_ADDR.PRMRY_CHK_FLG (+)
               AND BKG.BKG_NO         = TRUNK.BKG_NO(+)
               AND BKG.VSL_CD         = TRUNK.VSL_CD(+)
               AND BKG.SKD_VOY_NO     = TRUNK.SKD_VOY_NO(+)
               AND BKG.SKD_DIR_CD     = TRUNK.SKD_DIR_CD(+)
               AND 'T'                = TRUNK.VSL_PRE_PST_CD(+)
               AND BKG.BKG_NO = VVD1.BKG_NO(+)
               AND 1 = VVD1.VSL_SEQ(+)
               AND 'U' = VVD1.VSL_PRE_PST_CD(+)
               AND BKG.BKG_NO = VVD2.BKG_NO(+)
               AND 2 = VVD2.VSL_SEQ(+)
               AND 'U' = VVD2.VSL_PRE_PST_CD(+)
               AND BKG.BKG_NO = VVD3.BKG_NO(+)
               AND 3 = VVD3.VSL_SEQ(+)
               AND 'U' = VVD3.VSL_PRE_PST_CD(+)
               AND BKG.BKG_NO = VVD4.BKG_NO(+)
               AND 4 = VVD4.VSL_SEQ(+)
               AND 'U' = VVD4.VSL_PRE_PST_CD(+)
               AND BKG.BKG_NO = VVD5.BKG_NO(+)
               AND 1 = VVD5.VSL_SEQ(+)
               AND 'S' = VVD5.VSL_PRE_PST_CD(+)
               AND BKG.BKG_NO = VVD6.BKG_NO(+)
               AND 2 = VVD6.VSL_SEQ(+)
               AND 'S' = VVD6.VSL_PRE_PST_CD(+)
               AND BKG.BKG_NO = VVD7.BKG_NO(+)
               AND 3 = VVD7.VSL_SEQ(+)
               AND 'S' = VVD7.VSL_PRE_PST_CD(+)
               AND BKG.BKG_NO = VVD8.BKG_NO(+)
               AND 4 = VVD8.VSL_SEQ(+)
               AND 'S' = VVD8.VSL_PRE_PST_CD(+)
               AND (N1ST_VVD.BKG_NO, N1ST_VVD.VSL_PRE_PST_CD, N1ST_VVD.VSL_SEQ) 
                                         = (SELECT /*+ index(v2 xpkbkg_vvd) */ 
                                                    V2.BKG_NO, V2.VSL_PRE_PST_CD, V2.VSL_SEQ
                                              FROM BKG_VVD V2
                                             WHERE V2.BKG_NO = BKG.BKG_NO
                                               AND ROWNUM = 1)
               AND (LAST_VVD.BKG_NO, LAST_VVD.VSL_PRE_PST_CD, LAST_VVD.VSL_SEQ) 
                                         = (SELECT /*+ index_desc(v2 xpkbkg_vvd) */ 
                                                    V2.BKG_NO, V2.VSL_PRE_PST_CD, V2.VSL_SEQ
                                              FROM BKG_VVD V2
                                             WHERE V2.BKG_NO = BKG.BKG_NO
                                               AND ROWNUM = 1)
               AND N1ST_VVD.VSL_CD     = N1ST_SKD.VSL_CD(+)
               AND N1ST_VVD.SKD_VOY_NO = N1ST_SKD.SKD_VOY_NO(+)
               AND N1ST_VVD.SKD_DIR_CD = N1ST_SKD.SKD_DIR_CD(+)
               AND N1ST_VVD.POL_CD     = N1ST_SKD.VPS_PORT_CD(+)
               AND N1ST_VVD.POL_CLPT_IND_SEQ = N1ST_SKD.CLPT_IND_SEQ(+)
               AND LAST_VVD.VSL_CD     = LAST_SKD.VSL_CD(+)
               AND LAST_VVD.SKD_VOY_NO = LAST_SKD.SKD_VOY_NO(+)
               AND LAST_VVD.SKD_DIR_CD = LAST_SKD.SKD_DIR_CD(+)
               AND LAST_VVD.POD_CD     = LAST_SKD.VPS_PORT_CD(+)
               AND LAST_VVD.POD_CLPT_IND_SEQ = LAST_SKD.CLPT_IND_SEQ(+)
               AND BKG.BKG_NO = CHG.BKG_NO(+)
--ROUTE
               AND VVD.BKG_NO = BKG.BKG_NO
#if (${vvd_cd} != '')
               AND VVD.VSL_CD = SUBSTR(@[vvd_cd], 1, 4)
               AND VVD.SKD_VOY_NO = SUBSTR(@[vvd_cd], 5, 4)
               AND VVD.SKD_DIR_CD = SUBSTR(@[vvd_cd], 9, 1)
#if (${trunk_flag} != '')
               AND VVD.VSL_PRE_PST_CD = 'T'
#end
#end
#if (${dir_cd} != '') 
               AND VVD.SKD_DIR_CD = @[dir_cd]
#end
#if (${pol_cd} != '')
               AND VVD.POL_CD = @[pol_cd]
#if (${pol_local} != '')
               AND BKG.POL_CD = VVD.POL_CD
#end
#if (${pol_ts} != '')
               AND BKG.POL_CD <> VVD.POL_CD
#end
#end
#if (${pol_yard_cd} != '') 
               AND SUBSTR(VVD.POL_YD_CD,-2) = @[pol_yard_cd]
#if (${pol_local} != '')
               AND BKG.POL_NOD_CD = VVD.POL_YD_CD
#end
#if (${pol_ts} != '')
               AND BKG.POL_NOD_CD <> VVD.POL_YD_CD
#end
#end
#if (${pod_cd} != '') 
               AND VVD.POD_CD = @[pod_cd]
#if (${pod_local} != '')
               AND BKG.POD_CD = VVD.POD_CD
#end
#if (${pod_ts} != '')
               AND BKG.POD_CD <> VVD.POD_CD
#end
#end
#if (${pod_yard_cd} != '') 
               AND SUBSTR(VVD.POD_YD_CD,-2) = @[pod_yard_cd]
#if (${pod_local} != '')
               AND BKG.POD_NOD_CD = VVD.POD_YD_CD
#end
#if (${pod_ts} != '')
               AND BKG.POD_NOD_CD <> VVD.POD_YD_CD
#end
#end

#if (${sail_from_dt} != '' && ${sail_to_dt} != '') 
               AND ETD_VSK.VSL_CD = VVD.VSL_CD
               AND ETD_VSK.SKD_VOY_NO = VVD.SKD_VOY_NO
               AND ETD_VSK.SKD_DIR_CD = VVD.SKD_DIR_CD
               AND ETD_VSK.VPS_PORT_CD = VVD.POL_CD
               AND ETD_VSK.CLPT_IND_SEQ = VVD.POL_CLPT_IND_SEQ
               AND ETD_VSK.VPS_ETD_DT >= TO_DATE(@[sail_from_dt],'YYYY-MM-DD') 
               AND ETD_VSK.VPS_ETD_DT <= TO_DATE(@[sail_to_dt],'YYYY-MM-DD') +0.99999
#end
#if (${arr_from_dt} != '' && ${arr_to_dt} != '') 
               AND ETA_VSK.VSL_CD = VVD.VSL_CD
               AND ETA_VSK.SKD_VOY_NO = VVD.SKD_VOY_NO
               AND ETA_VSK.SKD_DIR_CD = VVD.SKD_DIR_CD
               AND ETA_VSK.VPS_PORT_CD = VVD.POD_CD
               AND ETA_VSK.CLPT_IND_SEQ = VVD.POD_CLPT_IND_SEQ
               AND ETA_VSK.VPS_ETD_DT >= TO_DATE(@[arr_from_dt],'YYYY-MM-DD') 
               AND ETA_VSK.VPS_ETD_DT <= TO_DATE(@[arr_to_dt],'YYYY-MM-DD') +0.99999
#end

#if (${por_cd} != '') 
               AND BKG.POR_CD LIKE @[por_cd]||'%' 
#end
#if (${del_cd} != '') 
               AND BKG.DEL_CD LIKE @[del_cd]||'%' 
#end
#if (${r_term} != '') 
               AND BKG.RCV_TERM_CD IN (${r_term})
#end
#if (${d_term} != '') 
               AND BKG.DE_TERM_CD IN (${d_term})
#end

--B/L Surrender Date
#if (${bl_srnd_from_dt} != '')
               AND SRD.EVNT_DT >= TO_DATE(@[bl_srnd_from_dt],'YYYY-MM-DD') 
#end
#if (${bl_srnd_to_dt} != '')
               AND SRD.EVNT_DT <= TO_DATE(@[bl_srnd_to_dt],'YYYY-MM-DD') +0.99999
#end
--Carrier
#if (${crr_cd} != '')
               AND BKG.SCAC_CD      = @[crr_cd]
#end
#if (${sc_rfa_gbn} == 'S') 
#if (${sc_rfa_no} != '') 
               AND BKG.SC_NO = @[sc_rfa_no]
#end
#elseif (${sc_rfa_gbn} == 'R') 
#if (${sc_rfa_no} != '') 
               AND BKG.RFA_NO = @[sc_rfa_no]
#end
#elseif (${sc_rfa_gbn} == 'T') 
#if (${sc_rfa_no} != '') 
               AND BKG.TAA_NO = @[sc_rfa_no]
#end
#end
--B/L Status
#if (${bl_sts_cd} == 'RDY')
               AND ISS.BL_RDY_FLG = 'Y'
#elseif (${bl_sts_cd} == 'NRD')
               AND ISS.BL_RDY_FLG = 'N'
#elseif (${bl_sts_cd} == 'ISS')
               AND ISS.OBL_ISS_FLG = 'Y'
#elseif (${bl_sts_cd} == 'NIS')
               AND ISS.OBL_ISS_FLG = 'N'
#elseif (${bl_sts_cd} == 'RLS')
               AND ISS.OBL_RLSE_FLG = 'Y'
#elseif (${bl_sts_cd} == 'SRR')
               AND ISS.OBL_SRND_FLG = 'Y'
#elseif (${bl_sts_cd} == 'RCV')
               AND ISS.OBL_RDEM_FLG = 'Y'
#end
--Internet BL
#if (${internet_bl} != '')
               AND ISS.OBL_INET_FLG      = @[internet_bl]
#end
--Country of POR
#if (${por_cd2} != '')
               AND SUBSTR(BKG.POR_CD, 1, 2) = @[por_cd2]
#end
--Country of POD
#if (${pod_cd2} != '')
               AND SUBSTR(BKG.POD_CD, 1, 2) = @[pod_cd2]
#end
--Last Discharge VVD
#if (${vvd_cd2} != '')
               AND LAST_VVD.VSL_CD = SUBSTR(@[vvd_cd2],1,4)
               AND LAST_VVD.SKD_VOY_NO = SUBSTR(@[vvd_cd2],5,4)
               AND LAST_VVD.SKD_DIR_CD = SUBSTR(@[vvd_cd2],9,1)
#end
--B/L Surrender Office
#if (${bl_srnd_ofc_cd} != '')
               AND USR.OFC_CD = @[bl_srnd_ofc_cd]
#end
--B/L Issue Office
#if (${cptr_ofc_cd} != '')
			   AND OBL_ISS_OFC_CD = @[cptr_ofc_cd]
#end
--Customer
#if (${cust_tp_cd_s} != '' || ${cust_tp_cd_c} != '' || ${cust_tp_cd_n} != '' || ${cust_tp_cd_f} != '' || ${cust_tp_cd_a} != '')
#if(${cust_cnt_cd} !='' && ${cust_seq} != '')
               AND ( 1=2
#if (${cust_tp_cd_s} !='')
                    OR (SH.CUST_CNT_CD = @[cust_cnt_cd] AND SH.CUST_SEQ = TO_NUMBER(@[cust_seq]))
#end
#if (${cust_tp_cd_c} !='')
                    OR (CN.CUST_CNT_CD = @[cust_cnt_cd] AND CN.CUST_SEQ = TO_NUMBER(@[cust_seq]))
#end
#if (${cust_tp_cd_n} !='')
                    OR (NF.CUST_CNT_CD = @[cust_cnt_cd] AND NF.CUST_SEQ = TO_NUMBER(@[cust_seq]))
#end
#if (${cust_tp_cd_f} !='')
                    OR (FF.CUST_CNT_CD = @[cust_cnt_cd] AND FF.CUST_SEQ = TO_NUMBER(@[cust_seq]))
#end
#if (${cust_tp_cd_a} !='')
                    OR (AN.CUST_CNT_CD = @[cust_cnt_cd] AND AN.CUST_SEQ = TO_NUMBER(@[cust_seq]))
#end
                   )
#end

#if(${cust_nm} !='')
               AND ( 1=2
#if (${cust_tp_cd_s} !='')
                    OR SH.CUST_NM LIKE @[cust_nm]||'%'
#end
#if (${cust_tp_cd_c} !='')
                    OR CN.CUST_NM LIKE @[cust_nm]||'%'
#end
#if (${cust_tp_cd_n} !='')
                    OR NF.CUST_NM LIKE @[cust_nm]||'%'
#end
#if (${cust_tp_cd_f} !='')
                    OR FF.CUST_NM LIKE @[cust_nm]||'%'
#end
#if (${cust_tp_cd_a} !='')
                    OR AN.CUST_NM LIKE @[cust_nm]||'%'
#end
                   )
#end
#end
     ) Z
 WHERE 1=1
--B/L pring status
#if (${bl_sts_cd} == 'PRT')
   AND OBL_PRN_FLG = 'Y'
#elseif (${bl_sts_cd} == 'NPT')
   AND OBL_PRN_FLG = 'N'
#end
--B/L Print Date
#if (${bl_prn_from_dt} != '') 
   AND TO_DATE(BL_PRT_DT,'YYYY-MM-DD HH24:MI') >= TO_DATE(@[bl_prn_from_dt],'YYYY-MM-DD')
#end
#if (${bl_prn_to_dt} != '') 
   AND TO_DATE(BL_PRT_DT,'YYYY-MM-DD HH24:MI') <= TO_DATE(@[bl_prn_to_dt],'YYYY-MM-DD') +0.99999
#end
--Cleared By
#if (${obl_iss_usr_id} != '')
   AND BKG_GET_TOKEN_FNC(CGO_RLSE,2) LIKE @[obl_iss_usr_id]||'%' 	
#end
--B/L Type
#if (${bl_tp_cd} == 'H')
   AND HBL_NO IS NOT NULL
#elseif (${bl_tp_cd} == 'O')
   AND (HBL_NO IS NULL AND BKG_STS_CD <> 'S' AND BL_TP_CD <> 'W')
#elseif (${bl_tp_cd} == 'W')
   AND BL_TP_CD = 'W'
#end

--B/L Rlease Office
#if (${bl_rlse_ofc_cd} != '')
   AND BL_RLSE_OFC = @[bl_rlse_ofc_cd]
#end
--Cargo Release Status
#if (${cgo_rlse_sts_cd} != '')
   AND SUBSTR(BKG_GET_TOKEN_FNC(CGO_RLSE,1),1,1) = @[cgo_rlse_sts_cd]
#end
)
#if (${orderby} == '') 
ORDER BY TEMP, BKG_NO, CNTR_NO
#else
ORDER BY TEMP, ${orderby}
#end			]]></sql>
			<params>
				<param name="vvd_cd" type="12" value="" out="N"/>
				<param name="dir_cd" type="12" value="" out="N"/>
				<param name="pol_cd" type="12" value="" out="N"/>
				<param name="pol_yard_cd" type="12" value="" out="N"/>
				<param name="pod_cd" type="12" value="" out="N"/>
				<param name="pod_yard_cd" type="12" value="" out="N"/>
				<param name="sail_from_dt" type="12" value="" out="N"/>
				<param name="sail_to_dt" type="12" value="" out="N"/>
				<param name="arr_from_dt" type="12" value="" out="N"/>
				<param name="arr_to_dt" type="12" value="" out="N"/>
				<param name="por_cd" type="12" value="" out="N"/>
				<param name="del_cd" type="12" value="" out="N"/>
				<param name="bl_srnd_from_dt" type="12" value="" out="N"/>
				<param name="bl_srnd_to_dt" type="12" value="" out="N"/>
				<param name="crr_cd" type="12" value="" out="N"/>
				<param name="sc_rfa_no" type="12" value="" out="N"/>
				<param name="internet_bl" type="12" value="" out="N"/>
				<param name="por_cd2" type="12" value="" out="N"/>
				<param name="pod_cd2" type="12" value="" out="N"/>
				<param name="vvd_cd2" type="12" value="" out="N"/>
				<param name="bl_srnd_ofc_cd" type="12" value="" out="N"/>
				<param name="cptr_ofc_cd" type="12" value="" out="N"/>
				<param name="cust_cnt_cd" type="12" value="" out="N"/>
				<param name="cust_seq" type="12" value="" out="N"/>
				<param name="cust_nm" type="12" value="" out="N"/>
				<param name="bl_prn_from_dt" type="12" value="" out="N"/>
				<param name="bl_prn_to_dt" type="12" value="" out="N"/>
				<param name="obl_iss_usr_id" type="12" value="" out="N"/>
				<param name="bl_rlse_ofc_cd" type="12" value="" out="N"/>
				<param name="cgo_rlse_sts_cd" type="12" value="" out="N"/>
			</params>
		</query>
	</querys>
</sqls>
