<?xml version="1.0" encoding="UTF-8"?>
<sqls>
	<querys>
		<query name="EmptyReleaseOrderDBDAOMtyRlseOrdRfOogRSQL">
			<desc><![CDATA[EmptyReleaseOrderDBDAOMtyRlseOrdRfOogRSQL]]></desc>
			<sql><![CDATA[
SELECT BB.BKG_NO
       ,RF.RC_SEQ CNTR_SEQ
       ,RF.CNTR_TPSZ_CD CNTR_TPSZ
       ,RF.CNTR_NO CNTR_NO
       ,RF.CMDT_CD CMDT_CODE
       ,REPLACE(RF.CMDT_DESC,',',' ') Commodity
       ,RF.CDO_TEMP
       ,CASE WHEN RF.CDO_TEMP IS NOT NULL THEN 'C' ELSE '' END AS TEMP_UNIT
       ,DECODE(RF.CNTR_VENT_TP_CD,'P',RF.VENT_RTO,NULL) VENT_RTO
       ,REPLACE(REPLACE(REPLACE(RF.DIFF_RMK, CHR(10), ' '), CHR(13), ' '),',',' ') AS DIFF_RMK
       ,null PCK_QTY
       ,null NET_WGT
       ,null GRS_WGT
       ,null TTL_DIM_LEN
       ,null TTL_DIM_WDT
       ,null TTL_DIM_HGT
       ,null OVR_FWRD_LEN
       ,null OVR_BKWD_LEN
       ,null OVR_RT_LEN
       ,null OVR_LF_LEN
       ,null OVR_HGT
       ,' ' AWK_RMK
FROM BKG_BOOKING BB
     ,BKG_RF_CGO RF
WHERE BB.BKG_NO = RF.BKG_NO
AND NVL(BB.EDI_HLD_FLG,'N') = 'N'
--AND BB.BKG_CGO_TP_CD IN ('F', 'R')
#if (${datetype} == 'FTP')
    AND BB.BKG_CRE_DT > SYSDATE -61
    AND BB.BKG_OFC_CD = UPPER(@[bkg_ofc_cd])
    AND (EXISTS (SELECT 'X' 
    			FROM BKG_HIS_MST BHM
                WHERE BHM.CRE_DT BETWEEN to_date(@[from_dt] ,'yyyy-mm-dd hh24:mi:ss') AND to_date(@[end_dt] ,'yyyy-mm-dd hh24:mi:ss')
    			AND BHM.BKG_HIS_ISS_UI_ID IN (SELECT ATTR_CTNT1 FROM BKG_HRD_CDG_CTNT WHERE HRD_CDG_ID = 'BKG_LDF_UI')
                AND BB.BKG_NO = BHM.BKG_NO)
      		OR EXISTS (SELECT 'X' FROM SCG_AUTHORIZATION SA WHERE SA.BKG_NO = BB.BKG_NO
                AND SA.SPCL_CGO_AUTH_CD = 'Y' 
                AND   SA.UPD_DT BETWEEN to_date(@[from_dt] ,'yyyy-mm-dd hh24:mi:ss') AND to_date(@[end_dt] ,'yyyy-mm-dd hh24:mi:ss')) 
    ) 
#else
--    AND   BB.BKG_STS_CD <> 'X'
    #if (${from_dt} != '')
      #if (${datetype} == 'BKG')
         AND BB.BKG_CRE_DT  BETWEEN to_date(@[from_dt] ,'yyyy-mm-dd hh24:mi') AND to_date(@[end_dt] ,'yyyy-mm-dd hh24:mi')
      #elseif(${datetype} == 'PUP')
         AND BB.MTY_PKUP_DT BETWEEN to_date(@[from_dt] ,'yyyy-mm-dd hh24:mi') AND to_date(@[end_dt] ,'yyyy-mm-dd hh24:mi')
      #end
    #end
    #if (${bkg_ofc_cd}!='')
       AND BB.BKG_OFC_CD = UPPER(@[bkg_ofc_cd])
    #end
    #if (${doc_usr_id}!='')
       AND UPPER(BB.DOC_USR_ID)  = UPPER(@[doc_usr_id])
    #end
    #if (${eq_ctrl_ofc_cd}!='')
       AND BB.EQ_CTRL_OFC_CD = UPPER(@[eq_ctrl_ofc_cd])
    #end
    #if (${vvd} !='')
       AND EXISTS (SELECT 'X' 
                   FROM BKG_VVD VVD 
                   WHERE BB.BKG_NO = VVD.BKG_NO
                   AND VVD.VSL_PRE_PST_CD IN ('S','T')
                   AND VVD.VSL_CD = UPPER(substr(@[vvd],0,4))
                   AND VVD.SKD_VOY_NO = UPPER(substr(@[vvd],5,4))
                   AND VVD.SKD_DIR_CD = UPPER(substr(@[vvd],9,1))
                  )
    #end
    #if (${por_cd} !='')
       AND BB.POR_CD   = UPPER(@[por_cd])
    #end
    #if (${pol_cd} !='')
       AND BB.POL_CD   = UPPER(@[pol_cd])
    #end
    #if (${pod_cd}!='')
       AND BB.POD_CD   = UPPER(@[pod_cd])
    #end
    #if (${mty_pkup_yd_cd}!='')
       AND BB.MTY_PKUP_YD_CD = UPPER(@[mty_pkup_yd_cd])
    #end
    #if (${full_rtn_yd_cd}!='')
       AND BB.FULL_RTN_YD_CD = UPPER(@[full_rtn_yd_cd])
    #end
    #if (${bkg_no}!='')
       AND BB.BKG_NO   = UPPER(@[bkg_no])
    #end
    #if (${eq_confirm}=='Y')
       AND EXISTS (SELECT 1 FROM BKG_DOC_PROC_SKD WHERE BKG_NO = BB.BKG_NO AND BKG_DOC_PROC_TP_CD = 'CNTCFM' AND DOC_PERF_DELT_FLG = 'N')
    #end
    #if (${eq_confirm}=='N')
       AND NOT EXISTS (SELECT 1 FROM BKG_DOC_PROC_SKD WHERE BKG_NO = BB.BKG_NO AND BKG_DOC_PROC_TP_CD = 'CNTCFM' AND DOC_PERF_DELT_FLG = 'N')
    #end
#end
UNION ALL
SELECT BB.BKG_NO
       ,AWK.AWK_CGO_SEQ CNTR_SEQ
       ,AWK.CNTR_TPSZ_CD CNTR_TPSZ
       ,AWK.CNTR_NO CNTR_NO
       ,AWK.CMDT_CD CMDT_CODE
       ,(SELECT REPLACE(MC.CMDT_NM,',',' ') FROM MDM_COMMODITY MC WHERE MC.CMDT_CD = AWK.CMDT_CD AND ROWNUM =1 ) Commodity
       ,null CDO_TEMP
       ,'' AS TEMP_UNIT
       ,null VENT_RTO
       ,'' DIFF_RMK
       ,AWK.PCK_QTY
       ,AWK.NET_WGT
       ,AWK.GRS_WGT
       ,AWK.TTL_DIM_LEN
       ,AWK.TTL_DIM_WDT
       ,AWK.TTL_DIM_HGT
       ,AWK.OVR_FWRD_LEN
       ,AWK.OVR_BKWD_LEN
       ,AWK.OVR_RT_LEN
       ,AWK.OVR_LF_LEN
       ,AWK.OVR_HGT
       ,REPLACE(REPLACE(REPLACE(NVL(AWK.DIFF_RMK, ' '), CHR(10), ' '), CHR(13), ' '),',',' ') AS AWK_RMK
FROM BKG_BOOKING BB
     ,BKG_AWK_CGO AWK
WHERE BB.BKG_NO = AWK.BKG_NO
AND NVL(BB.EDI_HLD_FLG,'N') = 'N'
--AND BB.BKG_CGO_TP_CD IN ('F', 'R')
#if (${datetype} == 'FTP')
    AND BB.BKG_CRE_DT > SYSDATE -61
    AND BB.BKG_OFC_CD = UPPER(@[bkg_ofc_cd])
    AND EXISTS (SELECT 'X' 
    			FROM BKG_HIS_MST BHM
                WHERE BHM.CRE_DT BETWEEN to_date(@[from_dt] ,'yyyy-mm-dd hh24:mi:ss') AND to_date(@[end_dt] ,'yyyy-mm-dd hh24:mi:ss')
    			AND BHM.BKG_HIS_ISS_UI_ID IN (SELECT ATTR_CTNT1 FROM BKG_HRD_CDG_CTNT WHERE HRD_CDG_ID = 'BKG_LDF_UI')
                AND BB.BKG_NO = BHM.BKG_NO)
#else
--    AND   BB.BKG_STS_CD <> 'X'
    #if (${from_dt} != '')
      #if (${datetype} == 'BKG')
         AND BB.BKG_CRE_DT  BETWEEN to_date(@[from_dt] ,'yyyy-mm-dd hh24:mi') AND to_date(@[end_dt] ,'yyyy-mm-dd hh24:mi')
      #elseif(${datetype} == 'PUP')
         AND BB.MTY_PKUP_DT BETWEEN to_date(@[from_dt] ,'yyyy-mm-dd hh24:mi') AND to_date(@[end_dt] ,'yyyy-mm-dd hh24:mi')
      #end
    #end
    #if (${bkg_ofc_cd}!='')
       AND BB.BKG_OFC_CD = UPPER(@[bkg_ofc_cd])
    #end
    #if (${doc_usr_id}!='')
       AND UPPER(BB.DOC_USR_ID)  = UPPER(@[doc_usr_id])
    #end
    #if (${eq_ctrl_ofc_cd}!='')
       AND BB.EQ_CTRL_OFC_CD = UPPER(@[eq_ctrl_ofc_cd])
    #end
    #if (${vvd} !='')
       AND EXISTS (SELECT 'X' 
                   FROM BKG_VVD VVD 
                   WHERE BB.BKG_NO = VVD.BKG_NO
                   AND VVD.VSL_PRE_PST_CD IN ('S','T')
                   AND VVD.VSL_CD = UPPER(substr(@[vvd],0,4))
                   AND VVD.SKD_VOY_NO = UPPER(substr(@[vvd],5,4))
                   AND VVD.SKD_DIR_CD = UPPER(substr(@[vvd],9,1))
                  )
    #end
    #if (${por_cd} !='')
       AND BB.POR_CD   = UPPER(@[por_cd])
    #end
    #if (${pol_cd} !='')
       AND BB.POL_CD   = UPPER(@[pol_cd])
    #end
    #if (${pod_cd}!='')
       AND BB.POD_CD   = UPPER(@[pod_cd])
    #end
    #if (${mty_pkup_yd_cd}!='')
       AND BB.MTY_PKUP_YD_CD = UPPER(@[mty_pkup_yd_cd])
    #end
    #if (${full_rtn_yd_cd}!='')
       AND BB.FULL_RTN_YD_CD = UPPER(@[full_rtn_yd_cd])
    #end
    #if (${bkg_no}!='')
       AND BB.BKG_NO   = UPPER(@[bkg_no])
    #end
    #if (${eq_confirm}=='Y')
       AND EXISTS (SELECT 1 FROM BKG_DOC_PROC_SKD WHERE BKG_NO = BB.BKG_NO AND BKG_DOC_PROC_TP_CD = 'CNTCFM' AND DOC_PERF_DELT_FLG = 'N')
    #end
    #if (${eq_confirm}=='N')
       AND NOT EXISTS (SELECT 1 FROM BKG_DOC_PROC_SKD WHERE BKG_NO = BB.BKG_NO AND BKG_DOC_PROC_TP_CD = 'CNTCFM' AND DOC_PERF_DELT_FLG = 'N')
    #end
#end			]]></sql>
			<params>
				<param name="bkg_ofc_cd" type="12" value="" out="N"/>
				<param name="from_dt" type="12" value="" out="N"/>
				<param name="end_dt" type="12" value="" out="N"/>
				<param name="doc_usr_id" type="12" value="" out="N"/>
				<param name="eq_ctrl_ofc_cd" type="12" value="" out="N"/>
				<param name="vvd" type="12" value="" out="N"/>
				<param name="por_cd" type="12" value="" out="N"/>
				<param name="pol_cd" type="12" value="" out="N"/>
				<param name="pod_cd" type="12" value="" out="N"/>
				<param name="mty_pkup_yd_cd" type="12" value="" out="N"/>
				<param name="full_rtn_yd_cd" type="12" value="" out="N"/>
				<param name="bkg_no" type="12" value="" out="N"/>
			</params>
		</query>
	</querys>
</sqls>
