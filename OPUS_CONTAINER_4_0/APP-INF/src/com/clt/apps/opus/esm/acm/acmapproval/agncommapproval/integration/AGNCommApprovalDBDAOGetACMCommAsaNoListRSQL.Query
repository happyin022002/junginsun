<?xml version="1.0" encoding="UTF-8"?>
<sqls>
	<querys>
		<query name="AGNCommApprovalDBDAOGetACMCommAsaNoListRSQL">
			<desc><![CDATA[]]></desc>
			<sql><![CDATA[
SELECT DISTINCT A.ASA_NO AS ASA_NO,
  A.ASA_NO||' ('||A.CURR_CD||', ' ||TO_CHAR(TO_DATE(A.ASA_PRD_FM_DT, 'YYYYMMDD'), 'YYYY/MM/DD') ||' ~ ' ||TO_CHAR(TO_DATE(A.ASA_PRD_TO_DT, 'YYYYMMDD'), 'YYYY/MM/DD') ||')' AS ASA_NAME,
  A.ASA_PRD_FM_DT
FROM SAR_ASA_MST A,
  MDM_ORGANIZATION B,
  MDM_VENDOR C
WHERE A.AGN_CD IN (
    SELECT DISTINCT AR_OFC_CD
    FROM MDM_ORGANIZATION
    WHERE 1=1
       AND OFC_CD = @[agn_cd]
        OR AR_OFC_CD = @[agn_cd])
  AND A.OFC_CD IN (
    SELECT DISTINCT AR_OFC_CD
     FROM MDM_ORGANIZATION
    WHERE 1=1
      AND OFC_CD = @[agn_cd]
       OR AR_OFC_CD = @[agn_cd])         
--  AND A.EXPN_EFF_DT IS NULL
--  AND A.AC_EFF_DT IS NULL
  AND A.ASA_FSH_DT IS NULL
  AND A.ASA_APRO_DT IS NULL
--  AND NVL(A.DELT_FLG, 'N') = 'N'
  AND A.AGN_CD = B.AR_OFC_CD
  AND A.CURR_CD = B.AR_CURR_CD
  AND NVL(B.SO_IF_CD, ' ') = 'O'
  AND B.VNDR_SEQ = C.VNDR_SEQ
  AND SYSDATE BETWEEN TO_DATE(A.ASA_PRD_FM_DT, 'YYYYMMDD') AND TO_DATE(A.ASA_PRD_TO_DT, 'YYYYMMDD') + 16
ORDER BY 3 DESC			]]></sql>
			<params>
				<param name="agn_cd" type="12" value="" out="N"/>
			</params>
		</query>
	</querys>
</sqls>
