<?xml version="1.0" encoding="UTF-8"?>
<sqls>
	<querys>
		<query name="StatusReportDBDAOSearchVgmDashboardListRSQL">
			<desc><![CDATA[Search VGM Dashboard List]]></desc>
			<sql><![CDATA[
WITH LTST AS(
SELECT * FROM (
SELECT 
BKG_NO, 
CNTR_NO, 
VGM_VIA, 
XTER_VGM_WGT, 
XTER_VGM_WGT_UT_CD, 
IN_USR, 
IN_DT, 
ESIG, 
VGM_SEQ, 
ESIG_CO_NM, 
XTER_VGM_RQST_CD, 
XTER_SNDR_ID, 
XTER_VGM_DOC_ID, 
XTER_VGM_RQST_SEQ, 
XTER_VGM_USR_ID,
WGT_TP_CD, 
VGM_BKG_NO,
REF_ID,
ROW_NUMBER() OVER (PARTITION BY BKG_NO, CNTR_NO ORDER BY IN_DT DESC) RNUM
 FROM ((SELECT 
		#if (${bkg_no_list} != '')
                BB.BKG_NO,
        #else
	        #if(${in_vvd} != '')
	            CNTR.BKG_NO,
	        #end
        #end
                XTER_VGM.CNTR_NO CNTR_NO,
                XTER_VGM.XTER_VGM_RQST_CD VGM_VIA,
                DECODE(XTER_VGM.WGT_TP_CD,'V',ROUND(DECODE(XTER_VGM.WGT_UT_CD,'KGS',XTER_VGM.VGM_WGT ,'LBS', XTER_VGM.VGM_WGT * 0.453592,NULL),3)
                                         ,'C',ROUND(DECODE(XTER_VGM.WGT_UT_CD,'KGS',XTER_VGM.VGM_WGT ,'LBS', XTER_VGM.VGM_WGT * 0.453592,NULL),3)+MST_SPEC_FNC('TARE', XTER_VGM.CNTR_NO)) XTER_VGM_WGT,
                DECODE(XTER_VGM.WGT_UT_CD,NULL,NULL,'KGS') XTER_VGM_WGT_UT_CD,
                XTER_VGM.USR_ID IN_USR,
                TO_CHAR(XTER_VGM.VGM_CRE_LOCL_DT,'YYYY-MM-DD HH24:MI') IN_DT,
                DECODE(XTER_VGM.ESIG_CO_NM,NULL,'N','Y') ESIG,
                XTER_VGM.VGM_SEQ VGM_SEQ,
                XTER_VGM.ESIG_CO_NM,
                XTER_VGM.XTER_VGM_RQST_CD,
	              'WEB' XTER_SNDR_ID,
            	  XTER_VGM.BKG_NO XTER_VGM_DOC_ID,
	              XTER_VGM.VGM_SEQ XTER_VGM_RQST_SEQ,
				  XTER_VGM.USR_ID XTER_VGM_USR_ID,
	              XTER_VGM.WGT_TP_CD WGT_TP_CD,
				XTER_VGM.BKG_NO VGM_BKG_NO,
				XTER_VGM.REF_ID REF_ID
           FROM BKG_XTER_VGM XTER_VGM
	              ,BKG_CONTAINER CNTR
				  ,BKG_BOOKING BB
	          #if(${in_vvd} != '')
	              ,BKG_VVD VVD
	          #end
          WHERE XTER_VGM.VGM_CRE_GDT = (SELECT MAX(VGM_CRE_GDT)
                                          FROM BKG_XTER_VGM
                                         WHERE BKG_NO = XTER_VGM.BKG_NO
                                           AND CNTR_NO = XTER_VGM.CNTR_NO
                                           AND ACT_TP_CD = 'I')
	      #if(${in_vvd} != '')
            AND VVD.VSL_CD = SUBSTR(@[in_vvd],1,4)
            AND VVD.SKD_VOY_NO = SUBSTR(@[in_vvd],5,4)
            AND VVD.SKD_DIR_CD = SUBSTR(@[in_vvd],9,1)
  		        #if(${in_pol_cd} != '')
            AND VVD.POL_CD = @[in_pol_cd]
  		        #end
            AND VVD.BKG_NO = BB.BKG_NO
	      #end
          #if (${bkg_no_list} != '')
            AND BB.BKG_NO IN (
			        #foreach($multiBkgNoVal IN ${bkg_no_list})        
				        #if($velocityCount < $bkg_no_list.size()) '$multiBkgNoVal', #else '$multiBkgNoVal' #end
			        #end
		          )
          #end
			AND XTER_VGM.BKG_NO like SUBSTR(BB.BKG_NO,1,10)||'%'
			AND CNTR.BKG_NO = BB.BKG_NO
            AND CNTR.CNTR_NO = XTER_VGM.CNTR_NO
		UNION
		SELECT  BB.BKG_NO,
                XTER_VGM.CNTR_NO CNTR_NO,
                XTER_VGM.XTER_VGM_RQST_CD VGM_VIA,
                DECODE(XTER_VGM.WGT_TP_CD,'V',ROUND(DECODE(XTER_VGM.WGT_UT_CD,'KGS',XTER_VGM.VGM_WGT ,'LBS', XTER_VGM.VGM_WGT * 0.453592,NULL),3)
                                         ,'C',ROUND(DECODE(XTER_VGM.WGT_UT_CD,'KGS',XTER_VGM.VGM_WGT ,'LBS', XTER_VGM.VGM_WGT * 0.453592,NULL),3)+MST_SPEC_FNC('TARE', XTER_VGM.CNTR_NO)) XTER_VGM_WGT,
                DECODE(XTER_VGM.WGT_UT_CD,NULL,NULL,'KGS') XTER_VGM_WGT_UT_CD,
                XTER_VGM.USR_ID IN_USR,
                TO_CHAR(XTER_VGM.VGM_CRE_LOCL_DT,'YYYY-MM-DD HH24:MI') IN_DT,
                DECODE(XTER_VGM.ESIG_CO_NM,NULL,'N','Y') ESIG,
                XTER_VGM.VGM_SEQ VGM_SEQ,
                XTER_VGM.ESIG_CO_NM,
                XTER_VGM.XTER_VGM_RQST_CD,
	              'WEB' XTER_SNDR_ID,
            	  XTER_VGM.BKG_NO XTER_VGM_DOC_ID,
	              XTER_VGM.VGM_SEQ XTER_VGM_RQST_SEQ,
				  XTER_VGM.USR_ID XTER_VGM_USR_ID,
	              XTER_VGM.WGT_TP_CD WGT_TP_CD,
				XTER_VGM.BKG_NO VGM_BKG_NO,
				XTER_VGM.REF_ID REF_ID
           FROM BKG_XTER_VGM XTER_VGM
	              ,BKG_CONTAINER CNTR
				  ,BKG_BOOKING BB
	          #if(${in_vvd} != '')
	              ,BKG_VVD VVD
	          #end
				,BKG_BOOKING TGT_BKG
          WHERE XTER_VGM.VGM_CRE_GDT = (SELECT MAX(VGM_CRE_GDT)
                                          FROM BKG_XTER_VGM
                                         WHERE BKG_NO = XTER_VGM.BKG_NO
                                           AND CNTR_NO = XTER_VGM.CNTR_NO
                                           AND ACT_TP_CD = 'I')
	      #if(${in_vvd} != '')
            AND VVD.VSL_CD = SUBSTR(@[in_vvd],1,4)
            AND VVD.SKD_VOY_NO = SUBSTR(@[in_vvd],5,4)
            AND VVD.SKD_DIR_CD = SUBSTR(@[in_vvd],9,1)
  		        #if(${in_pol_cd} != '')
            AND VVD.POL_CD = @[in_pol_cd]
  		        #end
            AND VVD.BKG_NO = BB.BKG_NO
	      #end
          #if (${bkg_no_list} != '')
            AND BB.BKG_NO IN (
			        #foreach($multiBkgNoVal IN ${bkg_no_list})        
				        #if($velocityCount < $bkg_no_list.size()) '$multiBkgNoVal', #else '$multiBkgNoVal' #end
			        #end
		          )
          #end
            AND BB.VSL_CD = TGT_BKG.VSL_CD
            AND BB.SKD_VOY_NO = TGT_BKG.SKD_VOY_NO
            AND BB.SKD_DIR_CD = TGT_BKG.SKD_DIR_CD
            AND BB.POL_CD = TGT_BKG.POL_CD
            AND BB.POD_CD = TGT_BKG.POD_CD
			AND XTER_VGM.BKG_NO = TGT_BKG.BKG_NO
            AND BB.BKG_NO = CNTR.BKG_NO
            AND CNTR.CNTR_NO = XTER_VGM.CNTR_NO
         UNION
         SELECT BB.BKG_NO,
                XTER_VGM.CNTR_NO CNTR_NO,
                XTER_VGM.XTER_VGM_RQST_CD VGM_VIA,
                DECODE(XTER_VGM.WGT_TP_CD,'V',ROUND(DECODE(XTER_VGM.WGT_UT_CD,'KGS',XTER_VGM.VGM_WGT ,'LBS', XTER_VGM.VGM_WGT * 0.453592,NULL),3)
                                         ,'C',ROUND(DECODE(XTER_VGM.WGT_UT_CD,'KGS',XTER_VGM.VGM_WGT ,'LBS', XTER_VGM.VGM_WGT * 0.453592,NULL),3)+MST_SPEC_FNC('TARE', XTER_VGM.CNTR_NO)) XTER_VGM_WGT,
                DECODE(XTER_VGM.WGT_UT_CD,NULL,NULL,'KGS') XTER_VGM_WGT_UT_CD,
                XTER_VGM.USR_ID IN_USR,
                TO_CHAR(XTER_VGM.VGM_CRE_LOCL_DT,'YYYY-MM-DD HH24:MI') IN_DT,
                DECODE(XTER_VGM.ESIG_CO_NM,NULL,'N','Y') ESIG,
                XTER_VGM.VGM_SEQ VGM_SEQ,
                XTER_VGM.ESIG_CO_NM,
                XTER_VGM.XTER_VGM_RQST_CD,
	            'WEB' XTER_SNDR_ID,
                XTER_VGM.BKG_NO XTER_VGM_DOC_ID,
	            XTER_VGM.VGM_SEQ XTER_VGM_RQST_SEQ,
			    XTER_VGM.USR_ID XTER_VGM_USR_ID,
	            XTER_VGM.WGT_TP_CD WGT_TP_CD,
				XTER_VGM.BKG_NO VGM_BKG_NO,
				XTER_VGM.REF_ID REF_ID
           FROM BKG_XTER_VGM XTER_VGM
	              ,BKG_CONTAINER CNTR
				  ,BKG_BOOKING BB
	          #if(${in_vvd} != '')
	              ,BKG_VVD VVD
	          #end
          WHERE XTER_VGM.VGM_CRE_GDT = (SELECT MAX(VGM_CRE_GDT)
                                          FROM BKG_XTER_VGM
                                         WHERE BKG_NO = XTER_VGM.BKG_NO
                                           AND CNTR_NO = XTER_VGM.CNTR_NO
										   AND VGM_SEQ = XTER_VGM.VGM_SEQ
                                           AND ACT_TP_CD = 'I')
	      #if(${in_vvd} != '')
            AND VVD.VSL_CD = SUBSTR(@[in_vvd],1,4)
            AND VVD.SKD_VOY_NO = SUBSTR(@[in_vvd],5,4)
            AND VVD.SKD_DIR_CD = SUBSTR(@[in_vvd],9,1)
  		        #if(${in_pol_cd} != '')
            AND VVD.POL_CD = @[in_pol_cd]
  		        #end
            AND VVD.BKG_NO = BB.BKG_NO
	      #end
          #if (${bkg_no_list} != '')
            AND BB.BKG_NO IN (
			        #foreach($multiBkgNoVal IN ${bkg_no_list})        
				        #if($velocityCount < $bkg_no_list.size()) '$multiBkgNoVal', #else '$multiBkgNoVal' #end
			        #end
		          )
          #end
            
			AND XTER_VGM.BKG_NO = CNTR.XTER_VGM_DOC_ID 
			AND CNTR.BKG_NO = BB.BKG_NO
            AND CNTR.CNTR_NO = XTER_VGM.CNTR_NO
            AND CNTR.XTER_SNDR_ID = 'WEB'
            AND CNTR.XTER_VGM_RQST_SEQ = XTER_VGM.VGM_SEQ
			AND CNTR.XTER_VGM_USR_ID = XTER_VGM.USR_ID
			)
        UNION ALL
         ( SELECT 
			#if (${bkg_no_list} != '')
                  BB.BKG_NO,
        	#else
	        	#if(${in_vvd} != '')
	              CNTR.BKG_NO,
	        	#end
        	#end
                  BXVR.CNTR_NO CNTR_NO,
                  'EDI' VGM_VIA,
                  ROUND(DECODE(BXVR.WGT_UT_CD,'KGS',BXVR.VGM_WGT ,'LBS', BXVR.VGM_WGT * 0.453592,NULL),3) XTER_VGM_WGT,
                  DECODE(BXVR.WGT_UT_CD,NULL,NULL,'KGS') XTER_VGM_WGT_UT_CD,
                  BXVR.XTER_SNDR_ID IN_USR,
                  TO_CHAR(GLOBALDATE_PKG.TIME_CONV_FNC('KRPUS',BXVR.UPD_DT,(SELECT POL_CD FROM BKG_BOOKING WHERE BKG_NO = REFNO.REF_NO)),'YYYY-MM-DD HH24:MI') IN_DT,
                  DECODE(BXVC.VGM_CUST_CNTC_TP_CD,'RP',DECODE(BXVC.VGM_CUST_CNTC_NM,NULL,'N','Y')) ESIG,
                  BXVR.XTER_VGM_RQST_SEQ VGM_SEQ,
                  DECODE(BXVC.VGM_CUST_CNTC_TP_CD,'RP',BXVC.VGM_CUST_CNTC_NM) ESIG_CO_NM,
                  'EDI' XTER_VGM_RQST_CD,
	                BXVR.XTER_SNDR_ID,
	                BXVR.XTER_VGM_DOC_ID,
	                BXVR.XTER_VGM_RQST_SEQ,
					'' XTER_VGM_USR_ID,
	                'V' WGT_TP_CD,
				  REFNO.REF_NO VGM_BKG_NO,
				  '' REF_ID
             FROM BKG_XTER_VGM_RQST BXVR,
                  BKG_XTER_VGM_CUST BXVC,
                  BKG_XTER_VGM_REF_NO REFNO
                #if(${in_vvd} != '')
                  ,BKG_VVD VVD
              	#end
                  ,BKG_CONTAINER CNTR
                  ,BKG_BOOKING BB
            WHERE BXVR.XTER_SNDR_ID = BXVC.XTER_SNDR_ID (+)
              AND BXVR.XTER_VGM_DOC_ID = BXVC.XTER_VGM_DOC_ID (+)
              AND BXVR.XTER_VGM_RQST_SEQ = BXVC.XTER_VGM_RQST_SEQ (+)
              AND BXVR.CNTR_NO = BXVC.CNTR_NO (+)
              AND BXVC.VGM_CUST_CNTC_TP_CD(+) = 'RP'
              AND BXVR.XTER_SNDR_ID = REFNO.XTER_SNDR_ID
              AND BXVR.XTER_VGM_DOC_ID = REFNO.XTER_VGM_DOC_ID
              AND BXVR.XTER_VGM_RQST_SEQ = REFNO.XTER_VGM_RQST_SEQ
              AND BXVR.CNTR_NO = REFNO.CNTR_NO
              AND NVL(REFNO.XTER_REF_SEQ, 0) = NVL((SELECT MAX(XTER_REF_SEQ)
                                                      FROM BKG_XTER_VGM_REF_NO
                                                     WHERE REFNO.XTER_SNDR_ID = XTER_SNDR_ID
                                                       AND REFNO.XTER_VGM_DOC_ID = XTER_VGM_DOC_ID
                                                       AND REFNO.XTER_VGM_RQST_SEQ = XTER_VGM_RQST_SEQ
                                                       AND REFNO.CNTR_NO = CNTR_NO
				                                               AND REFNO.REF_NO = REF_NO
				                                               AND XTER_REF_TP_CD IN ('BN','BM')), 0)
              AND NVL(BXVR.XTER_VGM_RQST_SEQ,0) = NVL((SELECT MAX(XTER_VGM_RQST_SEQ)
                                                         FROM BKG_XTER_VGM_RQST 
                                                        WHERE BXVR.XTER_SNDR_ID = XTER_SNDR_ID
                                                          AND BXVR.XTER_VGM_DOC_ID = XTER_VGM_DOC_ID
                                                          AND BXVR.CNTR_NO = CNTR_NO
														  AND NVL(VGM_ACK_RSPN_CD,'X') <> 'R'), 0)
              AND REFNO.REF_NO <> ' '
	      #if(${in_vvd} != '')
            AND VVD.VSL_CD = SUBSTR(@[in_vvd],1,4)
            AND VVD.SKD_VOY_NO = SUBSTR(@[in_vvd],5,4)
            AND VVD.SKD_DIR_CD = SUBSTR(@[in_vvd],9,1)
  		        #if(${in_pol_cd} != '')
            AND VVD.POL_CD = @[in_pol_cd]
  		        #end
            AND VVD.BKG_NO = BB.BKG_NO
	      #end
          #if (${bkg_no_list} != '')
            AND BB.BKG_NO IN (
			        #foreach($multiBkgNoVal IN ${bkg_no_list})        
				        #if($velocityCount < $bkg_no_list.size()) '$multiBkgNoVal', #else '$multiBkgNoVal' #end
			        #end
		          )
          #end
			  AND REFNO.REF_NO like SUBSTR(BB.BKG_NO,1,10)||'%'
              AND BB.BKG_NO = CNTR.BKG_NO
              AND CNTR.CNTR_NO = REFNO.CNTR_NO
	    	UNION
		   SELECT BB.BKG_NO,
                  BXVR.CNTR_NO CNTR_NO,
                  'EDI' VGM_VIA,
                  ROUND(DECODE(BXVR.WGT_UT_CD,'KGS',BXVR.VGM_WGT ,'LBS', BXVR.VGM_WGT * 0.453592,NULL),3) XTER_VGM_WGT,
                  DECODE(BXVR.WGT_UT_CD,NULL,NULL,'KGS') XTER_VGM_WGT_UT_CD,
                  BXVR.XTER_SNDR_ID IN_USR,
                  TO_CHAR(GLOBALDATE_PKG.TIME_CONV_FNC('KRPUS',BXVR.UPD_DT,(SELECT POL_CD FROM BKG_BOOKING WHERE BKG_NO = REFNO.REF_NO)),'YYYY-MM-DD HH24:MI') IN_DT,
                  DECODE(BXVC.VGM_CUST_CNTC_TP_CD,'RP',DECODE(BXVC.VGM_CUST_CNTC_NM,NULL,'N','Y')) ESIG,
                  BXVR.XTER_VGM_RQST_SEQ VGM_SEQ,
                  DECODE(BXVC.VGM_CUST_CNTC_TP_CD,'RP',BXVC.VGM_CUST_CNTC_NM) ESIG_CO_NM,
                  'EDI' XTER_VGM_RQST_CD,
	                BXVR.XTER_SNDR_ID,
	                BXVR.XTER_VGM_DOC_ID,
	                BXVR.XTER_VGM_RQST_SEQ,
					'' XTER_VGM_USR_ID,
	                'V' WGT_TP_CD,
   				  REFNO.REF_NO VGM_BKG_NO,
			      '' REF_ID
             FROM BKG_XTER_VGM_RQST BXVR,
                  BKG_XTER_VGM_CUST BXVC,
                  BKG_XTER_VGM_REF_NO REFNO
                #if(${in_vvd} != '')
                  ,BKG_VVD VVD
              	#end
                  ,BKG_CONTAINER CNTR
                  ,BKG_BOOKING BB
				  ,BKG_BOOKING TGT_BKG
            WHERE BXVR.XTER_SNDR_ID = BXVC.XTER_SNDR_ID (+)
              AND BXVR.XTER_VGM_DOC_ID = BXVC.XTER_VGM_DOC_ID (+)
              AND BXVR.XTER_VGM_RQST_SEQ = BXVC.XTER_VGM_RQST_SEQ (+)
              AND BXVR.CNTR_NO = BXVC.CNTR_NO (+)
              AND BXVC.VGM_CUST_CNTC_TP_CD(+) = 'RP'
              AND BXVR.XTER_SNDR_ID = REFNO.XTER_SNDR_ID
              AND BXVR.XTER_VGM_DOC_ID = REFNO.XTER_VGM_DOC_ID
              AND BXVR.XTER_VGM_RQST_SEQ = REFNO.XTER_VGM_RQST_SEQ
              AND BXVR.CNTR_NO = REFNO.CNTR_NO
              AND NVL(REFNO.XTER_REF_SEQ, 0) = NVL((SELECT MAX(XTER_REF_SEQ)
                                                      FROM BKG_XTER_VGM_REF_NO
                                                     WHERE REFNO.XTER_SNDR_ID = XTER_SNDR_ID
                                                       AND REFNO.XTER_VGM_DOC_ID = XTER_VGM_DOC_ID
                                                       AND REFNO.XTER_VGM_RQST_SEQ = XTER_VGM_RQST_SEQ
                                                       AND REFNO.CNTR_NO = CNTR_NO
				                                               AND REFNO.REF_NO = REF_NO
				                                               AND XTER_REF_TP_CD IN ('BN','BM')), 0)
              AND NVL(BXVR.XTER_VGM_RQST_SEQ,0) = NVL((SELECT MAX(XTER_VGM_RQST_SEQ)
                                                         FROM BKG_XTER_VGM_RQST 
                                                        WHERE BXVR.XTER_SNDR_ID = XTER_SNDR_ID
                                                          AND BXVR.XTER_VGM_DOC_ID = XTER_VGM_DOC_ID
                                                          AND BXVR.CNTR_NO = CNTR_NO
														  AND NVL(VGM_ACK_RSPN_CD,'X') <> 'R'), 0)
              AND REFNO.REF_NO <> ' '
	      #if(${in_vvd} != '')
            AND VVD.VSL_CD = SUBSTR(@[in_vvd],1,4)
            AND VVD.SKD_VOY_NO = SUBSTR(@[in_vvd],5,4)
            AND VVD.SKD_DIR_CD = SUBSTR(@[in_vvd],9,1)
  		        #if(${in_pol_cd} != '')
            AND VVD.POL_CD = @[in_pol_cd]
  		        #end
            AND VVD.BKG_NO = BB.BKG_NO
	      #end
          #if (${bkg_no_list} != '')
            AND BB.BKG_NO IN (
			        #foreach($multiBkgNoVal IN ${bkg_no_list})        
				        #if($velocityCount < $bkg_no_list.size()) '$multiBkgNoVal', #else '$multiBkgNoVal' #end
			        #end
		          )
          #end
          	  AND BB.VSL_CD = TGT_BKG.VSL_CD
              AND BB.SKD_VOY_NO = TGT_BKG.SKD_VOY_NO
              AND BB.SKD_DIR_CD = TGT_BKG.SKD_DIR_CD
              AND BB.POL_CD = TGT_BKG.POL_CD
              AND BB.POD_CD = TGT_BKG.POD_CD
              AND REFNO.REF_NO = TGT_BKG.BKG_NO
              AND BB.BKG_NO = CNTR.BKG_NO
              AND CNTR.CNTR_NO = REFNO.CNTR_NO
		   UNION
           SELECT BB.BKG_NO,
                  BXVR.CNTR_NO CNTR_NO,
                  'EDI' VGM_VIA,
                  ROUND(DECODE(BXVR.WGT_UT_CD,'KGS',BXVR.VGM_WGT ,'LBS', BXVR.VGM_WGT * 0.453592,NULL),3) XTER_VGM_WGT,
                  DECODE(BXVR.WGT_UT_CD,NULL,NULL,'KGS') XTER_VGM_WGT_UT_CD,
                  BXVR.XTER_SNDR_ID IN_USR,
                  TO_CHAR(GLOBALDATE_PKG.TIME_CONV_FNC('KRPUS',BXVR.UPD_DT,(SELECT POL_CD FROM BKG_BOOKING WHERE BKG_NO = BB.BKG_NO)),'YYYY-MM-DD HH24:MI') IN_DT,
                  DECODE(BXVC.VGM_CUST_CNTC_TP_CD,'RP',DECODE(BXVC.VGM_CUST_CNTC_NM,NULL,'N','Y')) ESIG,
                  BXVR.XTER_VGM_RQST_SEQ VGM_SEQ,
                  DECODE(BXVC.VGM_CUST_CNTC_TP_CD,'RP',BXVC.VGM_CUST_CNTC_NM) ESIG_CO_NM,
                  'EDI' XTER_VGM_RQST_CD,
	                BXVR.XTER_SNDR_ID,
	                BXVR.XTER_VGM_DOC_ID,
	                BXVR.XTER_VGM_RQST_SEQ,
					'' XTER_VGM_USR_ID,
	                'V' WGT_TP_CD,
				  REFNO.REF_NO VGM_BKG_NO,
				  '' REF_ID
             FROM BKG_XTER_VGM_RQST BXVR,
                  BKG_XTER_VGM_CUST BXVC,
				  BKG_XTER_VGM_REF_NO REFNO
                #if(${in_vvd} != '')
                  ,BKG_VVD VVD
              	#end
                  ,BKG_CONTAINER CNTR
                  ,BKG_BOOKING BB
            WHERE BXVR.XTER_SNDR_ID = BXVC.XTER_SNDR_ID (+)
              AND BXVR.XTER_VGM_DOC_ID = BXVC.XTER_VGM_DOC_ID (+)
              AND BXVR.XTER_VGM_RQST_SEQ = BXVC.XTER_VGM_RQST_SEQ (+)
              AND BXVR.CNTR_NO = BXVC.CNTR_NO (+)
              AND BXVC.VGM_CUST_CNTC_TP_CD(+) = 'RP'
		      AND BXVR.XTER_SNDR_ID = REFNO.XTER_SNDR_ID
              AND BXVR.XTER_VGM_DOC_ID = REFNO.XTER_VGM_DOC_ID
              AND BXVR.XTER_VGM_RQST_SEQ = REFNO.XTER_VGM_RQST_SEQ
              AND BXVR.CNTR_NO = REFNO.CNTR_NO
              AND NVL(REFNO.XTER_REF_SEQ, 0) = NVL((SELECT MAX(XTER_REF_SEQ)
                                                      FROM BKG_XTER_VGM_REF_NO
                                                     WHERE REFNO.XTER_SNDR_ID = XTER_SNDR_ID
                                                       AND REFNO.XTER_VGM_DOC_ID = XTER_VGM_DOC_ID
                                                       AND REFNO.XTER_VGM_RQST_SEQ = XTER_VGM_RQST_SEQ
                                                       AND REFNO.CNTR_NO = CNTR_NO
				                                               AND REFNO.REF_NO = REF_NO
				                                               AND XTER_REF_TP_CD IN ('BN','BM')), 0)
	      #if(${in_vvd} != '')
            AND VVD.VSL_CD = SUBSTR(@[in_vvd],1,4)
            AND VVD.SKD_VOY_NO = SUBSTR(@[in_vvd],5,4)
            AND VVD.SKD_DIR_CD = SUBSTR(@[in_vvd],9,1)
  		        #if(${in_pol_cd} != '')
            AND VVD.POL_CD = @[in_pol_cd]
  		        #end
            AND VVD.BKG_NO = BB.BKG_NO
	      #end
          #if (${bkg_no_list} != '')
            AND BB.BKG_NO IN (
			        #foreach($multiBkgNoVal IN ${bkg_no_list})        
				        #if($velocityCount < $bkg_no_list.size()) '$multiBkgNoVal', #else '$multiBkgNoVal' #end
			        #end
		          )
          #end
              AND BB.BKG_NO = CNTR.BKG_NO
              AND CNTR.XTER_SNDR_ID = BXVR.XTER_SNDR_ID 
              AND CNTR.XTER_VGM_DOC_ID = BXVR.XTER_VGM_DOC_ID 
              AND CNTR.XTER_VGM_RQST_SEQ = BXVR.XTER_VGM_RQST_SEQ 
              AND CNTR.CNTR_NO = BXVR.CNTR_NO
			  AND NVL(VGM_ACK_RSPN_CD,'X') <> 'R'
		)
    )
)
WHERE RNUM = 1
  )
SELECT  ROW_NUMBER() OVER(ORDER BY MST.BKG_NO) DENSE_RANK,
		ROW_NUMBER() OVER(ORDER BY MST.BKG_NO) NUM,
		MST.BKG_NO BKG_NO,
        MST.BL_NO BL_NO,
        MST.BKG_OFC_CD BKG_OFC_CD,
		MST.TRNK_VVD,
        MST.POL_CD POL_CD,
        MST.POD_CD POD_CD,
		MST.LT LT,
        MST.QTY_BKG QTY_BKG,
        MST.QTY_CNTR QTY_CNTR,
        MST.FST_ETD FST_ETD,
        MST.CNTR_NO CNTR_NO,
        MST.SZ SZ,
        MST.VGM_WGT VGM_WGT,
		MST.VGM_WGT_UT_CD VGM_WGT_UT_CD,
		MST.VGM_WGT_UPD_USR_ID VGM_WGT_UPD_USR_ID,
		MST.VGM_WGT_UPD_DT VGM_WGT_UPD_DT,
        MST.WGT WGT,
        MST.UNIT UNIT,
        MST.CM CM,
        MST.SHPR SHPR,
        MST.VGM_VIA VGM_VIA,
        MST.XTER_VGM_WGT XTER_VGM_WGT,
		MST.XTER_VGM_WGT_UT_CD XTER_VGM_WGT_UT_CD,
        MST.IN_USR IN_USR,
        MST.IN_DT IN_DT,
		MST.ESIG ESIG,
        MST.VGM_CLZ_FLG VGM_CLZ_FLG,
        MST.CLS_USR CLS_USR,
        MST.CLS_DT CLS_DT,
		MST.VGM_CUT_OFF_TM VGM_CUT_OFF_TM,
		MST.SUP,
		MST.VGM_SEQ,
		MST.ESIG_CO_NM,
        MST.XTER_SNDR_ID,
        MST.XTER_VGM_DOC_ID,
        MST.XTER_VGM_RQST_SEQ,
		MST.XTER_VGM_USR_ID,
		MST.WGT_TP_CD,
		MST.VGM_BKG_NO,
		MST.REF_ID,
		MST.PAYLD_PLS_TARE,
		MST.CGO_PLS_TARE,
		NVL(TO_CHAR((MST.VGM_WGT - MST.CGO_PLS_TARE) / MST.CGO_PLS_TARE * 100,'99990.99'),TO_CHAR('0','99990.99'))||' %' DIFF_PCT,
        COUNT(DISTINCT MST.BKG_NO) OVER() TTL_BKG,
        TO_CHAR(SUM(DECODE(MST.RNUM,1,MST.TTL_QTY_F,0)) OVER() ,'99990.99')||' F' TTL_QTY_F,
        TO_CHAR(SUM(DECODE(MST.RNUM,1,MST.TTL_QTY_T,0)) OVER() ,'99990.99')||' T' TTL_QTY_T,
        SUM(DECODE(MST.VGM_WGT,NULL,0,1)) OVER() TTL_VGM,
        SUM(DECODE(MST.VGM_WGT,NULL,1,0)) OVER() TTL_NON_VGM,
        SUM(DECODE(MST.XTER_VGM_WGT,NULL,1,0)) OVER() TTL_NON_RCVD_VGM,
        SUM(DECODE(MST.RNUM,1,DECODE(MST.VGM_CLZ_FLG,'Y',1,0),0)) OVER() TTL_CLZ_BKG,
#if (${bkg_no_list} != '')
		'Y' srch_mlt_bkg
#else
		'N' srch_mlt_bkg
#end
  FROM (SELECT BB.BKG_NO BKG_NO,
               BB.BL_NO BL_NO,
               BB.BKG_OFC_CD BKG_OFC_CD,
			   BB.VSL_CD||BB.SKD_VOY_NO||BB.SKD_DIR_CD TRNK_VVD,
               BB.POL_CD POL_CD,
               BB.POD_CD POD_CD,
			   DECODE(NVL(@[in_pol_cd],VVD.POL_CD),BB.POL_CD,'LC','TS') LT,
               BKG_JOIN_FNC(CURSOR(SELECT CNTR_TPSZ_CD||'-'||ltrim(TO_CHAR(NVL(OP_CNTR_QTY, 0), '99990.99'))
                          FROM BKG_QUANTITY
                         WHERE BKG_NO = BB.BKG_NO
                           AND CNTR_TPSZ_CD IS NOT NULL
                         ORDER BY CNTR_TPSZ_CD ) ) QTY_BKG,
               BKG_JOIN_FNC(CURSOR(SELECT CNTR_TPSZ_CD||'-'||ltrim(TO_CHAR(NVL(sum(CNTR_VOL_QTY), 0), '99990.99'))
                          FROM BKG_CONTAINER
                         WHERE BKG_NO = BB.BKG_NO
                           AND CNTR_TPSZ_CD IS NOT NULL
                         GROUP BY CNTR_TPSZ_CD
                         ORDER BY CNTR_TPSZ_CD ) ) QTY_CNTR,
               (SELECT TO_CHAR(VPS_ETD_DT,'YYYY-MM-DD HH24:MI') 
               	  FROM BKG_BOOKING BKG2, BKG_VVD VVD, VSK_VSL_PORT_SKD VSK
                 WHERE BKG2.BKG_NO = BB.BKG_NO
                   AND BKG2.BKG_NO = VVD.BKG_NO
                   AND BKG2.POL_CD = VVD.POL_CD
                   AND VVD.VSL_CD = VSK.VSL_CD
                   AND VVD.SKD_VOY_NO = VSK.SKD_VOY_NO
                   AND VVD.SKD_DIR_CD = VSK.SKD_DIR_CD
                   AND VVD.POL_CLPT_IND_SEQ = VSK.CLPT_IND_SEQ
                   AND VVD.POL_CD = VSK.VPS_PORT_CD
                   AND VVD.VSL_PRE_PST_CD||VVD.VSL_SEQ = ( SELECT MIN(VSL_PRE_PST_CD||VSL_SEQ) FROM BKG_VVD VVD2 WHERE VVD2.BKG_NO = BKG2.BKG_NO)
               ) FST_ETD,
               BC.CNTR_NO CNTR_NO,
               NVL(BC.CNTR_TPSZ_CD,COP.CNTR_TPSZ_CD) SZ,
               ROUND(DECODE(BC.VGM_WGT_UT_CD,'KGS', BC.VGM_WGT, 'LBS',BC.VGM_WGT * 0.453592,NULL),3) VGM_WGT,
			   DECODE(BC.VGM_WGT_UT_CD,NULL,NULL,'KGS') VGM_WGT_UT_CD,
			   BC.VGM_WGT_UPD_USR_ID VGM_WGT_UPD_USR_ID,
			   TO_CHAR(BC.VGM_WGT_UPD_DT,'YYYY-MM-DD HH24:MI') VGM_WGT_UPD_DT,
               BC.CNTR_WGT WGT,
               BC.WGT_UT_CD UNIT,
               NVL((SELECT DECODE(MF_CFM_FLG, 'Y', 'F', 'Y')
                          FROM BKG_CNTR_MF_DESC MF
                         WHERE BKG_NO = BB.BKG_NO
                           AND CNTR_NO = BC.CNTR_NO
                           AND ROWNUM = 1) , 'N') CM,
               SHPR.CUST_NM SHPR,
               LTST.VGM_VIA VGM_VIA,
			   LTST.XTER_VGM_WGT XTER_VGM_WGT,
			   LTST.XTER_VGM_WGT_UT_CD XTER_VGM_WGT_UT_CD,
               LTST.IN_USR IN_USR,
               LTST.IN_DT IN_DT,
			   NVL(LTST.ESIG,'N') ESIG,
               '' EML_ADDR,
               '' EML_RSLT,
               '' EML_DT,
               NVL(VGM_CLZ_FLG,'N') VGM_CLZ_FLG,
               DECODE(VGM_CLZ_FLG,'Y',CLZ.EVNT_USR_ID) CLS_USR,
               DECODE(VGM_CLZ_FLG,'Y',TO_CHAR(CLZ.EVNT_DT,'YYYY-MM-DD HH24:MI:SS')) CLS_DT,
               (SELECT SUM(DECODE(SUBSTR(CNTR_TPSZ_CD, -1), '2', NVL(OP_CNTR_QTY, 0)))
                  FROM BKG_QUANTITY
                 WHERE BKG_NO = BB.BKG_NO
                   AND CNTR_TPSZ_CD IS NOT NULL ) TTL_QTY_T,
               (SELECT SUM(DECODE(SUBSTR(CNTR_TPSZ_CD, -1), '2', NULL, NVL(OP_CNTR_QTY, 0)))
                  FROM BKG_QUANTITY
                 WHERE BKG_NO = BB.BKG_NO
                   AND CNTR_TPSZ_CD IS NOT NULL ) TTL_QTY_F,
			   (SELECT TO_CHAR(BKG_GET_VGM_CCT_FNC(SKD.POL_NOD_CD, SKD.SLAN_CD, SKD.SLAN_DIR_CD, CGO_TP_CD, SKD.VVD, SKD.CLPT_IND_SEQ, SKD.VPS_ETB_DT, SKD.VPS_ETD_DT),'YYYY-MM-DD HH24:MI') AS VGM_CCT
  				  FROM (SELECT SKD.SLAN_CD SLAN_CD , VVD.SKD_DIR_CD SLAN_DIR_CD , CASE WHEN DCGO_FLG = 'Y' THEN ''                                                                                                                                                                                              WHEN RC_FLG   = 'Y' THEN 'RF'
			                                                                           WHEN DCGO_FLG = 'N' AND RC_FLG = 'N' AND AWK_CGO_FLG = 'N' AND BB_CGO_FLG = 'N' THEN 'DR'
			                                                                           ELSE 'AL' END CGO_TP_CD,
		                       VPS_ETB_DT , VPS_ETD_DT , POL_NOD_CD , NVL(VVD.POL_CLPT_IND_SEQ, 1) AS CLPT_IND_SEQ , VVD.VSL_CD||VVD.SKD_VOY_NO||VVD.SKD_DIR_CD AS VVD, BK.BKG_NO
          				  FROM BKG_BOOKING BK, BKG_VVD VVD, VSK_VSL_PORT_SKD SKD
				         WHERE BK.BKG_NO = VVD.BKG_NO
				           AND BK.POL_CD = VVD.POL_CD
				           AND VVD.VSL_PRE_PST_CD IN ('S', 'T')
				           AND VVD.VSL_CD NOT IN ('COXX', 'COYY', 'COZZ')
				           AND VVD.VSL_CD = SKD.VSL_CD
				           AND VVD.SKD_VOY_NO = SKD.SKD_VOY_NO
				           AND VVD.SKD_DIR_CD = SKD.SKD_DIR_CD
				           AND VVD.POL_CD = SKD.VPS_PORT_CD
				           AND NVL(VVD.POL_CLPT_IND_SEQ, 1) = SKD.CLPT_IND_SEQ) SKD
			             WHERE SKD.BKG_NO = BB.BKG_NO 
						   AND ROWNUM = 1) VGM_CUT_OFF_TM,
		       DECODE((SELECT 'Y'
                  FROM BKG_EDI_TRD_PRNR_SUB_LNK EY,
                       BKG_EDI_SUB_LNK_MSG MSG,
                       BKG_BOOKING BKG1
                 WHERE BB.BKG_NO = BKG1.BKG_NO
                   AND EY.TRD_PRNR_SUB_LNK_SEQ = MSG.TRD_PRNR_SUB_LNK_SEQ
                   AND EY.PRNR_SUB_LNK_DIV_CD = '1'
                   AND MSG.EDI_MSG_TP_ID = 'VGM'
                   AND MSG.MSG_TP_DESC = '1'
                   AND ((MSG.EDI_MSG_IND_CD = 31
                        AND (EY.PRNR_SUB_LNK_CD = BKG1.POR_NOD_CD
                             OR EY.PRNR_SUB_LNK_CD = BKG1.FULL_RTN_YD_CD
                             OR EY.PRNR_SUB_LNK_CD = BKG1.MTY_RTN_YD_CD ))
                       OR
                       (MSG.EDI_MSG_IND_CD = 32
                        AND EY.PRNR_SUB_LNK_CD = BKG1.POL_NOD_CD)
                       OR 
                       (MSG.EDI_MSG_IND_CD = 33
                        AND EXISTS (SELECT 'Y' FROM BKG_VVD WHERE BKG1.BKG_NO = BKG_NO AND EY.PRNR_SUB_LNK_CD = POL_YD_CD AND BKG1.POL_NOD_CD <> POL_YD_CD))
                       OR
                       (MSG.EDI_MSG_IND_CD = 35
                        AND (EY.PRNR_SUB_LNK_CD = BKG1.POR_NOD_CD
                             OR EY.PRNR_SUB_LNK_CD = BKG1.FULL_RTN_YD_CD
                             OR EY.PRNR_SUB_LNK_CD = BKG1.MTY_RTN_YD_CD ))
                       OR
                       (MSG.EDI_MSG_IND_CD = 36
                        AND EY.PRNR_SUB_LNK_CD = BKG1.POL_NOD_CD))
                   AND ROWNUM = 1), 'Y', 'Y', 'N') SUP,
			   LTST.VGM_SEQ VGM_SEQ,
			   LTST.ESIG_CO_NM,
			   LTST.XTER_SNDR_ID,
			   LTST.XTER_VGM_DOC_ID,
			   LTST.XTER_VGM_RQST_SEQ,
			   LTST.XTER_VGM_USR_ID,
			   LTST.WGT_TP_CD,
			   LTST.VGM_BKG_NO,
			   LTST.REF_ID,
			   MST_SPEC_FNC('PAYL',BC.CNTR_NO) + MST_SPEC_FNC('TARE',BC.CNTR_NO) PAYLD_PLS_TARE,
			   (SELECT ROUND(SUM(DECODE(TC.WGT_UT_CD,'KGS',TC.CNTR_WGT,'LBS',TC.CNTR_WGT * 0.453592,NULL)),3) 
				   FROM BKG_BOOKING TB, BKG_CONTAINER TC
				  WHERE TB.BKG_NO = TC.BKG_NO
					AND BC.CNTR_NO = TC.CNTR_NO
					AND TB.BKG_STS_CD <> 'X'
					AND (TB.VSL_CD, TB.SKD_VOY_NO, TB.SKD_DIR_CD) IN (SELECT VSL_CD, SKD_VOY_NO, SKD_DIR_CD
																		FROM BKG_BOOKING TT WHERE TT.BKG_NO = BB.BKG_NO)) + MST_SPEC_FNC('TARE',BC.CNTR_NO) CGO_PLS_TARE,
               ROW_NUMBER() OVER (PARTITION BY BC.BKG_NO,BC.CNTR_NO  ORDER BY BC.BKG_NO,BC.CNTR_NO) AS CTR_RNUM,
               ROW_NUMBER() OVER (PARTITION BY BB.BKG_NO  ORDER BY BB.BKG_NO ) AS RNUM
          FROM BKG_VVD VVD,
			   BKG_BOOKING BB ,
               BKG_CONTAINER BC ,
               BKG_BL_DOC BD ,
               BKG_CUSTOMER SHPR ,
               BKG_CUSTOMER FWDR ,
			   LTST,
			   SCE_COP_HDR COP,
               (SELECT DOC.BKG_NO,
                       DOC.EVNT_DT,
                       DOC.EVNT_USR_ID
                  FROM BKG_DOC_PROC_SKD DOC
                 WHERE DOC.BKG_DOC_PROC_TP_CD = 'VGMCLZ'
                   AND DOC.DOC_PERF_DELT_FLG = 'N') CLZ
         WHERE NVL(BB.BKG_STS_CD, 'Z') <> 'X'
		   AND BB.BKG_CGO_TP_CD <> 'P'
           AND BB.BKG_NO = COP.BKG_NO
		   AND COP.BKG_NO = BC.BKG_NO(+)
		   AND COP.CNTR_NO =BC.CNTR_NO(+)
           AND COP.COP_STS_CD <> 'X'
		   AND BB.BKG_NO = BD.BKG_NO
           AND BB.BKG_NO = SHPR.BKG_NO(+)
           AND SHPR.BKG_CUST_TP_CD = 'S'
           AND BB.BKG_NO = FWDR.BKG_NO(+)
           AND FWDR.BKG_CUST_TP_CD = 'F'
           AND BB.BKG_NO = CLZ.BKG_NO(+)
		   AND LTST.BKG_NO(+) = BC.BKG_NO
		   AND LTST.CNTR_NO(+) = BC.CNTR_NO 
		   AND VVD.BKG_NO = BB.BKG_NO
		#if (${bkg_no_list} != '')
		   AND BB.BKG_NO IN (
			#foreach($multiBkgNoVal IN ${bkg_no_list})        
				#if($velocityCount < $bkg_no_list.size()) '$multiBkgNoVal', #else '$multiBkgNoVal' #end
			#end
			)
	       AND VVD.VSL_PRE_PST_CD = 'T'
		#end
		#if (${in_vvd} != '')
           AND VVD.VSL_CD = SUBSTR(@[in_vvd], 1, 4)
           AND VVD.SKD_VOY_NO = SUBSTR(@[in_vvd], 5, 4)
           AND VVD.SKD_DIR_CD = SUBSTR(@[in_vvd], 9, 1)
		#end
		#if(${in_pol_cd} != '')
		   AND VVD.POL_CD = @[in_pol_cd]
		#end
		#if(${in_pol_yd_cd} != '')
		   AND SUBSTR(VVD.POL_YD_CD,-2) = @[in_pol_yd_cd]
		#end
		#if(${in_pol_lt} == 'LC')
		   AND VVD.POL_CD = BB.POL_CD
		#end
		#if(${in_pol_lt} == 'TS')
		   AND VVD.POL_CD <> BB.POL_CD
		#end
		#if(${in_pod_cd} != '')
		   AND VVD.POD_CD = @[in_pod_cd]
		#end
		#if(${in_pod_yd_cd} != '')
		   AND SUBSTR(VVD.POD_YD_CD,-2) = @[in_pod_yd_cd]
		#end
		#if(${in_pod_lt} == 'LC')
		   AND VVD.POD_CD = BB.POD_CD
		#end
		#if(${in_pod_lt} == 'TS')
		   AND VVD.POD_CD <> BB.POD_CD
		#end
		#if(${rcv_term_cd} != '')
		   AND BB.RCV_TERM_CD = @[rcv_term_cd]
		#end
		#if(${de_term_cd} != '')
		   AND BB.DE_TERM_CD = @[de_term_cd]
		#end
		#if(${in_bkg_ofc_cd} != '')
		   AND BB.BKG_OFC_CD = @[in_bkg_ofc_cd]
		#end
		#if(${vgm_opt} == 'I')
		   AND LTST.XTER_VGM_WGT <> 0
		#elseif(${vgm_opt} == 'N')
		   AND NVL(LTST.XTER_VGM_WGT,0) = 0
		#end
		#if(${in_vgm} != 'ALL')
		   AND LTST.XTER_VGM_RQST_CD = DECODE(@[in_vgm],'ECOM','WEB','EDI')
		#end
		#if(${board_from_dt} != '')
		   AND BD.BL_OBRD_DT >= TO_DATE(@[board_from_dt],'YYYY-MM-DD')
		#end
		#if(${board_to_dt} != '')
		   AND BD.BL_OBRD_DT <= TO_DATE(@[board_to_dt],'YYYY-MM-DD') +0.99999
		#end
		#if(${bkg_from_dt} != '')
		   AND BB.BKG_CRE_DT >= TO_DATE(@[bkg_from_dt],'YYYY-MM-DD') 
		#end
		#if(${bkg_to_dt} != '')
		   AND BB.BKG_CRE_DT <= TO_DATE(@[bkg_to_dt],'YYYY-MM-DD') +0.99999
		#end
		#if(${p_bkg_cust_tp_cd} !='' || ${in_cust_cnt_cd} !='' || ${in_cust_seq} !='' || ${in_cust_nm} != '')
		AND EXISTS( SELECT 'Y'
					FROM BKG_CUSTOMER Z
					WHERE 1=1
					AND Z.BKG_NO = BB.BKG_NO
				#if (${p_bkg_cust_tp_cd} !='')			
		     		AND Z.BKG_CUST_TP_CD = @[p_bkg_cust_tp_cd]
				#end
				#if (${in_cust_cnt_cd} !='')
				    AND Z.CUST_CNT_CD =@[in_cust_cnt_cd]
				#end
				#if (${in_cust_seq} !='')
					AND Z.CUST_SEQ =@[in_cust_seq]
				#end
				#if (${in_cust_nm} != '') 
					AND UPPER(Z.CUST_NM) LIKE '%'||UPPER(@[in_cust_nm])||'%'
				#end
				)	
		#end
		#if(${mss_sig} == 'Y')
			AND LTST.ESIG_CO_NM IS NULL
		#end
		#if(${late_upd} == 'Y')
     	    AND LTST.XTER_VGM_WGT <> BC.VGM_WGT
		#end
) MST
WHERE 1=1
#if(${ovr_payld} == 'Y')
  AND MST.VGM_WGT > MST.PAYLD_PLS_TARE
#end
#if(${diff_5_pct} == 'Y')
  AND ABS((MST.VGM_WGT - MST.CGO_PLS_TARE) / MST.CGO_PLS_TARE * 100) > 5
#end
#if(${diff_10_pct} == 'Y')
  AND ABS((MST.VGM_WGT - MST.CGO_PLS_TARE) / MST.CGO_PLS_TARE * 100) > 10
#end			]]></sql>
			<params>
				<param name="in_vvd" type="12" value="" out="N"/>
				<param name="in_pol_cd" type="12" value="" out="N"/>
				<param name="in_pol_yd_cd" type="12" value="" out="N"/>
				<param name="in_pod_cd" type="12" value="" out="N"/>
				<param name="in_pod_yd_cd" type="12" value="" out="N"/>
				<param name="rcv_term_cd" type="12" value="" out="N"/>
				<param name="de_term_cd" type="12" value="" out="N"/>
				<param name="in_bkg_ofc_cd" type="12" value="" out="N"/>
				<param name="in_vgm" type="12" value="" out="N"/>
				<param name="board_from_dt" type="12" value="" out="N"/>
				<param name="board_to_dt" type="12" value="" out="N"/>
				<param name="bkg_from_dt" type="12" value="" out="N"/>
				<param name="bkg_to_dt" type="12" value="" out="N"/>
				<param name="p_bkg_cust_tp_cd" type="12" value="" out="N"/>
				<param name="in_cust_cnt_cd" type="12" value="" out="N"/>
				<param name="in_cust_seq" type="12" value="" out="N"/>
				<param name="in_cust_nm" type="12" value="" out="N"/>
			</params>
		</query>
	</querys>
</sqls>
