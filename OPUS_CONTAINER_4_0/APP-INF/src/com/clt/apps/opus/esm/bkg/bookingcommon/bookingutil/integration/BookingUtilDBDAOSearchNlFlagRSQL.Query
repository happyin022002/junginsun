<?xml version="1.0" encoding="UTF-8"?>
<sqls>
	<querys>
		<query name="BookingUtilDBDAOSearchNlFlagRSQL">
			<desc><![CDATA[해당 bkg이 NL 지역에 들리는 지 조회]]></desc>
			<sql><![CDATA[
select 'Y' RESULT
#if (${ca_flg}== 'Y') 
  from bkg_vvd_his vvd, bkg_bkg_his bk
 where bk.bkg_no = @[bkg_no]
   and bk.bkg_no = vvd.bkg_no
   and bk.corr_no = 'TMP0000001'
   and vvd.corr_no = 'TMP0000001'
#else
  from bkg_vvd vvd, bkg_booking bk
 where bk.bkg_no = @[bkg_no]
   and bk.bkg_no = vvd.bkg_no
#end
   --and (vvd.pol_cd like 'NL%' or vvd.pod_cd like 'NL%' or bk.pod_cd like 'NL%' or bk.del_cd like 'NL%')
   and (   SUBSTR(vvd.pod_cd, 1, 2) IN (SELECT ATTR_CTNT1
                                          FROM BKG_CSTMS_CD_CONV_CTNT
                                         WHERE CNT_CD ='EU'
                                           AND CSTMS_DIV_ID='EU_MEMBER_CNT' )
        OR SUBSTR(bk.pod_cd, 1, 2) IN (SELECT ATTR_CTNT1
                                         FROM BKG_CSTMS_CD_CONV_CTNT
                                        WHERE CNT_CD ='EU'
                                          AND CSTMS_DIV_ID='EU_MEMBER_CNT' )) -- EU대상 국가로 조회
   and exists (select 'x'
                 from mdm_vsl_cntr mdm
                where vvd.vsl_cd = mdm.vsl_cd
                  and mdm.fdr_div_cd = 'T')
   and rownum = 1			]]></sql>
			<params>
				<param name="bkg_no" type="12" value="AAR000009100" out="N"/>
			</params>
		</query>
	</querys>
</sqls>
