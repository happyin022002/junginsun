<?xml version="1.0" encoding="UTF-8"?>
<sqls>
	<querys>
		<query name="EurCustomsTransmissionDBDAOsearchCntrRfAkCgoRSQL">
			<desc><![CDATA[Container 정보 및 Reefer, Break bulk, Akward정보를 조회한다.]]></desc>
			<sql><![CDATA[
SELECT TB.*
      ,TO_CHAR(CNTRWGT_T + CNTRTRW_T, 'FM999999999999990.000') AS CNTRGWGT
      ,TO_CHAR(CNTRWGT_T,             'FM999999999999990.000') AS CNTRWGT
      ,TO_CHAR(CNTRTRW_T,             'FM999999999999990.000') AS CNTRTRW
  FROM (

SELECT BC.CNTR_NO   AS CNTRNBR
      ,BC.PCK_TP_CD AS PUNIT
      ,BC.PCK_QTY   AS PKG
      ,BC.WGT_UT_CD AS CNTR_WGT_UNIT
      ,DECODE(BC.WGT_UT_CD,'LBS',ROUND(NVL(BC.CNTR_WGT,0)*0.4536, 3),NVL(BC.CNTR_WGT,0)) AS CNTRWGT_T
      ,(SELECT DECODE(NVL(S.TARE_WGT, 0), 0
                                          , DECODE(NVL(MDM.CNTR_TPSZ_TARE_WGT, 0), 0
                                          , DECODE(M.CNTR_TPSZ_CD, 'T2', 3600, 'T4', 5200, 0)
                                          , MDM.CNTR_TPSZ_TARE_WGT)
                                          , S.TARE_WGT  ) TARE_WGT
          FROM MST_CONTAINER  M
              ,MST_CNTR_SPEC  S
              ,MDM_CNTR_TP_SZ MDM
         WHERE M.CNTR_NO      = BC.CNTR_NO
           AND M.CNTR_SPEC_NO = S.CNTR_SPEC_NO(+)
           AND M.CNTR_TPSZ_CD = MDM.CNTR_TPSZ_CD
       ) AS CNTRTRW_T
      ,BC.CNTR_TPSZ_CD AS CNTRTYPE
      ,(SELECT CNTR_SEAL_NO
          FROM BKG_CNTR_SEAL_NO
         WHERE BKG_NO = BC.BKG_NO
           AND CNTR_NO = BC.CNTR_NO
           AND CNTR_SEAL_SEQ > 0
           AND ROWNUM = 1
       ) AS SEALNBR
      ,DECODE(@[bkg_cgo_tp], 'F','F','M') AS FM_IND
      ,BC.RC_FLG AS RF_IND
      ,BC.DCGO_FLG AS DG_IND
      ,BC.BB_CGO_FLG AS BK_IND
      ,BC.AWK_CGO_FLG AS AK_IND
      ,NVL(BAC.GRS_WGT, 0) AS OVWGT
--      ,'' AS STWG_REQ
      ,(SELECT INTG_CD_VAL_DESC
          FROM COM_INTG_CD_DTL A
              ,BKG_STWG_CGO    B
         WHERE A.INTG_CD_ID = 'CD02146'
           AND A.INTG_CD_VAL_CTNT = B.STWG_CD
           AND TO_CHAR(SYSDATE, 'YYYYMMDD') BETWEEN A.APLY_ST_DT AND A.APLY_END_DT
           AND B.BKG_NO = BC.BKG_NO
           AND ROWNUM = 1
        ) AS STWG_REQ
      ,BRC.CDO_TEMP AS TEMP
      ,DECODE(BRC.CDO_TEMP, NULL, '', 'C') AS TUNIT
      ,DECODE(BRC.CNTR_VENT_TP_CD, 'P', BRC.VENT_RTO||' %', 'C', BRC.CBM_PER_HR_QTY||' CMH', '')  AS VENT
      ,BC.MEAS_QTY   AS MEASURE
      ,BC.MEAS_UT_CD AS MEASURE_UNIT
      ,NVL(BC.RCV_TERM_CD,' ')||NVL(BC.DE_TERM_CD,' ') AS RDTYPE
      ,@[cmdt_desc]  AS CMDT_DESC
      ,@[cmdt_cd]    AS CMDT_CD
      ,BKG_TOKEN_NL_FNC(NVL(BRC.DIFF_RMK,' '),0,'') AS RF_REMARK
      ,@[bkg_spe_rd] AS RFDRY_IND
      ,NVL(BAC.OVR_FWRD_LEN, 0) AS OVF
      ,NVL(BAC.OVR_BKWD_LEN, 0) AS OVR
      ,NVL(BAC.OVR_HGT, 0) AS OVH
      ,NVL(BAC.OVR_LF_LEN, 0) AS OVLW
      ,NVL(BAC.OVR_RT_LEN, 0) AS OVRW
      ,BAC.WGT_UT_CD AS OVWGT_UNIT
      ,NVL(BAC.OVR_VOID_SLT_QTY, 0) AS VOID_SLOT
      ,NVL(BC.SOC_FLG,'N') AS SOCIND
      ,'' AS HAULAGE
      ,NVL(BBC.GRS_WGT, 0) AS BKWGT
      ,BBC.WGT_UT_CD AS BKWGTU
      ,NVL(BBC.DIM_WDT, 0) AS BKW
      ,NVL(BBC.DIM_HGT, 0) AS BKH
      ,NVL(BBC.DIM_LEN, 0) AS BKL
      ,MC.OWNR_CO_CD AS CNTROWN
      ,MC.LSTM_CD AS CNTRTRM
      ,BC.CNTR_NO
      ,(SELECT MAX( DECODE( NVL(INV.DMDT_AR_IF_CD,'N'),'Y',TO_CHAR(CALC.TO_MVMT_DT,'YYYYMMDD'),'N',TO_CHAR(CALC.FT_END_DT, 'YYYYMMDD')))
          FROM DMT_CHG_BKG_CNTR BCNTR
              ,DMT_CHG_CALC CALC
              ,DMT_INV_MN INV
        WHERE BCNTR.BKG_NO  = BC.BKG_NO
          AND BCNTR.CNTR_NO = BC.CNTR_NO
          AND CALC.SYS_AREA_GRP_ID         = BCNTR.SYS_AREA_GRP_ID
          AND CALC.CNTR_NO                 = BCNTR.CNTR_NO
          AND CALC.CNTR_CYC_NO             = BCNTR.CNTR_CYC_NO
          AND CALC.DMDT_TRF_CD             IN ('DMIF', 'CTIC')
          AND CALC.DMDT_CHG_LOC_DIV_CD NOT IN ('TSP', 'SZP')
          AND CALC.DUL_TP_EXPT_FLG = 'N'
          AND CALC.DMDT_INV_NO = INV.DMDT_INV_NO(+)
       ) AS NOD_DEM_FT
      ,BC.CNTR_PRT_FLG AS PL_IND
  FROM BKG_CONTAINER   BC
      ,BKG_RF_CGO      BRC
      ,BKG_AWK_CGO     BAC
      ,BKG_BB_CGO      BBC
      ,MST_CONTAINER   MC
      ,MDM_CNTR_TP_SZ  MCTS
 WHERE BC.BKG_NO       = @[bkg_no]
   AND BC.BKG_NO       = BRC.BKG_NO       (+)
   AND BC.CNTR_NO      = BRC.CNTR_NO      (+)
   AND BC.BKG_NO       = BAC.BKG_NO       (+)
   AND BC.CNTR_NO      = BAC.CNTR_NO      (+)
   AND BC.BKG_NO       = BBC.BKG_NO       (+)
   AND BC.CNTR_NO      = MC.CNTR_NO       (+)
   AND BC.CNTR_TPSZ_CD = MCTS.CNTR_TPSZ_CD(+)

     ) TB			]]></sql>
			<params>
				<param name="bkg_cgo_tp" type="12" value="" out="N"/>
				<param name="cmdt_desc" type="12" value="" out="N"/>
				<param name="cmdt_cd" type="12" value="" out="N"/>
				<param name="bkg_spe_rd" type="12" value="" out="N"/>
				<param name="bkg_no" type="12" value="" out="N"/>
			</params>
		</query>
	</querys>
</sqls>
