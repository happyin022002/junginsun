<?xml version="1.0" encoding="UTF-8"?>
<sqls>
	<querys>
		<query name="GeneralBookingSplitCombineDBDAOsearchBkgForSplitRSQL">
			<desc><![CDATA[booking split 화면에서 split시 참고할 data를 조회한다.   ]]></desc>
			<sql><![CDATA[
SELECT BK.BKG_NO
        , BK.BL_NO
        , BK.VSL_CD||BK.SKD_VOY_NO||BK.SKD_DIR_CD TVVD
		, (SELECT VVD.VSL_CD||VVD.SKD_VOY_NO||VVD.SKD_DIR_CD 
			 FROM BKG_VVD VVD
  		    WHERE BK.BKG_NO          = VVD.BKG_NO
   		      AND BK.POL_CD          = VVD.POL_CD
   		      AND VVD.VSL_PRE_PST_CD IN ('S', 'T')) FIRST_VVD
        , BK.POR_CD
        , BK.POL_CD
        , BK.POD_CD
        , BK.DEL_CD
        , DECODE(NVL(ST.STWG_CD,         'N'), 'N', 'N', 'Y') STWG_CD
        , BK.HNGR_FLG
        , DECODE(NVL(BK.STOP_OFF_LOC_CD, 'N'), 'N', 'N', 'Y') STOP_OFF_LOC_CD
        , DECODE(NVL(BK.RAIL_BLK_CD,     'N'), 'N', 'N', 'Y') RAIL_BLK_CD
        , BK.HOT_DE_FLG 
        , BK.SPCL_HIDE_FLG 
        , BK.FD_GRD_FLG 
        , BK.PRCT_FLG 
        , DECODE(NVL(BK.XTER_RMK,        'N'), 'N', 'N', 'Y') REMARK
        , BL.ACT_WGT
        , BL.WGT_UT_CD
        , TRUNC(BL.PCK_QTY) PCK_QTY
        , BL.PCK_TP_CD
        , BL.MEAS_QTY
        , BL.MEAS_UT_CD
        , NVL((SELECT 'Y' FROM BKG_DG_CGO  DG WHERE DG.BKG_NO = BK.BKG_NO AND ROWNUM = 1), 'N') DG
        , NVL((SELECT 'Y' FROM BKG_RF_CGO  RF WHERE RF.BKG_NO = BK.BKG_NO AND ROWNUM = 1), 'N') RF
        , NVL((SELECT 'Y' FROM BKG_AWK_CGO AK WHERE AK.BKG_NO = BK.BKG_NO AND ROWNUM = 1), 'N') AK
        , NVL((SELECT 'Y' FROM BKG_BB_CGO  BB WHERE BB.BKG_NO = BK.BKG_NO AND ROWNUM = 1), 'N') BB
        , BK.PCTL_NO
        , BL.BDR_FLG
        , NVL((SELECT 'Y' FROM BKG_TRO     WHERE CFM_FLG = 'Y' AND BKG_NO = BK.BKG_NO AND ROWNUM = 1
                UNION
               SELECT 'Y' FROM BKG_EUR_TRO WHERE CFM_FLG = 'Y' AND BKG_NO = BK.BKG_NO AND ROWNUM = 1), 'N') TRO_FLG
        , BK.ADV_SHTG_CD
		, BK.SPLIT_FLG
        , BK.BKG_STS_CD
		, (SELECT DECODE(CONTI_CD, 'E', 'EUR', 'GEN')
             FROM MDM_LOCATION 
            WHERE LOC_CD = BK.POL_CD) TRO_TP		, NVL((SELECT 'Y'
    		     FROM BKG_VVD VVD, BKG_COFF_TM COFF
    		    WHERE BK.BKG_NO          = VVD.BKG_NO
    		      AND BK.POL_CD          = VVD.POL_CD
    		      AND VVD.VSL_PRE_PST_CD IN ('S', 'T')
    		      AND COFF.VSL_CD        = VVD.VSL_CD
    		      AND COFF.SKD_VOY_NO    = VVD.SKD_VOY_NO
    		      AND COFF.SKD_DIR_CD    = VVD.SKD_DIR_CD
    		      AND COFF.POL_CD        = VVD.POL_CD
    		      AND COFF.CLPT_IND_SEQ  = VVD.POL_CLPT_IND_SEQ
				  AND ROWNUM = 1), 'N') BKG_CLOSE
		, NVL(ISS.OBL_ISS_FLG, 'N') OBL_ISS_FLG
		, BK.BKG_WT_CHK_FLG
		, BK.EDI_HLD_FLG
  FROM BKG_BOOKING BK, BKG_BL_DOC BL, BKG_BL_ISS ISS, BKG_STWG_CGO ST
 WHERE BK.BKG_NO = BL.BKG_NO
   AND BK.BKG_NO = ISS.BKG_NO(+)
   AND BK.BKG_NO = @[bkg_no]
   AND BK.BKG_NO = ST.BKG_NO(+)
   AND 1         = ST.STWG_SEQ(+)			]]></sql>
			<params>
				<param name="bkg_no" type="12" value="SAVY9140008" out="N"/>
			</params>
		</query>
	</querys>
</sqls>
