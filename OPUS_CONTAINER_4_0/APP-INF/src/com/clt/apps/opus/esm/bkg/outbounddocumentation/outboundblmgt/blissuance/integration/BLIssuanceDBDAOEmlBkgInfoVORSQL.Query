<?xml version="1.0" encoding="UTF-8"?>
<sqls>
	<querys>
		<query name="BLIssuanceDBDAOEmlBkgInfoVORSQL">
			<desc><![CDATA[BLIssuanceDBDAOEmlBkgInfoVO]]></desc>
			<sql><![CDATA[
SELECT  
	BKG.BKG_NO
	,BKG.BL_NO
	,CUST.CUST_NM AS SHPR_NM
	,VSL.VSL_ENG_NM||' '||BKG.SKD_VOY_NO||BKG.SKD_DIR_CD AS VVD
	,POR.LOC_NM ||','||CNT_POR.CNT_NM  AS POR
	,POD.LOC_NM ||','||CNT_POD.CNT_NM  AS POD
	,TO_CHAR(DOC.BL_OBRD_DT, 'MON DD, YYYY', 'NLS_DATE_LANGUAGE=ENGLISH') AS BL_OBRD_DT
	,CASE WHEN FINV.CUST_REF_NO_CTNT > ' ' THEN FINV.CUST_REF_NO_CTNT
	      WHEN EBFF.CUST_REF_NO_CTNT > ' ' THEN EBFF.CUST_REF_NO_CTNT
	 ELSE NVL(TRIM(BKG.SC_NO),BKG.RFA_NO) 
	 END AS REF_NO
FROM   
	BKG_BOOKING BKG
	,BKG_CUSTOMER CUST
	,MDM_VSL_CNTR VSL
	,MDM_LOCATION POR
	,MDM_LOCATION POD
	,BKG_BL_DOC DOC
	,MDM_COUNTRY CNT_POR
	,MDM_COUNTRY CNT_POD
	,BKG_REFERENCE FINV
	,BKG_REFERENCE EBFF
WHERE 0=0
AND BKG.BKG_NO = CUST.BKG_NO(+)
AND CUST.BKG_CUST_TP_CD(+) = 'S'
AND BKG.VSL_CD = VSL.VSL_CD(+)
AND BKG.POR_CD = POR.LOC_CD(+)
AND BKG.POD_CD = POD.LOC_CD(+)
AND BKG.BKG_NO = DOC.BKG_NO(+)
AND POR.CNT_CD = CNT_POR.CNT_CD(+)
AND POD.CNT_CD = CNT_POD.CNT_CD(+) 
AND BKG.BKG_NO = @[bkg_no]
AND BKG.BKG_NO = FINV.BKG_NO(+)
AND FINV.BKG_REF_TP_CD(+) ='FINV'
AND BKG.BKG_NO = EBFF.BKG_NO(+)
AND EBFF.BKG_REF_TP_CD(+) ='EBFF'			]]></sql>
			<params>
				<param name="bkg_no" type="12" value="" out="N"/>
			</params>
		</query>
	</querys>
</sqls>
