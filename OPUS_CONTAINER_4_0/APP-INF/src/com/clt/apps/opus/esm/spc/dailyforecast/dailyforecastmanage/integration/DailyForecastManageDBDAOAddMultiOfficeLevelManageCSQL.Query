<?xml version="1.0" encoding="UTF-8"?>
<sqls>
	<querys>
		<query name="DailyForecastManageDBDAOAddMultiOfficeLevelManageCSQL">
			<desc><![CDATA[Insert]]></desc>
			<sql><![CDATA[
INSERT INTO SPC_OFC_LVL
  (OFC_CD,
   OFC_APLY_FM_YRWK,
   OFC_APLY_TO_YRWK,
   OFC_TP_CD,
   OFC_ENG_NM,
   OFC_LOCL_NM,
   PRNT_OFC_CD,
   OFC_KND_CD,
   DELT_FLG,
   OFC_SLS_DELT_FLG,
   OFC_LVL,
   N1ST_PRNT_OFC_CD,
   N2ND_PRNT_OFC_CD,
   N3RD_PRNT_OFC_CD,
   N4TH_PRNT_OFC_CD,
   N5TH_PRNT_OFC_CD,
   N6TH_PRNT_OFC_CD,
   N7TH_PRNT_OFC_CD,
   SAQ_RGN_OFC_CD,
   SPC_SLS_OFC_CD,
   CRE_USR_ID,
   CRE_DT,
   UPD_USR_ID,
   UPD_DT)
  SELECT Z.OFC_CD,
         '100000',
         '999953',
         Z.OFC_TP_CD,
         Z.OFC_ENG_NM,
         Z.OFC_LOCL_NM,
         Z.PRNT_OFC_CD,
         Z.OFC_KND_CD,
         Z.DELT_FLG,
         NVL(Z.OFC_SLS_DELT_FLG, 'N'),
         DECODE(Z.OFC_TP_CD, 'QT', 3, 'SQ', 3, LENGTH(Z.OFC) / 6) LVL,
         DECODE(Z.OFC_TP_CD, 'QT', 'CSCHO', 'SQ', 'CSCHO', TRIM(SUBSTR(Z.OFC, 1, 6))) N1ST_PRNT_OFC_CD,
         DECODE(Z.OFC_TP_CD, 'QT', Z.PRNT_OFC_CD, 'SQ', Z.PRNT_OFC_CD, TRIM(SUBSTR(Z.OFC, 7, 6))) N2ND_PRNT_OFC_CD,
         DECODE(Z.OFC_TP_CD, 'QT', Z.OFC_CD, TRIM(SUBSTR(Z.OFC, 13, 6))) N3RD_PRNT_OFC_CD,
         TRIM(SUBSTR(Z.OFC, 19, 6)) N4TH_PRNT_OFC_CD,
         TRIM(SUBSTR(Z.OFC, 25, 6)) N5TH_PRNT_OFC_CD,
         TRIM(SUBSTR(Z.OFC, 31, 6)) N6TH_PRNT_OFC_CD,
         TRIM(SUBSTR(Z.OFC, 37, 6)) N7TH_PRNT_OFC_CD,
         NVL((SELECT C.CONV_RGN_OFC_CD FROM SPC_RGN_OFC_CONV C WHERE C.SLS_RGN_OFC_CD = Z.OFC_CD), Z.OFC_CD) SAQ_RGN_OFC_CD,
         CASE
           WHEN LENGTH(Z.OFC) / 6 >= 5 THEN
            TRIM(SUBSTR(Z.OFC, 25, 6))
           ELSE
            Z.OFC_CD
         END SPC_SLS_OFC_CD,
         'SYSTEM',
         SYSDATE,
         'SYSTEM',
         SYSDATE
    FROM (SELECT M.OFC_TP_CD,
                 M.OFC_CD,
                 M.OFC_ENG_NM,
                 M.OFC_LOCL_NM,
                 M.PRNT_OFC_CD,
                 M.OFC_KND_CD,
                 M.DELT_FLG,
                 M.OFC_SLS_DELT_FLG,
                 (SELECT CASE
                           WHEN (COUNT(1) = 1 AND MAX(DECODE(O.OFC_TP_CD, 'HO', 'Y')) = 'Y') OR
                                MAX(DECODE(O.OFC_TP_CD, 'HO', 'Y', 'N')) || MAX(DECODE(O.OFC_TP_CD, 'HQ', 'Y', 'N')) = 'YY' THEN
                            DECODE(MAX(DECODE(O.OFC_TP_CD, 'AQ', 'Y', 'N')),
                                   'Y',
                                   RPAD(MAX(DECODE(ROWNUM, 9, O.OFC_CD)), 6, ' ') || RPAD(MAX(DECODE(ROWNUM, 8, O.OFC_CD)), 6, ' ') ||
                                   RPAD(MAX(DECODE(ROWNUM, 7, O.OFC_CD)), 6, ' ') || RPAD(MAX(DECODE(ROWNUM, 6, O.OFC_CD)), 6, ' ') ||
                                   RPAD(MAX(DECODE(ROWNUM, 5, O.OFC_CD)), 6, ' ') || RPAD(MAX(DECODE(ROWNUM, 4, O.OFC_CD)), 6, ' ') ||
                                   RPAD(MAX(DECODE(ROWNUM, 3, O.OFC_CD)), 6, ' ') || RPAD(MAX(DECODE(ROWNUM, 2, O.OFC_CD)), 6, ' ') ||
                                   RPAD(MAX(DECODE(ROWNUM, 1, O.OFC_CD)), 6, ' '),
                                   RPAD(MAX(DECODE(ROWNUM, 9, O.OFC_CD)), 6, ' ') || RPAD(MAX(DECODE(ROWNUM, 8, O.OFC_CD)), 6, ' ') || DECODE(COUNT(1), 9, '      ', '') ||
                                   RPAD(MAX(DECODE(ROWNUM, 7, O.OFC_CD)), 6, ' ') || DECODE(COUNT(1), 8, '      ', '') || RPAD(MAX(DECODE(ROWNUM, 6, O.OFC_CD)), 6, ' ') ||
                                   DECODE(COUNT(1), 7, '      ', '') || RPAD(MAX(DECODE(ROWNUM, 5, O.OFC_CD)), 6, ' ') || DECODE(COUNT(1), 6, '      ', '') ||
                                   RPAD(MAX(DECODE(ROWNUM, 4, O.OFC_CD)), 6, ' ') || DECODE(COUNT(1), 5, '      ', '') || RPAD(MAX(DECODE(ROWNUM, 3, O.OFC_CD)), 6, ' ') ||
                                   DECODE(COUNT(1), 4, '      ', '') || RPAD(MAX(DECODE(ROWNUM, 2, O.OFC_CD)), 6, ' ') || DECODE(COUNT(1), 3, '      ', '') ||
                                   RPAD(MAX(DECODE(ROWNUM, 1, O.OFC_CD)), 6, ' '))
                           ELSE
                            ''
                         END OFC_CD
                    FROM MDM_ORGANIZATION O
                   WHERE O.OFC_TP_CD IN ('HO', 'HQ', 'AQ', 'BB', 'BA', 'BS', 'AF') --NYCNA의 LAXDD, CHIND를 AREA처럼 취급하기위해 추가
                     AND NOT EXISTS (SELECT 1 FROM SPC_RGN_OFC_CONV C WHERE C.SLS_RGN_OFC_CD = O.OFC_CD)
                  CONNECT BY NOCYCLE PRIOR O.PRNT_OFC_CD = O.OFC_CD
                   START WITH O.OFC_CD = M.OFC_CD
                          AND O.OFC_TP_CD IN ('HO', 'HQ', 'AQ', 'BB', 'BA', 'BS', 'AF') --NYCNA의 LAXDD, CHIND를 AREA처럼 취급하기위해 추가
                          AND NOT EXISTS (SELECT 1 FROM SPC_RGN_OFC_CONV C WHERE C.SLS_RGN_OFC_CD = O.OFC_CD)) OFC
            FROM MDM_ORGANIZATION M) Z			]]></sql>
			<params>
			</params>
		</query>
	</querys>
</sqls>
