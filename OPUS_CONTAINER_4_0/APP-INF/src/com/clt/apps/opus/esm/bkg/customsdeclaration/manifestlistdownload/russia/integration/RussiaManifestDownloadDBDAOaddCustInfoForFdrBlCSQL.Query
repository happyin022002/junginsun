<?xml version="1.0" encoding="UTF-8"?>
<sqls>
	<querys>
		<query name="RussiaManifestDownloadDBDAOaddCustInfoForFdrBlCSQL">
			<desc><![CDATA[addCustInfoForFdrBl]]></desc>
			<sql><![CDATA[
MERGE INTO BKG_CSTMS_RU_CUST A
USING (
         SELECT  LPAD(@[bl_no],12)   AS BL_NO
               , @[bkg_cust_tp_cd]   AS BKG_CUST_TP_CD
               , NVL(@[cust_nm], '')          AS CUST_NM
               , NVL(@[cust_addr], '')        AS CUST_ADDR
               , @[cre_usr_id]       AS CRE_USR_ID
               , SYSDATE             AS CRE_DT
               , @[upd_usr_id]       AS UPD_USR_ID
               , SYSDATE             AS UPD_DT
         FROM    DUAL
      ) B
ON (A.BL_NO = B.BL_NO
	AND A.BKG_CUST_TP_CD = B.BKG_CUST_TP_CD 
)

WHEN MATCHED THEN

  UPDATE
  SET    CUST_NM  = B.CUST_NM
	    ,CUST_ADDR = B.CUST_ADDR
        ,UPD_USR_ID = B.UPD_USR_ID
        ,UPD_DT = B.UPD_DT


WHEN NOT MATCHED THEN
  INSERT VALUES(   B.BL_NO
                 , B.BKG_CUST_TP_CD
                 , B.CUST_NM
                 , B.CUST_ADDR
                 , B.CRE_USR_ID
                 , B.CRE_DT
                 , B.UPD_USR_ID
                 , B.UPD_DT
    )			]]></sql>
			<params>
				<param name="bl_no" type="12" value="" out="N"/>
				<param name="bkg_cust_tp_cd" type="12" value="" out="N"/>
				<param name="cust_nm" type="12" value="" out="N"/>
				<param name="cust_addr" type="12" value="" out="N"/>
				<param name="cre_usr_id" type="12" value="" out="N"/>
				<param name="upd_usr_id" type="12" value="" out="N"/>
			</params>
		</query>
	</querys>
</sqls>
