<?xml version="1.0" encoding="UTF-8"?>
<sqls>
	<querys>
		<query name="HoldNoticeDBDAOsearchArrNtcSndHistRSQL">
			<desc><![CDATA[.]]></desc>
			<sql><![CDATA[
SELECT A.BKG_NO
      --,HIS_SEQ
      ,A.NTC_VIA_CD
      --,NTC_KND_CD
      --,CNTR_NO
      --,AGN_CD
      --,NTC_FOM_CD
      --,NTC_SEQ
      --,BKG_CUST_TP_CD
      ,A.CUST_CNTC_TP_CD
      ,DECODE(A.NTC_FAX_NO,NULL,NULL,NVL(B.FAX_NO,A.NTC_FAX_NO)) AS NTC_FAX_NO
      ,DECODE(A.NTC_EML,NULL,NULL,NVL(B.NTC_EML,A.NTC_EML))   AS NTC_EML
      /*,SND_ID
      ,EDI_ID
      ,ESVC_GRP_CD
      ,BKG_NTC_SND_RSLT_CD
      ,TML_NTC_SND_STS_CD
      ,CGOR_RCVR_TP_CD
      ,CGOR_STS_CD
      ,FRT_HDN_FLG
      ,FRT_ALL_FLG
      ,FRT_CLT_FLG
      ,FRT_PPD_FLG
      ,FRT_CHG_FLG
      ,FRT_ARR_FLG
      ,SND_OFC_CD
      ,SND_USR_ID
      ,SND_RQST_DT
      ,SND_RTY_KNT
      ,SND_DT
      ,DIFF_RMK
      ,CUST_CNTC_AMD_FLG
      ,DP_HDN_FLG
      ,CRE_USR_ID
      ,CRE_DT
      ,UPD_USR_ID
      ,UPD_DT
      ,SND_GDT
      ,DO_EDI_TP_CD*/
FROM   (
        SELECT /*+ index_desc(BNTC XPKBKG_NTC_HIS) */
               BNTC.*
        FROM   BKG_BOOKING  BKGM
              ,BKG_CUSTOMER BCST
              ,BKG_NTC_HIS  BNTC
        WHERE  BKGM.BKG_NO            = @[bkg_no]
        AND    BCST.BKG_NO            = BKGM.BKG_NO 
        AND    BCST.BKG_CUST_TP_CD    = @[bkg_cust_tp_cd]
        AND    BCST.AN_SND_FLG        = 'Y'
        AND    BNTC.BKG_NO            = BCST.BKG_NO
        AND    BNTC.BKG_CUST_TP_CD    = BCST.BKG_CUST_TP_CD
        AND    BNTC.NTC_KND_CD        = 'AN'
        AND    ROWNUM = 1
       ) A,
       (
        SELECT /*+ INDEX_DESC(B XPKBKG_HLD_NTC) */
               C.*
        FROM   BKG_HLD_NTC     A
              ,BKG_HLD_NTC     B
              ,BKG_HLD_NTC_DTL C
        WHERE  A.BKG_NO           = @[bkg_no]
        AND    A.NTC_SEQ          = @[ntc_seq]
        AND    B.BKG_NO           = A.BKG_NO
        AND    B.HLD_NTC_TP_CD    = 'PH'
        AND    B.CUST_CNT_CD      = A.CUST_CNT_CD
        AND    B.CUST_SEQ         = A.CUST_SEQ
        AND    B.CSTMS_PRE_HLD_CD = A.CSTMS_PRE_HLD_CD
        AND    C.BKG_NO           = B.BKG_NO
        AND    C.NTC_SEQ          = B.NTC_SEQ
        AND    ROWNUM = 1
       ) B
WHERE  A.BKG_NO          = B.BKG_NO(+)
AND    A.CUST_CNTC_TP_CD = B.CUST_CNTC_TP_CD(+)			]]></sql>
			<params>
				<param name="bkg_no" type="12" value="" out="N"/>
				<param name="bkg_cust_tp_cd" type="12" value="" out="N"/>
				<param name="ntc_seq" type="12" value="" out="N"/>
			</params>
		</query>
	</querys>
</sqls>
