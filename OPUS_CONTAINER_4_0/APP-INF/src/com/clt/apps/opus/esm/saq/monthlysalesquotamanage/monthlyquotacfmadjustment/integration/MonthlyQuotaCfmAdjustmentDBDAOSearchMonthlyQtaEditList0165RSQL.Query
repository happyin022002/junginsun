<?xml version="1.0" encoding="UTF-8"?>
<sqls>
	<querys>
		<query name="MonthlyQuotaCfmAdjustmentDBDAOSearchMonthlyQtaEditList0165RSQL">
			<desc><![CDATA[searchMonthlyQtaEditList 조회
History : 2011.02.16 김종준 [T-선사] Dry 이외의 GAMer 필드등 제거]]></desc>
			<sql><![CDATA[
SELECT   LPAD(ROW_NUMBER() OVER(ORDER BY  QTA.MQTA_RLSE_VER_NO
                                            ,QTA.BSE_YR
                                            ,QTA.BSE_QTR_CD
                                            ,QTA.QTA_TGT_CD
                                            ,QTA.TRD_CD
                                            ,QTA.DIR_CD
                                            ,QTA.RLANE_CD
                                            ,VVD.SPRT_GRP_CD
                                            ,VVD.BSA_GRP_CD
                                            ,QTA.BSE_MON
                                            ,VVD.BSE_WK
                                            ,QTA.VSL_CD
                                            ,QTA.SKD_VOY_NO
                                            ,QTA.SKD_DIR_CD
                                            ,QTA.RGN_OFC_CD),5,'0')  AS RN
        ,QTA.MQTA_RLSE_VER_NO
        ,QTA.BSE_YR
        ,QTA.BSE_QTR_CD
        ,QTA.QTA_TGT_CD
        ,QTA.TRD_CD
        ,QTA.DIR_CD
        ,VVD.SUB_TRD_CD
        ,QTA.RLANE_CD
        ,QTA.VSL_CD||QTA.SKD_VOY_NO||QTA.SKD_DIR_CD                     AS VVD_CD
        ,VVD.SPRT_GRP_CD||VVD.BSA_GRP_CD                                AS LANE_GRP
        ,QTA.BSE_MON
        ,VVD.BSE_WK
        ,VVD.FNL_BSA_CAPA
 		--2010.04.26 2010-2Q 까지  데이터  Office Level 로 데이터 생성  (수정오류)
        --,DECODE(QTA_TGT_CD,'G','',QTA.RGN_OFC_CD)                       AS RGN_OFC_CD
		,QTA.RGN_OFC_CD
        ,QTA.RHQ_CD
        ,DECODE(QTA_TGT_CD,'G','',QTA.AQ_CD)                            AS AQ_CD
		--,QTA.AQ_CD
        ,'TEU'                                                          AS UNIT
        ,QTA.LOD_QTY                                                    AS LOD_QTY
        ,QTA.LOD_QTY * QTA.GRS_RPB_REV                                  AS GRS_REV
        ,QTA.GRS_RPB_REV                                                AS GRS_RPB_REV
        ,QTA.LOD_QTY * (QTA.GRS_RPB_REV - QTA.CM_UC_AMT      )          AS CM_AMT
        ,QTA.CM_UC_AMT
        ,QTA.OPFIT_UC_AMT
        ,QTA.FULL_STVG_UC_AMT
        ,QTA.FULL_TRSP_UC_AMT
        ,QTA.MTY_STVG_UC_AMT
        ,QTA.MTY_TRSP_UC_AMT
        ,QTA.CNTR_FX_UC_AMT
        ,QTA.CHSS_FX_UC_AMT
        ,QTA.AGN_COMM_UT_AMT
        ,QTA.BIZ_ACT_UC_AMT
        ,QTA.SLT_MGMT_UC_AMT
        ,QTA.OWN_VOL_ACT_UC_AMT
        ,QTA.STP_UC_AMT
        ,QTA.EQ_HLD_UC_AMT
        ,QTA.EQ_REPO_UC_AMT
        ,QTA.EQ_SIM_UC_AMT
        ,QTA.CONV_DIR_CD
        ,QTA.SAQ_MISC_REV_AMT
        ,QTA.CUST_GRP_ID
        ,QTA.ADD_TP_CD
FROM     SAQ_MON_CFM_TGT_VVD VVD
        ,SAQ_MON_CFM_QTA     QTA
WHERE   1=1
AND     QTA.MQTA_RLSE_VER_NO    = @[mqtaRlseVerNo]
AND     QTA.BSE_YR              = @[bse_yr]
AND     QTA.BSE_QTR_CD          = @[bse_qtr_cd]
AND     QTA.QTA_TGT_CD          = @[qtaTgtCd]
AND     QTA.TRD_CD              = @[trd_cd]
AND     QTA.DIR_CD              = @[dir_cd]
AND     QTA.RLANE_CD            LIKE NVL(@[rlane_cd], '%')
AND     VVD.MQTA_RLSE_VER_NO    = QTA.mqta_rlse_ver_no
AND     VVD.BSE_YR              = QTA.bse_yr
AND     VVD.BSE_QTR_CD          = QTA.bse_qtr_cd
AND     VVD.BSE_MON             = QTA.bse_mon
AND     VVD.TRD_CD              = QTA.trd_cd
AND     VVD.RLANE_CD            = QTA.rlane_cd
AND     VVD.DIR_CD              = QTA.dir_cd
AND     VVD.VSL_CD              = QTA.vsl_cd
AND     VVD.SKD_VOY_NO          = QTA.skd_voy_no
AND     VVD.SKD_DIR_CD          = QTA.skd_dir_cd
ORDER BY QTA.MQTA_RLSE_VER_NO
        ,QTA.BSE_YR
        ,QTA.BSE_QTR_CD
        ,QTA.QTA_TGT_CD
        ,QTA.TRD_CD
        ,QTA.DIR_CD
        ,QTA.RLANE_CD
        ,VVD.SPRT_GRP_CD
        ,VVD.BSA_GRP_CD
        ,QTA.BSE_MON
        ,VVD.BSE_WK
        ,QTA.VSL_CD
        ,QTA.SKD_VOY_NO
        ,QTA.SKD_DIR_CD
        ,QTA.RGN_OFC_CD			]]></sql>
			<params>
				<param name="mqtaRlseVerNo" type="12" value="" out="N"/>
				<param name="bse_yr" type="12" value="" out="N"/>
				<param name="bse_qtr_cd" type="12" value="" out="N"/>
				<param name="qtaTgtCd" type="12" value="" out="N"/>
				<param name="trd_cd" type="12" value="" out="N"/>
				<param name="dir_cd" type="12" value="" out="N"/>
				<param name="rlane_cd" type="12" value="" out="N"/>
			</params>
		</query>
	</querys>
</sqls>
