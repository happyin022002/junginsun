<?xml version="1.0" encoding="UTF-8"?>
<sqls>
	<querys>
		<query name="KorManifestListDBDAOaddDgVVDInfoCSQL">
			<desc><![CDATA[최초 Download시 DG VVD정보가 Table에 Insert된다.]]></desc>
			<sql><![CDATA[
INSERT 
  INTO BKG_CSTMS_KR_DG_CGO_VVD 
     ( MRN_NO
     , MRN_CHK_NO
     , VSL_CD
     , SKD_VOY_NO
     , SKD_DIR_CD
     , PORT_CD
     , IO_BND_CD
     , INTER_CNG_CTRL_NO
     , VSL_NM
     , KR_VSL_CALL_SGN_CD
     , ARR_DT
     , DCHG_FM_DT
     , DCHG_TO_DT
     , KR_DCHG_CO_ID
     , DCHG_VNDR_NM
     , KR_CSTMS_DCHG_N1ST_JB_CD
     , KR_CSTMS_DCHG_N2ND_JB_CD
     , TTL_CNTR_KNT
     , DG_TTL_WGT
     , PRE_CLPT_CD
     , PORT_AREA_N1ST_ID
     , PORT_AREA_N2ND_ID
     , PORT_DESC
     , REP_SBST_CTNT
     , CNTC_PSON_DESC
     , CRE_DT
     , CRE_USR_ID
     , UPD_DT
     , UPD_USR_ID
     , MF_SND_DT
     , MF_SND_USR_ID
     , CALL_KNT
     , VVD_SEQ
     , IO_BND_DT
     , KR_PORT_AUTH_CD
     , KR_CSTMS_DG_TRNS_CD
     , DCGO_SEQ
     , TML_VSL_CD
     , TML_SKD_VOY_NO
     )
SELECT SUBSTR(@[mrn_no],1,10)
     , SUBSTR(@[mrn_no],11,1)
     , SUBSTR(@[vvd], 1, 4)
     , SUBSTR(@[vvd], 5, 4)
     , SUBSTR(@[vvd], 9, 1)
     , @[port_cd]
     , DECODE(@[io], '01', 'I', 'O')
     , NVL(@[doc_no], MAX(INTER_CNG_CTRL_NO)+1)
     , @[vsl_eng_nm]
     , @[call_sgn_no]
     , CASE WHEN @[arv_dt] = ' ' THEN NULL ELSE TO_DATE(@[arv_dt], 'YYYY-MM-DD HH24:MI') END
     , CASE WHEN @[from_dt] = ' ' THEN NULL ELSE TO_DATE(@[from_dt], 'YYYY-MM-DD HH24:MI') END
     , CASE WHEN @[to_dt] = ' ' THEN NULL ELSE TO_DATE(@[to_dt], 'YYYY-MM-DD HH24:MI') END
     , @[dchg_com_cd]
     , @[dsch_com_nm]
     , @[job_code1]
     , @[job_code2]
     , @[total_cntr]
     , @[total_wgt]
     , @[pre_port]
     , @[port_area]
     , @[port_anch]
     , @[port_desc]
     , @[substance]
     , @[contact]
     , SYSDATE
     , @[user_id]
     , SYSDATE
     , @[user_id]
     , NULL
     , NULL
     , @[call_knt]
     , @[max_vvd_seq]
     , CASE WHEN @[io_dt] = ' ' THEN NULL ELSE TO_DATE(@[io_dt], 'YYYY-MM-DD HH24:MI') END
     , @[authority]
     , @[trans_code]
     , NVL(@[dgco_seq],0)
     , @[tml_vvd]
     , @[tml_skd_voy_no]
  FROM BKG_CSTMS_KR_DG_CGO_VVD 
 WHERE MRN_NO      =   SUBSTR(@[mrn_no],1,10)
   AND MRN_CHK_NO  =   SUBSTR(@[mrn_no],11,1)
   AND VSL_CD      =   SUBSTR(@[vvd], 1, 4)
   AND SKD_VOY_NO  =   SUBSTR(@[vvd], 5, 4)
   AND SKD_DIR_CD  =   SUBSTR(@[vvd], 9, 1)
   AND VVD_SEQ     =   (@[max_vvd_seq] - 1)			]]></sql>
			<params>
				<param name="mrn_no" type="12" value="" out="N"/>
				<param name="vvd" type="12" value="" out="N"/>
				<param name="port_cd" type="12" value="" out="N"/>
				<param name="io" type="12" value="" out="N"/>
				<param name="doc_no" type="12" value="" out="N"/>
				<param name="vsl_eng_nm" type="12" value="" out="N"/>
				<param name="call_sgn_no" type="12" value="" out="N"/>
				<param name="arv_dt" type="12" value="" out="N"/>
				<param name="from_dt" type="12" value="" out="N"/>
				<param name="to_dt" type="12" value="" out="N"/>
				<param name="dchg_com_cd" type="12" value="" out="N"/>
				<param name="dsch_com_nm" type="12" value="" out="N"/>
				<param name="job_code1" type="12" value="" out="N"/>
				<param name="job_code2" type="12" value="" out="N"/>
				<param name="total_cntr" type="12" value="" out="N"/>
				<param name="total_wgt" type="12" value="" out="N"/>
				<param name="pre_port" type="12" value="" out="N"/>
				<param name="port_area" type="12" value="" out="N"/>
				<param name="port_anch" type="12" value="" out="N"/>
				<param name="port_desc" type="12" value="" out="N"/>
				<param name="substance" type="12" value="" out="N"/>
				<param name="contact" type="12" value="" out="N"/>
				<param name="user_id" type="12" value="" out="N"/>
				<param name="call_knt" type="12" value="" out="N"/>
				<param name="max_vvd_seq" type="12" value="" out="N"/>
				<param name="io_dt" type="12" value="" out="N"/>
				<param name="authority" type="12" value="" out="N"/>
				<param name="trans_code" type="12" value="" out="N"/>
				<param name="dgco_seq" type="12" value="" out="N"/>
				<param name="tml_vvd" type="12" value="" out="N"/>
				<param name="tml_skd_voy_no" type="12" value="" out="N"/>
			</params>
		</query>
	</querys>
</sqls>
