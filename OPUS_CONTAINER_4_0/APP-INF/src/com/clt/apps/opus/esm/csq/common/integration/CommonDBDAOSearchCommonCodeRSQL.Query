<?xml version="1.0" encoding="UTF-8"?>
<sqls>
	<querys>
		<query name="CommonDBDAOSearchCommonCodeRSQL">
			<desc><![CDATA[CSQ 에서 사용하는 목록성 코드조회]]></desc>
			<sql><![CDATA[
#if (${methodname} == 'searchYearList')

/* Year 콤보의 목록을 가져온다 */
  SELECT T_YEAR - CPY_NO CODE 
        ,T_YEAR - CPY_NO NAME
    FROM (
           SELECT 2013 AS F_YEAR
                 ,TO_CHAR(SYSDATE, 'YYYY') + 1 AS T_YEAR
             FROM DUAL
         ) Y
        ,COM_CPY_NO C
   WHERE C.CPY_NO <= T_YEAR - F_YEAR
ORDER BY C.CPY_NO

#elseif (${methodname} == 'searchQuarterList')

/* Quarter 콤보의 목록을 가져온다 */
  SELECT INTG_CD_VAL_CTNT    AS CODE
        ,INTG_CD_VAL_DP_DESC AS NAME
    FROM COM_INTG_CD_DTL
   WHERE INTG_CD_ID        = 'CD01365'
     AND INTG_CD_VAL_CTNT <> '00'
ORDER BY INTG_CD_VAL_DP_SEQ

#elseif (${methodname} == 'searchOfficeViewList')

/* Office View 콤보의 목록을 가져온다 */
  SELECT INTG_CD_VAL_CTNT    AS CODE
        ,INTG_CD_VAL_DP_DESC AS NAME
    FROM COM_INTG_CD_DTL
   WHERE INTG_CD_ID        = 'CD00940'
     AND INTG_CD_VAL_DESC <> 'ALL'
ORDER BY INTG_CD_VAL_DP_SEQ

#elseif (${methodname} == 'searchMdmTradeList')

/* Trade 콤보의 목록을 가져온다 */
  SELECT TRD_CD CODE
        ,TRD_CD NAME
    FROM MDM_TRADE
   WHERE VSL_TP_CD = 'C'
     AND DELT_FLG  = 'N'
     AND TRD_CD   <> 'COM'
ORDER BY TRD_CD

#elseif (${methodname} == 'searchMdmSubTradeList')

/* Sub Trade 콤보의 목록을 가져온다 */
  SELECT DISTINCT 
         SUB_TRD_CD CODE
        ,SUB_TRD_CD NAME
    FROM COA_LANE_RGST
   WHERE DELT_FLG = 'N'
#if (${f_trd_cd} != ''  && ${f_trd_cd} != 'All')
     AND TRD_CD   = @[f_trd_cd]
#end
ORDER BY SUB_TRD_CD

#elseif (${methodname} == 'searchSubTradeList')

/* Sub Trade 콤보의 목록을 가져온다 */
SELECT DISTINCT 
       SUB_TRD_CD CODE
      ,SUB_TRD_CD NAME
  FROM CSQ_QTA_LANE_MGMT
 WHERE 1=1
   AND CSQ_ACT_FLG = 'Y'
#if (${sector_include} != 'Y')
   AND IAS_SCTR_FLG = 'N'
#end
#if (${f_trd_cd} != '' && ${f_trd_cd} != 'All')
   AND TRD_CD      = NVL(@[f_trd_cd], TRD_CD)
#end
   AND BSE_TP_CD   = @[f_bse_tp_cd]
   AND BSE_YR      = @[f_bse_yr]
   AND BSE_QTR_CD  = DECODE(@[f_bse_tp_cd],'Y','00',@[f_bse_qtr_cd])
ORDER BY SUB_TRD_CD

#elseif (${methodname} == 'searchRhqList')

/* RHQ 콤보의 목록을 가져온다 */
  SELECT DISTINCT
         N2ND_PRNT_OFC_CD AS CODE
        ,N2ND_PRNT_OFC_CD AS NAME
    FROM CSQ_ORGANIZATION_V
   WHERE N2ND_PRNT_OFC_CD IS NOT NULL
     AND DELT_FLG = 'N'
ORDER BY N2ND_PRNT_OFC_CD

#elseif (${methodname} == 'searchOfcList')

/* Office 콤보의 목록을 가져온다 */
--MDM과 CSQ_QTA_OFC UNION 해서 가져옴
SELECT DISTINCT
     N4TH_PRNT_OFC_CD AS CODE
    ,N4TH_PRNT_OFC_CD AS NAME
FROM CSQ_ORGANIZATION_V
WHERE N4TH_PRNT_OFC_CD IS NOT NULL
#if (${f_rhq_cd} != '' && ${f_rhq_cd} != 'All')
 AND N2ND_PRNT_OFC_CD = @[f_rhq_cd]
#end
AND DELT_FLG = 'N'
UNION
SELECT DISTINCT
   RGN_OFC_CD AS CODE
  ,RGN_OFC_CD AS NAME
FROM CSQ_QTA_OFC 
WHERE 1=1
#if (${f_rhq_cd} != '' && ${f_rhq_cd} != 'All')
AND RHQ_CD = @[f_rhq_cd]
#end
AND DELT_FLG = 'N'


#elseif (${methodname} == 'searchHoTeamsList')

/* H/O Teams 목록을 조회한다 */
  SELECT DISTINCT
         TEAM_CD AS CODE
        ,TEAM_CD AS NAME
    FROM CSQ_DAT_RLT
#if (${rhq} == 'Org')
UNION ALL
/* RHQ 콤보의 목록을 가져온다 */
  SELECT DISTINCT
         N2ND_PRNT_OFC_CD AS CODE
        ,N2ND_PRNT_OFC_CD AS NAME
    FROM CSQ_ORGANIZATION_V
   WHERE N2ND_PRNT_OFC_CD IS NOT NULL
     AND DELT_FLG = 'N'
#end

#elseif (${methodname} == 'searchCPeriodList')

/* Create Period 기간을 가져온다 */
SELECT MIN_YRWK || '~' || MAX_YRWK AS CODE
      ,SUBSTR(MIN_YRWK, 1, 4) || '.wk' || SUBSTR(MIN_YRWK, 5, 2) || ' ~ ' || SUBSTR(MAX_YRWK, 1, 4) || '.wk' || SUBSTR(MAX_YRWK, 5, 2) AS NAME
  FROM (
         SELECT /*+ index_desc(coa_wk_prd XPKCOA_WK_PRD) */
                MIN(COST_YR||COST_WK) AS MIN_YRWK
               ,MAX(COST_YR||COST_WK) AS MAX_YRWK
           FROM COA_WK_PRD
          WHERE COST_YR||COST_WK <= @[f_year_wk]
            AND ROWNUM           <= @[f_dur]
       )

#elseif (${methodname} == 'searchNextQtaList')

/* 현재 주차를 포함한 분기의 다음 분기를 가져온다 */
SELECT DECODE(QTA, 1, COST_YR + 1, COST_YR) || '-' || QTA || 'Q' AS CODE
      ,DECODE(QTA, 1, COST_YR + 1, COST_YR) || '-' || QTA || 'Q' AS NAME
  FROM (
         SELECT COST_YR
               ,CASE WHEN COST_WK <= 13 THEN 2
                     WHEN COST_WK <= 26 THEN 3
                     WHEN COST_WK <= 39 THEN 4
                     WHEN COST_WK <= 53 THEN 1
                 END QTA
           FROM COA_WK_PRD
          WHERE TO_CHAR(SYSDATE, 'YYYYMMDD') BETWEEN SLS_FM_DT AND SLS_TO_DT
       )

#elseif (${methodname} == 'rhqForPlan')

/* RHQ 목록을 조회한다 */
  SELECT DISTINCT
         RHQ_CD AS CODE
        ,RHQ_CD AS NAME
    FROM CSQ_QTA_OFC 
   WHERE DELT_FLG = 'N'
ORDER BY RHQ_CD

#elseif (${methodname} == 'officeForPlan')

/* OFC 목록을 조회한다 */
  SELECT DISTINCT
         RGN_OFC_CD AS CODE
        ,RGN_OFC_CD AS NAME
    FROM CSQ_QTA_OFC 
   WHERE RHQ_CD = (SELECT CASE WHEN @[rhq_cd] IN (SELECT INTG_CD_VAL_CTNT FROM COM_INTG_CD_DTL WHERE INTG_CD_ID = 'CD03255') THEN RHQ_CD
                                                                                                                            ELSE @[rhq_cd]
                           END TEAM_CD
                      FROM DUAL)
     AND DELT_FLG = 'N'
ORDER BY RGN_OFC_CD

#elseif (${methodname} == 'searchGroupCustomer')

/* Group Customer 목록을 조회한다 */
	SELECT DISTINCT
       	   CUST_GRP_ID CODE
          ,CUST_GRP_NM NAME
	  FROM MDM_CUST_PERF_GRP
	 WHERE DELT_FLG = 'N'
#if (${f_acc_grp_cd} != ''  && ${f_acc_grp_cd} == 'C')
	   AND NEW_KEY_ACCT_FLG = 'Y' --> CORE
#end
#if (${f_acc_grp_cd} != ''  && ${f_acc_grp_cd} == 'R')
	   AND RGN_ACCT_FLG ='Y'     --> REGION
#end
  ORDER BY CUST_GRP_ID

#elseif (${methodname} == 'searchVvdList')

/* VVD 콤보의 목록을 가져온다 */
  SELECT DISTINCT
         VSL_CD || SKD_VOY_NO || SKD_DIR_CD AS CODE
        ,VSL_CD || SKD_VOY_NO || SKD_DIR_CD AS NAME
    FROM CSQ_CFM_TGT_VVD
   WHERE BSE_TP_CD  = 'Q'
     AND BSE_YR     = @[f_bse_yr]
     AND BSE_QTR_CD = @[f_bse_qtr_cd]
     AND QTA_TGT_CD = @[f_qta_tgt_cd]
     AND TRD_CD     = @[f_trd_cd]
     AND DIR_CD     = @[f_dir_cd]
     AND SUB_TRD_CD = @[f_sub_trd_cd]
     AND RLANE_CD   = @[f_rlane_cd]
ORDER BY CODE

#elseif (${methodname} == 'searchMdmRLaneList')

SELECT DISTINCT
       RLANE_CD AS CODE
      ,RLANE_CD AS NAME
  FROM MDM_DTL_REV_LANE
 WHERE 1=1
#if (${f_trd_cd} != '' && ${f_trd_cd} != 'All')
   AND TRD_CD     = @[f_trd_cd]
#end
#if (${f_sub_trd_cd} != '' && ${f_sub_trd_cd} != 'All')
   AND SUB_TRD_CD = @[f_sub_trd_cd]
#end
   AND DELT_FLG   = 'N'
 ORDER BY SUBSTR(RLANE_CD,-2), RLANE_CD

#elseif (${methodname} == 'searchRLaneList')

/* Lane Master 상의 Overall RLane 콤보의 목록을 가져온다 */
SELECT DISTINCT
       A1.RLANE_CD AS CODE
      ,A1.RLANE_CD AS NAME
  FROM CSQ_QTA_LANE_MGMT A1
WHERE 1=1
#if (${f_trd_cd} != '' && ${f_trd_cd} != 'All')
   AND A1.TRD_CD      = NVL(@[f_trd_cd], A1.TRD_CD)
#end
   AND A1.BSE_TP_CD   = @[f_bse_tp_cd]
   AND A1.BSE_YR      = @[f_bse_yr]
   AND A1.BSE_QTR_CD  = DECODE(@[f_bse_tp_cd],'Y','00',@[f_bse_qtr_cd])
#if (${f_sub_trd_cd} != '' && ${f_sub_trd_cd} != 'All')
   AND A1.SUB_TRD_CD  = @[f_sub_trd_cd]
#end
   AND A1.CSQ_ACT_FLG = 'Y'
#if (${sector_include} != 'Y')
   AND A1.IAS_SCTR_FLG = 'N'
#end
ORDER BY A1.RLANE_CD

#elseif (${methodname} == 'searchRLaneSectorList')

/* Lane Master 상의 Sector RLane 콤보의 목록을 가져온다 */
SELECT DISTINCT
       A1.RLANE_CD AS CODE
      ,A1.RLANE_CD AS NAME
  FROM CSQ_QTA_LANE_MGMT A1
WHERE 1=1
#if (${f_trd_cd} != '' && ${f_trd_cd} != 'All')
   AND A1.TRD_CD      = NVL(@[f_trd_cd], A1.TRD_CD)
#end
   AND A1.BSE_TP_CD   = @[f_bse_tp_cd]
   AND A1.BSE_YR      = @[f_bse_yr]
   AND A1.BSE_QTR_CD  = DECODE(@[f_bse_tp_cd],'Y','00',@[f_bse_qtr_cd])
#if (${f_sub_trd_cd} != '' && ${f_sub_trd_cd} != 'All')
   AND A1.SUB_TRD_CD  = @[f_sub_trd_cd]
#end
   AND A1.CSQ_ACT_FLG = 'Y'
   AND A1.IAS_SCTR_FLG = 'Y'
ORDER BY A1.RLANE_CD

#elseif (${methodname} == 'searchCurrentQtaList')

/* 현재 주차의 분기를 가져온다 */
SELECT COST_YR || '-' || QTA || 'Q' AS CODE
      ,COST_YR || '-' || QTA || 'Q' AS NAME
  FROM (
         SELECT COST_YR
               ,CASE WHEN COST_WK <= 13 THEN 1
                     WHEN COST_WK <= 26 THEN 2
                     WHEN COST_WK <= 39 THEN 3
                     WHEN COST_WK <= 53 THEN 4
                 END QTA
           FROM COA_WK_PRD
          WHERE TO_CHAR(SYSDATE, 'YYYYMMDD') BETWEEN SLS_FM_DT AND SLS_TO_DT
       )

#elseif (${methodname} == 'searchTradeList')

-- OverAll 또는 Sector를 포함한 전체 Trade 정보를 조회한다
SELECT DISTINCT
       TRD_CD CODE
      ,TRD_CD NAME
  FROM CSQ_QTA_LANE_MGMT
 WHERE 1=1
   AND CSQ_ACT_FLG  = 'Y'
   AND BSE_TP_CD   = @[f_bse_tp_cd]
   AND BSE_YR      = @[f_bse_yr]
   AND BSE_QTR_CD  = DECODE(@[f_bse_tp_cd],'Y','00',@[f_bse_qtr_cd])
#if (${sector_include} != 'Y')
   AND IAS_SCTR_FLG = 'N'
#end
 ORDER BY TRD_CD

#elseif (${methodname} == 'searchPfGroupList')

-- PF Group List 콤보의 목록을 가져온다.
SELECT DISTINCT 
       RLANE_CD||'|'||PF_GRP_CD NAME
      ,PF_GRP_CD CODE
#if (${tb_nm} == 'csq_sctr_pair_mgmt')
FROM CSQ_SCTR_PAIR_MGMT
#elseif (${tb_nm} == 'csq_sctr_lane_ofc')
FROM CSQ_SCTR_LANE_OFC
#end
WHERE 1=1
AND RLANE_CD IN (${f_rlane_cd})
ORDER BY NAME, CODE 

#elseif (${methodname} == 'searchSubTradeSectorList')

/* Sub Trade Sector 콤보의 목록을 가져온다 */
SELECT DISTINCT 
       SUB_TRD_CD CODE
      ,SUB_TRD_CD NAME
  FROM CSQ_QTA_LANE_MGMT
 WHERE 1=1
   AND CSQ_ACT_FLG = 'Y'
   AND IAS_SCTR_FLG = 'Y'
#if (${f_trd_cd} != '' && ${f_trd_cd} != 'All')
   AND TRD_CD      = NVL(@[f_trd_cd], TRD_CD)
#end
   AND BSE_TP_CD   = @[f_bse_tp_cd]
   AND BSE_YR      = @[f_bse_yr]
   AND BSE_QTR_CD  = DECODE(@[f_bse_tp_cd],'Y','00',@[f_bse_qtr_cd])
ORDER BY SUB_TRD_CD

#end			]]></sql>
			<params>
				<param name="f_trd_cd" type="12" value="" out="N"/>
				<param name="f_bse_tp_cd" type="12" value="" out="N"/>
				<param name="f_bse_yr" type="12" value="" out="N"/>
				<param name="f_bse_qtr_cd" type="12" value="" out="N"/>
				<param name="f_rhq_cd" type="12" value="" out="N"/>
				<param name="f_year_wk" type="12" value="" out="N"/>
				<param name="f_dur" type="12" value="" out="N"/>
				<param name="rhq_cd" type="12" value="" out="N"/>
				<param name="f_qta_tgt_cd" type="12" value="" out="N"/>
				<param name="f_dir_cd" type="12" value="" out="N"/>
				<param name="f_sub_trd_cd" type="12" value="" out="N"/>
				<param name="f_rlane_cd" type="12" value="" out="N"/>
			</params>
		</query>
	</querys>
</sqls>
