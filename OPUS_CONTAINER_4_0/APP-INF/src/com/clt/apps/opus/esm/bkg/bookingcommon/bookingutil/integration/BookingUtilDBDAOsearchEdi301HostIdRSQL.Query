<?xml version="1.0" encoding="UTF-8"?>
<sqls>
	<querys>
		<query name="BookingUtilDBDAOsearchEdi301HostIdRSQL">
			<desc><![CDATA[searchEdi301HostId]]></desc>
			<sql><![CDATA[
#if (${sndr_tp_cd} == 'CUST') 
    SELECT mchn_trd_prnr_id HOST_TP_ID
      FROM bkg_edi_grp
     WHERE cust_trd_prnr_id  = @[rcv_id]
       AND esvc_grp_delt_flg = 'N'
       AND rownum            = 1 
#elseif (${sndr_tp_cd} == 'CUST_301')
    SELECT BHCC.ATTR_CTNT4 AS HOST_TP_ID
    FROM BKG_HRD_CDG_CTNT BHCC
    WHERE BHCC.HRD_CDG_ID = 'CUSTOMER_301_EDI_ID'
    AND BHCC.ATTR_CTNT3 = @[rcv_id]
    AND ROWNUM =  1
#elseif (${sndr_tp_cd} == 'APERAK') 
	SELECT 
		HRD.ATTR_CTNT2 HOST_TP_ID
    FROM BKG_HRD_CDG_CTNT HRD
   	WHERE HRD_CDG_ID = 'XTER_ACK_RECEIVER'
   	AND HRD.ATTR_CTNT1 = @[rcv_id]
	AND ROWNUM = 1
#else
#if (${edi_ref_cd} != '') 
    SELECT SNDR_TRD_PRNR_ID HOST_TP_ID			
      FROM BKG_EDI_TRD_PRNR_SUB_LNK EY			
			, BKG_EDI_SUB_LNK_MSG MSG
     WHERE EY.TRD_PRNR_SUB_LNK_SEQ = MSG.TRD_PRNR_SUB_LNK_SEQ			
       AND EY.RCVR_TRD_PRNR_ID = @[edi_rcv_id]
       AND EY.PRNR_SUB_LNK_CD = @[edi_ref_cd]
       AND MSG.EDI_MSG_TP_ID = '301'
#if (${msg_cd} == '2')
       AND MSG.EDI_MSG_IND_CD IN ('1','2')	
#else
       AND MSG.EDI_MSG_IND_CD = @[msg_cd]	
#end
       AND EDI_MSG_TP_ID <> 'COPRAR'			
       AND MSG_TP_DESC   = '1'			
       AND rownum        = 1         
#else
    SELECT SNDR_TRD_PRNR_ID HOST_TP_ID
      FROM BKG_EDI_TRD_PRNR_SUB_LNK EY
			, BKG_EDI_SUB_LNK_MSG MSG
     WHERE EY.TRD_PRNR_SUB_LNK_SEQ = MSG.TRD_PRNR_SUB_LNK_SEQ
       AND EY.RCVR_TRD_PRNR_ID = @[rcv_id]
       AND EDI_MSG_TP_ID <> 'COPRAR'
       AND MSG_TP_DESC   = '1'
       AND rownum        = 1
#end
#end			]]></sql>
			<params>
				<param name="rcv_id" type="12" value="TRAPACI " out="N"/>
				<param name="edi_rcv_id" type="12" value="" out="N"/>
				<param name="edi_ref_cd" type="12" value="" out="N"/>
				<param name="msg_cd" type="12" value="" out="N"/>
			</params>
		</query>
	</querys>
</sqls>
