<?xml version="1.0" encoding="UTF-8"?>
<sqls>
	<querys>
		<query name="UsaCustomsTransmissionDBDAOsearchAmsCodeByVvdRSQL">
			<desc><![CDATA[]]></desc>
			<sql><![CDATA[
SELECT CASE
          WHEN @[loc_cd] = 'USNYC' THEN
             (NVL((SELECT ATTR_CTNT2
                     FROM BKG_CSTMS_CD_CONV_CTNT
                    WHERE CNT_CD = 'US'
                      AND CSTMS_DIV_ID = 'AMS_TML_CD_MAP'
                      AND ATTR_CTNT1 = (SELECT V.POD_YD_CD
                                               FROM BKG_VVD V
                                        #if (${bl_no} != '')
                                                    ,BKG_BOOKING B
                                        #end
                                              WHERE V.VSL_CD = SUBSTR(@[vvd], 1, 4)
                                                AND V.SKD_VOY_NO = SUBSTR(@[vvd], 5, 4)
                                                AND V.SKD_DIR_CD = SUBSTR(@[vvd], 9, 1)
                                        #if (${bl_no} != '')
                                                AND B.BL_NO = @[bl_no]
                                                AND V.BKG_NO = B.BKG_NO
                                        #end
                                                AND V.POD_CD = @[loc_cd]
                                                AND ROWNUM = 1)), (SELECT LOC_AMS_PORT_CD
                                                                     FROM MDM_LOCATION
                                                                    WHERE LOC_CD = @[loc_cd])))
          ELSE
             (SELECT LOC_AMS_PORT_CD
                FROM MDM_LOCATION
               WHERE LOC_CD = @[loc_cd])
       END
  FROM DUAL			]]></sql>
			<params>
				<param name="loc_cd" type="12" value="" out="N"/>
				<param name="vvd" type="12" value="" out="N"/>
				<param name="bl_no" type="12" value="" out="N"/>
			</params>
		</query>
	</querys>
</sqls>
