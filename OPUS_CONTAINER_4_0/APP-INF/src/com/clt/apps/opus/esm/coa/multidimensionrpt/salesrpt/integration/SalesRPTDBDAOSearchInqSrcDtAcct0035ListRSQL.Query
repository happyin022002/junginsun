<?xml version="1.0" encoding="UTF-8"?>
<sqls>
	<querys>
		<query name="SalesRPTDBDAOSearchInqSrcDtAcct0035ListRSQL">
			<desc><![CDATA[Inquiry by Source Data
@SJH.20140814 : COA_BKG_EXPN_DTL_WK 삭제
@SJH.20141023 : SLT_INTER_PRC_AMT 추가
@SJH.20141215 : GROUP BY 정리 및 필드 그룹함수 추가]]></desc>
			<sql><![CDATA[
#if(${f_excel} =='Y')
  SELECT   'R.MONTH'  COST_YRMON
    , 'S.MONTH' SLS_YRMON
    , 'WEEK'  COST_WK
    , 'BKG NO'  BKG_NO
    , '1ST SAILING DATE' N1ST_SAIL_DT				--SJH.20141217.ADD
    , 'BL NO'  			BL_NO
    , 'BL TYPE' 		BL_NO_TP					--SJH.20141217.ADD : BL_NO_TP, CNTR_TPSZ_CD, SVC_SCP_CD, SUB_TRD_CD
    , 'TYPE/SIZE'		CNTR_TPSZ_CD
    , 'SERVICE SCOPE'	SVC_SCP_CD
    , 'TRADE'  TRD_CD
    , 'SUB TRADE'		SUB_TRD_CD
    , 'R.LANE'  RLANE_CD
    , 'IOC'  IOC_CD
    , 'REV VVD'  R_VVD 
    , 'DIR'  DIR_CD
    , 'C.RHQ'  C_RHQ
    , 'C.AD'  C_AD
    , 'C.OFC'  C_OFC
    , 'C.S.REP'  CSREP_CD
    , 'L.RHQ'  L_RHQ
    , 'L.AD'  L_AD
    , 'L.OFC'  L_OFC
    , 'L.REP'  LREP_CD
    , 'BKG OFC'  BKG_OFC_CD
    , 'BKG STS'  BKG_STS_CD
    , 'USA MODE'  USA_MODE
    , 'POR'  BKG_POR_CD
    , '1ST POL'  BKG_POL_CD							--SJH.20141217.MOD
    , 'LAST POD'  BKG_POD_CD
    , 'DEL'  BKG_DEL_CD
    , 'RCV TERM'  BKG_RCV_TERM_CD
    , 'DEL TERM'  BKG_DE_TERM_CD
    , 'REP CMDT CD'  REP_CMDT_CD
    , 'REP CMDT DESC'  REP_CMDT_NM
    , 'CMDT CD'  CMDT_CD
    , 'CMDT DESC'  CMDT_NM
    , 'TRADE1'  N1ST_TRD_CD
    , 'TRADE2'  N2ND_TRD_CD
    , 'TRADE3'  N3RD_TRD_CD
    , 'TRADE4'  N4TH_TRD_CD
    , 'LANE1'  N1ST_RLANE_CD
    , 'LANE2'  N2ND_RLANE_CD
    , 'LANE3'  N3RD_RLANE_CD
    , 'LANE4'  N4TH_RLANE_CD
    , 'VVD1'  N1ST_FINC_VVD_CD
    , 'VVD2'  N2ND_FINC_VVD_CD
    , 'VVD3'  N3RD_FINC_VVD_CD
    , 'VVD4'  N4TH_FINC_VVD_CD
    , 'POL1'  N1ST_POL_CD
    , 'POL2'  N2ND_POL_CD
    , 'POL3'  N3RD_POL_CD
    , 'POL4'  N4TH_POL_CD
    , 'POD1'  N1ST_POD_CD
    , 'POD2'  N2ND_POD_CD
    , 'POD3'  N3RD_POD_CD
    , 'POD4'  N4TH_POD_CD
    , 'TRUNK POL'			REV_POL_CD				--SJH.20141217.ADD
	, 'TRUNK POD'			REV_POD_CD
	, 'LAST VVD'			LAST_VVD
	, 'LAST TRADE'			LAST_TRADE
	, 'LAST LANE'			LAST_LANE
	, 'EMPTY PICK UP'		MTY_PKUP_YD_CD
	, 'EMPTY RETURN'		MTY_RTN_YD_CD
    , 'SC NO'  SC_NO
    , 'RFA NO'  RFA_NO
    , 'TAA NO'				TAA_NO					--SJH.20141217.ADD
    , 'NVOCC'  NVOCC
    , 'SC/RFA CUST TP'  CUST_TP						--SJH.20141217.MOD
    , 'SC/RFC CUST CD'  SC_CUST_CD
    , 'SC/RFC CUST NM'  SC_CUST_NM
    , 'SC/RFA GROUP CUST NM'					CUST_GRP_NM				--SJH.20141218.ADD
    , 'SC/RFA CUST NEED BASE SEG. CLASS 1'		NBS_CLSS_CD1
	, 'SC/RFA CUST NEED BASE SEG. CLASS 2'		NBS_CLSS_CD2
	, 'SC/RFA CUST NEED BASE SEG. CLASS 3'		NBS_CLSS_CD3
	, 'SC/RFA CUST KEY ACCOUNT FLAG'			CUST_KEY_AGMT_MGR_FLG
    , 'BKG SHPR_CD'  SHPR_CD
    , 'BKG SHPR_NM'  SHPR_NM
	, 'B/L SHPR TP'  BL_SHPR_TP
    , 'B/L SHPR NM'  BL_SHPR_NM
    , 'CNEE CD'  CNEE_CD
    , 'CNEE NM'  CNEE_NM
    , 'NOTIFY CD'  NTFY_CD
    , 'NOTIFY NM'  NTFY_NM
    , 'PRD CCT'  PPD_CCT
    , 'BL ON BOARD DT'  BL_ONBOARD_DT
    , 'CGO RCV DT'  CGO_RCV_DT
    , 'SOC'  SOC
    , 'REV MT'  REV_MT    
    , 'DG'  DG
    , 'RF'  RF		--SJH.20141111.ADD, SJH.20141217.MOD
    , 'BB'  BB
    , 'AK'  AK
    , 'AUTO RATING DATE'	AUTO_RAT_DT				--SJH.2014121.ADD
    , 'CARGO WEIGHT'  		WEIGHT
    , 'TARE WEIGHT'			TARE_WEIGHT
    , 'CARGO WEGHT UNIT' 	UNIT
    , 'TARE WEIGHT UNIT'	TARE_WEIGHT_UNIT
    , 'QUANTITY'			QUANTITY
    , 'TEU'					TEU
    , 'FR_REV'				FR_REV
     
  --#foreach($key in ${allcols}) 
  --  ,'FR_$key' REV_$key
  --#end 
  
  --,'FR_REV_TTL' TOT_FR_REV_TPSZ
    ,'MISC_REV_TTL' TOT_MISC_REV_TPSZ
    ,'REV_TTL' TOT_REV_TPSZ
  --#foreach($key in ${allcols}) 
  --  ,'LOAD_$key' QTY_$key
  --#end  
  
  --,'LOAD_TTL(TEU)' TOT_QTY
  --,'Freight Revenue' FREIGTH_REV
  --,'Misc Operation Revenue' MISC_REV
			
  #if(${f_pro_lvl} =='O')      
    ,'CNTR DEM/DET' DMDT_COST
	#end		
    --SJH.20141217.ADD
    ,'OB BASIC STEVEDORAGE' 			OB_BASIC_STEVEDORAGE
    ,'IB BASIC STEVEDORAGE' 			IB_BASIC_STEVEDORAGE
    ,'OB ON DOCK CY EXPENSE' 			OB_DCK_CY_HNDL_COM_AMT
    ,'OB CARGO HANDLING EXPENSE' 		OB_CGO_HNDL_COM_AMT
    ,'OB STORAGE' 						OB_FCNTR_STO_COM_AMT
    ,'OB MISC CARGO HANDLING EXPENSE' 	OB_MISC_CGO_HNDL_COM_AMT
    ,'IB ON DOCK CY EXPENSE' 			IB_DCK_CY_HNDL_COM_AMT
    ,'IB CARGO HANDLING EXPENSE' 		IB_CGO_HNDL_COM_AMT
    ,'IB STORAGE' 						IB_FCNTR_STO_COM_AMT
    ,'IB MISC CARGO HANDLING EXPENSE' 	IB_MISC_CGO_HNDL_COM_AMT

    ,'TS STEVEDORAGE' 					TS_STVG_COM_AMT
	,'TS OTHER CY EXPENSE' 				TS_OTHER_CY_EXPENSE
	,'TS ON DOCK CY EXPENSE' 			TS_DCK_CY_HNDL_COM_AMT
	,'TS CARGO HANDLING EXPENSE' 		TS_CGO_HNDL_COM_AMT
	,'TS STORAGE' 						TS_FCNTR_STO_COM_AMT
    ,'CARGO VARIABLE VOLUME DISCOUNT' 	CGO_VAR_VOL_DC_AMT

	,'OB RAIL TRUCK' 					OB_FULL_RAIL_TRK_COM_AMT
    ,'OB RAIL DIRECT' 					OB_FULL_RAIL_DIR_COM_AMT
    ,'OB TRUCK DIRECT' 					OB_FULL_TRK_DIR_COM_AMT
    ,'OB WATER DIRECT' 					OB_FULL_WTR_DIR_COM_AMT
    ,'OB WATER RAIL' 					OB_FULL_WTR_RAIL_COM_AMT
    ,'OB WATER TRUCK' 					OB_FULL_WTR_TRK_COM_AMT
    ,'OB OTHER TRANSPORT EXPENSE' 		OB_FULL_TRSP_OTR_AMT

	,'IB RAIL TRUCK' 					IB_FULL_RAIL_TRK_COM_AMT
    ,'IB RAIL DIRECT' 					IB_FULL_RAIL_DIR_COM_AMT
    ,'IB TRUCK DIRECT' 					IB_FULL_TRK_DIR_COM_AMT
    ,'IB WATER DIRECT' 					IB_FULL_WTR_DIR_COM_AMT
    ,'IB WATER RAIL' 					IB_FULL_WTR_RAIL_COM_AMT
    ,'IB WATER TRUCK' 					IB_FULL_WTR_TRK_COM_AMT
    ,'IB OTHER TRANSPORT EXPENSE' 		IB_FULL_TRSP_OTR_AMT

	,'TS FULL TRANSPORT EXPENSE' 		TS_FULL_TRSP_COM_AMT
	,'TS OTHER TRANSPORT EXPENSE' 		TS_FULL_TRSP_OTR_AMT
	,'OB EMPTY REPOSITIONING COST A' 	OB_MTY_PA_AMT
	,'IB EMPTY REPOSITIONING COST A' 	IB_MTY_PA_AMT
	,'OB EMPTY REPOSITIONING COST B' 	OB_MTY_PA_AMT2
	,'IB EMPTY REPOSITIONING COST B' 	IB_MTY_PA_AMT2

	,'OB AGENCY COMMISSION' 			OB_AC_COM_AMT
	,'IB AGENCY COMMSISION' 			IB_AC_COM_AMT
	,'T/S AGENCY COMMISSION' 			TS_AC_COM_AMT
	,'FAC A/C' 							AC_FAC_AMT
	,'CHF COMMISSION' 					AC_CHF_AMT
	,'OTHER COMMISSION' 				AC_OTR_AMT
    
  --#if (${f_pro_vw} =='P')
  --  ,'Empty Reposition Expense(EPP A)' EMPTY_REPOSITION_EXPENSE_A	--SJH.20141111.MOD
  --  ,'Empty Reposition Expense(EPP B)' EMPTY_REPOSITION_EXPENSE_B	--SJH.20141111.MOD
  --#end
			
  --,'Agent Commission' AGENT_COMMISSION
    ,'SLOT INTERNAL PRICING' SLT_INTER_PRC_AMT

	,'MNR COST' 						CNTR_MNR_CHG_PA_AMT
	,'REEFER COST' 						RF_COM_AMT
	,'CHASSIS COST'						CHSS_FX_AMT

  #if(${f_pro_vw} =='P')
    ,'Variable Cost Total A' CM_COST_TOTAL_A		--SJH.20141111.MOD.ADD, SJH.20141217.MOD
    ,'CM Total A' CM_A
    ,'Variable Cost Total B' CM_COST_TOTAL_B
    ,'CM Total B' CM_B
  #end
  	
  #if(${f_pro_lvl} =='O' && ${f_pro_vw} =='P' )			
    ,'CNTR Long Term EQ Rental' CNTR_LONG_TERM_EQ_RENTAL
    ,'CNTR Short Term EQ Rental' CNTR_SHORT_TERM_EQ_RENTAL
    ,'CNTR M&R Charge' CNTR_MR_CHARGE
    ,'CNTR Depreciation' CNTR_DEPRECIATION
    ,'CNTR Insurance' CNTR_INSURANCE
    ,'Chassis Short Term EQ Rental' CHASSIS_SHORT_TERM_EG_RENTAL
    ,'Chassis Long Term EQ Rental' CHASSIS_LONG_TERM_EQ_RENTAL
    ,'Chassis M&R Charge' SHASSIS_MR_CHARGE
    ,'Chassis Depreciation' CHASSIS_DEPRECIATION
    ,'Chassis Drayage' CHASSIS_DRAYAGE
    ,'Chassis Insurance' CHASSIS_INSURANCE    
  #end				
  FROM DUAL 
  UNION ALL 
#end
				
SELECT  
   A2.COST_YRMON  
  ,A2.SLS_YRMON  
  ,A2.COST_WK 
  ,A2.BKG_NO              									AS BKG_NO  
  ,TO_CHAR(MAX(A6.N1ST_SAIL_DT),'YYYY-MM-DD HH24:MI:SS')   	AS N1ST_SAIL_DT		--SJH.20141215.ADD  
  ,MAX(A2.BL_NO || A2.BL_NO_TP || A2.BL_NO_CHK) 			AS BL_NO  
  ,MAX(A2.BL_NO_TP)											AS BL_NO_TP			--SJH.20141215.ADD
  ,MAX(A2.CNTR_TPSZ_CD)      								AS CNTR_TPSZ_CD	
  ,MAX(A6.SVC_SCP_CD)										AS SVC_SCP_CD
  ,MAX(A2.TRD_CD)  									AS TRD_CD
  ,MAX(A2.SUB_TRD_CD)								AS SUB_TRD_CD				--SJH.20141215.ADD
  ,MAX(A2.RLANE_CD)                               	AS RLANE_CD
  ,MAX(A2.IOC_CD)                                 	AS IOC_CD 
  ,MAX(A2.VSL_CD || A2.SKD_VOY_NO || A2.DIR_CD)  	AS R_VVD  
  ,MAX(A2.DIR_CD)  									AS DIR_CD
  ,MAX(A2.CTRT_HQ_OFC_CD)                        	AS C_RHQ 
  ,MAX(A2.CTRT_RGN_OFC_CD)                       	AS C_AD 
  ,MAX(A2.CTRT_OFC_CD)                           	AS C_OFC 
  ,MAX(A2.CTRT_SREP_CD)                          	AS CSREP_CD 
  ,MAX(A2.RHQ_CD)                                	AS L_RHQ 
  ,MAX(A2.RGN_OFC_CD)                            	AS L_AD 
  ,MAX(A2.SLS_OFC_CD)                            	AS L_OFC 
  ,MAX(A2.SREP_CD)                               	AS LREP_CD  
  ,MAX(A2.BKG_OFC_CD)                            	AS BKG_OFC_CD
  ,MAX(A2.BKG_STS_CD)                            	AS BKG_STS_CD
  ,MAX(A2.USA_BKG_MOD_CD)                        	AS USA_MODE 
  ,MAX(A2.BKG_POR_CD)                            	AS BKG_POR_CD
  ,MAX(A2.BKG_POL_CD)                            	AS BKG_POL_CD
  ,MAX(A2.BKG_POD_CD)                            	AS BKG_POD_CD
  ,MAX(A2.BKG_DEL_CD)                            	AS BKG_DEL_CD
  ,MAX(A2.BKG_RCV_TERM_CD)                       	AS BKG_RCV_TERM_CD
  ,MAX(A2.BKG_DE_TERM_CD)                        	AS BKG_DE_TERM_CD
  ,MAX(A2.REP_CMDT_CD)                           	AS REP_CMDT_CD
  ,MAX(A5.REP_CMDT_NM)                           	AS REP_CMDT_NM
  ,MAX(A2.CMDT_CD)                               	AS CMDT_CD
  ,MAX(A3.CMDT_NM)                               	AS CMDT_NM
  ,MAX(A2.N1ST_TRD_CD)                           	AS N1ST_TRD_CD
  ,MAX(A2.N2ND_TRD_CD)                           	AS N2ND_TRD_CD
  ,MAX(A2.N3RD_TRD_CD)                           	AS N3RD_TRD_CD
  ,MAX(A2.N4TH_TRD_CD)                           	AS N4TH_TRD_CD
  ,MAX(A2.N1ST_RLANE_CD)                         	AS N1ST_RLANE_CD
  ,MAX(A2.N2ND_RLANE_CD)                         	AS N2ND_RLANE_CD
  ,MAX(A2.N3RD_RLANE_CD)                         	AS N3RD_RLANE_CD
  ,MAX(A2.N4TH_RLANE_CD)                         	AS N4TH_RLANE_CD
  ,MAX(A2.N1ST_FINC_VVD_CD)                      	AS N1ST_FINC_VVD_CD
  ,MAX(A2.N2ND_FINC_VVD_CD)                      	AS N2ND_FINC_VVD_CD
  ,MAX(A2.N3RD_FINC_VVD_CD)                      	AS N3RD_FINC_VVD_CD
  ,MAX(A2.N4TH_FINC_VVD_CD)                      	AS N4TH_FINC_VVD_CD
  ,MAX(A2.N1ST_POL_CD)                           	AS N1ST_POL_CD
  ,MAX(A2.N2ND_POL_CD)                           	AS N2ND_POL_CD
  ,MAX(A2.N3RD_POL_CD)                           	AS N3RD_POL_CD
  ,MAX(A2.N4TH_POL_CD)                           	AS N4TH_POL_CD
  ,MAX(A2.N1ST_POD_CD)                           	AS N1ST_POD_CD
  ,MAX(A2.N2ND_POD_CD)                           	AS N2ND_POD_CD
  ,MAX(A2.N3RD_POD_CD)                           	AS N3RD_POD_CD
  ,MAX(A2.N4TH_POD_CD)                           	AS N4TH_POD_CD
  ,MAX(A6.REV_POL_CD)								AS REV_POL_CD				--SJH.20141215.ADD
  ,MAX(A6.REV_POD_CD)								AS REV_POD_CD				--SJH.20141215.ADD
  ,MAX(COALESCE(A2.N4TH_FINC_VVD_CD,A2.N3RD_FINC_VVD_CD,A2.N2ND_FINC_VVD_CD,A2.N1ST_FINC_VVD_CD)) 	AS LAST_VVD		--SJH.20141215.ADD
  ,MAX(COALESCE(A2.N4TH_TRD_CD,A2.N3RD_TRD_CD,A2.N2ND_TRD_CD,A2.N1ST_TRD_CD)) 			 		 	AS LAST_TRADE	--SJH.20141215.ADD
  ,MAX(COALESCE(A2.N4TH_RLANE_CD,A2.N3RD_RLANE_CD,A2.N2ND_RLANE_CD,A2.N1ST_RLANE_CD)) 			 	AS LAST_LANE	--SJH.20141215.ADD
  ,MAX(A6.MTY_PKUP_YD_CD)							AS MTY_PKUP_YD_CD			--SJH.20141215.ADD
  ,MAX(A6.MTY_RTN_YD_CD)							AS MTY_RTN_YD_CD			--SJH.20141215.ADD
  ,MAX(A2.SC_NO)  									AS SC_NO
  ,MAX(A2.RFA_NO)  									AS RFA_NO
  ,MAX(A2.TAA_NO)									AS TAA_NO					--SJH.20141215.ADD				
  ,MAX(DECODE(A2.CUST_TP_CD,'N','Y','N'))                               AS NVOCC 
  ,MAX(A2.AGMT_CUST_TP_CD)                          AS CUST_TP  
  ,MAX(A2.AGMT_CNT_CD || TO_CHAR(LPAD(DECODE(A2.AGMT_CUST_SEQ,0,'',A2.AGMT_CUST_SEQ),6,'0')))  		AS SC_CUST_CD  
  ,MAX((   
    SELECT CUST_LGL_ENG_NM   
      FROM MDM_CUSTOMER B1   
     WHERE A2.AGMT_CNT_CD   = B1.CUST_CNT_CD(+)   
       AND A2.AGMT_CUST_SEQ = B1.CUST_SEQ(+)   
  )) AS SC_CUST_NM   
  ,MAX(A8.CUST_GRP_NM)								AS CUST_GRP_NM				--SJH.20141218.ADD
  ,MAX(A8.NBS_CLSS_CD1)								AS NBS_CLSS_CD1 
  ,MAX(A8.NBS_CLSS_CD2)								AS NBS_CLSS_CD2 
  ,MAX(A8.NBS_CLSS_CD3)								AS NBS_CLSS_CD3
  ,MAX(A2.CUST_KEY_AGMT_MGR_FLG)					AS CUST_KEY_AGMT_MGR_FLG
  ,MAX(A2.SHPR_CNT_CD || TO_CHAR(LPAD(DECODE(A2.SHPR_CUST_SEQ,0,'',A2.SHPR_CUST_SEQ),6,'0')))  		AS SHPR_CD   
  ,MAX((   
    SELECT CUST_LGL_ENG_NM   
      FROM MDM_CUSTOMER B1   
     WHERE A2.SHPR_CNT_CD   = B1.CUST_CNT_CD(+)   
       AND A2.SHPR_CUST_SEQ = B1.CUST_SEQ(+)   
  )) AS SHPR_NM
  ,MAX(A2.CUST_TP_CD)								AS BL_SHPR_TP
  ,MAX(A2.SHPR_NM)                                  AS BL_SHPR_NM  
  ,MAX(A2.CNEE_CNT_CD || TO_CHAR(LPAD(DECODE(A2.CNEE_CUST_SEQ,0,'',A2.CNEE_CUST_SEQ),6,'0'))) 		AS CNEE_CD  
  ,MAX((   
    SELECT CUST_LGL_ENG_NM   
      FROM MDM_CUSTOMER B1   
     WHERE A2.CNEE_CNT_CD   = B1.CUST_CNT_CD(+)   
       AND A2.CNEE_CUST_SEQ = B1.CUST_SEQ(+)   
  )) AS CNEE_NM  /*CNEE   */
  ,MAX(A2.NTFY_CNT_CD || TO_CHAR(LPAD(DECODE(A2.NTFY_CUST_SEQ,0,'',A2.NTFY_CUST_SEQ),6,'0')))	 	AS NTFY_CD 
  ,MAX((   
    SELECT CUST_LGL_ENG_NM   
      FROM MDM_CUSTOMER B1   
     WHERE A2.NTFY_CNT_CD   = B1.CUST_CNT_CD(+)   
       AND A2.NTFY_CUST_SEQ = B1.CUST_SEQ(+)   
  )) AS NTFY_NM   /*NTFY*/   
  ,MAX(A2.OFT_TP_CD)                                AS PPD_CCT 
  ,MAX(TO_CHAR(A2.OBRD_DT,'YYYY-MM-DD'))            AS BL_ONBOARD_DT  
  ,MAX(TO_CHAR(A2.CNTR_RCV_DT,'YYYY-MM-DD'))        AS CGO_RCV_DT  
  ,MAX(A2.SOC_FLG)                                  AS SOC 
  ,DECODE(MAX(A2.BKG_CGO_TP_CD), 'R', 'Y', 'N')     AS REV_MT   
  ,NVL(MAX(A2.SPCL_DG_CGO_FLG), 'N')                AS DG 						--SJH.20141215.MOD : DB, RC, BB, AK : A2.->A6.
  ,NVL(MAX(A2.SPCL_RC_FLG), 'N')                    AS RF 						--SJH.20141111.ADD
  ,NVL(MAX(A2.SPCL_BB_CGO_FLG), 'N')                AS BB  
  ,NVL(MAX(A2.SPCL_AWK_CGO_FLG), 'N')               AS AK 
  ,MAX(A2.AUTO_RAT_DT)								AS AUTO_RAT_DT				--SJH.20141215.ADD
  ,TO_CHAR(MAX(A2.BKG_CGO_WGT))                     AS WEIGHT 
  ,TO_CHAR(MAX(NVL(A7.CNTR_TPSZ_TARE_WGT,0)*NVL(A2.BKG_QTY,0)))	AS TARE_WEIGHT	--SJH.20141215.ADD 
  ,MAX(A2.BKG_WGT_TP_CD)                            AS UNIT 
  ,'KGS'                                             AS TARE_WEIGHT_UNIT 		--SJH.20141215.ADD
  ,TO_CHAR(SUM(NVL(A2.BKG_QTY,0)))                  AS QUANTITY 				--SJH.20141215.ADD
  ,TO_CHAR(SUM(DECODE(SUBSTR(A2.SPCL_CNTR_TPSZ_CD,-1),'2',A2.BKG_QTY,A2.BKG_QTY*2)))	AS TEU 						--SJH.20141215.ADD
  ,TO_CHAR(SUM(NVL(A2.BKG_REV,0)+NVL(A2.BKG_OFT_REV,0)))   AS FR_REV			--SJH.20141215.ADD
			
  --#foreach($key in ${allcols}) 
  --  ,TO_CHAR(SUM(DECODE(A2.SPCL_CNTR_TPSZ_CD, '$key',  A2.BKG_REV+A2.BKG_OFT_REV)))      AS REV_$key				--SJH.20141215.DEL
  --#end
  
  --,TO_CHAR(SUM(A2.BKG_REV+A2.BKG_OFT_REV))                                   AS TOT_FR_REV_TPSZ 			 		--SJH.20141215.DEL
  ,TO_CHAR(SUM(A2.BKG_MISC_REV+A2.SCR_CHG_REV))                              AS TOT_MISC_REV_TPSZ 
  ,TO_CHAR(SUM(A2.BKG_REV+A2.BKG_OFT_REV+A2.BKG_MISC_REV+A2.SCR_CHG_REV))    AS TOT_REV_TPSZ 
		
  --#foreach($key in ${allcols}) 
  --  ,TO_CHAR(SUM(DECODE(A2.SPCL_CNTR_TPSZ_CD, '$key',  A2.BKG_QTY)))                     AS QTY_$key
  --#end
  
  --,TO_CHAR(SUM(DECODE(SUBSTR(A2.SPCL_CNTR_TPSZ_CD,-1),'2',A2.BKG_QTY,A2.BKG_QTY*2))) AS TOT_QTY 
  --,TO_CHAR(SUM(A2.BKG_REV+A2.BKG_OFT_REV))                                   AS FREIGTH_REV 
  --,TO_CHAR(SUM(A2.BKG_MISC_REV+A2.SCR_CHG_REV))                              AS MISC_REV 
		
  #if(${f_pro_lvl} =='O')
    ,TO_CHAR(SUM(A2.DMDT_COM_AMT))                                             AS DMDT_COST 
  #end

  ,TO_CHAR(SUM(A2.OB_BZC_STVG_COM_AMT))            	AS OB_BASIC_STEVEDORAGE 
  ,TO_CHAR(SUM(A2.IB_BZC_STVG_COM_AMT))            	AS IB_BASIC_STEVEDORAGE 

  --SJH.20141217.ADD
  ,TO_CHAR(SUM(A2.OB_DCK_CY_HNDL_COM_AMT))      	AS OB_DCK_CY_HNDL_COM_AMT
  ,TO_CHAR(SUM(A2.OB_CGO_HNDL_COM_AMT))            	AS OB_CGO_HNDL_COM_AMT
  ,TO_CHAR(SUM(A2.OB_FCNTR_STO_COM_AMT))          	AS OB_FCNTR_STO_COM_AMT 
  ,TO_CHAR(SUM(A2.OB_MISC_CGO_HNDL_COM_AMT))  		AS OB_MISC_CGO_HNDL_COM_AMT
  ,TO_CHAR(SUM(A2.IB_DCK_CY_HNDL_COM_AMT))      	AS IB_DCK_CY_HNDL_COM_AMT
  ,TO_CHAR(SUM(A2.IB_CGO_HNDL_COM_AMT))            	AS IB_CGO_HNDL_COM_AMT
  ,TO_CHAR(SUM(A2.IB_FCNTR_STO_COM_AMT))          	AS IB_FCNTR_STO_COM_AMT 
  ,TO_CHAR(SUM(A2.IB_MISC_CGO_HNDL_COM_AMT))  		AS IB_MISC_CGO_HNDL_COM_AMT

  ,TO_CHAR(SUM(A2.TS_STVG_COM_AMT))          	    AS TS_STVG_COM_AMT
  ,TO_CHAR(SUM(A2.OTR_CY_HNDL_COM_AMT))          	AS TS_OTHER_CY_EXPENSE
  ,TO_CHAR(SUM(A2.TS_DCK_CY_HNDL_COM_AMT))         	AS TS_DCK_CY_HNDL_COM_AMT
  ,TO_CHAR(SUM(A2.TS_CGO_HNDL_COM_AMT))          	AS TS_CGO_HNDL_COM_AMT
  ,TO_CHAR(SUM(A2.TS_FCNTR_STO_COM_AMT))          	AS TS_FCNTR_STO_COM_AMT

  ,TO_CHAR(SUM(A2.CGO_VAR_VOL_DC_AMT))          	AS CGO_VAR_VOL_DC_AMT

  ,TO_CHAR(SUM(A2.OB_FULL_RAIL_TRK_COM_AMT))       	AS OB_FULL_RAIL_TRK_COM_AMT
  ,TO_CHAR(SUM(A2.OB_FULL_RAIL_DIR_COM_AMT))       	AS OB_FULL_RAIL_DIR_COM_AMT
  ,TO_CHAR(SUM(A2.OB_FULL_TRK_DIR_COM_AMT))         AS OB_FULL_TRK_DIR_COM_AMT
  ,TO_CHAR(SUM(A2.OB_FULL_WTR_DIR_COM_AMT))         AS OB_FULL_WTR_DIR_COM_AMT
  ,TO_CHAR(SUM(A2.OB_FULL_WTR_RAIL_COM_AMT))        AS OB_FULL_WTR_RAIL_COM_AMT
  ,TO_CHAR(SUM(A2.OB_FULL_WTR_TRK_COM_AMT ))        AS OB_FULL_WTR_TRK_COM_AMT 
  ,TO_CHAR(SUM(A2.OB_FULL_TRSP_OTR_AMT))          	AS OB_FULL_TRSP_OTR_AMT

  ,TO_CHAR(SUM(A2.IB_FULL_RAIL_TRK_COM_AMT))       	AS IB_FULL_RAIL_TRK_COM_AMT
  ,TO_CHAR(SUM(A2.IB_FULL_RAIL_DIR_COM_AMT))       	AS IB_FULL_RAIL_DIR_COM_AMT
  ,TO_CHAR(SUM(A2.IB_FULL_TRK_DIR_COM_AMT))         AS IB_FULL_TRK_DIR_COM_AMT
  ,TO_CHAR(SUM(A2.IB_FULL_WTR_DIR_COM_AMT))         AS IB_FULL_WTR_DIR_COM_AMT
  ,TO_CHAR(SUM(A2.IB_FULL_WTR_RAIL_COM_AMT))        AS IB_FULL_WTR_RAIL_COM_AMT
  ,TO_CHAR(SUM(A2.IB_FULL_WTR_TRK_COM_AMT ))        AS IB_FULL_WTR_TRK_COM_AMT 
  ,TO_CHAR(SUM(A2.IB_FULL_TRSP_OTR_AMT))          	AS IB_FULL_TRSP_OTR_AMT

  ,TO_CHAR(SUM(A2.TS_FULL_TRSP_COM_AMT))          	AS TS_FULL_TRSP_COM_AMT
  ,TO_CHAR(SUM(A2.TS_FULL_TRSP_OTR_AMT))          	AS TS_FULL_TRSP_OTR_AMT
  ,TO_CHAR(SUM(A2.OB_MTY_PA_AMT))          			AS OB_MTY_PA_AMT
  ,TO_CHAR(SUM(A2.IB_MTY_PA_AMT))          			AS IB_MTY_PA_AMT
  ,TO_CHAR(SUM(A2.OB_MTY_PA_AMT2))          		AS OB_MTY_PA_AMT2
  ,TO_CHAR(SUM(A2.IB_MTY_PA_AMT2))          		AS IB_MTY_PA_AMT2

  ,TO_CHAR(SUM(A2.OB_AC_COM_AMT))          			AS OB_AC_COM_AMT
  ,TO_CHAR(SUM(A2.IB_AC_COM_AMT))          			AS IB_AC_COM_AMT
  ,TO_CHAR(SUM(A2.TS_AC_COM_AMT))          			AS TS_AC_COM_AMT
  ,TO_CHAR(SUM(A2.AC_FAC_AMT))          			AS AC_FAC_AMT
  ,TO_CHAR(SUM(A2.AC_CHF_AMT))          			AS AC_CHF_AMT
  ,TO_CHAR(SUM(A2.AC_OTR_AMT))          			AS AC_OTR_AMT

  --,TO_CHAR(SUM(A2.TML_COM_AMT))                     AS EXCLUSIVE_TERMINAL_ADD_COST 
  --,TO_CHAR(SUM(A2.CGO_VAR_VOL_DC_AMT))        		AS CARGO_VARIABLE_VOLUME_DISCOUNT 
  --,TO_CHAR(SUM(A2.FULL_RAIL_DIR_COM_AMT))  			AS RAIL_DIRECT 
  --,TO_CHAR(SUM(A2.FULL_RAIL_TRK_COM_AMT))  			AS RAIL_TRUCK 
  --,TO_CHAR(SUM(A2.FULL_TRK_DIR_COM_AMT))    		AS TRUCK_DIRCET 
  --,TO_CHAR(SUM(A2.FULL_WTR_DIR_COM_AMT))    		AS WATER_DIRECT 
  --,TO_CHAR(SUM(A2.FULL_WTR_RAIL_COM_AMT))  			AS WATER_RAIL 
  --,TO_CHAR(SUM(A2.FULL_WTR_TRK_COM_AMT))    		AS WATER_TRUCK 
  --,TO_CHAR(SUM(A2.FULL_TRSP_COM_AMT))          		AS OTHER_TRANSPORT_EXPENSE 
		
  --#if (${f_pro_vw} =='P')
  --  ,TO_CHAR(SUM(A2.MTY_STVG_PA_AMT))              	AS EMPTY_REPOSITION_EXPENSE_A	--SJH.20141111.MOD
  --  ,TO_CHAR(SUM(A2.MTY_TRSP_PA_AMT2))             	AS EMPTY_REPOSITION_EXPENSE_B	--SJH.20141111.MOD
  --#end
		
  --,TO_CHAR(SUM(A2.AC_COM_AMT))                      AS AGENT_COMMISSION 
  ,TO_CHAR(SUM(A2.SLT_INTER_PRC_AMT))               AS SLT_INTER_PRC_AMT
  --SJH.20141217.ADD 
  ,TO_CHAR(SUM(A2.CNTR_MNR_CHG_PA_AMT))             AS CNTR_MNR_CHG_PA_AMT
  ,TO_CHAR(SUM(A2.RF_COM_AMT))              		AS RF_COM_AMT
  ,TO_CHAR(SUM(A2.CHSS_FX_AMT))               		AS CHSS_FX_AMT

  --SJH.20141111.MOD, ADD
  ,TO_CHAR(SUM(DECODE(@[f_pro_vw],'P',A2.PA_CM_COST_TTL_AMT,'R',A2.RA_CM_COST_TTL_AMT)))   	AS CM_COST_TOTAL_A 
  ,TO_CHAR(SUM(A2.BKG_REV+A2.BKG_OFT_REV+A2.BKG_MISC_REV+A2.SCR_CHG_REV) 
    - SUM(DECODE(@[f_pro_vw],'P',A2.PA_CM_COST_TTL_AMT,'R',A2.RA_CM_COST_TTL_AMT)))       	AS CM_A 
  ,TO_CHAR(SUM(DECODE(@[f_pro_vw],'P',A2.PA_CM_COST_TTL_AMT2,'R',A2.RA_CM_COST_TTL_AMT)))   AS CM_COST_TOTAL_B 
  ,TO_CHAR(SUM(A2.BKG_REV+A2.BKG_OFT_REV+A2.BKG_MISC_REV+A2.SCR_CHG_REV) 
    - SUM(DECODE(@[f_pro_vw],'P',A2.PA_CM_COST_TTL_AMT2,'R',A2.RA_CM_COST_TTL_AMT)))       	AS CM_B 
	    
  #if(${f_pro_lvl} =='O' && ${f_pro_vw} =='P' )
    ,TO_CHAR(SUM(A2.CNTR_LTERM_PA_AMT))                                        AS CNTR_LONG_TERM_EQ_RENTAL 
    ,TO_CHAR(SUM(A2.CNTR_STERM_PA_AMT))                                        AS CNTR_SHORT_TERM_EQ_RENTAL 
    ,TO_CHAR(SUM(A2.CNTR_MNR_CHG_PA_AMT))                                      AS CNTR_MR_CHARGE 
    ,TO_CHAR(SUM(A2.CNTR_DPC_PA_AMT))                                          AS CNTR_DEPRECIATION 
    ,TO_CHAR(SUM(A2.CNTR_INSUR_PA_AMT))                                        AS CNTR_INSURANCE 
    ,TO_CHAR(SUM(A2.CHSS_STERM_PA_AMT))                                        AS CHASSIS_SHORT_TERM_EG_RENTAL 
    ,TO_CHAR(SUM(A2.CHSS_LTERM_PA_AMT))                                        AS CHASSIS_LONG_TERM_EQ_RENTAL 
    ,TO_CHAR(SUM(A2.CHSS_MNR_CHG_PA_AMT))                                      AS SHASSIS_MR_CHARGE 
    ,TO_CHAR(SUM(A2.CHSS_DPC_PA_AMT))                                          AS CHASSIS_DEPRECIATION 
    ,TO_CHAR(SUM(A2.CHSS_DRYG_PA_AMT))                                         AS CHASSIS_DRAYAGE 
    ,TO_CHAR(SUM(A2.CHSS_INSUR_PA_AMT))                                        AS CHASSIS_INSURANCE 
  #end	
	    
FROM  
   #if(${f_chkprd} =='M')
    COA_BKG_EXPN_DTL A2
   #elseif (${f_chkprd} =='W')
    COA_BKG_EXPN_DTL A2 
   #end
  
  ,COA_OFC_LVL A4 
  ,MDM_COMMODITY A3    
  ,MDM_REP_CMDT A5 
  ,COA_RGST_BKG A6																--SJH.20141215.ADD
  ,MDM_CNTR_TP_SZ A7
  ,(SELECT CUST.CUST_CNT_CD,   													--SJH.20141218.ADD
           CUST.CUST_SEQ, 
           GRP.CUST_GRP_NM,
           CUST.NBS_CLSS_CD1, 
           CUST.NBS_CLSS_CD2, 
           CUST.NBS_CLSS_CD3
      FROM MDM_CUSTOMER CUST,
           MDM_CUST_PERF_GRP GRP
     WHERE CUST.CUST_GRP_ID = GRP.CUST_GRP_ID(+)
	) A8
WHERE 1 = 1

  #if(${f_chkprd} =='M')    
    AND A2.COST_YRMON  = @[f_year]||@[f_mon] 
    AND A2.COST_YRMON  BETWEEN A4.OFC_APLY_FM_YRMON AND A4.OFC_APLY_TO_YRMON
  #elseif (${f_chkprd} =='W')    
	AND SUBSTR(A2.SLS_YRMON,1,4)||A2.COST_WK BETWEEN @[f_year]||@[f_fm_wk] AND @[f_year]||@[f_to_wk]
    
	  
    #if(${f_sls_mon} !='')
    	AND A2.SLS_YRMON = @[f_year]||@[f_sls_mon]    
    #end 
    
    AND A2.SLS_YRMON     BETWEEN A4.OFC_APLY_FM_YRMON AND A4.OFC_APLY_TO_YRMON
  #end

  #if(${f_ofc_vw} =='C')	
	AND A2.AGMT_SGN_OFC_CD = A4.OFC_CD
  #elseif (${f_ofc_vw} =='L')	
	AND A2.SLS_OFC_CD = A4.OFC_CD
  #else
	AND 1 = 0
  #end  
  
  AND A2.CMDT_CD       = A3.CMDT_CD(+)  
  AND A2.REP_CMDT_CD   = A5.REP_CMDT_CD(+) 
  AND NVL(A2.DELT_FLG, 'N') = 'N' 
  AND A2.BKG_STS_CD    IN ('F','S',DECODE(@[f_bkg_sts],'Y', 'W')) 
  AND A2.BKG_CGO_TP_CD <> 'P' 
  AND A2.BL_NO_TP      IN ('M','0') 	 
  AND A2.BKG_NO 	   = A6.BKG_NO 												--SJH.20141215.ADD
  AND A2.SPCL_CNTR_TPSZ_CD = A7.CNTR_TPSZ_CD(+)									--SJH.20141215.ADD
  AND A2.AGMT_CNT_CD   = A8.CUST_CNT_CD(+)   									--SJH.20141218.ADD
  AND A2.AGMT_CUST_SEQ = A8.CUST_SEQ(+)  
		
  #if(${f_ofc_cd} !='')
    #if(${f_excl_sts} =='')
      AND DECODE(@[f_ofc_lvl],'1',A4.OFC_N1ST_LVL_CD,'2',A4.OFC_N2ND_LVL_CD,'3',A4.OFC_N3RD_LVL_CD,'4',A4.OFC_N4TH_LVL_CD,'5',A4.OFC_N5TH_LVL_CD,'6',A4.OFC_N6TH_LVL_CD,'7',A4.OFC_N7TH_LVL_CD) = @[f_ofc_cd] 
    #else
      AND A4.OFC_CD = @[f_ofc_cd] 
    #end
  #end

  #if(${f_ofc_lvl}=='6' || ${f_ofc_lvl}=='7')
    AND A4.OFC_LVL = @[f_ofc_lvl]
  #else
    AND A4.OFC_LVL < '9'
  #end
				
  #if(${f_vsl_cd} !='')
    AND A2.VSL_CD  = @[f_vsl_cd] 
  #end  
  #if(${f_skd_voy_no} !='')
    AND A2.SKD_VOY_NO     = @[f_skd_voy_no] 
  #end
  #if(${f_skd_dir_cd} !='')
    AND A2.DIR_CD         = @[f_skd_dir_cd] 
  #end
  #if(${f_trd_cd} !='')
    AND A2.TRD_CD         = @[f_trd_cd] 
  #end
  #if(${f_rlane_cd} !='')
    AND A2.RLANE_CD       = @[f_rlane_cd] 
  #end
  #if(${f_ioc_cd} !='')
    AND A2.IOC_CD         = @[f_ioc_cd] 
  #end
  #if(${f_dir_cd} !='')
    AND A2.DIR_CD         = @[f_dir_cd] 
  #end
  #if(${f_bkg_por_cd} !='')
    AND A2.BKG_POR_CD     LIKE @[f_bkg_por_cd] || '%' 
  #end
  #if(${f_rev_pol_cd} !='')
    AND A2.REV_POL_CD     LIKE @[f_rev_pol_cd] || '%' 
  #end
  #if(${f_rev_pod_cd} !='')
    AND A2.REV_POD_CD     LIKE @[f_rev_pod_cd] || '%' 
  #end
  #if(${f_bkg_del_cd} !='')
    AND A2.BKG_DEL_CD     LIKE @[f_bkg_del_cd] || '%' 
  #end
  #if(${f_shpr_cd} !='')
    AND A2.SHPR_CNT_CD||A2.SHPR_CUST_SEQ = @[f_shpr_cd] 
  #end
  #if(${f_sc_no} !='')
    AND A2.SC_NO          = @[f_sc_no] 
  #end
  #if(${f_rfa_no} !='')
    AND A2.RFA_NO         = @[f_rfa_no] 
  #end
  #if(${f_taa_no} !='')
    AND A2.TAA_NO         = @[f_taa_no] 
  #end
  #if(${f_rep_cmdt_cd} !='')
    AND A2.REP_CMDT_CD    = @[f_rep_cmdt_cd] 
  #end
  #if(${f_usa_bkg_mod_cd} !='')
    AND A2.USA_BKG_MOD_CD = @[f_usa_bkg_mod_cd] 
  #end	
  --SJH.20141218.ADD
  #if(${f_svc_scp_cd} !='')
    AND A6.SVC_SCP_CD = @[f_svc_scp_cd] 
  #end	
  #if(${f_bkg_pol_cd} !='')
    AND A2.BKG_POL_CD = @[f_bkg_pol_cd] 
  #end	
  #if(${f_bkg_pod_cd} !='')
    AND A2.BKG_POD_CD = @[f_bkg_pod_cd] 
  #end	
  #if(${f_cust_grp_nm} !='')
    AND A8.CUST_GRP_NM LIKE '%'||@[f_cust_grp_nm]||'%'
  #end	
GROUP BY 
   A2.COST_YRMON 
  ,A2.SLS_YRMON  
  ,A2.COST_WK 
  ,A2.BKG_NO 
  ,A2.CNTR_TPSZ_CD			]]></sql>
			<params>
				<param name="f_pro_vw" type="12" value="" out="N"/>
				<param name="f_year" type="12" value="" out="N"/>
				<param name="f_mon" type="12" value="" out="N"/>
				<param name="f_fm_wk" type="12" value="" out="N"/>
				<param name="f_to_wk" type="12" value="" out="N"/>
				<param name="f_sls_mon" type="12" value="" out="N"/>
				<param name="f_bkg_sts" type="12" value="" out="N"/>
				<param name="f_ofc_lvl" type="12" value="" out="N"/>
				<param name="f_ofc_cd" type="12" value="" out="N"/>
				<param name="f_vsl_cd" type="12" value="" out="N"/>
				<param name="f_skd_voy_no" type="12" value="" out="N"/>
				<param name="f_skd_dir_cd" type="12" value="" out="N"/>
				<param name="f_trd_cd" type="12" value="" out="N"/>
				<param name="f_rlane_cd" type="12" value="" out="N"/>
				<param name="f_ioc_cd" type="12" value="" out="N"/>
				<param name="f_dir_cd" type="12" value="" out="N"/>
				<param name="f_bkg_por_cd" type="12" value="" out="N"/>
				<param name="f_rev_pol_cd" type="12" value="" out="N"/>
				<param name="f_rev_pod_cd" type="12" value="" out="N"/>
				<param name="f_bkg_del_cd" type="12" value="" out="N"/>
				<param name="f_shpr_cd" type="12" value="" out="N"/>
				<param name="f_sc_no" type="12" value="" out="N"/>
				<param name="f_rfa_no" type="12" value="" out="N"/>
				<param name="f_taa_no" type="12" value="" out="N"/>
				<param name="f_rep_cmdt_cd" type="12" value="" out="N"/>
				<param name="f_usa_bkg_mod_cd" type="12" value="" out="N"/>
				<param name="f_svc_scp_cd" type="12" value="" out="N"/>
				<param name="f_bkg_pol_cd" type="12" value="" out="N"/>
				<param name="f_bkg_pod_cd" type="12" value="" out="N"/>
				<param name="f_cust_grp_nm" type="12" value="" out="N"/>
			</params>
		</query>
	</querys>
</sqls>
