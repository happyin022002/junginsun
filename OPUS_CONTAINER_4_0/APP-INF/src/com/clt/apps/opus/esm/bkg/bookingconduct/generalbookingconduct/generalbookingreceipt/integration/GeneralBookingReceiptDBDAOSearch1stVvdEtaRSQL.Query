<?xml version="1.0" encoding="UTF-8"?>
<sqls>
	<querys>
		<query name="GeneralBookingReceiptDBDAOSearch1stVvdEtaRSQL">
			<desc><![CDATA[   ]]></desc>
			<sql><![CDATA[
SELECT TO_CHAR(N1ST_ETA, 'yyyy-mm-dd hh24:mi') n1st_eta
      ,TO_CHAR(N1ST_ETA, 'yyyy-mm-dd') 		 n1st_eta_day
      ,TO_CHAR(N1ST_ETA, 'hh24:mi') 		 n1st_eta_time
	  ,TO_CHAR(DEL_ETA,  'yyyy-mm-dd hh24:mi') del_eta
      ,TO_CHAR(DEL_ETA,  'yyyy-mm-dd') 		 del_eta_day
      ,TO_CHAR(DEL_ETA,  'hh24:mi') 		 del_eta_time
  FROM (SELECT MAX(DTL.ESTM_DT) DEL_ETA
		  FROM BKG_BOOKING BK
				, SCE_COP_HDR HDR
				, SCE_COP_DTL DTL
 		 WHERE BK.BKG_NO     = HDR.BKG_NO(+)
		   AND HDR.COP_NO    = DTL.COP_NO
  		   AND BK.DEL_NOD_CD = DTL.NOD_CD(+)
		   AND (DTL.ACT_CD LIKE 'FI__A_' OR DTL.ACT_CD LIKE 'FU__U_')
		   AND BK.BKG_NO  = @[bkg_no]) DEL_ETA
	  ,(SELECT VPS_ETA_DT N1ST_ETA
		  FROM VSK_VSL_PORT_SKD
		 WHERE VPS_PORT_CD  = @[pol_cd]
		   AND CLPT_IND_SEQ = NVL((SELECT VVD.POL_CLPT_IND_SEQ
									 FROM BKG_VVD VVD
								    WHERE VVD.BKG_NO = @[bkg_no]
									  AND VVD.POL_CD = @[pol_cd]
								      AND VVD.VSL_CD       = substr(@[bkg_vvd_cd], 1, 4)
								      AND VVD.SKD_VOY_NO   = substr(@[bkg_vvd_cd], 5, 4)
								      AND VVD.SKD_DIR_CD   = substr(@[bkg_vvd_cd], 9, 1)
								      AND ROWNUM = 1), '1')
		   AND VSL_CD       = substr(@[bkg_vvd_cd], 1, 4)
		   AND SKD_VOY_NO   = substr(@[bkg_vvd_cd], 5, 4)
		   AND SKD_DIR_CD   = substr(@[bkg_vvd_cd], 9, 1)) N1ST_ETA			]]></sql>
			<params>
				<param name="bkg_no" type="12" value="SEL900009500" out="N"/>
				<param name="pol_cd" type="12" value="KRPUS" out="N"/>
				<param name="bkg_vvd_cd" type="12" value="HNPT0085E" out="N"/>
			</params>
		</query>
	</querys>
</sqls>
