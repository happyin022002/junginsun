<?xml version="1.0" encoding="UTF-8"?>
<sqls>
	<querys>
		<query name="MonthlyQuotaGuidelineDBDAOMonthlyGuidelineVVDInfo0076CSQL">
			<desc><![CDATA[SAQ_MON_TGT_VVD_ADJ Insert]]></desc>
			<sql><![CDATA[
INSERT INTO SAQ_MON_TGT_VVD_ADJ (
            BSE_YR              ,          
            BSE_QTR_CD          ,          
            GLINE_VER_NO        ,          
            TRD_CD              ,          
            RLANE_CD            ,          
            DIR_CD              ,          
            VSL_CD              ,          
            SKD_VOY_NO          ,          
            SKD_DIR_CD          ,          
            SPRT_GRP_CD         ,          
            BSA_GRP_CD          ,          
            BSE_MON             ,          
            BSE_WK              ,          
            SUB_TRD_CD          ,          
            IOC_CD              ,          
            VVD_SEQ             ,          
            FNL_BSA_CAPA        ,          
            LST_LODG_PORT_ETD_DT,          
            UPD_RMK             ,          
            CRE_USR_ID          ,          
            CRE_DT              ,          
            UPD_USR_ID          ,          
            UPD_DT              )          
SELECT                           		
            VVD.BSE_YR              ,          	
            VVD.BSE_QTR_CD          ,          	
            @[version] gline_ver_no ,          	
            VVD.TRD_CD              ,          	
            VVD.RLANE_CD            ,          	
            NVL(DIR.CONV_DIR_CD, VVD.DIR_CD),  	
            VVD.VSL_CD              ,          	
            VVD.SKD_VOY_NO          ,          	
            VVD.SKD_DIR_CD          ,          	
            VVD.SPRT_GRP_CD         ,          	
            VVD.BSA_GRP_CD          ,          	
            VVD.BSE_MON             ,          	
            VVD.BSE_WK              ,          	
            VVD.SUB_TRD_CD          ,          	
            VVD.IOC_CD              ,          	
            VVD.VVD_SEQ             ,          	
            VVD.FNL_BSA_CAPA        ,          	
            VVD.LST_LODG_PORT_ETD_DT,          	
            VVD.UPD_RMK             ,          	
            @[user_id]              ,          	
            SYSDATE                 ,          	
            @[user_id]              ,          	
            SYSDATE                           	
FROM        SAQ_MON_TGT_VVD  VVD,          	
            SAQ_MON_DIR_CONV DIR           	
WHERE       VVD.BSE_YR      = @[year]          
AND         VVD.BSE_QTR_CD  = @[bse_qtr_cd]    
AND         VVD.BSE_YR      = DIR.BSE_YR(+)    
AND         VVD.BSE_QTR_CD  = DIR.BSE_QTR_CD(+)
AND         VVD.TRD_CD      = DIR.TRD_CD(+)    
AND         VVD.RLANE_CD    = DIR.RLANE_CD(+)  
AND         VVD.DIR_CD      = DIR.DIR_CD(+)    
AND         VVD.DELT_FLG    = 'N'              
AND         VVD.TRD_CD      IN ( SELECT TRD_CD              	
                                  FROM  SAQ_TGT_GRP_TRD_V     	
                                  WHERE SAQ_TGT_GRP_CD = @[target_grp] )			]]></sql>
			<params>
				<param name="version" type="12" value="" out="N"/>
				<param name="user_id" type="12" value="" out="N"/>
				<param name="year" type="12" value="" out="N"/>
				<param name="bse_qtr_cd" type="12" value="" out="N"/>
				<param name="target_grp" type="12" value="" out="N"/>
			</params>
		</query>
	</querys>
</sqls>
