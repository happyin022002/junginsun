<?xml version="1.0" encoding="UTF-8"?>
<sqls>
	<querys>
		<query name="ChinaManifestListDownloadDBDAOsearchBlMdListRSQL">
			<desc><![CDATA[searchBlMdList]]></desc>
			<sql><![CDATA[
SELECT  SUBSTR(
            MAX(TO_CHAR(MD.MK_SEQ, '00')||
            MD.BL_NO||CHR(9)||
            MD.MK_SEQ||CHR(9)||
            @[trans_mode])
        ,4) BL_NO,
        SUBSTR(
            MAX(TO_CHAR(MD.MK_SEQ, '00')||
				--MD.CMDT_DESC||CHR(9)||
                MD.MK_DESC)
        ,4) BL_MK_DESC,
		@[usr_id] AS CRE_USR_ID,
		@[usr_id] AS UPD_USR_ID
FROM    (
            SELECT  BB.BL_NO,
                    MK.MK_SEQ,					
                    DBMS_LOB.substr( MK.MK_DESC, 3990,1 ) AS MK_DESC
                    --DBMS_LOB.substr( MK.CMDT_DESC, DBMS_LOB.GetLength(MK.CMDT_DESC) ) AS CMDT_DESC
            FROM    BKG_BL_MK_DESC MK, BKG_BOOKING BB
            WHERE   1=1
			AND ( #foreach($field_id in ${field_list}) 
      				#if($velocityCount > 1)
      				OR #end      MK.BKG_NO IN ( $field_id )
      			  #end
			)
            AND     MK.BKG_NO = BB.BKG_NO
			#if (${bkg_cgo_tp_cd} != '') 
			AND     DECODE(BB.BKG_CGO_TP_CD,'P','P','F') = @[bkg_cgo_tp_cd]
			#end
        ) MD
GROUP BY MD.BL_NO			]]></sql>
			<params>
				<param name="trans_mode" type="12" value="" out="N"/>
				<param name="usr_id" type="12" value="" out="N"/>
				<param name="bkg_cgo_tp_cd" type="12" value="" out="N"/>
			</params>
		</query>
	</querys>
</sqls>
