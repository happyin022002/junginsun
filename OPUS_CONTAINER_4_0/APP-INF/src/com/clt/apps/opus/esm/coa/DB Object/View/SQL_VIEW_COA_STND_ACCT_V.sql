CREATE OR REPLACE VIEW OPUSADM.COA_STND_ACCT_V
(   STND_COST_TP_CD,
    MGRP_COST_CD,
    MGRP_COST_CD_DESC,
    SGRP_COST_CD,
    SGRP_COST_CD_DESC,
    STND_COST_CD,
    COA_COST_SRC_PRT_CD,
    STND_COST_NM,
    PA_VW,
    RA_VW,
    ACCT_DP_SEQ
)
AS
SELECT DISTINCT C.STND_COST_TP_CD,
  DECODE(A.COA_COST_SRC_PRT_CD, 'PA', B.MGRP_COST_CD, 'RA', B.RA_MN_COST_CD, B.MGRP_COST_CD) MGRP_COST_CD,
  C.MGRP_COST_CD_DESC,
  DECODE(A.COA_COST_SRC_PRT_CD, 'PA', A.SGRP_COST_CD, 'RA', B.RA_SGRP_COST_CD, B.SGRP_COST_CD) SGRP_COST_CD,
  D.SGRP_COST_CD_DESC,
  DECODE(A.COA_COST_SRC_PRT_CD, 'PA', A.STND_COST_CD, 'RA', B.RA_ACCT_CD, A.STND_COST_CD) STND_COST_CD,
  A.COA_COST_SRC_PRT_CD,
  DECODE(A.COA_COST_SRC_PRT_CD, 'PA', B.STND_COST_NM, 'RA', B.RA_STND_COST_DESC , B.RA_STND_COST_DESC) DISC,
  PERF_VW_CD PA_VW,
  RA_PERF_VW_CD RA_VW,
  ACCT_DP_SEQ
FROM COA_COST_SRC_ACCT A,
  COA_STND_ACCT B,
  COA_MN_GRP_COST C,
  COA_SUB_GRP_COST D
WHERE A.STND_COST_CD = B.STND_COST_CD
  AND NVL(B.DELT_FLG, 'N') = 'N'
  AND B.MGRP_COST_CD = C.MGRP_COST_CD
  AND B.SGRP_COST_CD = D.SGRP_COST_CD
ORDER BY ACCT_DP_SEQ ;