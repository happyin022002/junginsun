<?xml version="1.0" encoding="UTF-8"?>
<sqls>
	<querys>
		<query name="Jp24ManifestListDownloadDBDAOAddAdvJpVslSkdCSQL">
			<desc><![CDATA[]]></desc>
			<sql><![CDATA[
INSERT INTO BKG_CSTMS_ADV_JP_VSL_SKD

       (VSL_CD,
        SKD_VOY_NO,
        SKD_DIR_CD,
        POL_CD,
        YD_SEQ,
        ETA_DT,
        ETB_DT,
        ETD_DT,
        CALL_SGN_NO,
        JO_CD1,
        MF_SND_FLG,
        FNL_EDI_SND_FLG,
        IB_CSSM_VOY_NO,
        CRE_USR_ID,
        CRE_DT,
        UPD_USR_ID,
        UPD_DT)

SELECT VSL_CD,
       SKD_VOY_NO,
       SKD_DIR_CD,
       VPS_PORT_CD,
       @[pol_split_no],
       VPS_ETA_DT,
       TO_DATE(@[vps_dt], 'YYYY-MM-DD HH24:MI'),
       VPS_ETD_DT,
       @[call_sgn_no],
       DECODE(@[rlx_div], '1', 'Y', NULL),
       DECODE(@[mf_snd_flg], 'Y', 'Y', 'N'),
       DECODE(@[fnl_edi_snd_flg], 'Y', 'Y', 'N'),
       NVL(@[ib_cssm_voy_no], ''),
       @[usr_id],
       SYSDATE,
       @[usr_id],
       SYSDATE

  FROM VSK_VSL_PORT_SKD

 WHERE VSL_CD = SUBSTR(@[vvd], 1, 4)
   AND SKD_VOY_NO = SUBSTR(@[vvd], 5, 4)
   AND SKD_DIR_CD = SUBSTR(@[vvd], 9, 1)
   AND VPS_PORT_CD = @[pol_cd]
   AND CLPT_IND_SEQ = 

(SELECT MIN(P.CLPT_IND_SEQ) 
                                 FROM VSK_VSL_PORT_SKD P
                                WHERE 1=1
                                  AND P.VSL_CD = SUBSTR(@[vvd], 1, 4)
                                  AND P.SKD_VOY_NO = SUBSTR(@[vvd], 5, 4)
                                  AND P.SKD_DIR_CD = SUBSTR(@[vvd], 9, 1)
                                  AND P.VPS_PORT_CD = @[pol_cd]
                                  AND NVL(P.SKD_CNG_STS_CD, 'X') <> 'S') 



			]]></sql>
			<params>
				<param name="pol_split_no" type="12" value="" out="N"/>
				<param name="vps_dt" type="12" value="" out="N"/>
				<param name="call_sgn_no" type="12" value="" out="N"/>
				<param name="rlx_div" type="12" value="" out="N"/>
				<param name="mf_snd_flg" type="12" value="" out="N"/>
				<param name="fnl_edi_snd_flg" type="12" value="" out="N"/>
				<param name="ib_cssm_voy_no" type="12" value="" out="N"/>
				<param name="usr_id" type="12" value="" out="N"/>
				<param name="vvd" type="12" value="" out="N"/>
				<param name="pol_cd" type="12" value="" out="N"/>
			</params>
		</query>
	</querys>
</sqls>
