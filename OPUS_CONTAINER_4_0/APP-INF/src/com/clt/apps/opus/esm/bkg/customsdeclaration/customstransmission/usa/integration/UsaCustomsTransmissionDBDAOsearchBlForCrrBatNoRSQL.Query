<?xml version="1.0" encoding="UTF-8"?>
<sqls>
	<querys>
		<query name="UsaCustomsTransmissionDBDAOsearchBlForCrrBatNoRSQL">
			<desc><![CDATA[]]></desc>
			<sql><![CDATA[
SELECT DECODE(C.BL_NO, NULL, 'AMS VSL Departure', 'AMS') AS IBFLAG
      ,NVL(A.VVD, C.VSL_CD || C.SKD_VOY_NO || C.SKD_DIR_CD) AS VVD
      ,C.BL_NO
      ,NVL(A.POL_CD, C.CSTMS_POL_CD) AS CSTMS_POL_CD
      ,NVL(A.POD_CD, C.CSTMS_POD_CD) AS CSTMS_POD_CD
  FROM (SELECT CNT_CD
              ,CRR_BAT_NO
              ,VSL_CD || SKD_VOY_NO || SKD_DIR_CD AS VVD
              ,POL_CD
              ,POD_CD
          FROM BKG_CSTMS_ADV_SND_LOG
         WHERE (CNT_CD, IO_BND_CD, SND_DT, HIS_SEQ) = (SELECT CNT_CD, IO_BND_CD, SND_DT, HIS_SEQ
                                                         FROM BKG_CSTMS_ADV_SND_LOG_DTL
                                                        WHERE CNT_CD = 'US'
                                                          AND IO_BND_CD = 'I'
                                                          AND SND_DT > SYSDATE -2
                                                          AND EDI_SND_LOG_CTNT LIKE '$$$%'
                                                          AND EDI_SND_LOG_CTNT LIKE '%' || @[crr_bat_no] || '%'
                                                      )
       ) A
      ,BKG_CSTMS_ADV_EDI_BL_RSPN B
      ,BKG_CSTMS_ADV_BL          C
 WHERE A.CNT_CD     = B.CNT_CD(+)
   AND A.CRR_BAT_NO = B.CRR_BAT_NO(+)
   AND B.CNT_CD     = C.CNT_CD(+)
   AND B.BL_NO      = C.BL_NO(+)			]]></sql>
			<params>
				<param name="crr_bat_no" type="12" value="" out="N"/>
			</params>
		</query>
	</querys>
</sqls>
