<?xml version="1.0" encoding="UTF-8"?>
<sqls>
	<querys>
		<query name="SCReportDBDAOPriMotChargesRSQL">
			<desc><![CDATA[get the MOT Charges]]></desc>
			<sql><![CDATA[
SELECT 
       LISTAGG (''''||CHG.CHG_TY||'''', ',') WITHIN GROUP (ORDER BY CHG.IND)  AS CHARGES
  FROM (SELECT
               Y.IND, Y.CHG_CD, Y.CHG_NM, Y.RMK_FLG, Y.CHG_TY, ROW_NUMBER() OVER(PARTITION BY Y.CHG_CD ORDER BY Y.CHG_TY ) AS IND_SEQ
          FROM (SELECT 
                       ROWNUM AS IND
                     , X.CHG_CD
                     , X.CHG_NM
                     , X.RMK_FLG
                     , CASE WHEN X.CHG_GB = 'CURR_FLG' AND X.CHG_TP = 'Y' THEN X.CHG_CD||'_CUR'
                            WHEN X.CHG_GB = 'XCH_RT_FLG' AND X.CHG_TP = 'Y' THEN X.CHG_CD||'_EXE'
                            ELSE X.CHG_TP
                        END CHG_TY
                  FROM (SELECT
                               CHG_CD, CHG_NM, CHG_CD AS CHG_CD1, CURR_FLG, XCH_RT_FLG, RMK_FLG
                          FROM PRI_MOT_CHG)
                  UNPIVOT 
                  ( 
                    CHG_TP FOR CHG_GB IN ( CHG_CD1, CURR_FLG, XCH_RT_FLG  ) 
                  ) X
                 WHERE X.CHG_TP <> 'N') Y
        WHERE Y.CHG_CD <> 'OFT'
        ORDER BY Y.IND) CHG			]]></sql>
			<params>
			</params>
		</query>
	</querys>
</sqls>
