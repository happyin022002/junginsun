<?xml version="1.0" encoding="UTF-8"?>
<sqls>
	<querys>
		<query name="TCharterIOInvoiceDAOSearchOffhireInvoiceListRSQL">
			<desc><![CDATA[TCharterIOInvoiceDAOSearchOffhireInvoiceListRSQL]]></desc>
			<sql><![CDATA[
SELECT FA.ACCT_ITM_NM, 
       FD.ACCT_CD, 
       FD.ACCT_ITM_SEQ, 
       DECODE(FD.FLET_CURR_CHK_CD,'F',FD.CURR_CD,NULL) CURR_CD, 
       TRIM(DECODE(FD.FLET_CURR_CHK_CD,'F',TO_CHAR(FD.INV_AMT,'999,999,999,999,999,990.00'),NULL)) INV_AMT,
       TRIM(DECODE(FD.FLET_CURR_CHK_CD,'F',TO_CHAR(FD.INV_AMT,'999,999,999,999,999,990.00'),NULL)) ORI_INV_AMT,
       TRIM(DECODE(FD.FLET_CURR_CHK_CD,'F',TO_CHAR(FD.INV_AMT,'999,999,999,999,999,990.00'),NULL)) FIR_INV_AMT,
       DECODE(FD.FLET_CURR_CHK_CD,'S',FD.CURR_CD,NULL) CURR_CD2, 
       TRIM(DECODE(FD.FLET_CURR_CHK_CD,'S',TO_CHAR(FD.INV_AMT,'999,999,999,999,999,990.00'),NULL)) INV_AMT2,
       TRIM(DECODE(FD.FLET_CURR_CHK_CD,'S',TO_CHAR(FD.INV_AMT,'999,999,999,999,999,990.00'),NULL)) ORI_INV_AMT2,
       TRIM(DECODE(FD.FLET_CURR_CHK_CD,'S',TO_CHAR(FD.INV_AMT,'999,999,999,999,999,990.00'),NULL)) FIR_INV_AMT2,
       FD.INV_DESC,
       FD.FLET_CTRT_NO,
       FD.FLET_ISS_TP_CD,
       FD.INV_SEQ,
       FD.INV_DTL_SEQ,
       DECODE(FD.SLP_TP_CD, NULL, 'N', 'Y') SLP_TP_CD
  FROM FMS_INVOICE FI, FMS_INV_DTL FD, FMS_ACCT_ITM FA
 WHERE FI.FLET_CTRT_NO = FD.FLET_CTRT_NO
   AND FI.FLET_CTRT_NO = @[flet_ctrt_no]
   AND FI.INV_SEQ = DECODE(@[inv_seq],NULL,(SELECT MAX(INV_SEQ) FROM FMS_INVOICE WHERE FLET_CTRT_NO = @[flet_ctrt_no] AND FLET_ISS_TP_CD = 'OFF'),@[inv_seq])
   AND FI.FLET_ISS_TP_CD = 'OFF'
   AND FI.INV_SEQ = FD.INV_SEQ
   AND FI.FLET_ISS_TP_CD = FD.FLET_ISS_TP_CD
   AND FD.ACCT_CD = FA.ACCT_CD
   AND FD.ACCT_ITM_SEQ = FA.ACCT_ITM_SEQ
 ORDER BY FD.INV_DTL_SEQ, FD.ACCT_CD			]]></sql>
			<params>
				<param name="flet_ctrt_no" type="12" value="" out="N"/>
				<param name="inv_seq" type="12" value="" out="N"/>
			</params>
		</query>
	</querys>
</sqls>
