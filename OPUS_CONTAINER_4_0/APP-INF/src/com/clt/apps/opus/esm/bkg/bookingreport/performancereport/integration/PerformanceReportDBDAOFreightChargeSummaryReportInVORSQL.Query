<?xml version="1.0" encoding="UTF-8"?>
<sqls>
	<querys>
		<query name="PerformanceReportDBDAOFreightChargeSummaryReportInVORSQL">
			<desc><![CDATA[Freight & Charge 요약 리포트 조회한다]]></desc>
			<sql><![CDATA[
SELECT /*+ RULE */  
#if (${sorting_priority} != '')  
		--DECODE(CHARGE.FRT_CHG_TP_CD,'TF','Trunk FRT','IH','Inland CHRG','CY','CY/CFS CHRG', 'OP','Outport CHRG', 'SA','Sales CHRG','OT','Others',' ') || '|' ||  ${sorting_priority} FRT_CHG_TP_CD
		CHARGE.FRT_CHG_TP_CD  || '|' ||  ${sorting_priority} FRT_CHG_TP_CD
#else 
		CHARGE.FRT_CHG_TP_CD
		--DECODE(CHARGE.FRT_CHG_TP_CD,'TF','Trunk FRT','IH','Inland CHRG','CY','CY/CFS CHRG', 'OP','Outport CHRG', 'SA','Sales CHRG','OT','Others',' ') FRT_CHG_TP_CD
#end
,	   'Freight Charge : '  || DECODE(CHARGE.FRT_CHG_TP_CD,'TF','Trunk FRT','IH','Inland CHRG','CY','CY/CFS CHRG', 'OP','Outport CHRG', 'SA','Sales CHRG','OT','Others',' ') PER_GROUP
,      BKG_RATE.RAT_UT_CD  PER
,      NVL(BKG_RATE.CHG_CD,' ')    CHG_CD                   
,       SUM((NVL(BKG_RATE.CHG_AMT,0))/NVL(GL_MON_XCH_RT.USD_LOCL_XCH_RT,1)) BRATE_PREPAID 
,      NVL(CHARGE.CHG_NM,' ')   CHG_NM
--------------------------------------------------------------------------

#if (${sorting_priority} != '')  
,	    ${sorting_priority} SORTING_PRIORITY
#else 
,	   '' SORTING_PRIORITY
#end

,      '' BKG_NO
,      '' BL_NO
,      '' SLAN_CD
,      '' POR_CD
,      '' DEL_CD
,      '' VVD_CD
,      '' POL_CD
,      '' POD_CD
,      '' BKG_OFC_CD
,      '' OB_SLS_OFC_CD
,      '' CUST_TP_CD
,      '' CUST_CNT_CD
,      '' CUST_SEQ
,      '' DCGO_FLG
,      '' RD_CGO_FLG
,      '' AWK_CGO_FLG
,      '' BB_CGO_FLG
,      '' RC_FLG
,      '' RAT_UT_CD
,      '' REP_CMDT_CD
,	   '' CMDT_CD
--,      '' FRT_CHG_TP_CD
,	   '' CNTR_TPSZ_CD
,      '' CHG_REV_TP_CD
,	   '' PRE_RLY_PORT_CD
,	   '' PST_RLY_PORT_CD
--------------------------------------------------------------------------
FROM  BKG_CHG_RT BKG_RATE
,     MDM_CHARGE CHARGE
,     GL_MON_XCH_RT
,     BKG_BL_OUTBOUND_V VB
--------------------------------------------------------------------------
WHERE BKG_RATE.CHG_CD = CHARGE.CHG_CD 
AND   BKG_RATE.BKG_NO(+) = VB.BKG_NO 
AND   TO_CHAR(BKG_RATE.CRE_DT,'YYYYMM') = GL_MON_XCH_RT.ACCT_XCH_RT_YRMON(+)
AND   BKG_RATE.CURR_CD = GL_MON_XCH_RT.CURR_CD(+)
AND   GL_MON_XCH_RT.ACCT_XCH_RT_LVL = '1'
AND   VB.Split_Flg  = 'N'  --VB.SPLIT_RSN_CD  IS NULL 
AND   VB.BKG_STS_CD != 'X'  
AND   BKG_RATE.FRT_INCL_XCLD_DIV_CD   = 'N'
--------------------------------------------------------------------------
#if (${bkg_no} != '') 
AND   VB.BKG_NO = @[bkg_no]
#end

#if (${bl_no} != '') 
AND   VB.BL_NO = @[bl_no]
#end

#if (${slan_cd} != '') 
AND   VB.SLAN_CD = @[slan_cd]
#end

#if (${por_cd} != '') 
AND   VB.POR_CD     = @[por_cd]
#end

#if (${del_cd} != '') 
AND   VB.DEL_CD  =   @[del_cd]
#end

#if (${vvd_cd} != '')
AND   VB.KEY_VSL_CD =  SUBSTR(@[vvd_cd],1,4)
AND   VB.KEY_SKD_VOY_NO = SUBSTR(@[vvd_cd],5,4)
AND   VB.KEY_SKD_DIR_CD = SUBSTR(@[vvd_cd],9,1)
#end


#if (${pol_cd} != '') 
AND   VB.KEY_POL_LOC     = @[pol_cd]

#if (${pre_rly_port_cd} != '') 
AND   VB.KEY_POL_LOC     = VB.PRE_RLY_PORT_CD
#end
#end

#if (${pod_cd} != '') 
AND   VB.KEY_POD_LOC     = @[pod_cd]
#if (${pst_rly_port_cd} != '') 
AND   VB.KEY_POD_LOC   = VB.PST_RLY_PORT_CD
#end
#end 

#if (${bkg_ofc_cd} != '') 
AND   VB.BKG_OFC_CD   = @[bkg_ofc_cd]
#end


#if (${ob_sls_ofc_cd} != '') 
AND   VB.OB_SLS_OFC_CD = @[ob_sls_ofc_cd]
#end  

--------------------------------------------------------------------------
--1.'SHPR'
#if (${cust_tp_cd} == 'S') 
	#if (${cust_cnt_cd} != '' && ${cust_seq} == '') 
AND	  SUBSTR(VB.SHIPPER,1,2) = @[cust_cnt_cd] 
	#end 
	#if (${cust_cnt_cd} != '' && ${cust_seq} != '') 
AND	  VB.SHIPPER LIKE @[cust_cnt_cd] || @[cust_seq]
	#end 
--2.'CNEE'
#elseif (${cust_tp_cd} == 'C') 
	#if (${cust_cnt_cd} != '' && ${cust_seq} == '') 
AND	  SUBSTR(VB.CONSIGNEE,1,2) = @[cust_cnt_cd]
	#end 
	#if (${cust_cnt_cd} != '' && ${cust_seq} != '') 
AND	  VB.CONSIGNEE LIKE @[cust_cnt_cd] || @[cust_seq]
	#end 
--3.'NTFY'
#elseif (${cust_tp_cd} == 'N') 
	#if (${cust_cnt_cd} != '' && ${cust_seq} == '') 
AND	  SUBSTR(VB.NTFY,1,2) = @[cust_cnt_cd]
	#end 
	#if (${cust_cnt_cd} != '' && ${cust_seq} != '') 
AND	  VB.NTFY LIKE @[cust_cnt_cd] || @[cust_seq]
	#end 
--4.'ANFY'
#elseif (${cust_tp_cd} == 'A') 
	#if (${cust_cnt_cd} != '' && ${cust_seq} == '') 
AND	  SUBSTR(VB.ANTY,1,2) = @[cust_cnt_cd]
	#end 
	#if (${cust_cnt_cd} != '' && ${cust_seq} != '') 
AND	  VB.ANTY LIKE @[cust_cnt_cd] || @[cust_seq]
	#end 
--5.'FWDR'
#elseif (${cust_tp_cd} == 'F')
	#if (${cust_cnt_cd} != '' && ${cust_seq} == '') 
AND	  SUBSTR(VB.FFDR,1,2) = @[cust_cnt_cd]
	#end 
	#if (${cust_cnt_cd} != '' && ${cust_seq} != '') 
AND	  VB.FFDR LIKE @[cust_cnt_cd] || @[cust_seq]
	#end 
#else
--6.'�좏깮�섏� �딆븯�꾨븣..'
	#if (${cust_cnt_cd} != '' && ${cust_seq} == '') 
AND	  	(SUBSTR(VB.SHIPPER,1,2) = @[cust_cnt_cd] OR	
		SUBSTR(VB.CONSIGNEE,1,2)= @[cust_cnt_cd] OR
		SUBSTR(VB.NTFY,1,2) = @[cust_cnt_cd] OR
		SUBSTR(VB.ANTY,1,2) = @[cust_cnt_cd] OR 
		SUBSTR(VB.FFDR,1,2) = @[cust_cnt_cd])
	#end 
	#if (${cust_cnt_cd} != '' && ${cust_seq} != '') 
AND		(VB.SHIPPER = @[cust_cnt_cd] || @[cust_seq] OR	
		VB.CONSIGNEE = @[cust_cnt_cd] || @[cust_seq] OR
		VB.NTFY = @[cust_cnt_cd]|| @[cust_seq] OR
		VB.ANTY = @[cust_cnt_cd]|| @[cust_seq] OR 
		VB.FFDR = @[cust_cnt_cd]|| @[cust_seq])
	#end
#end
--------------------------------------------------------------------------
#if(${dcgo_flg} != '' || ${rd_cgo_flg} != ''|| ${rc_flg} != ''|| ${awk_cgo_flg} != '' || ${bb_cgo_flg} != '')
AND ( 1=2
#if (${dcgo_flg} != '') 
OR VB.DCGO_FLG = @[dcgo_flg]	--Special DG   
#end

#if (${rd_cgo_flg} != '') 
OR VB.RD_CGO_FLG = @[rd_cgo_flg]	--Special RD    
#end

#if (${rc_flg} != '') 
OR VB.RC_FLG = @[rc_flg]		--Special RF       
#end

#if (${awk_cgo_flg} != '') 
OR VB.AWK_CGO_FLG = @[awk_cgo_flg]	--Special AK          
#end

#if (${bb_cgo_flg} != '') 
OR VB.BB_CGO_FLG = @[bb_cgo_flg]	--Special BB             
#end
)
#end
#if (${rep_cmdt_cd} != '') 
AND VB.REP_CMDT_CD  LIKE @[rep_cmdt_cd] || '%' 	--Commodity REP
#end

#if (${cmdt_cd} != '') 
AND VB.CMDT_CD LIKE @[cmdt_cd] || '%' 	--Commodity
#end

#if (${cntr_tpsz_cd} != '') 
AND BKG_RATE.RAT_UT_CD  = @[cntr_tpsz_cd]   --E/Q Type/Size(cntr_tpsz_cd)
#end

#if (${frt_chg_tp_cd} != '') 
AND CHARGE.FRT_CHG_TP_CD  = @[frt_chg_tp_cd]	--Freight Charge Type
#end

#if (${chg_rev_tp_cd} != '') 
AND CHARGE.CHG_REV_TP_CD = @[chg_rev_tp_cd]	--Revenue Class
#end
 
--------------------------------------------------------------------------
GROUP BY 
--DECODE(CHARGE.FRT_CHG_TP_CD,'TF','Trunk FRT','IH','Inland CHRG','CY','CY/CFS CHRG', 'OP','Outport CHRG', 'SA','Sales CHRG','OT','Others',' ')
		CHARGE.FRT_CHG_TP_CD
,     BKG_RATE.RAT_UT_CD 
,     BKG_RATE.CHG_CD
,     CHARGE.CHG_NM 
#if (${sorting_priority} != '') 
,  ${sorting_priority}
#end
--------------------------------------------------------------------------
ORDER BY 
--DECODE(CHARGE.FRT_CHG_TP_CD,'TF','Trunk FRT','IH','Inland CHRG','CY','CY/CFS CHRG', 'OP','Outport CHRG', 'SA','Sales CHRG','OT','Others',' ')
	CHARGE.FRT_CHG_TP_CD
#if (${sorting_priority} != '') 
,  ${sorting_priority}
#end 
,      BKG_RATE.RAT_UT_CD
,     BKG_RATE.CHG_CD			]]></sql>
			<params>
				<param name="bkg_no" type="12" value="" out="N"/>
				<param name="bl_no" type="12" value="" out="N"/>
				<param name="slan_cd" type="12" value="" out="N"/>
				<param name="por_cd" type="12" value="" out="N"/>
				<param name="del_cd" type="12" value="" out="N"/>
				<param name="vvd_cd" type="12" value="" out="N"/>
				<param name="pol_cd" type="12" value="" out="N"/>
				<param name="pod_cd" type="12" value="" out="N"/>
				<param name="bkg_ofc_cd" type="12" value="" out="N"/>
				<param name="ob_sls_ofc_cd" type="12" value="" out="N"/>
				<param name="cust_cnt_cd" type="12" value="" out="N"/>
				<param name="cust_seq" type="12" value="" out="N"/>
				<param name="dcgo_flg" type="12" value="" out="N"/>
				<param name="rd_cgo_flg" type="12" value="" out="N"/>
				<param name="rc_flg" type="12" value="" out="N"/>
				<param name="awk_cgo_flg" type="12" value="" out="N"/>
				<param name="bb_cgo_flg" type="12" value="" out="N"/>
				<param name="rep_cmdt_cd" type="12" value="" out="N"/>
				<param name="cmdt_cd" type="12" value="" out="N"/>
				<param name="cntr_tpsz_cd" type="12" value="" out="N"/>
				<param name="frt_chg_tp_cd" type="12" value="" out="N"/>
				<param name="chg_rev_tp_cd" type="12" value="" out="N"/>
			</params>
		</query>
	</querys>
</sqls>
