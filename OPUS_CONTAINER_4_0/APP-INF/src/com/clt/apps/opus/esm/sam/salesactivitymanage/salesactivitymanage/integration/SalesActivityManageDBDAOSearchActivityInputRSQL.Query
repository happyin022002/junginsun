<?xml version="1.0" encoding="UTF-8"?>
<sqls>
	<querys>
		<query name="SalesActivityManageDBDAOSearchActivityInputRSQL">
			<desc><![CDATA[Sales Activity List 조회]]></desc>
			<sql><![CDATA[
SELECT A.SLS_ACT_SEQ ACTIVITY_NO
      ,A.SREP_CD SLS_CODE
      ,C.SREP_NM SLS_NAME
      ,A.CUST_CNT_CD||TRIM(TO_CHAR(A.CUST_SEQ, '099999')) CUS_CODE
      ,B.CUST_LGL_ENG_NM CUS_NAME
      ,NVL2(A.SLS_MGR_CMT_DESC,'Y','N') MGR_COMMENT
      ,D.SLS_ACT_SUB_TP_DESC PURPOSE
      ,A.CALL_RPT_FLG CALL_REPORT
      ,A.ACT_PLN_DT PLAN_DT
      ,A.SLS_ACT_ACT_DT ACTUAL_DT
      ,TO_CHAR(A.CRE_DT, 'YYYY-MM-DD') CRE_DT
      ,A.CRE_USR_ID
      ,B.CUST_LGL_ENG_NM
      ,A.SREP_CMT_DESC
      ,A.SLS_MGR_CMT_DESC
      ,A.SLS_ACT_TP_CD PURPOSE1
      ,A.SLS_ACT_SUB_TP_CD PURPOSE2
      ,A.ACT_CHNL_CD CHANNEL

FROM SAM_SLS_ACT A
    ,MDM_CUSTOMER B
    ,MDM_SLS_REP C
    ,SAM_SLS_ACT_TP_DTL D
WHERE 1=1
AND A.SREP_CD = C.SREP_CD
AND A.CUST_CNT_CD = B.CUST_CNT_CD
AND A.CUST_SEQ = B.CUST_SEQ
AND A.SLS_ACT_SUB_TP_CD = D.SLS_ACT_SUB_TP_CD

#if(${office_cd} != '')
--AND C.OFC_CD = [office_cd] --임시적으로 조건 제거. 20131008
#end 

#if(${sales_rep_cd} != '')
AND A.SREP_CD = @[sales_rep_cd]
#end 

#if(${team_cd} != '')
AND C.OFC_TEAM_CD = @[team_cd] 
#end 

#if(${status} == 'R')
AND A.CRE_DT IS NOT NULL
AND A.ACT_PLN_DT IS NULL
AND A.SLS_ACT_ACT_DT IS NULL
#elseif(${status} == 'O')
AND A.CRE_DT IS NOT NULL
AND A.ACT_PLN_DT IS NOT NULL
AND A.SLS_ACT_ACT_DT IS NULL 
#elseif(${status} == 'P')
AND A.CRE_DT IS NOT NULL
AND A.ACT_PLN_DT < SYSDATE 
#elseif(${status} == 'C')
AND A.SLS_ACT_ACT_DT IS NOT NULL
#end 

#if(${search_type} == 'P')
	 AND A.ACT_PLN_DT IS NOT NULL
    #if(${from_date} != '' && ${to_date} != '')
     AND A.ACT_PLN_DT BETWEEN @[from_date] AND @[to_date]
    #end 
#elseif(${search_type} == 'C')
	 AND A.CRE_DT IS NOT NULL
    #if(${from_date} != '' && ${to_date} != '')
     AND A.CRE_DT BETWEEN @[from_date] AND @[to_date]
    #end
#elseif(${search_type} == 'A')
	 AND A.SLS_ACT_ACT_DT IS NOT NULL
    #if(${from_date} != '' && ${to_date} != '')
     AND A.SLS_ACT_ACT_DT BETWEEN @[from_date] AND @[to_date]
    #end 
#end
 

#if(${activity} != '')
AND A.SLS_ACT_SEQ = @[activity] 
#end 

#if(${customer_cd} != '')
AND A.CUST_CNT_CD = SUBSTR(@[customer_cd],1,2)  
AND A.CUST_SEQ = SUBSTR(@[customer_cd],3,8)  
#end

ORDER BY A.SLS_ACT_SEQ			]]></sql>
			<params>
				<param name="sales_rep_cd" type="12" value="" out="N"/>
				<param name="team_cd" type="12" value="" out="N"/>
				<param name="from_date" type="12" value="" out="N"/>
				<param name="to_date" type="12" value="" out="N"/>
				<param name="activity" type="12" value="" out="N"/>
				<param name="customer_cd" type="12" value="" out="N"/>
			</params>
		</query>
	</querys>
</sqls>
