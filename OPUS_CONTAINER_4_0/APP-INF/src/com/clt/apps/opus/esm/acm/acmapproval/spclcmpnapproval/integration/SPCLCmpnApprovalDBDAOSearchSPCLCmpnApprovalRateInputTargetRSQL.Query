<?xml version="1.0" encoding="UTF-8"?>
<sqls>
	<querys>
		<query name="SPCLCmpnApprovalDBDAOSearchSPCLCmpnApprovalRateInputTargetRSQL">
			<desc><![CDATA[Ex.Rate input 대상을 조회한다.]]></desc>
			<sql><![CDATA[
SELECT
       A.BKG_NO              AS BKG_NO
     , A.SPCL_OFC_CD         AS SPCL_OFC_CD
     , A.SPCL_CMPN_SEQ       AS SPCL_CMPN_SEQ
     , A.SPCL_CMPN_STS_CD    AS SPCL_CMPN_STS_CD
     , A.CUST_CNT_CD||TO_CHAR(A.CUST_SEQ,'FM000000')  AS CUST_CNT_SEQ
     , A.SPCL_AGMT_SEQ       AS SPCL_AGMT_SEQ
     , @[pay_xch_rt] 		 AS PAY_XCH_RT
     , @[usr_id]			 AS USR_ID
  FROM ACM_SPCL_CMPN     A,
       MDM_CUSTOMER      B,
       ACM_AGN_BKG_INFO  C,
       BKG_BOOKING       D
 WHERE A.CUST_CNT_CD   = SUBSTR(@[cust_cnt_seq], 0, 2)
   AND A.CUST_SEQ      = SUBSTR(@[cust_cnt_seq], 3, 6)
   AND A.AP_OFC_CD     IS NOT NULL
   AND A.CUST_CNT_CD   = B.CUST_CNT_CD
   AND A.CUST_SEQ      = B.CUST_SEQ
   AND A.BKG_NO        = C.BKG_NO
   AND A.BKG_NO        = D.BKG_NO(+)
   AND A.AP_OFC_CD     IS NOT NULL
   AND A.CRE_USR_ID    != 'COST'
   AND C.BL_NO         IS NOT NULL

#if(${vndr_seq} != '')
   AND A.VNDR_SEQ      = @[vndr_seq]
#end
#if(${ar_ofc_cd} != '')
   AND A.AP_OFC_CD     = @[ar_ofc_cd]
#end
   AND A.SPCL_CMPN_STS_CD = 'CS'
   AND NVL(A.PAY_CHK_FLG,'N') = 'Y'
#if(${date_div} == 'C')
   AND C.BKG_CRE_DT
BETWEEN TO_DATE(REPLACE(@[date_fm],'-', ''),'YYYYMMDD')
   AND TO_DATE(REPLACE(@[date_to],'-', ''),'YYYYMMDD')+0.99999
#elseif(${date_div} == 'E')
   AND A.VSL_DEP_DT
BETWEEN TO_DATE(REPLACE(@[date_fm],'-', ''),'YYYYMMDD')
   AND TO_DATE(REPLACE(@[date_to],'-', ''),'YYYYMMDD')+0.99999
#elseif(${date_div} == 'I')
   AND A.IF_DT
BETWEEN TO_DATE(REPLACE(@[date_fm],'-', ''),'YYYYMMDD')
   AND TO_DATE(REPLACE(@[date_to],'-', ''),'YYYYMMDD')+0.99999
#end			]]></sql>
			<params>
				<param name="pay_xch_rt" type="12" value=" " out="N"/>
				<param name="usr_id" type="12" value="" out="N"/>
				<param name="cust_cnt_seq" type="12" value="" out="N"/>
				<param name="vndr_seq" type="12" value="" out="N"/>
				<param name="ar_ofc_cd" type="12" value="" out="N"/>
				<param name="date_fm" type="12" value="" out="N"/>
				<param name="date_to" type="12" value="" out="N"/>
			</params>
		</query>
	</querys>
</sqls>
