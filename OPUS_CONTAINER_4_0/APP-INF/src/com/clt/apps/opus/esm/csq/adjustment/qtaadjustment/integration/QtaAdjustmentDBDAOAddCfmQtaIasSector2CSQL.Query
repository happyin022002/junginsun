<?xml version="1.0" encoding="UTF-8"?>
<sqls>
	<querys>
		<query name="QtaAdjustmentDBDAOAddCfmQtaIasSector2CSQL">
			<desc><![CDATA[[CMCB adjust for IAS Sector]을 [생성] 합니다.
CSQ_CFM_QTA Insert (overall report에서 조회되도록)]]></desc>
			<sql><![CDATA[
INSERT INTO CSQ_CFM_QTA 
           (
            SELECT A1.QTA_RLSE_VER_NO
                  ,A1.BSE_TP_CD
                  ,A1.BSE_YR
                  ,A1.BSE_QTR_CD
                  ,A1.OFC_VW_CD
                  ,'D' AS QTA_TGT_CD
                  ,A1.TRD_CD
                  ,A1.RLANE_CD
                  ,A1.DIR_CD
                  ,A1.VSL_CD
                  ,A1.SKD_VOY_NO
                  ,A1.SKD_DIR_CD
                  ,A1.RGN_OFC_CD
                  ,A1.RHQ_CD
                  ,A1.AQ_CD
                  ,A1.CONV_DIR_CD
                  ,A1.LOD_QTY
                  ,DECODE(A1.LOD_QTY, 0, 0, A1.GRS_RPB_REV/A1.LOD_QTY)
                  ,DECODE(A1.LOD_QTY, 0, 0, A1.PA_CM_UC_AMT/A1.LOD_QTY)
                  ,DECODE(A1.LOD_QTY, 0, 0, A1.RA_CM_UC_AMT/A1.LOD_QTY)
                  ,'M' CSQ_CNG_TP_CD
                  ,@[usr_id]
                  ,SYSDATE
                  ,@[usr_id]
                  ,SYSDATE
            FROM (
                    SELECT QTA_RLSE_VER_NO
                          ,BSE_TP_CD
                          ,BSE_YR
                          ,BSE_QTR_CD
                          ,OFC_VW_CD
                          ,TRD_CD
                          ,RLANE_CD
                          ,DIR_CD
                          ,VSL_CD
                          ,SKD_VOY_NO
                          ,SKD_DIR_CD
                          ,RGN_OFC_CD
                          ,RHQ_CD
                          ,AQ_CD
                          ,DIR_CD AS CONV_DIR_CD
                          ,SUM(LOD_QTY) AS LOD_QTY
                          ,SUM(GRS_RPB_REV*LOD_QTY)   AS GRS_RPB_REV
                          ,SUM(PA_CM_UC_AMT*LOD_QTY)  AS PA_CM_UC_AMT
                          ,SUM(RA_CM_UC_AMT*LOD_QTY)  AS RA_CM_UC_AMT
                    FROM CSQ_SCTR_CFM_QTA
                    WHERE BSE_TP_CD                = 'Q'
                    AND SUBSTR(QTA_RLSE_VER_NO,-2) = '02'
                    AND BSE_YR                     = @[f_bse_yr]
                    AND BSE_QTR_CD                 = @[f_bse_qtr_cd]
                    AND OFC_VW_CD                  = SUBSTR(@[f_ofc_vw_cd], 0 ,1)
                    AND RLANE_CD                   = @[f_rlane_cd]
                    AND DIR_CD                     = @[f_dir_cd]
                    GROUP BY QTA_RLSE_VER_NO
                          ,BSE_TP_CD
                          ,BSE_YR
                          ,BSE_QTR_CD
                          ,OFC_VW_CD
                          ,TRD_CD
                          ,RLANE_CD
                          ,DIR_CD
                          ,VSL_CD
                          ,SKD_VOY_NO
                          ,SKD_DIR_CD
                          ,RGN_OFC_CD
                          ,RHQ_CD
                          ,AQ_CD
                  ) A1
           )			]]></sql>
			<params>
				<param name="usr_id" type="12" value="" out="N"/>
				<param name="f_bse_yr" type="12" value="" out="N"/>
				<param name="f_bse_qtr_cd" type="12" value="" out="N"/>
				<param name="f_ofc_vw_cd" type="12" value="" out="N"/>
				<param name="f_rlane_cd" type="12" value="" out="N"/>
				<param name="f_dir_cd" type="12" value="" out="N"/>
			</params>
		</query>
	</querys>
</sqls>
