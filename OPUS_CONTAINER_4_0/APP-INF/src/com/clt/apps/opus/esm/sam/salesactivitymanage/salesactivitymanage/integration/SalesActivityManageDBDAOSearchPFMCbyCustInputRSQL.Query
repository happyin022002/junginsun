<?xml version="1.0" encoding="UTF-8"?>
<sqls>
	<querys>
		<query name="SalesActivityManageDBDAOSearchPFMCbyCustInputRSQL">
			<desc><![CDATA[Performance by Customer 조회]]></desc>
			<sql><![CDATA[
WITH SAM09 AS(
	SELECT A.BKG_NO
      			  ,TO_CHAR(A.BKG_CRE_DT, 'YYYY-MM-DD') BKG_CRE_DT
      			  ,E.CUST_CNT_CD||TRIM(TO_CHAR(E.CUST_SEQ,'099999')) CUST_CD
     			  ,A.CMDT_CD
    			  ,A.VSL_CD||A.SKD_VOY_NO||A.SKD_DIR_CD VVD
     			  ,A.POR_CD
   			      ,A.POL_CD
   			      ,A.POD_CD
     			  ,A.DEL_CD
    			  ,A.BKG_STS_CD
    			  ,A.OB_SREP_CD SREP_CD
     			  ,C.CNTR_TPSZ_CD
     			  ,C.OP_CNTR_QTY
	  			
			  FROM BKG_BOOKING A
   				  ,MDM_CUSTOMER B
    			  ,BKG_QUANTITY C
    			  ,MDM_SLS_REP D
   				  ,BKG_CUSTOMER E
			WHERE 1=1
			AND A.BKG_NO = C.BKG_NO
			AND D.OFC_CD = B.OFC_CD
			AND B.SREP_CD = D.SREP_CD
			AND B.CUST_CNT_CD = E.CUST_CNT_CD
			AND B.CUST_SEQ = E.CUST_SEQ
			AND A.BKG_NO = E.BKG_NO

			#if(${sales_office} != '')
			AND D.OFC_CD = @[sales_office]
			#end   

			#if(${from_date} != '' && ${to_date} != '') 
			AND A.BKG_CRE_DT BETWEEN TO_DATE(@[from_date],'YYYY/MM/DD') AND TO_DATE(@[to_date],'YYYY/MM/DD')
			#end 

			#if(${sales_rep} != '')
			AND B.SREP_CD = @[sales_rep]
			#end

			#if(${cust_cd} != '')
			AND B.CUST_CNT_CD = SUBSTR(@[cust_cd],1,2)
			AND B.CUST_SEQ = SUBSTR(@[cust_cd],3,6)
			#end
			)

SELECT BKG_NO
      ,BKG_CRE_DT
      ,CUST_CD
      ,CMDT_CD
      ,VVD
      ,POR_CD
      ,POL_CD
      ,POD_CD
      ,DEL_CD
      ,BKG_STS_CD
      ,SREP_CD
      ,CNTR_TPSZ_CD
      ,OP_CNTR_QTY
	  ,TOTAL_BKG
  FROM SAM09, (SELECT COUNT(DISTINCT BKG_NO) TOTAL_BKG
 			     FROM SAM09)







			]]></sql>
			<params>
				<param name="sales_office" type="12" value="" out="N"/>
				<param name="from_date" type="12" value="" out="N"/>
				<param name="to_date" type="12" value="" out="N"/>
				<param name="sales_rep" type="12" value="" out="N"/>
				<param name="cust_cd" type="12" value="" out="N"/>
			</params>
		</query>
	</querys>
</sqls>
