<?xml version="1.0" encoding="UTF-8"?>
<sqls>
	<querys>
		<query name="KrWharfageDecMgtDBDAOsearchKrWhfDecExptVolListRSQL">
			<desc><![CDATA[s]]></desc>
			<sql><![CDATA[
SELECT DECODE(RNUM, 1, '20', 2, '40', 3, '45') SIZE_ID,
       DECODE(RNUM, 1, HYO_SUNG_20_QTY, 2, HYO_SUNG_40_QTY, 3, HYO_SUNG_45_QTY) AS HYO_SUNG_QTY,
       DECODE(RNUM, 1, DAE_WOO_20_QTY, 2, DAE_WOO_40_QTY, 3, DAE_WOO_45_QTY) AS DAE_WOO_QTY,
       DECODE(RNUM, 1, DONG_BU_20_QTY, 2, DONG_BU_40_QTY, 3, DONG_BU_45_QTY) AS DONG_BU_QTY,
       DECODE(RNUM, 1, HYUN_DAI_20_QTY, 2, HYUN_DAI_40_QTY, 3, HYUN_DAI_45_QTY) AS HYUN_DAI_QTY,
       DECODE(RNUM, 1, DONG_KUK_20_QTY, 2, DONG_KUK_40_QTY, 3, DONG_KUK_45_QTY) AS DONG_KUK_QTY,
       DECODE(RNUM, 1, THRU_TS_20_QTY, 2, THRU_TS_40_QTY, 3, THRU_TS_45_QTY) AS THRU_TS_QTY,
       DECODE(RNUM, 1, CUST_TS_20_QTY, 2, CUST_TS_40_QTY, 3, CUST_TS_45_QTY) AS CUST_TS_QTY,
       DECODE(RNUM, 1, REV_MT_20_QTY, 2, REV_MT_40_QTY, 3, REV_MT_45_QTY) AS REV_MT_QTY,
       DECODE(RNUM, 1, OTR_20_QTY, 2, OTR_40_QTY, 3, OTR_45_QTY) AS OTR_QTY
  FROM (SELECT -- 20FT --
               SUM(CASE WHEN SUBSTR(BB.WHF_BND_CD, 2, 1) = 'T' THEN 0 -- OT, IT등 T/S 화물은 0
                        WHEN BB.WFG_EXPT_CD = 'S' AND BB.CUST_RGST_NO = '105-81-59519' THEN CC.TAX_TEU_QTY + CC.EXPT_TEU_QTY
                        ELSE 0
                   END) AS HYO_SUNG_20_QTY,
               SUM(CASE WHEN SUBSTR(BB.WHF_BND_CD, 2, 1) = 'T' THEN 0 -- OT, IT등 T/S 화물은 0
                        WHEN BB.WFG_EXPT_CD = 'S' AND BB.CUST_RGST_NO IN ('401-85-04303', '401-85-08615') THEN CC.TAX_TEU_QTY + CC.EXPT_TEU_QTY
                        ELSE 0
                   END) AS DAE_WOO_20_QTY,
               SUM(CASE WHEN SUBSTR(BB.WHF_BND_CD, 2, 1) = 'T' THEN 0 -- OT, IT등 T/S 화물은 0
                        WHEN BB.WFG_EXPT_CD = 'S' AND BB.CUST_RGST_NO = '137-85-00522' THEN CC.TAX_TEU_QTY + CC.EXPT_TEU_QTY
                        ELSE 0
                   END) AS DONG_BU_20_QTY,
               SUM(CASE WHEN SUBSTR(BB.WHF_BND_CD, 2, 1) = 'T' THEN 0 -- OT, IT등 T/S 화물은 0
                        WHEN BB.WFG_EXPT_CD = 'S' AND BB.CUST_RGST_NO = '416-85-06244' THEN CC.TAX_TEU_QTY + CC.EXPT_TEU_QTY
                        ELSE 0
                   END) AS HYUN_DAI_20_QTY,
               SUM(CASE WHEN SUBSTR(BB.WHF_BND_CD, 2, 1) = 'T' THEN 0 -- OT, IT등 T/S 화물은 0
                        WHEN BB.WFG_EXPT_CD = 'S' AND BB.CUST_RGST_NO = '506-85-03346' THEN CC.TAX_TEU_QTY + CC.EXPT_TEU_QTY
                        ELSE 0
                   END) AS DONG_KUK_20_QTY,
               SUM(CASE WHEN SUBSTR(BB.WHF_BND_CD, 2, 1) = 'T' AND BB.WHF_BL_THRU_TS_FLG = 'Y' THEN CC.TAX_TEU_QTY + CC.EXPT_TEU_QTY + CC.BLK_TEU_QTY
                        ELSE 0
                   END) AS THRU_TS_20_QTY,
               SUM(CASE WHEN SUBSTR(BB.WHF_BND_CD, 2, 1) = 'T' AND BB.WHF_BL_THRU_TS_FLG = 'N' THEN CC.TAX_TEU_QTY + CC.EXPT_TEU_QTY + CC.BLK_TEU_QTY
                        ELSE 0
                   END) AS CUST_TS_20_QTY,
               SUM(CASE WHEN SUBSTR(BB.WHF_BND_CD, 2, 1) = 'T' THEN 0
                        WHEN BB.WHF_BL_CGO_TP_CD = 'R' THEN CC.TAX_TEU_QTY + CC.EXPT_TEU_QTY + CC.BLK_TEU_QTY
                        ELSE 0
                   END) AS REV_MT_20_QTY,
               SUM(CASE WHEN SUBSTR(BB.WHF_BND_CD, 2, 1) = 'T' THEN 0
                        WHEN NVL(CC.KR_WHF_EXPT_CD, 'Z') IN ('Z', 'D', 'B', 'X', 'N', 'S') THEN 0
                        ELSE CC.TAX_TEU_QTY + CC.EXPT_TEU_QTY + CC.BLK_TEU_QTY
                   END) OTR_20_QTY,
               -- 40FT --
               SUM(CASE WHEN SUBSTR(BB.WHF_BND_CD, 2, 1) = 'T' THEN 0 -- OT, IT등 T/S 화물은 0
                        WHEN BB.WFG_EXPT_CD = 'S' AND BB.CUST_RGST_NO = '105-81-59519' THEN CC.TAX_FEU_QTY + CC.EXPT_FEU_QTY
                        ELSE 0
                   END) AS HYO_SUNG_40_QTY,
               SUM(CASE WHEN SUBSTR(BB.WHF_BND_CD, 2, 1) = 'T' THEN 0 -- OT, IT등 T/S 화물은 0
                        WHEN BB.WFG_EXPT_CD = 'S' AND BB.CUST_RGST_NO IN ('401-85-04303', '401-85-08615') THEN CC.TAX_FEU_QTY + CC.EXPT_FEU_QTY
                        ELSE 0
                   END) AS DAE_WOO_40_QTY,
               SUM(CASE WHEN SUBSTR(BB.WHF_BND_CD, 2, 1) = 'T' THEN 0 -- OT, IT등 T/S 화물은 0
                        WHEN BB.WFG_EXPT_CD = 'S' AND BB.CUST_RGST_NO = '137-85-00522' THEN CC.TAX_FEU_QTY + CC.EXPT_FEU_QTY
                        ELSE 0
                   END) AS DONG_BU_40_QTY,
               SUM(CASE WHEN SUBSTR(BB.WHF_BND_CD, 2, 1) = 'T' THEN 0 -- OT, IT등 T/S 화물은 0
                        WHEN BB.WFG_EXPT_CD = 'S' AND BB.CUST_RGST_NO = '416-85-06244' THEN CC.TAX_FEU_QTY + CC.EXPT_FEU_QTY
                        ELSE 0
                   END) AS HYUN_DAI_40_QTY,
               SUM(CASE WHEN SUBSTR(BB.WHF_BND_CD, 2, 1) = 'T' THEN 0 -- OT, IT등 T/S 화물은 0
                        WHEN BB.WFG_EXPT_CD = 'S' AND BB.CUST_RGST_NO = '506-85-03346' THEN CC.TAX_FEU_QTY + CC.EXPT_FEU_QTY
                        ELSE 0
                   END) AS DONG_KUK_40_QTY,
               SUM(CASE WHEN SUBSTR(BB.WHF_BND_CD, 2, 1) = 'T' AND BB.WHF_BL_THRU_TS_FLG = 'Y' THEN CC.TAX_FEU_QTY + CC.EXPT_FEU_QTY + CC.BLK_FEU_QTY
                        ELSE 0
                   END) AS THRU_TS_40_QTY,
               SUM(CASE WHEN SUBSTR(BB.WHF_BND_CD, 2, 1) = 'T' AND BB.WHF_BL_THRU_TS_FLG = 'N' THEN CC.TAX_FEU_QTY + CC.EXPT_FEU_QTY + CC.BLK_FEU_QTY
                        ELSE 0
                   END) AS CUST_TS_40_QTY,
               SUM(CASE WHEN SUBSTR(BB.WHF_BND_CD, 2, 1) = 'T' THEN 0
                        WHEN BB.WHF_BL_CGO_TP_CD = 'R' THEN CC.TAX_FEU_QTY + CC.EXPT_FEU_QTY + CC.BLK_FEU_QTY
                        ELSE 0
                   END) AS REV_MT_40_QTY,
               SUM(CASE WHEN SUBSTR(BB.WHF_BND_CD, 2, 1) = 'T' THEN 0
                        WHEN NVL(CC.KR_WHF_EXPT_CD, 'Z') IN ('Z', 'D', 'B', 'X', 'N', 'S') THEN 0
                        ELSE CC.TAX_FEU_QTY + CC.EXPT_FEU_QTY + CC.BLK_FEU_QTY
                   END) OTR_40_QTY,
               -- 45FT --
               SUM(CASE WHEN SUBSTR(BB.WHF_BND_CD, 2, 1) = 'T' THEN 0 -- OT, IT등 T/S 화물은 0
                        WHEN BB.WFG_EXPT_CD = 'S' AND BB.CUST_RGST_NO = '105-81-59519' THEN CC.TAX_45FT_QTY + CC.EXPT_45FT_QTY
                        ELSE 0
                   END) AS HYO_SUNG_45_QTY,
               SUM(CASE WHEN SUBSTR(BB.WHF_BND_CD, 2, 1) = 'T' THEN 0 -- OT, IT등 T/S 화물은 0
                        WHEN BB.WFG_EXPT_CD = 'S' AND BB.CUST_RGST_NO IN ('401-85-04303', '401-85-08615') THEN CC.TAX_45FT_QTY + CC.EXPT_45FT_QTY
                        ELSE 0
                   END) AS DAE_WOO_45_QTY,
               SUM(CASE WHEN SUBSTR(BB.WHF_BND_CD, 2, 1) = 'T' THEN 0 -- OT, IT등 T/S 화물은 0
                        WHEN BB.WFG_EXPT_CD = 'S' AND BB.CUST_RGST_NO = '137-85-00522' THEN CC.TAX_45FT_QTY + CC.EXPT_45FT_QTY
                        ELSE 0
                   END) AS DONG_BU_45_QTY,
               SUM(CASE WHEN SUBSTR(BB.WHF_BND_CD, 2, 1) = 'T' THEN 0 -- OT, IT등 T/S 화물은 0
                        WHEN BB.WFG_EXPT_CD = 'S' AND BB.CUST_RGST_NO = '416-85-06244' THEN CC.TAX_45FT_QTY + CC.EXPT_45FT_QTY
                        ELSE 0
                   END) AS HYUN_DAI_45_QTY,
               SUM(CASE WHEN SUBSTR(BB.WHF_BND_CD, 2, 1) = 'T' THEN 0 -- OT, IT등 T/S 화물은 0
                        WHEN BB.WFG_EXPT_CD = 'S' AND BB.CUST_RGST_NO = '506-85-03346' THEN CC.TAX_45FT_QTY + CC.EXPT_45FT_QTY
                        ELSE 0
                   END) AS DONG_KUK_45_QTY,
               SUM(CASE WHEN SUBSTR(BB.WHF_BND_CD, 2, 1) = 'T' AND BB.WHF_BL_THRU_TS_FLG = 'Y' THEN CC.TAX_45FT_QTY + CC.EXPT_45FT_QTY + CC.BLK_45FT_QTY
                        ELSE 0
                   END) AS THRU_TS_45_QTY,
               SUM(CASE WHEN SUBSTR(BB.WHF_BND_CD, 2, 1) = 'T' AND BB.WHF_BL_THRU_TS_FLG = 'N' THEN CC.TAX_45FT_QTY + CC.EXPT_45FT_QTY + CC.BLK_45FT_QTY
                        ELSE 0
                   END) AS CUST_TS_45_QTY,
               SUM(CASE WHEN SUBSTR(BB.WHF_BND_CD, 2, 1) = 'T' THEN 0
                        WHEN BB.WHF_BL_CGO_TP_CD = 'R' THEN CC.TAX_45FT_QTY + CC.EXPT_45FT_QTY + CC.BLK_45FT_QTY
                        ELSE 0
                   END) AS REV_MT_45_QTY,
               SUM(CASE WHEN SUBSTR(BB.WHF_BND_CD, 2, 1) = 'T' THEN 0
                        WHEN NVL(CC.KR_WHF_EXPT_CD, 'Z') IN ('Z', 'D', 'B', 'X', 'N', 'S') THEN 0
                        ELSE CC.TAX_FEU_QTY + CC.EXPT_45FT_QTY + CC.BLK_45FT_QTY
                   END) OTR_45_QTY  
          FROM (SELECT B.VSL_CD, B.SKD_VOY_NO, B.SKD_DIR_CD, B.WHF_BND_CD, B.BL_NO, MAX(B.CHG_RT_SEQ) AS CHG_RT_SEQ
                  FROM BKG_KR_WHF_BL A, BKG_KR_WHF_RT B, BKG_BOOKING C
                 WHERE A.VSL_CD = SUBSTR(@[vvd], 1, 4)
                   AND A.SKD_VOY_NO = SUBSTR(@[vvd], 5, 4)
                   AND A.SKD_DIR_CD = SUBSTR(@[vvd], 9, 1)
                   AND DECODE(SUBSTR(@[whf_bnd_cd], 1, 1), 'O', A.WHF_POL_CD, A.WHF_POD_CD) = @[port_cd]
                   AND A.WHF_BL_STS_CD != 'D'
                   AND A.WHF_BND_CD = DECODE(@[whf_bnd_cd], 'IN', 'II', @[whf_bnd_cd])
                   AND B.VSL_CD = A.VSL_CD
                   AND B.SKD_VOY_NO = A.SKD_VOY_NO
                   AND B.SKD_DIR_CD = A.SKD_DIR_CD
                   AND B.WHF_BND_CD = A.WHF_BND_CD
                   AND B.BL_NO = A.BL_NO
                   AND C.BL_NO = A.BL_NO
                   AND C.BKG_CGO_TP_CD != 'P'
                 GROUP BY B.VSL_CD, B.SKD_VOY_NO, B.SKD_DIR_CD, B.WHF_BND_CD, B.BL_NO) AA,
               BKG_KR_WHF_BL BB,
               BKG_KR_WHF_RT CC
         WHERE BB.VSL_CD = AA.VSL_CD
           AND BB.SKD_VOY_NO = AA.SKD_VOY_NO
           AND BB.SKD_DIR_CD = AA.SKD_DIR_CD
           AND BB.WHF_BND_CD = AA.WHF_BND_CD
           AND BB.BL_NO = AA.BL_NO
           AND CC.VSL_CD = AA.VSL_CD
           AND CC.SKD_VOY_NO = AA.SKD_VOY_NO
           AND CC.SKD_DIR_CD = AA.SKD_DIR_CD
           AND CC.WHF_BND_CD = AA.WHF_BND_CD
           AND CC.BL_NO = AA.BL_NO
           AND CC.CHG_RT_SEQ = AA.CHG_RT_SEQ),
       (SELECT 1 AS RNUM FROM DUAL UNION ALL
        SELECT 2 FROM DUAL UNION ALL
        SELECT 3 FROM DUAL)			]]></sql>
			<params>
				<param name="vvd" type="12" value="" out="N"/>
				<param name="whf_bnd_cd" type="12" value="" out="N"/>
				<param name="port_cd" type="12" value="" out="N"/>
			</params>
		</query>
	</querys>
</sqls>
