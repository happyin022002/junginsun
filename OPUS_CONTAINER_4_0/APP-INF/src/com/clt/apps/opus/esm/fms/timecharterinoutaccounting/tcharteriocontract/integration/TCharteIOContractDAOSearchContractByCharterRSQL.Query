<?xml version="1.0" encoding="UTF-8"?>
<sqls>
	<querys>
		<query name="TCharteIOContractDAOSearchContractByCharterRSQL">
			<desc><![CDATA[TCharteIOContractDAOSearchContractByCharterRSQL]]></desc>
			<sql><![CDATA[
select  flet_ctrt_no,
		vsl_cd,
		vsl_eng_nm,
		flet_ctrt_tp_cd,
		vndr_lgl_eng_nm,
		cust_cnt_cd,
		cust_seq,
		ownr_nm,
		DECODE(exist,null,'I','') ibflag
from (
	select  fc.flet_ctrt_no,
			fc.vsl_cd,
			(select vsl_eng_nm from mdm_vsl_cntr where vsl_cd = fc.vsl_cd and rownum =1) vsl_eng_nm,
		    DECODE(fc.flet_ctrt_tp_cd,'TI','T/C In','TO','T/C Out','OW','Ownership') flet_ctrt_tp_cd, 
			CASE WHEN fc.flet_ctrt_tp_cd = 'TO' THEN 
					  (select mv.cust_lgl_eng_nm 
						 from mdm_customer mv, fms_owner fo 
						where cust_cnt_cd = fc.cust_cnt_cd 
						  and cust_seq = fc.cust_seq 
						  and mv.flet_mgmt_ownr_cust_seq = fo.ownr_seq 
						  and rownum =1) 
				 ELSE 
					  (select mv.vndr_lgl_eng_nm 
						 from mdm_vendor mv, fms_owner fo 
						where vndr_seq = fc.vndr_seq 
						  and mv.flet_mgmt_ownr_vndr_seq = fo.ownr_seq 
						  and rownum =1) 
			END vndr_lgl_eng_nm, 
			fc.cust_cnt_cd, 
			DECODE(fc.cust_seq,null,fc.vndr_seq,fc.cust_seq) cust_seq, 
			CASE WHEN fc.flet_ctrt_tp_cd = 'TO' THEN 
					  (select fo.ownr_nm 
						 from mdm_customer mv, fms_owner fo 
						where cust_cnt_cd = fc.cust_cnt_cd 
						  and cust_seq = fc.cust_seq 
						  and mv.flet_mgmt_ownr_cust_seq = fo.ownr_seq 
						  and rownum =1) 
				 ELSE 
					  (select fo.ownr_nm 
						 from mdm_vendor mv, fms_owner fo 
						where vndr_seq = fc.vndr_seq 
						  and mv.flet_mgmt_ownr_vndr_seq = fo.ownr_seq 
						  and rownum =1) 
			END ownr_nm,
			(select flet_ctrt_no from fms_invoice where flet_ctrt_no = @[flet_ctrt_no] and flet_iss_tp_cd = 'CHT' and rownum = 1) exist
	  from  fms_contract fc
	 where  fc.flet_ctrt_no = @[flet_ctrt_no]
	   and  rownum = 1
   )			]]></sql>
			<params>
				<param name="flet_ctrt_no" type="12" value="" out="N"/>
			</params>
		</query>
	</querys>
</sqls>
