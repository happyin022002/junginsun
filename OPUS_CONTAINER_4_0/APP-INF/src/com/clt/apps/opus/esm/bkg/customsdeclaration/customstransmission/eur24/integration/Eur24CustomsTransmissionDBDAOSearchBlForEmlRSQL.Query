<?xml version="1.0" encoding="UTF-8"?>
<sqls>
	<querys>
		<query name="Eur24CustomsTransmissionDBDAOSearchBlForEmlRSQL">
			<desc><![CDATA[]]></desc>
			<sql><![CDATA[
#if (${ibflag} == 'ENS') 
SELECT A.EUR_EDI_MSG_TP_ID
      ,A.VSL_CD
      ,A.SKD_VOY_NO
      ,A.SKD_DIR_CD
      ,A.VSL_CD || A.SKD_VOY_NO || A.SKD_DIR_CD AS VVD
      ,A.CSTMS_PORT_CD
      ,A.BL_NO
      ,A.EDI_RCV_DT
      ,A.EDI_RCV_SEQ
      ,B.RVIS_N1ST_CLPT_CD
      ,C.POL_CD
      ,C.POD_CD
      ,(SELECT OFC_ENG_NM
          FROM MDM_ORGANIZATION M
              ,BKG_BL_ISS       S
              ,BKG_BOOKING      BKG
         WHERE S.OBL_ISS_OFC_CD = M.OFC_CD
           AND S.BKG_NO         = BKG.BKG_NO
           AND BKG.BL_NO        = C.BL_NO
       ) AS OFC_ENG_NM
  FROM (SELECT A.EUR_EDI_MSG_TP_ID
              ,A.VSL_CD
              ,A.SKD_VOY_NO
              ,A.SKD_DIR_CD
              ,A.CSTMS_PORT_CD
              ,A.BL_NO
              ,B.EDI_RCV_DT
              ,B.EDI_RCV_SEQ
          FROM BKG_CSTMS_ADV_EUR_SND A
              ,BKG_CSTMS_ADV_EUR_RCV B
         WHERE A.MSG_SND_NO = B.MSG_RCV_NO
           AND B.EDI_RCV_DT = @[edi_rcv_dt]
           AND B.EDI_RCV_SEQ = @[edi_rcv_seq]
       ) A
       ,BKG_CSTMS_EUR_VSL B
       ,BKG_CSTMS_EUR_BL  C
 WHERE A.VSL_CD        = B.VSL_CD(+)
   AND A.SKD_VOY_NO    = B.SKD_VOY_NO(+)
   AND A.SKD_DIR_CD    = B.SKD_DIR_CD(+)
   AND A.CSTMS_PORT_CD = B.CSTMS_PORT_CD(+)
   AND A.VSL_CD        = C.VSL_CD(+)
   AND A.SKD_VOY_NO    = C.SKD_VOY_NO(+)
   AND A.SKD_DIR_CD    = C.SKD_DIR_CD(+)
   AND A.CSTMS_PORT_CD = C.CSTMS_PORT_CD(+)
   AND A.BL_NO         = C.BL_NO(+)
#else
SELECT A.EUR_EDI_MSG_TP_ID
      ,A.VSL_CD
      ,A.SKD_VOY_NO
      ,A.SKD_DIR_CD
      ,A.VSL_CD || A.SKD_VOY_NO || A.SKD_DIR_CD AS VVD
      ,A.CSTMS_PORT_CD
      ,A.BL_NO
      ,B.EDI_RCV_DT
      ,B.EDI_RCV_SEQ
      ,'' RVIS_N1ST_CLPT_CD
      ,C.POL_CD
      ,C.POD_CD
  FROM BKG_CSTMS_EUR_IO_SND A
      ,BKG_CSTMS_EUR_IO_RCV B
      ,BKG_CSTMS_EUR_IO_BL  C
 WHERE B.BND_TP_CD   = 'O'
   AND B.EDI_RCV_DT  = @[edi_rcv_dt]
   AND B.EDI_RCV_SEQ = @[edi_rcv_seq]
   AND B.MSG_RCV_NO  = A.MSG_SND_NO(+)
   AND A.BL_NO       = C.BL_NO(+)
#end			]]></sql>
			<params>
				<param name="edi_rcv_dt" type="12" value="" out="N"/>
				<param name="edi_rcv_seq" type="12" value="" out="N"/>
			</params>
		</query>
	</querys>
</sqls>
