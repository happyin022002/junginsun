<?xml version="1.0" encoding="UTF-8"?>
<sqls>
	<querys>
		<query name="Eur24CustomsTransmissionDBDAOSearchBlForEdiErrRSQL">
			<desc><![CDATA[]]></desc>
			<sql><![CDATA[
SELECT DECODE(A.EUR_EDI_MSG_TP_ID, 'DIV', 'Diversion', 'ARN', 'AN', A.EUR_EDI_MSG_TP_ID) AS EUR_EDI_MSG_TP_ID
      ,A.VSL_CD
      ,A.SKD_VOY_NO
      ,A.SKD_DIR_CD
      ,A.VSL_CD || A.SKD_VOY_NO || A.SKD_DIR_CD AS VVD
      ,A.CSTMS_PORT_CD
      ,A.BL_NO
      ,C.POL_CD
      ,NVL(C.POD_CD, A.CSTMS_PORT_CD) AS POD_CD
      ,B.RVIS_N1ST_CLPT_CD
  FROM BKG_CSTMS_ADV_EUR_SND A
      ,BKG_CSTMS_EUR_VSL     B
      ,BKG_CSTMS_EUR_BL      C
 WHERE A.VSL_CD        = B.VSL_CD(+)
   AND A.SKD_VOY_NO    = B.SKD_VOY_NO(+)
   AND A.SKD_DIR_CD    = B.SKD_DIR_CD(+)
   AND A.CSTMS_PORT_CD = B.CSTMS_PORT_CD(+)
   AND A.VSL_CD        = C.VSL_CD(+)
   AND A.SKD_VOY_NO    = C.SKD_VOY_NO(+)
   AND A.SKD_DIR_CD    = C.SKD_DIR_CD(+)
   AND A.CSTMS_PORT_CD = C.CSTMS_PORT_CD(+)
   AND A.BL_NO         = C.BL_NO(+)
   AND A.EDI_SND_MSG_CTNT LIKE '%' || @[msg_key] || '%'
   AND A.SND_DT > SYSDATE - 1
UNION ALL
SELECT A.EUR_EDI_MSG_TP_ID
      ,A.VSL_CD
      ,A.SKD_VOY_NO
      ,A.SKD_DIR_CD
      ,A.VSL_CD || A.SKD_VOY_NO || A.SKD_DIR_CD AS VVD
      ,A.CSTMS_PORT_CD
      ,A.BL_NO
      ,C.POL_CD
      ,C.POD_CD
      ,'' AS RVIS_N1ST_CLPT_CD
  FROM BKG_CSTMS_EUR_IO_SND  A
      ,BKG_CSTMS_EUR_BL      C
 WHERE A.VSL_CD        = C.VSL_CD
   AND A.SKD_VOY_NO    = C.SKD_VOY_NO
   AND A.SKD_DIR_CD    = C.SKD_DIR_CD
   AND A.CSTMS_PORT_CD = C.CSTMS_PORT_CD
   AND A.BL_NO         = C.BL_NO
   AND A.EDI_SND_MSG_CTNT LIKE '%' || @[msg_key] || '%'
   AND A.SND_DT > SYSDATE - 1			]]></sql>
			<params>
				<param name="msg_key" type="12" value="" out="N"/>
			</params>
		</query>
	</querys>
</sqls>
