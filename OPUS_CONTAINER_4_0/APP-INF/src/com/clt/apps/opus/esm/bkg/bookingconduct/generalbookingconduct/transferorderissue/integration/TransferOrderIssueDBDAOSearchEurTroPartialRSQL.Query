<?xml version="1.0" encoding="UTF-8"?>
<sqls>
	<querys>
		<query name="TransferOrderIssueDBDAOSearchEurTroPartialRSQL">
			<desc><![CDATA[Tro confirm시 같은 cntr를 다른 bkg에서 confirm하는 지 확인한다.]]></desc>
			<sql><![CDATA[
select bk2.bkg_no
  from bkg_eur_tro tro1
        , bkg_booking bk1
        , bkg_container cntr1
        , bkg_container cntr2
        , bkg_booking bk2
        , bkg_eur_tro tro2
 where tro1.bkg_no	      = @[bkg_no]
   and tro1.cntr_no       = @[cntr_no]
   and tro1.io_bnd_cd     = @[io_bnd_cd]
   and tro1.tro_seq       = @[tro_seq]
   and tro1.bkg_no        = bk1.bkg_no --해당 tro의 bkg의 
   and tro1.bkg_no        = cntr1.bkg_no --cntr가 
   and tro1.cntr_no       = cntr1.cntr_no --confirm하려는 tro에 assign되있는 데
   and cntr1.cntr_no      = cntr2.cntr_no --같은 cntr가
   AND nvl(CNTR1.CNMV_ID_NO , 0)   = nvl(CNTR2.CNMV_ID_NO , 0)
   AND nvl(CNTR1.CNMV_CYC_NO, 0)   = nvl(CNTR2.CNMV_CYC_NO, 0)   
   AND nvl(CNTR1.CNMV_YR    , 'X') = nvl(CNTR2.CNMV_YR    , 'X')
   and bk1.bkg_no         <> bk2.bkg_no --다른 bkg의 
   and tro2.bkg_no        = bk2.bkg_no --tro에 
   and tro2.bkg_no		  = cntr2.bkg_no
   and tro2.cntr_no       = cntr2.cntr_no --assign되있고
   and bk2.bkg_sts_cd     <> 'X' --cancel bkg도 아니고
   and tro2.cfm_flg       = 'Y' --confirm 되어 있는 tro가 
   and rownum			  = 1 --하나라도 잇으면 confirm 불가			]]></sql>
			<params>
				<param name="bkg_no" type="12" value="NBO9BD17418A1" out="N"/>
				<param name="cntr_no" type="12" value="HJCU8234857" out="N"/>
				<param name="io_bnd_cd" type="12" value="I" out="N"/>
				<param name="tro_seq" type="12" value="1" out="N"/>
			</params>
		</query>
	</querys>
</sqls>
