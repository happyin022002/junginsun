<?xml version="1.0" encoding="UTF-8"?>
<sqls>
	<querys>
		<query name="StatusReportDBDAOBkgRptDownExcel1705HGRSQL">
			<desc><![CDATA[BkgRptDownExcel1705HG
2015.05.30 decide to delete HG type.]]></desc>
			<sql><![CDATA[
#if (${sel_cols} != '') 
SELECT ${sel_cols}
#else 
SELECT *
#end
FROM (
    SELECT
         '1' AS TEMP
        ,'GOH Info' AS 	MER_HNGR_QTY
        ,'GOH Info' AS 	CRR_HNGR_DBL_BAR_QTY
        ,'GOH Info' AS 	CRR_HNGR_SGL_BAR_QTY
        ,'GOH Info' AS 	CRR_HNGR_TPL_BAR_QTY
        ,'BKG & B/L Info' AS 	BL_NO
        ,'BKG & B/L Info' AS 	BL_RLSE_OFC
        ,'BKG & B/L Info' AS 	BKG_CRE_DT
        ,'BKG & B/L Info' AS 	BKG_STAFF
        ,'BKG & B/L Info' AS 	BKG_NO
        ,'BKG & B/L Info' AS 	BKG_OFC_CD
        ,'BKG & B/L Info' AS 	INTER_RMK
        ,'BKG & B/L Info' AS 	DG_CERTI
        ,'BKG & B/L Info' AS 	XPT_DECL_RCV
        ,'BKG & B/L Info' AS 	STOP_OFF_LOC_CD
        ,'BKG & B/L Info' AS 	SLS_AREA
        ,'BKG & B/L Info' AS 	OB_SLS_OFC_CD
        ,'BKG & B/L Info' AS 	OB_SREP_CD
        ,'BKG & B/L Info' AS 	CTRL_PTY
        ,'BKG & B/L Info' AS 	SI_FLG
        ,'BKG & B/L Info' AS 	SPCL_HND_RMK
        ,'BKG & B/L Info' AS 	STOP_OFF_DIFF_RMK
        ,'Cargo & Commodity' AS 	BKG_STS
        ,'Cargo & Commodity' AS 	CGO_N
        ,'Cargo & Commodity' AS 	CMDT_DESC
        ,'Cargo & Commodity' AS 	IB_HLG
        ,'Cargo & Commodity' AS 	OB_HLG
        ,'Cargo & Commodity' AS 	MARK_NOS
        ,'Cargo & Commodity' AS 	PCK_DESC
        ,'Cargo & Commodity' AS 	FRT_TERM_CD
        ,'Cargo & Commodity' AS 	XTER_RMK
        ,'Cargo & Commodity' AS 	SEGR_GRP
        ,'Cargo & Commodity' AS 	STWG_RQST_DTL
        ,'Cargo & Commodity' AS 	STWG_RQST_TYPE
        ,'Cargo & Commodity' AS 	VENUS_STS
        ,'Container' AS 	ACT_PKUP_DT
        ,'Container' AS 	ACT_RTN_DT
        ,'Container' AS 	CGO_WGT
        ,'Container' AS 	CGO_WGT_UT_CD
        ,'Container' AS 	MEAS_QTY
        ,'Container' AS 	MEAS_UT_CD
        ,'Container' AS 	CNTR_NO
        ,'Container' AS 	CNTR_TPSZ_CD
        ,'Container' AS 	CNMV_STS_CD
        ,'Container' AS 	MTY_PKUP_LOC
        ,'Container' AS 	MTY_RTN_LOC
        ,'Container' AS 	ESTM_PKUP_DT
        ,'Container' AS 	ESTM_RTN_DT
        ,'Container' AS 	FULL_RTN_YD_CD
        ,'Container' AS 	SEAL_NO
        ,'Container' AS 	SOC_FLG
        ,'Container' AS 	SUBST_TYPE
        ,'Customer' AS 	CNEE_ADDR
        ,'Customer' AS 	NTFY_ADDR
        ,'Customer' AS 	SHPR_ADDR
        ,'Customer' AS 	CNEE_NM
        ,'Customer' AS 	FFWD_CNTC_NO
        ,'Customer' AS 	FFWD_CNTC_NM
        ,'Customer' AS 	NTFY_PARTY
        ,'Customer' AS 	POR_EMER_CNTC_NM
        ,'Customer' AS 	POR_EMER_CNTC_NO
        ,'Customer' AS 	SHPR_CNTC_NM
        ,'Customer' AS 	SHPR_CNTC_NO
        ,'Customer' AS 	SHPR_NM
        ,'Rate & Invoice' AS 	SC_RFA_NO
        ,'Rate & Invoice' AS 	PROP_NO
        ,'Rate & Invoice' AS 	TAA_NO
        ,'Route & Schedule' AS 	N1_V_DIR
        ,'Route & Schedule' AS 	N1_V_SVC
        ,'Route & Schedule' AS 	N1_V_VVD
        ,'Route & Schedule' AS 	N1_V_VSL_CD
        ,'Route & Schedule' AS 	N1_V_VSL_NM
        ,'Route & Schedule' AS 	N1_V_VOY_NO
        ,'Route & Schedule' AS 	N2_V_VVD
        ,'Route & Schedule' AS 	N3_V_VVD
        ,'Route & Schedule' AS 	N4_V_VVD
        ,'Route & Schedule' AS 	POD_ETB
        ,'Route & Schedule' AS 	POL_ETB
        ,'Route & Schedule' AS 	POD_NOD_CD
        ,'Route & Schedule' AS 	POL_NOD_CD
        ,'Route & Schedule' AS 	BLCK_STWG_CD
        ,'Route & Schedule' AS 	BOUND
        ,'Route & Schedule' AS 	N1_POL_CNT_CD
        ,'Route & Schedule' AS 	FM_CTY_CNT_CD
        ,'Route & Schedule' AS 	LST_POD_CNT_CD
        ,'Route & Schedule' AS 	TO_CTY_CNT_CD
        ,'Route & Schedule' AS 	ETA
        ,'Route & Schedule' AS 	ETD
        ,'Route & Schedule' AS 	FNL_DEST_CD
        ,'Route & Schedule' AS 	FIRST_POL
        ,'Route & Schedule' AS 	POL_CUTOFF_DT
        ,'Route & Schedule' AS 	POR_CD
        ,'Route & Schedule' AS 	LAST_POD
        ,'Route & Schedule' AS 	TRUNK_VVD
        ,'Route & Schedule' AS 	DEL_CD
        ,'Route & Schedule' AS 	POD_CD
        ,'Route & Schedule' AS 	POL_CD
        ,'Route & Schedule' AS 	VPS_ETD_DT
        ,'Route & Schedule' AS 	SERVICE
        ,'Route & Schedule' AS 	TO_CITY
        ,'Route & Schedule' AS 	TRD_CD
        ,'Route & Schedule' AS 	TRF_MODE
        ,'Route & Schedule' AS 	TRSP_MOD
        ,'Route & Schedule' AS 	TS_PORT_1
        ,'Route & Schedule' AS 	TS_PORT_2
        ,'Route & Schedule' AS 	TS_PORT_3
    FROM DUAL
    UNION ALL
    SELECT
         '2' AS TEMP
        ,'Hanger Installation Order - M HGR' AS 	MER_HNGR_QTY
        ,'Hanger Installation Order - Double' AS 	CRR_HNGR_DBL_BAR_QTY
        ,'Hanger Installation Order - Single' AS 	CRR_HNGR_SGL_BAR_QTY
        ,'Hanger Installation Order - Triple' AS 	CRR_HNGR_TPL_BAR_QTY
        ,'B/L No.' AS 	BL_NO
        ,'B/L Release OFC' AS 	BL_RLSE_OFC
        ,'BKG Creation Date' AS 	BKG_CRE_DT
        ,'BKG Creator' AS 	BKG_STAFF
        ,'BKG No.' AS 	BKG_NO
        ,'BKG OFC' AS 	BKG_OFC_CD
        ,'BKG Remarks' AS 	INTER_RMK
        ,'DG Certificate Rsvd.' AS 	DG_CERTI
        ,'Export Declaration Rcvd.' AS 	XPT_DECL_RCV
        ,'Stop Off Location' AS 	STOP_OFF_LOC_CD
        ,'Sales Area' AS 	SLS_AREA
        ,'Sales OFC' AS 	OB_SLS_OFC_CD
        ,'Sales Representative' AS 	OB_SREP_CD
        ,'Shipment Control Party' AS 	CTRL_PTY
        ,'SI & B/L Master Rcvd' AS 	SI_FLG
        ,'Special Handling Instructions' AS 	SPCL_HND_RMK
        ,'Stop Off Cargo Order Remarks' AS 	STOP_OFF_DIFF_RMK
        ,'BKG Status' AS 	BKG_STS
        ,'Cargo Nature' AS 	CGO_N
        ,'CMDT Name' AS 	CMDT_DESC
        ,'IB Haulage Type' AS 	IB_HLG
        ,'OB Haulage Type' AS 	OB_HLG
        ,'Marks and No.s' AS 	MARK_NOS
        ,'No. and Type of PKGs' AS 	PCK_DESC
        ,'Payment Term' AS 	FRT_TERM_CD
        ,'Remarks' AS 	XTER_RMK
        ,'Segregation Group' AS 	SEGR_GRP
        ,'Stowage Special Request Detail' AS 	STWG_RQST_DTL
        ,'Stowage Special Request Type' AS 	STWG_RQST_TYPE
        ,'Venus Status (DG)' AS 	VENUS_STS
        ,'Actual Pick Up Date/Time' AS 	ACT_PKUP_DT
        ,'Actual Return Date/Time' AS 	ACT_RTN_DT
        ,'Cargo WGT' AS 	CGO_WGT
        ,'Cargo WGT Unit' AS 	CGO_WGT_UT_CD
        ,'GRS MEA' AS 	MEAS_QTY
        ,'GRS MEA Unit' AS 	MEAS_UT_CD
        ,'CNTR No.' AS 	CNTR_NO
        ,'CNTR Size Type' AS 	CNTR_TPSZ_CD
        ,'CNTR Status' AS 	CNMV_STS_CD
        ,'Empty Pickup location' AS 	MTY_PKUP_LOC
        ,'Empty Return Location' AS 	MTY_RTN_LOC
        ,'Estd Pick Up Date/Time' AS 	ESTM_PKUP_DT
        ,'Estd Return Date/Time' AS 	ESTM_RTN_DT
        ,'Full Return Location' AS 	FULL_RTN_YD_CD
        ,'Seal No.' AS 	SEAL_NO
        ,'SOC' AS 	SOC_FLG
        ,'Substitution Type' AS 	SUBST_TYPE
        ,'Address of CNEE' AS 	CNEE_ADDR
        ,'Address of NTFY' AS 	NTFY_ADDR
        ,'Address of SHPR' AS 	SHPR_ADDR
        ,'CNEE Name' AS 	CNEE_NM
        ,'FWDR Contact No.' AS 	FFWD_CNTC_NO
        ,'FWDR Emergency Contact Name' AS 	FFWD_CNTC_NM
        ,'NTFY Party' AS 	NTFY_PARTY
        ,'POR Emergency Contact Name' AS 	POR_EMER_CNTC_NM
        ,'POR Emergency Contact No.' AS 	POR_EMER_CNTC_NO
        ,'SHPR Contact Name' AS 	SHPR_CNTC_NM
        ,'SHPR Contact No.' AS 	SHPR_CNTC_NO
        ,'SHPR Name' AS 	SHPR_NM
        ,'SC/Rate Agreement No' AS 	SC_RFA_NO
        ,'Service Agreement no' AS 	PROP_NO
        ,'Tariff No' AS 	TAA_NO
        ,'1st Direction' AS 	N1_V_DIR
        ,'1st Service' AS 	N1_V_SVC
        ,'1st SVVD' AS 	N1_V_VVD
        ,'1st Vessel Code' AS 	N1_V_VSL_CD
        ,'1st Vessel Name' AS 	N1_V_VSL_NM
        ,'1st Voyage' AS 	N1_V_VOY_NO
        ,'2nd  SVVD ' AS 	N2_V_VVD
        ,'3rd SVVD' AS 	N3_V_VVD
        ,'4th SVVD' AS 	N4_V_VVD
        ,'Berth at First Port of Load Date' AS 	POD_ETB
        ,'Berth at Last Port of Discharge Date' AS 	POL_ETB
        ,'Berth at POD' AS 	POD_NOD_CD
        ,'Berth at POL' AS 	POL_NOD_CD
        ,'Block Stowage' AS 	BLCK_STWG_CD
        ,'Bound' AS 	BOUND
        ,'Country of First Load Port' AS 	N1_POL_CNT_CD
        ,'Country of From City' AS 	FM_CTY_CNT_CD
        ,'Country of Last Discharge Port' AS 	LST_POD_CNT_CD
        ,'Country of To City' AS 	TO_CTY_CNT_CD
        ,'Estimated Date of Arrival (ETA)' AS 	ETA
        ,'Estimated Date of Departure (ETD)' AS 	ETD
        ,'Final Destination' AS 	FNL_DEST_CD
        ,'First Load Port' AS 	FIRST_POL
        ,'First Load Port Cut-Off Date' AS 	POL_CUTOFF_DT
        ,'From City' AS 	POR_CD
        ,'Last Discharge Port' AS 	LAST_POD
        ,'Mother SVVD' AS 	TRUNK_VVD
        ,'Place of Delivery' AS 	DEL_CD
        ,'Port of Discharge' AS 	POD_CD
        ,'Port of Load' AS 	POL_CD
        ,'Sailing Date at First POL' AS 	VPS_ETD_DT
        ,'Service' AS 	SERVICE
        ,'To City' AS 	TO_CITY
        ,'Trade ' AS 	TRD_CD
        ,'Traffic Mode' AS 	TRF_MODE
        ,'Transport Mode' AS 	TRSP_MOD
        ,'T/S Port 1' AS 	TS_PORT_1
        ,'T/S Port 2' AS 	TS_PORT_2
        ,'T/S Port 3' AS 	TS_PORT_3
    FROM DUAL
    UNION ALL
    
    SELECT '3' AS TEMP
    -- GOH CARGO DETAILS
    -----------------------------------------------------------
         , TO_CHAR(QTY.MER_HNGR_QTY) MER_HNGR_QTY
         , TO_CHAR(QTY.CRR_HNGR_DBL_BAR_QTY) CRR_HNGR_DBL_BAR_QTY
         , TO_CHAR(QTY.CRR_HNGR_SGL_BAR_QTY) CRR_HNGR_SGL_BAR_QTY
         , TO_CHAR(QTY.CRR_HNGR_TPL_BAR_QTY) CRR_HNGR_TPL_BAR_QTY
    -- BKG & B/L Info
    -----------------------------------------------------------
         , BK.BL_NO
         , (SELECT USR.OFC_CD FROM BKG_DOC_PROC_SKD PROC, COM_USER USR
             WHERE PROC.BKG_DOC_PROC_TP_CD = 'OBLREL'
               AND PROC.BKG_NO = BK.BKG_NO
               AND PROC.DOC_PERF_DELT_FLG ='N'
               AND PROC.EVNT_USR_ID = USR.USR_ID) AS BL_RLSE_OFC
         , TO_CHAR(BK.BKG_CRE_DT, 'YYYY-MM-DD') BKG_CRE_DT
         , BK.DOC_USR_ID BKG_STAFF
         , BK.BKG_NO
         , BK.BKG_OFC_CD
         , REPLACE(BK.INTER_RMK,CHR(10),' ') INTER_RMK
         , CASE WHEN (SELECT COUNT(1) FROM BKG_IMG_STO IMG WHERE IMG.BKG_NO = BK.BKG_NO AND IMG.RIDR_TP_CD = 'D') > 0 THEN 'Y' ELSE 'N' END DG_CERTI
         , DECODE(NVL(MRN.CUST_REF_NO_CTNT,''),'','N','Y') AS XPT_DECL_RCV
         , BK.STOP_OFF_LOC_CD
         , (SELECT LOC_CD FROM MDM_ORGANIZATION WHERE OFC_CD = BK.BKG_OFC_CD) AS SLS_AREA
         , BK.OB_SLS_OFC_CD
         , BK.OB_SREP_CD
         , '' CTRL_PTY
         , BK.SI_FLG
         , BK.STWG_CD SPCL_HND_RMK
         , REPLACE(BK.STOP_OFF_DIFF_RMK,CHR(10),' ') STOP_OFF_DIFF_RMK
    -- Cargo & Commodity
    -----------------------------------------------------------
         , (SELECT INTG_CD_VAL_DP_DESC
              FROM COM_INTG_CD_DTL 
             WHERE INTG_CD_ID = 'CD00769'
               AND INTG_CD_VAL_CTNT = BK.BKG_STS_CD) BKG_STS
         , NVL(SUBSTR(DECODE(BK.DCGO_FLG,'Y',',DG','')||DECODE(BK.RC_FLG,'Y',',RF','')||DECODE(BK.AWK_CGO_FLG,'Y',',AW','')||DECODE(BK.BB_CGO_FLG,'Y',',BB','')||DECODE(BK.RD_CGO_FLG,'Y',',RD',''),2),'DR') AS CGO_N
         , (SELECT CMDT_NM FROM MDM_COMMODITY CMDT WHERE CMDT.CMDT_CD = BK.CMDT_CD) CMDT_DESC
         , NVL((SELECT DECODE(TRO.HLG_TP_CD, 'C', 'C', 'M')
                  FROM BKG_EUR_TRO TRO
                 WHERE TRO.BKG_NO = BK.BKG_NO
                   AND TRO.CNTR_NO = CNTR.CNTR_NO
                   AND TRO.IO_BND_CD = 'I'
                   AND TRO.CXL_FLG = 'N'), DECODE(BK.DE_TERM_CD, 'D', 'C', 'M')) AS IB_HLG
         , DECODE(BK.RCV_TERM_CD, 'D', 'C', 'M') AS OB_HLG
         , (SELECT REPLACE(TO_CHAR(MK.MK_DESC),CHR(10),' ')
              FROM BKG_BL_MK_DESC MK
             WHERE BK.BKG_NO = MK.BKG_NO
               AND MK.MK_SEQ = 1) MARK_NOS
         , BL.PCK_QTY||(SELECT PCK_NM FROM MDM_PCK_TP PCK WHERE BL.PCK_TP_CD = PCK.PCK_CD) PCK_DESC
         , RATE.FRT_TERM_CD
         , REPLACE(BK.XTER_RMK,CHR(10),' ') XTER_RMK
         , (SELECT SEGR.IMDG_SEGR_GRP_NO || '-' || SEGR.IMDG_SEGR_GRP_NM 
              FROM BKG_DG_CGO DG, SCG_IMDG_SEGR_GRP SEGR, SCG_IMDG_UN_NO_SEGR_GRP UN_GRP
             WHERE BK.BKG_NO         = DG.BKG_NO
               AND DG.IMDG_UN_NO     = UN_GRP.IMDG_UN_NO
               AND DG.IMDG_UN_NO_SEQ = UN_GRP.IMDG_UN_NO_SEQ
               AND SEGR.IMDG_SEGR_GRP_NO = UN_GRP.IMDG_SEGR_GRP_NO
               AND ROWNUM = 1) SEGR_GRP
         , REPLACE(BK.STWG_RMK,CHR(10),' ') STWG_RQST_DTL
         , (SELECT INTG_CD_VAL_DP_DESC
              FROM COM_INTG_CD_DTL 
             WHERE INTG_CD_ID = 'CD02094'
               AND INTG_CD_VAL_CTNT = BK.STWG_CD) STWG_RQST_TYPE
         , CASE WHEN (SELECT COUNT(1) FROM BKG_DG_CGO DG WHERE DG.BKG_NO = BK.BKG_NO) = 0 THEN ''
                WHEN (SELECT COUNT(1) FROM BKG_DG_CGO DG WHERE DG.BKG_NO = BK.BKG_NO AND SPCL_CGO_APRO_CD = 'P') > 0 THEN 'P'
                WHEN (SELECT COUNT(1) FROM BKG_DG_CGO DG WHERE DG.BKG_NO = BK.BKG_NO AND SPCL_CGO_APRO_CD = 'N') > 0 THEN 'N'
                WHEN (SELECT COUNT(1) FROM BKG_DG_CGO DG WHERE DG.BKG_NO = BK.BKG_NO AND SPCL_CGO_APRO_CD <> 'C')
                    = (SELECT COUNT(1) FROM BKG_DG_CGO DG WHERE DG.BKG_NO = BK.BKG_NO AND SPCL_CGO_APRO_CD = 'Y') THEN 'Y' 
           END VENUS_STS
    -- Container
    -----------------------------------------------------------
         , (SELECT TO_CHAR(CNMV_EVNT_DT,'YYYY-MM-DD HH24:MI')
              FROM CTM_MOVEMENT CTM 
             WHERE CTM.CNTR_NO = CNTR.CNTR_NO
               AND CTM.CNMV_YR = CNTR.CNMV_YR
               AND CTM.CNMV_ID_NO = CNTR.CNMV_ID_NO
               AND CTM.MVMT_STS_CD = 'OP') ACT_PKUP_DT
         , (SELECT TO_CHAR(CNMV_EVNT_DT,'YYYY-MM-DD HH24:MI')
              FROM CTM_MOVEMENT CTM 
             WHERE CTM.CNTR_NO = CNTR.CNTR_NO
               AND CTM.CNMV_YR = CNTR.CNMV_YR
               AND CTM.CNMV_ID_NO = CNTR.CNMV_ID_NO
               AND CTM.MVMT_STS_CD = 'OC') ACT_RTN_DT
         , TO_CHAR(CNTR.CNTR_WGT) CGO_WGT
         , CNTR.WGT_UT_CD CGO_WGT_UT_CD
         , TO_CHAR(CNTR.MEAS_QTY) MEAS_QTY
         , CNTR.MEAS_UT_CD
         , CNTR.CNTR_NO
         , CNTR.CNTR_TPSZ_CD
         , CNTR.CNMV_STS_CD
         , (SELECT SUBSTR(PRD.MTY_PKUP_YD_CD, 1, 5) FROM PRD_PROD_CTL_MST PRD WHERE PRD.PCTL_NO = BK.PCTL_NO) MTY_PKUP_LOC
         , (SELECT SUBSTR(PRD.MTY_RTN_YD_CD,  1, 5) FROM PRD_PROD_CTL_MST PRD WHERE PRD.PCTL_NO = BK.PCTL_NO) MTY_RTN_LOC
         , (SELECT TO_CHAR(ARR_ST_DT,'YYYY-MM-DD HH24:MI')
              FROM PRD_PROD_CTL_ROUT_DTL DTL, PRD_PROD_CTL_MST MST
             WHERE BK.PCTL_NO = MST.PCTL_NO
               AND BK.PCTL_NO = DTL.PCTL_NO
               AND MST.MTY_PKUP_YD_CD = DTL.ORG_NOD_CD
               AND DTL.NOD_LNK_DIV_CD = 'N'
               AND DTL.MTY_YD_FLG = 'Y') ESTM_PKUP_DT
         , (SELECT TO_CHAR(ARR_ST_DT,'YYYY-MM-DD HH24:MI')
              FROM PRD_PROD_CTL_ROUT_DTL DTL, PRD_PROD_CTL_MST MST
             WHERE BK.PCTL_NO = MST.PCTL_NO
               AND BK.PCTL_NO = DTL.PCTL_NO
               AND MST.MTY_RTN_YD_CD = DTL.ORG_NOD_CD
               AND DTL.NOD_LNK_DIV_CD = 'N'
               AND DTL.MTY_YD_FLG = 'Y') ESTM_RTN_DT
         , (SELECT SUBSTR(PRD.FULL_RTN_YD_CD, 1, 5) FROM PRD_PROD_CTL_MST PRD WHERE PRD.PCTL_NO = BK.PCTL_NO) FULL_RTN_YD_CD
         , (SELECT CNTR_SEAL_NO FROM BKG_CNTR_SEAL_NO SEAL WHERE CNTR.CNTR_NO = SEAL.CNTR_NO AND ROWNUM = 1) SEAL_NO
         , CNTR.SOC_FLG
         , DECODE(CNTR.EQ_SUBST_FLG, 'Y', CNTR.EQ_SUBST_TPSZ_CD, '') SUBST_TYPE
    -- Customer
    -----------------------------------------------------------
         , (SELECT REPLACE(CUST_ADDR,CHR(10),' ') FROM BKG_CUSTOMER C WHERE C.BKG_NO = BK.BKG_NO AND C.BKG_CUST_TP_CD = 'C') CNEE_ADDR
         , (SELECT REPLACE(CUST_ADDR,CHR(10),' ') FROM BKG_CUSTOMER N WHERE N.BKG_NO = BK.BKG_NO AND N.BKG_CUST_TP_CD = 'N') NTFY_ADDR
         , (SELECT REPLACE(CUST_ADDR,CHR(10),' ') FROM BKG_CUSTOMER S WHERE S.BKG_NO = BK.BKG_NO AND S.BKG_CUST_TP_CD = 'S') SHPR_ADDR
         , (SELECT REPLACE(CUST_NM,CHR(10),' ')   FROM BKG_CUSTOMER C WHERE C.BKG_NO = BK.BKG_NO AND C.BKG_CUST_TP_CD = 'C') CNEE_NM
         , (SELECT PHN_NO    FROM MDM_CUST_CNTC_PNT CNTC, BKG_CUSTOMER F WHERE BK.BKG_NO = F.BKG_NO AND F.BKG_CUST_TP_CD = 'F' AND CNTC.CUST_CNT_CD = F.CUST_CNT_CD AND CNTC.CUST_SEQ = F.CUST_SEQ AND ROWNUM = 1) AS FFWD_CNTC_NO
         , (SELECT CNTC_PSON_NM FROM MDM_CUST_ADDR     ADDR, BKG_CUSTOMER F WHERE BK.BKG_NO = F.BKG_NO AND F.BKG_CUST_TP_CD = 'F' AND ADDR.CUST_CNT_CD = F.CUST_CNT_CD AND ADDR.CUST_SEQ = F.CUST_SEQ AND PRMRY_CHK_FLG = 'Y' AND ROWNUM = 1) AS FFWD_CNTC_NM
         , (SELECT REPLACE(CUST_NM,CHR(10),' ')   FROM BKG_CUSTOMER C WHERE C.BKG_NO = BK.BKG_NO AND C.BKG_CUST_TP_CD = 'N') NTFY_PARTY
         , (SELECT SREP_NM FROM MDM_SLS_REP M WHERE M.SREP_CD = BK.OB_SREP_CD) POR_EMER_CNTC_NM
         , (SELECT MPHN_NO FROM MDM_SLS_REP M WHERE M.SREP_CD = BK.OB_SREP_CD) POR_EMER_CNTC_NO
         , (SELECT CNTC_PSON_NM FROM MDM_CUST_ADDR     ADDR, BKG_CUSTOMER S WHERE BK.BKG_NO = S.BKG_NO AND S.BKG_CUST_TP_CD = 'S' AND ADDR.CUST_CNT_CD = S.CUST_CNT_CD AND ADDR.CUST_SEQ = S.CUST_SEQ AND PRMRY_CHK_FLG = 'Y' AND ROWNUM = 1) AS SHPR_CNTC_NM
         , (SELECT PHN_NO       FROM MDM_CUST_CNTC_PNT CNTC, BKG_CUSTOMER S WHERE BK.BKG_NO = S.BKG_NO AND S.BKG_CUST_TP_CD = 'S' AND CNTC.CUST_CNT_CD = S.CUST_CNT_CD AND CNTC.CUST_SEQ = S.CUST_SEQ AND ROWNUM = 1) AS SHPR_CNTC_NO
         , (SELECT REPLACE(CUST_NM,CHR(10),' ')   FROM BKG_CUSTOMER C WHERE C.BKG_NO = BK.BKG_NO AND C.BKG_CUST_TP_CD = 'S') SHPR_NM
    -- Rate & Invoice
    -----------------------------------------------------------
         , NVL(BK.SC_NO, BK.RFA_NO) SC_RFA_NO
         , (SELECT PROP_NO FROM BKG_CHG_RT WHERE BKG_NO = BK.BKG_NO AND RT_SEQ = 1) AS PROP_NO
         , BK.TAA_NO
    -- Route & Schedule
    -----------------------------------------------------------
         , SUBSTR(ROUTE.VVD_1, 9, 1) N1_V_DIR
         , ROUTE.SLAN_1 N1_V_SVC
         , ROUTE.VVD_1 N1_V_VVD
         , SUBSTR(ROUTE.VVD_1, 1, 4) N1_V_VSL_CD     
         , (SELECT M.VSL_ENG_NM FROM MDM_VSL_CNTR M WHERE M.VSL_CD = SUBSTR(ROUTE.VVD_1, 1, 4)) N1_V_VSL_NM
         , SUBSTR(ROUTE.VVD_1, 5, 4) N1_V_VOY_NO
         , ROUTE.VVD_2 N2_V_VVD
         , ROUTE.VVD_3 N3_V_VVD
         , ROUTE.VVD_4 N4_V_VVD
         , TO_CHAR(LAST_VVD.VPS_ETB_DT,'YYYY-MM-DD HH24:MI') POD_ETB
         , TO_CHAR(N1ST_VVD.VPS_ETB_DT,'YYYY-MM-DD HH24:MI') POL_ETB 
         , BK.POD_NOD_CD
         , BK.POL_NOD_CD
         , BK.BLCK_STWG_CD
         , DECODE(@[io_bnd_cd], 'O', 'Departure', 'Arrival') BOUND
         , SUBSTR(ROUTE.POL_1,    1, 2) N1_POL_CNT_CD
         , SUBSTR(BK.POR_CD,      1, 2) FM_CTY_CNT_CD
         , SUBSTR(ROUTE.LAST_POD, 1, 2) LST_POD_CNT_cD
         , SUBSTR(BK.DEL_CD,      1, 2) TO_CTY_CNT_CD
         , TO_CHAR(LAST_VVD.VPS_ETA_DT,'YYYY-MM-DD HH24:MI') ETA
         , TO_CHAR(N1ST_VVD.VPS_ETD_DT,'YYYY-MM-DD HH24:MI') ETD
         , BK.FNL_DEST_CD
         , BK.POL_CD FIRST_POL
         , (SELECT TO_CHAR(NVL(MNL_SET_DT,SYS_SET_DT),'YYYY-MM-DD HH24:MI') FROM BKG_CLZ_TM WHERE CLZ_TP_CD = 'T' AND BKG_NO=BK.BKG_NO) AS POL_CUTOFF_DT
         , BK.POR_CD
         , ROUTE.LAST_POD
         , BK.VSL_CD||BK.SKD_VOY_NO||BK.SKD_DIR_CD TRUNK_VVD
         , BK.DEL_CD
         , BK.POD_CD
         , BK.POL_CD
         , TO_CHAR(N1ST_VVD.VPS_ETD_DT,'YYYY-MM-DD HH24:MI') VPS_ETD_DT
         , (SELECT SVC_SCP_NM FROM MDM_SVC_SCP SCP WHERE SCP.SVC_SCP_CD = BK.SVC_SCP_CD) SERVICE
         , NVL((SELECT SUBSTR(LOC_CD,1,2) FROM BKG_EUR_TRO TRO, BKG_EUR_TRO_DTL DTL 
                 WHERE TRO.BKG_NO = BK.BKG_NO 
                   AND TRO.CNTR_NO = CNTR.CNTR_NO
                   AND TRO.IO_BND_CD = 'I' 
                   AND TRO.BKG_NO = DTL.BKG_NO 
                   AND TRO.IO_BND_CD = DTL.IO_BND_CD 
                   AND TRO.TRO_SEQ = DTL.TRO_SEQ), SUBSTR(BK.DEL_CD,1,2)) AS TO_CITY
         , COA.TRD_CD
         , CASE WHEN BK.RCV_TERM_CD ='S' OR BK.DE_TERM_CD ='S' THEN 'LCL'
                ELSE 'FCL'
            END TRF_MODE
         , DECODE(BK.ORG_TRNS_MOD_CD||BK.DEST_TRNS_MOD_CD, NULL, '' , BK.ORG_TRNS_MOD_CD||'/'||BK.DEST_TRNS_MOD_CD ) AS TRSP_MOD
         , DECODE(ROUTE.POD_2, '', ROUTE.POD_1, '') TS_PORT_1
         , DECODE(ROUTE.POD_3, '', ROUTE.POD_2, '') TS_PORT_2
         , DECODE(ROUTE.POD_4, '', ROUTE.POD_3, '') TS_PORT_3
      FROM BKG_BOOKING BK
         , BKG_VVD VVD
         , BKG_BL_DOC BL
         , BKG_CONTAINER CNTR
         , BKG_RATE RATE
         , BKG_BL_ISS ISS
         , BKG_REFERENCE MRN
         , COA_RGST_BKG COA
         
         , (SELECT BKG_NO
                  ,VVD_1
                  ,VVD_2
                  ,VVD_3
                  ,VVD_4
                  ,SLAN_1
                  ,SLAN_2
                  ,SLAN_3
                  ,SLAN_4
                  ,POL_1
                  ,POL_2
                  ,POL_3
                  ,POL_4
                  ,POL_YD_1
                  ,POL_YD_2
                  ,POL_YD_3
                  ,POL_YD_4
                  ,DECODE(POD_4, '', DECODE(POD_3, '', DECODE(POD_2, '', VVD_1, VVD_2), VVD_3), VVD_4) AS LAST_VVD
                  ,COALESCE(POD_4, POD_3, POD_2, POD_1) AS LAST_POD
                  ,COALESCE(POD_1, POD_2, POD_3, POD_4) AS FIRST_POD
                  ,POD_1
                  ,POD_2
                  ,POD_3
                  ,POD_4
                  ,POD_YD_1
                  ,POD_YD_2
                  ,POD_YD_3
                  ,POD_YD_4
                  ,POL_CLPT_IND_SEQ_1
                  ,DECODE(POD_4, '', DECODE(POD_3, '', DECODE(POD_2, '', POD_CLPT_IND_SEQ_1, POD_CLPT_IND_SEQ_2), POD_CLPT_IND_SEQ_3), POD_CLPT_IND_SEQ_4) AS LAST_POD_CLPT_IND_SEQ
              FROM (
                    SELECT LEAD(VSL_CD || SKD_VOY_NO || SKD_DIR_CD, 0) OVER (PARTITION BY BKG_NO ORDER BY VSL_PRE_PST_CD, VSL_SEQ) AS VVD_1
                          ,LEAD(VSL_CD || SKD_VOY_NO || SKD_DIR_CD, 1) OVER (PARTITION BY BKG_NO ORDER BY VSL_PRE_PST_CD, VSL_SEQ) AS VVD_2
                          ,LEAD(VSL_CD || SKD_VOY_NO || SKD_DIR_CD, 2) OVER (PARTITION BY BKG_NO ORDER BY VSL_PRE_PST_CD, VSL_SEQ) AS VVD_3
                          ,LEAD(VSL_CD || SKD_VOY_NO || SKD_DIR_CD, 3) OVER (PARTITION BY BKG_NO ORDER BY VSL_PRE_PST_CD, VSL_SEQ) AS VVD_4
                          ,LEAD(SLAN_CD, 0) OVER (PARTITION BY BKG_NO ORDER BY VSL_PRE_PST_CD, VSL_SEQ) AS SLAN_1
                          ,LEAD(SLAN_CD, 1) OVER (PARTITION BY BKG_NO ORDER BY VSL_PRE_PST_CD, VSL_SEQ) AS SLAN_2
                          ,LEAD(SLAN_CD, 2) OVER (PARTITION BY BKG_NO ORDER BY VSL_PRE_PST_CD, VSL_SEQ) AS SLAN_3
                          ,LEAD(SLAN_CD, 3) OVER (PARTITION BY BKG_NO ORDER BY VSL_PRE_PST_CD, VSL_SEQ) AS SLAN_4
                          ,LEAD(POL_CD, 0) OVER (PARTITION BY BKG_NO ORDER BY VSL_PRE_PST_CD, VSL_SEQ) AS POL_1
                          ,LEAD(POL_CD, 1) OVER (PARTITION BY BKG_NO ORDER BY VSL_PRE_PST_CD, VSL_SEQ) AS POL_2
                          ,LEAD(POL_CD, 2) OVER (PARTITION BY BKG_NO ORDER BY VSL_PRE_PST_CD, VSL_SEQ) AS POL_3
                          ,LEAD(POL_CD, 3) OVER (PARTITION BY BKG_NO ORDER BY VSL_PRE_PST_CD, VSL_SEQ) AS POL_4
                          ,LEAD(SUBSTR(POL_YD_CD,-2), 0) OVER (PARTITION BY BKG_NO ORDER BY VSL_PRE_PST_CD, VSL_SEQ) AS POL_YD_1
                          ,LEAD(SUBSTR(POL_YD_CD,-2), 1) OVER (PARTITION BY BKG_NO ORDER BY VSL_PRE_PST_CD, VSL_SEQ) AS POL_YD_2
                          ,LEAD(SUBSTR(POL_YD_CD,-2), 2) OVER (PARTITION BY BKG_NO ORDER BY VSL_PRE_PST_CD, VSL_SEQ) AS POL_YD_3
                          ,LEAD(SUBSTR(POL_YD_CD,-2), 3) OVER (PARTITION BY BKG_NO ORDER BY VSL_PRE_PST_CD, VSL_SEQ) AS POL_YD_4
                          ,LEAD(POD_CD, 0) OVER (PARTITION BY BKG_NO ORDER BY VSL_PRE_PST_CD, VSL_SEQ) AS POD_1
                          ,LEAD(POD_CD, 1) OVER (PARTITION BY BKG_NO ORDER BY VSL_PRE_PST_CD, VSL_SEQ) AS POD_2
                          ,LEAD(POD_CD, 2) OVER (PARTITION BY BKG_NO ORDER BY VSL_PRE_PST_CD, VSL_SEQ) AS POD_3
                          ,LEAD(POD_CD, 3) OVER (PARTITION BY BKG_NO ORDER BY VSL_PRE_PST_CD, VSL_SEQ) AS POD_4
                          ,LEAD(SUBSTR(POD_YD_CD,-2), 0) OVER (PARTITION BY BKG_NO ORDER BY VSL_PRE_PST_CD, VSL_SEQ) AS POD_YD_1
                          ,LEAD(SUBSTR(POD_YD_CD,-2), 1) OVER (PARTITION BY BKG_NO ORDER BY VSL_PRE_PST_CD, VSL_SEQ) AS POD_YD_2
                          ,LEAD(SUBSTR(POD_YD_CD,-2), 2) OVER (PARTITION BY BKG_NO ORDER BY VSL_PRE_PST_CD, VSL_SEQ) AS POD_YD_3
                          ,LEAD(SUBSTR(POD_YD_CD,-2), 3) OVER (PARTITION BY BKG_NO ORDER BY VSL_PRE_PST_CD, VSL_SEQ) AS POD_YD_4
                          ,LEAD(POL_CLPT_IND_SEQ, 0) OVER (PARTITION BY BKG_NO ORDER BY VSL_PRE_PST_CD, VSL_SEQ) AS POL_CLPT_IND_SEQ_1
                          ,LEAD(POD_CLPT_IND_SEQ, 0) OVER (PARTITION BY BKG_NO ORDER BY VSL_PRE_PST_CD, VSL_SEQ) AS POD_CLPT_IND_SEQ_1
                          ,LEAD(POD_CLPT_IND_SEQ, 1) OVER (PARTITION BY BKG_NO ORDER BY VSL_PRE_PST_CD, VSL_SEQ) AS POD_CLPT_IND_SEQ_2
                          ,LEAD(POD_CLPT_IND_SEQ, 2) OVER (PARTITION BY BKG_NO ORDER BY VSL_PRE_PST_CD, VSL_SEQ) AS POD_CLPT_IND_SEQ_3
                          ,LEAD(POD_CLPT_IND_SEQ, 3) OVER (PARTITION BY BKG_NO ORDER BY VSL_PRE_PST_CD, VSL_SEQ) AS POD_CLPT_IND_SEQ_4
                          ,ROW_NUMBER() OVER (PARTITION BY BKG_NO ORDER BY VSL_PRE_PST_CD, VSL_SEQ) AS RN
                          ,BKG_NO
                      FROM BKG_VVD
                   )
             WHERE RN = 1
           ) ROUTE
         , BKG_QUANTITY QTY
         , VSK_VSL_PORT_SKD N1ST_VVD
         , VSK_VSL_PORT_SKD LAST_VVD
         
     WHERE BK.BKG_NO = BL.BKG_NO
       AND BK.BKG_NO = VVD.BKG_NO
       AND BK.BKG_NO = ROUTE.BKG_NO
       AND BK.BKG_NO = RATE.BKG_NO(+)
       AND BK.BKG_NO = ISS.BKG_NO(+)
       AND BK.BKG_NO = COA.BKG_NO(+)
       
       AND BK.BKG_STS_CD <> 'X'
       AND BK.BKG_CGO_TP_CD <> 'P'
       
       AND BK.BKG_NO = MRN.BKG_NO(+)
       AND 'XMRN' = MRN.BKG_REF_TP_CD(+)--Export MRN No.
               
       AND SUBSTR(ROUTE.VVD_1,1,4) = N1ST_VVD.VSL_CD(+)
       AND SUBSTR(ROUTE.VVD_1,5,4) = N1ST_VVD.SKD_VOY_NO(+)
       AND SUBSTR(ROUTE.VVD_1,9,1) = N1ST_VVD.SKD_DIR_CD(+)
       AND ROUTE.POL_1 = N1ST_VVD.VPS_PORT_CD(+)
       AND ROUTE.POL_CLPT_IND_SEQ_1 = N1ST_VVD.CLPT_IND_SEQ(+)
       AND SUBSTR(ROUTE.LAST_VVD,1,4) = LAST_VVD.VSL_CD(+)
       AND SUBSTR(ROUTE.LAST_VVD,5,4) = LAST_VVD.SKD_VOY_NO(+)
       AND SUBSTR(ROUTE.LAST_VVD,9,1) = LAST_VVD.SKD_DIR_CD(+)
       AND ROUTE.LAST_POD = LAST_VVD.VPS_PORT_CD(+)
       AND ROUTE.LAST_POD_CLPT_IND_SEQ = LAST_VVD.CLPT_IND_SEQ(+)
   
       AND BK.HNGR_FLG = 'Y'
       AND BK.BKG_NO = QTY.BKG_NO
       
       AND QTY.BKG_NO = CNTR.BKG_NO(+)
       AND QTY.CNTR_TPSZ_CD = CNTR.CNTR_TPSZ_CD(+)
       AND (QTY.CRR_HNGR_DBL_BAR_QTY > 0 OR QTY.CRR_HNGR_SGL_BAR_QTY > 0 OR QTY.CRR_HNGR_TPL_BAR_QTY > 0)
       AND VVD.VSL_PRE_PST_CD = 'T'
	--===================================================================== 화면 조건절 start
    #if (${vvd_cd} != '')
       AND @[vvd_cd] IN (ROUTE.VVD_1, ROUTE.VVD_2, ROUTE.VVD_3, ROUTE.VVD_4)
    #end
	#if (${pol_cd} != '') 
	   AND @[pol_cd] IN (ROUTE.POL_1, ROUTE.POL_2, ROUTE.POL_3, ROUTE.POL_4)
	 #if (${local_ts} != '' && ${local_ts} == 'L')
	   AND BK.POL_CD = @[pol_cd]
	 #end
	 #if (${local_ts} != '' && ${local_ts} == 'T')
	   AND BK.POL_CD <> @[pol_cd]
	 #end
	#end
	#if (${pol_yard_cd} != '') 
	   AND @[pol_yard_cd] IN (ROUTE.POL_YD_1, ROUTE.POL_YD_2, ROUTE.POL_YD_3, ROUTE.POL_YD_4)
	 #if (${local_ts} != '' && ${local_ts} == 'L')
	   AND SUBSTR(BK.POL_NOD_CD,-2) = @[pol_yard_cd]
	 #end
	 #if (${local_ts} != '' && ${local_ts} == 'T')
	   AND SUBSTR(BK.POL_NOD_CD,-2) <> @[pol_yard_cd]
	 #end
	#end
	#if (${pod_cd} != '') 
	   AND @[pod_cd] IN (ROUTE.POD_1, ROUTE.POD_2, ROUTE.POD_3, ROUTE.POD_4)
	 #if (${local_ts} != '' && ${local_ts} == 'L')
	   AND BK.POD_CD = @[pod_cd]
	 #end
	 #if (${local_ts} != '' && ${local_ts} == 'T')
	   AND BK.POD_CD <> @[pod_cd]
	 #end
	#end
	#if (${pod_yard_cd} != '') 
	   AND @[pod_yard_cd] IN (ROUTE.POD_YD_1, ROUTE.POD_YD_2, ROUTE.POD_YD_3, ROUTE.POD_YD_4)
	 #if (${local_ts} != '' && ${local_ts} == 'L')
	   AND SUBSTR(BK.POD_NOD_CD,-2) = @[pod_yard_cd]
	 #end
	 #if (${local_ts} != '' && ${local_ts} == 'T')
	   AND SUBSTR(BK.POD_NOD_CD,-2) <> @[pod_yard_cd]
	 #end
	#end
	
    #if (${sail_from_dt} != '') 
	   AND N1ST_VVD.VPS_ETD_DT >= TO_DATE(@[sail_from_dt],'YYYY-MM-DD') 
    #end
    #if (${sail_to_dt} != '') 
	   AND N1ST_VVD.VPS_ETD_DT <= TO_DATE(@[sail_to_dt],'YYYY-MM-DD') +0.99999
    #end
    #if (${arr_from_dt} != '') 
	   AND LAST_VVD.VPS_ETA_DT >= TO_DATE(@[arr_from_dt],'YYYY-MM-DD') 
    #end
    #if (${arr_to_dt} != '') 
	   AND LAST_VVD.VPS_ETA_DT <= TO_DATE(@[arr_to_dt],'YYYY-MM-DD') +0.99999
    #end
    #if (${bkg_from_dt} != '') 
	   AND BK.BKG_CRE_DT >= TO_DATE(@[bkg_from_dt],'YYYY-MM-DD') 
    #end
    #if (${bkg_to_dt} != '') 
	   AND BK.BKG_CRE_DT <= TO_DATE(@[bkg_to_dt],'YYYY-MM-DD') +0.99999
    #end
	#if (${bkg_no} != '') 
       AND BK.BKG_NO = @[bkg_no]
    #end
    #if (${bl_no} != '') 
       AND BK.BL_NO = @[bl_no]
    #end
	#if (${bkg_ofc_cd} != '') 
       AND BK.BKG_OFC_CD = @[bkg_ofc_cd]
    #end
    
    
    #if (${ob_srep_cd} != '') 
       AND BK.OB_SREP_CD = @[ob_srep_cd]
    #end
    #if (${b_staff_id} != '' && ${bkg_staff_type1} != '')
       AND BK.DOC_USR_ID = @[b_staff_id]
    #elseif (${b_staff_id} != '' && ${bkg_staff_type2} != '')
       AND (SELECT USR_NM FROM COM_USER WHERE USR_ID = BK.DOC_USR_ID) = @[b_staff_id]
    #end
    #if (${bkg_sts_cd} != '')
       AND BK.BKG_STS_CD IN (@[bkg_sts_cd])--?이게 되나?
    #end
	
    #if (${por_cd2} != '') 
       AND BK.POR_CD LIKE @[por_cd2]||'%' 
    #end
    #if (${pol_cd2} != '') 
       AND BK.POL_CD LIKE @[pol_cd2]||'%' 
    #end
    #if (${pod_cd2} != '') 
       AND BK.POD_CD LIKE @[pod_cd2]||'%' 
    #end
    #if (${del_cd} != '') 
       AND BK.DEL_CD LIKE @[del_cd2]||'%' 
    #end
#if (${r_term} != '') 
       AND BK.RCV_TERM_CD IN (${r_term})
#end
#if (${d_term} != '') 
       AND BK.DE_TERM_CD IN (${d_term})
#end
    #if (${dir_cd} != '') 
       AND BK.SKD_DIR_CD = @[dir_cd]
    #end
    
    #if (${trd_cd} != '') 
       AND COA.TRD_CD = @[trd_cd]
    #end
    #if (${sub_trd_cd} != '') 
       AND COA.SUB_TRD_CD = @[sub_trd_cd]
    #end
    #if (${lane_cd} != '') 
       AND @[lane_cd] IN (ROUTE.SLAN_1, ROUTE.SLAN_2, ROUTE.SLAN_3, ROUTE.SLAN_4)
    #end

    #if (${cust_tp_cd_s} != '' || ${cust_tp_cd_c} != '' || ${cust_tp_cd_n} != '' || ${cust_tp_cd_f} != '' || ${cust_tp_cd_a} != '') 
       AND EXISTS (SELECT 'Y' FROM BKG_CUSTOMER C
                    WHERE C.BKG_NO = BK.BKG_NO
                    #if (${cust_cnt_cd} !='')                    
                      AND C.CUST_CNT_CD = @[cust_cnt_cd]
                    #end
                    #if (${cust_seq} !='')                    
                      AND C.CUST_SEQ = @[cust_seq]
                    #end
                      AND BKG_CUST_TP_CD IN ('',@[cust_tp_cd_s],@[cust_tp_cd_c],@[cust_tp_cd_n],@[cust_tp_cd_f],@[cust_tp_cd_a])
                    #if (${cust_nm} !='')                    
                      AND C.CUST_NM = @[cust_nm]
                    #end
                    #if (${cust_grp_id} !='')                    
                      AND (SELECT CUST_GRP_ID FROM MDM_CUSTOMER M WHERE M.CUST_CNT_CD = B.CUST_CNT_CD AND M.CUST_SEQ = B.CUST_SEQ) = @[cust_grp_id]
                    #end
                  )
    #end

    #if (${sc_rfa_gbn} == 'S') 
     #if (${sc_rfa_no} != '') 
               AND BK.SC_NO = @[sc_rfa_no]
     #end
    #elseif (${sc_rfa_gbn} == 'R') 
     #if (${sc_rfa_no} != '') 
               AND BK.RFA_NO = @[sc_rfa_no]
     #end
    #elseif (${sc_rfa_gbn} == 'T') 
     #if (${sc_rfa_no} != '') 
               AND BK.TAA_NO = @[sc_rfa_no]
     #end
    #end
	--===================================================================== 화면 조건절 end
)
START WITH TEMP = '1'										--20150309.ADD
CONNECT BY LEVEL < 3
#if (${orderby} == '') 
ORDER BY TEMP, BKG_NO, CNTR_NO
#else
ORDER BY TEMP, ${orderby}
#end			]]></sql>
			<params>
				<param name="io_bnd_cd" type="12" value="" out="N"/>
				<param name="vvd_cd" type="12" value="" out="N"/>
				<param name="pol_cd" type="12" value="" out="N"/>
				<param name="pol_yard_cd" type="12" value="" out="N"/>
				<param name="pod_cd" type="12" value="" out="N"/>
				<param name="pod_yard_cd" type="12" value="" out="N"/>
				<param name="sail_from_dt" type="12" value="" out="N"/>
				<param name="sail_to_dt" type="12" value="" out="N"/>
				<param name="arr_from_dt" type="12" value="" out="N"/>
				<param name="arr_to_dt" type="12" value="" out="N"/>
				<param name="bkg_from_dt" type="12" value="" out="N"/>
				<param name="bkg_to_dt" type="12" value="" out="N"/>
				<param name="bkg_no" type="12" value="" out="N"/>
				<param name="bl_no" type="12" value="" out="N"/>
				<param name="bkg_ofc_cd" type="12" value="" out="N"/>
				<param name="ob_srep_cd" type="12" value="" out="N"/>
				<param name="b_staff_id" type="12" value="" out="N"/>
				<param name="bkg_sts_cd" type="12" value="" out="N"/>
				<param name="por_cd2" type="12" value="" out="N"/>
				<param name="pol_cd2" type="12" value="" out="N"/>
				<param name="pod_cd2" type="12" value="" out="N"/>
				<param name="del_cd2" type="12" value="" out="N"/>
				<param name="dir_cd" type="12" value="" out="N"/>
				<param name="trd_cd" type="12" value="" out="N"/>
				<param name="sub_trd_cd" type="12" value="" out="N"/>
				<param name="lane_cd" type="12" value="" out="N"/>
				<param name="cust_cnt_cd" type="12" value="" out="N"/>
				<param name="cust_seq" type="12" value="" out="N"/>
				<param name="cust_tp_cd_s" type="12" value="" out="N"/>
				<param name="cust_tp_cd_c" type="12" value="" out="N"/>
				<param name="cust_tp_cd_n" type="12" value="" out="N"/>
				<param name="cust_tp_cd_f" type="12" value="" out="N"/>
				<param name="cust_tp_cd_a" type="12" value="" out="N"/>
				<param name="cust_nm" type="12" value="" out="N"/>
				<param name="cust_grp_id" type="12" value="" out="N"/>
				<param name="sc_rfa_no" type="12" value="" out="N"/>
			</params>
		</query>
	</querys>
</sqls>
