<?xml version="1.0" encoding="UTF-8"?>
<sqls>
	<querys>
		<query name="TCharterIOInvoiceDAOSearchPrepaymentInvoiceRSQL">
			<desc><![CDATA[TCharterIOInvoiceDAOSearchPrepaymentInvoiceRSQL]]></desc>
			<sql><![CDATA[
SELECT FI.FLET_CTRT_NO,
       FC.VSL_CD,
       (SELECT VSL_ENG_NM 
	      FROM MDM_VSL_CNTR 
		 WHERE VSL_CD = FC.VSL_CD 
		   AND ROWNUM =1) VSL_ENG_NM,
	   (SELECT INTG_CD_VAL_DP_DESC 
          FROM COM_INTG_CD_DTL
		 WHERE INTG_CD_ID = 'CD01513'
		   AND INTG_CD_VAL_CTNT = FC.FLET_CTRT_TP_CD) FLET_CTRT_TP_CD,
	   CASE WHEN FC.FLET_CTRT_TP_CD = 'TO' THEN
         	(SELECT MV.CUST_LGL_ENG_NM
			   FROM MDM_CUSTOMER MV, FMS_OWNER FO
 			  WHERE CUST_CNT_CD = FC.CUST_CNT_CD
   			    AND CUST_SEQ = FC.CUST_SEQ
 			    AND MV.FLET_MGMT_OWNR_CUST_SEQ = FO.OWNR_SEQ
				AND ROWNUM =1)
            ELSE 
			(SELECT MV.VNDR_LGL_ENG_NM
			  FROM MDM_VENDOR MV, FMS_OWNER FO
 			 WHERE VNDR_SEQ = FC.VNDR_SEQ
 			   AND MV.FLET_MGMT_OWNR_VNDR_SEQ = FO.OWNR_SEQ
			   AND ROWNUM =1)
       END VNDR_LGL_ENG_NM,
	   FC.CUST_CNT_CD,
	   DECODE(FC.CUST_SEQ,NULL,FC.VNDR_SEQ,FC.CUST_SEQ) CUST_SEQ,
	   CASE WHEN FC.FLET_CTRT_TP_CD = 'TO' THEN
         	(SELECT FO.OWNR_NM
			   FROM MDM_CUSTOMER MV, FMS_OWNER FO
 			  WHERE CUST_CNT_CD = FC.CUST_CNT_CD
   			    AND CUST_SEQ = FC.CUST_SEQ
 			    AND MV.FLET_MGMT_OWNR_CUST_SEQ = FO.OWNR_SEQ
				AND ROWNUM =1)
            ELSE 
			(SELECT FO.OWNR_NM
			  FROM MDM_VENDOR MV, FMS_OWNER FO
 			 WHERE VNDR_SEQ = FC.VNDR_SEQ
 			   AND MV.FLET_MGMT_OWNR_VNDR_SEQ = FO.OWNR_SEQ
			   AND ROWNUM =1)
       END OWNR_NM,
	   TO_CHAR(FI.EFF_DT,'YYYY-MM-DD') EFF_DT,
       TO_CHAR(FI.EFF_DT,'HH24:MI') FROM_TIME,
	   TO_CHAR(FI.EXP_DT,'YYYY-MM-DD') EXP_DT,
	   TO_CHAR(FI.EXP_DT,'HH24:MI') TO_TIME,
       TO_CHAR(FI.INV_USD_DYS,'FM999,999.0000') INV_USD_DYS,
	   TO_CHAR(FC.ACMM_RT_AMT,'FM990.00') ACMM_RT_AMT,
	   TO_CHAR(FC.FLET_BROG_RT_AMT,'FM990.00') FLET_BROG_RT_AMT,
	   FI.ACMM_FLG, 
	   FI.BROG_FLG,
       FI.INV_SEQ
  FROM FMS_INVOICE FI, FMS_CONTRACT FC
 WHERE FC.FLET_CTRT_NO   = @[flet_ctrt_no]
   AND FI.PPAY_HIR_NO    = @[ppay_hir_no]
   AND FI.FLET_ISS_TP_CD = 'PRE'
   AND FC.FLET_CTRT_NO   = FI.FLET_CTRT_NO			]]></sql>
			<params>
				<param name="flet_ctrt_no" type="12" value="" out="N"/>
				<param name="ppay_hir_no" type="12" value="" out="N"/>
			</params>
		</query>
	</querys>
</sqls>
