<?xml version="1.0" encoding="UTF-8"?>
<sqls>
	<querys>
		<query name="SpecialManifestDBDAOsearchDgValidationByCntrKeyRSQL">
			<desc><![CDATA[cntr_no를 입력시 validation]]></desc>
			<sql><![CDATA[
#if (${cgo_opr_cd} == 'NYK')
SELECT (SELECT NVL(MAX(CNTR_CGO_SEQ),0) + 1
          FROM BKG_CSTMS_EUR_DG
         WHERE EUR_DG_DECL_TP_CD = @[d_type]
           AND VSL_CD            = SUBSTR(@[vvd_cd], 1, 4)
           AND SKD_VOY_NO        = SUBSTR(@[vvd_cd], 5, 4)
           AND SKD_DIR_CD        = SUBSTR(@[vvd_cd], 9, 1)
           AND PORT_CD           = @[port_cd]
           AND BL_NO             = @[bl_no]
           AND CNTR_NO           = @[cond_value]
       )AS CNTR_CGO_SEQ
      ,CNTR_NO AS CNTR_REF_NO
      ,CNTR_TPSZ_CD
  FROM MST_CONTAINER
 WHERE CNTR_NO = @[cond_value]
#else
SELECT A.SPCL_CGO_SEQ AS CNTR_CGO_SEQ
      ,A.CNTR_REF_NO
      ,A.CNTR_TPSZ_CD
  FROM SCG_PRNR_APRO_RQST_CGO A
 WHERE BKG_REF_NO  = @[bl_no]
   AND CNTR_REF_NO = @[cond_value]
   AND AUTH_STS_CD = 'Y'
UNION
SELECT A.SPCL_CGO_SEQ AS CNTR_CGO_SEQ
      ,A.CNTR_REF_NO
      ,A.CNTR_TPSZ_CD
  FROM SCG_PRNR_APRO_RQST_CGO A
      ,BKG_CSTMS_EUR_DG_HIS   B
 WHERE A.BKG_REF_NO  = B.BL_NO
   AND A.CNTR_REF_NO = B.CNTR_REF_NO
   AND A.BKG_REF_NO  = @[bl_no]
   AND B.CNTR_NO     = @[cond_value]
   AND A.AUTH_STS_CD = 'Y'
#end			]]></sql>
			<params>
				<param name="d_type" type="12" value="" out="N"/>
				<param name="vvd_cd" type="12" value="" out="N"/>
				<param name="port_cd" type="12" value="" out="N"/>
				<param name="bl_no" type="12" value="" out="N"/>
				<param name="cond_value" type="12" value="" out="N"/>
			</params>
		</query>
	</querys>
</sqls>
