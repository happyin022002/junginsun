<?xml version="1.0" encoding="UTF-8"?>
<sqls>
	<querys>
		<query name="FFCmpnApprovalDBDAOSearchFFCmpnApprovalDetailListRSQL">
			<desc><![CDATA[SearchFFCmpnApprovalDetailList]]></desc>
			<sql><![CDATA[
SELECT A.BKG_FF_CNT_CD||TO_CHAR(A.BKG_FF_SEQ,'FM000000') AS FF_CNT_SEQ,
       TO_CHAR(A.VNDR_SEQ,'FM000000') AS VNDR_SEQ,
       A.BKG_NO,
       C.BL_NO,
       A.FF_REF_NO,
       A.IF_AMT,
       DECODE(SUBSTR(A.FF_DIV_CD,1,1),'B','RATE','CNTR') AS FF_TYPE,
       A.FF_BKG_RT,
       D.BKG_STS_CD,
       A.FF_CMPN_RMK,
       A.FF_SEQ
  FROM ACM_FF_CMPN A,
       MDM_CUSTOMER B,
       ACM_AGN_BKG_INFO C,
       BKG_BOOKING D
 WHERE A.BKG_FF_CNT_CD = SUBSTR(@[hid_ff_cnt_seq], 0, 2)
   AND A.BKG_FF_SEQ = SUBSTR(@[hid_ff_cnt_seq], 3, 6)
   AND A.AP_OFC_CD IS NOT NULL
   AND A.BKG_FF_CNT_CD = B.CUST_CNT_CD
   AND A.BKG_FF_SEQ = B.CUST_SEQ
   AND C.BKG_STS_CD <> 'A'
   AND A.BKG_NO = C.BKG_NO
   AND A.BKG_NO = D.BKG_NO(+)
   AND A.AP_OFC_CD IS NOT NULL
   AND A.CRE_USR_ID != 'COST'
   AND C.BL_NO IS NOT NULL
#if (${vndr_seq} != '')
   AND A.VNDR_SEQ = @[vndr_seq]
#end
#if (${ap_ofc_cd} != '')
   AND A.AP_OFC_CD = @[ap_ofc_cd]
#end
#if (${if_opt} == 'CS')
   AND A.FF_CMPN_STS_CD IN ('CS', 'CM', 'CA')
   #if (${csr_no} == '')
   AND A.CSR_NO IS NULL
   #else
   AND A.CSR_NO = @[csr_no]
   #end
#elseif(${if_opt} == 'PS')	
   AND A.FF_CMPN_STS_CD = 'IF'
   AND A.FF_CMPN_RMK = 'APPROVAL REQUEST!'
   AND A.CSR_NO = @[csr_no]
#elseif(${if_opt} == 'IF')	
   AND A.FF_CMPN_STS_CD = 'IF'
   AND A.FF_CMPN_RMK = 'Interface Success!'
   AND A.CSR_NO = @[csr_no]
#else
   AND A.FF_CMPN_STS_CD = @[if_opt]
   AND A.CSR_NO = @[csr_no]
#end
/* 날짜 조회 조건 */
#if(${date_div} == 'B')	
       AND C.BKG_CRE_DT	
   BETWEEN TO_DATE(REPLACE(@[date_fm],'-', ''),'YYYYMMDD')	
       AND TO_DATE(REPLACE(@[date_to],'-', ''),'YYYYMMDD')+0.99999	
#elseif(${date_div} == 'E')	
       AND A.VSL_DEP_DT	
   BETWEEN TO_DATE(REPLACE(@[date_fm],'-', ''),'YYYYMMDD')	
       AND TO_DATE(REPLACE(@[date_to],'-', ''),'YYYYMMDD')+0.99999	
#elseif(${date_div} == 'C')	
       AND A.UPD_DT	
   BETWEEN TO_DATE(REPLACE(@[date_fm],'-', ''),'YYYYMMDD')	
       AND TO_DATE(REPLACE(@[date_to],'-', ''),'YYYYMMDD')+0.99999	
#elseif(${date_div} == 'P')	
       AND A.APRO_DT	
   BETWEEN TO_DATE(REPLACE(@[date_fm],'-', ''),'YYYYMMDD')	
       AND TO_DATE(REPLACE(@[date_to],'-', ''),'YYYYMMDD')+0.99999	
#elseif(${date_div} == 'I')	
       AND A.IF_DT	
   BETWEEN TO_DATE(REPLACE(@[date_fm],'-', ''),'YYYYMMDD')	
       AND TO_DATE(REPLACE(@[date_to],'-', ''),'YYYYMMDD')+0.99999	
#end
#if(${bl_no} != '')	
       AND C.BL_NO	
        IN	
         ( $bl_no	
         )	
#end	
ORDER BY 1			]]></sql>
			<params>
				<param name="hid_ff_cnt_seq" type="12" value="" out="N"/>
				<param name="vndr_seq" type="12" value="" out="N"/>
				<param name="ap_ofc_cd" type="12" value="" out="N"/>
				<param name="csr_no" type="12" value="" out="N"/>
				<param name="if_opt" type="12" value="" out="N"/>
				<param name="date_fm" type="12" value="" out="N"/>
				<param name="date_to" type="12" value="" out="N"/>
			</params>
		</query>
	</querys>
</sqls>
