/*=========================================================
*Copyright(c) 2016 CyberLogitec
*@FileName : SalesRPTDBDAOSearchInqByCondition060ListRSQL.java
*@FileTitle : 
*Open Issues :
*Change history :
*@LastModifyDate : 2016.03.18
*@LastModifier : 
*@LastVersion : 1.0
* 2016.03.18 
* 1.0 Creation
=========================================================*/
package com.clt.apps.opus.esm.coa.multidimensionrpt.salesrpt.integration;

import java.util.HashMap;
import org.apache.log4j.Logger;
import com.clt.framework.support.db.ISQLTemplate;

/**
 *
 * @author 
 * @see DAO 참조
 * @since J2EE 1.6
 */

public class SalesRPTDBDAOSearchInqByCondition060ListRSQL implements ISQLTemplate{

	private StringBuffer query = new StringBuffer();
	
	Logger log =Logger.getLogger(this.getClass());
	
	/** Parameters definition in params/param elements */
	private HashMap<String,String[]> params = null;
	
	/**
	  * <pre>
	  * @SJH.20140806 : BKG_NO multi 조회로 수정
	  * @SJH.20140814 : COA_BKG_EXPN_DTL_WK -> COA_BKG_EXPN_DTL
	  * </pre>
	  */
	public SalesRPTDBDAOSearchInqByCondition060ListRSQL(){
		setQuery();
		params = new HashMap<String,String[]>();
		query.append("/*").append("\n"); 
		query.append("Path : com.clt.apps.opus.esm.coa.multidimensionrpt.salesrpt.integration").append("\n"); 
		query.append("FileName : SalesRPTDBDAOSearchInqByCondition060ListRSQL").append("\n"); 
		query.append("*/").append("\n"); 
	}
	
	public String getSQL(){
		return query.toString();
	}
	
	public HashMap<String,String[]> getParams() {
		return params;
	}

	/**
	 * Query 생성
	 */
	public void setQuery(){
		query.append("SELECT" ).append("\n"); 
		query.append("       COST_YRMON                                                  AS COST_YRMON" ).append("\n"); 
		query.append("      ,SLS_YRMON                                                   AS SLS_YRMON" ).append("\n"); 
		query.append("      ,COST_WK                                                     AS COST_WK" ).append("\n"); 
		query.append("#foreach(${keys} IN ${keyList1})" ).append("\n"); 
		query.append("    #if (${keys} == 'obrd_dt' || ${keys} == 'cntr_rcv_dt')" ).append("\n"); 
		query.append("      ,TO_CHAR($keys,'YYYY-MM-DD') AS $keys" ).append("\n"); 
		query.append("    #else" ).append("\n"); 
		query.append("      ,$keys AS $keys" ).append("\n"); 
		query.append("    #end" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("      ,DIR_CD2                                                     AS DIR_CD2" ).append("\n"); 
		query.append("      ,TPSZ_CODE                                                   AS TPSZ_CODE" ).append("\n"); 
		query.append("      ,SUM(QUANTITY)                                               AS QUANTITY" ).append("\n"); 
		query.append("	  ,SUM(TEU)                                               	   AS TEU" ).append("\n"); 
		query.append("      ,SUM(BKG_REV)                                                AS REV" ).append("\n"); 
		query.append("      --SJH.20141112.MOD,ADD" ).append("\n"); 
		query.append("      ,SUM(CM_COST_A)                                              AS CMC_A" ).append("\n"); 
		query.append("      ,SUM(BKG_REV+MISC_REV)-SUM(CM_COST_A)                        AS CM_A" ).append("\n"); 
		query.append("      ,SUM(CM_COST_B)                                              AS CMC_B" ).append("\n"); 
		query.append("      ,SUM(BKG_REV+MISC_REV)-SUM(CM_COST_B)                        AS CM_B" ).append("\n"); 
		query.append("      ,SUM(BKG_REV)/SUM(TEU)                                       AS G_RPB" ).append("\n"); 
		query.append("      --,SUM(CM_COST_A)                                              AS CM_COST_A			--20160318.DEL" ).append("\n"); 
		query.append("      ,SUM(CM_COST_A)/SUM(TEU)                                     AS CMCOST_A" ).append("\n"); 
		query.append("      ,(SUM(BKG_REV+MISC_REV)-SUM(CM_COST_A))/SUM(TEU)             AS CMB_A" ).append("\n"); 
		query.append("      --,SUM(CM_COST_B)                                              AS CM_COST_B			--20160318.DEL" ).append("\n"); 
		query.append("      ,SUM(CM_COST_B)/SUM(TEU)                                     AS CMCOST_B" ).append("\n"); 
		query.append("      ,(SUM(BKG_REV+MISC_REV)-SUM(CM_COST_B))/SUM(TEU)             AS CMB_B" ).append("\n"); 
		query.append("  FROM (" ).append("\n"); 
		query.append(" " ).append("\n"); 
		query.append("    SELECT 'dummy'  dummy_column" ).append("\n"); 
		query.append("          ,D.BKG_NO AS CHG_BKG_NO" ).append("\n"); 
		query.append("          ,D.SPCL_CNTR_TPSZ_CD" ).append("\n"); 
		query.append("#set($sc_desc_flg   = 'FALSE')" ).append("\n"); 
		query.append("#set($cmdt_desc_flg = 'FALSE')" ).append("\n"); 
		query.append("#set($bl_shpr_flg   = 'FALSE')" ).append("\n"); 
		query.append("#set($tare_flg = 'FALSE')" ).append("\n"); 
		query.append("#foreach(${keys} IN ${keyList2})" ).append("\n"); 
		query.append("    #if (${keys} == 'sc_desc' || ${keys} == 'nbs_clss_cd1' || ${keys} == 'nbs_clss_cd2' || ${keys} == 'nbs_clss_cd3' || ${keys} == 'cust_grp_nm')" ).append("\n"); 
		query.append("          ,J.$keys AS $keys" ).append("\n"); 
		query.append("    #set($sc_desc_flg = 'TRUE') " ).append("\n"); 
		query.append("    #elseif (${keys} == 'cntr_tpsz_tare_wgt')" ).append("\n"); 
		query.append("          ,NVL(D.BKG_QTY,0) * NVL(MC.CNTR_TPSZ_TARE_WGT,0)		   AS CNTR_TPSZ_TARE_WGT" ).append("\n"); 
		query.append("    #set($tare_flg = 'TRUE')" ).append("\n"); 
		query.append("    #elseif (${keys} == 'tare_weight')" ).append("\n"); 
		query.append("          ,'KGS' AS $keys" ).append("\n"); 
		query.append("    #elseif (${keys} == 'rep_cmdt_desc')" ).append("\n"); 
		query.append("          ,F.$keys AS $keys" ).append("\n"); 
		query.append("    #set($cmdt_desc_flg = 'TRUE')" ).append("\n"); 
		query.append("    #elseif (${keys} == 'shpr_nm')" ).append("\n"); 
		query.append("          ,H.BL_SHPR_NM                                                                       AS SHPR_NM" ).append("\n"); 
		query.append("    #set($bl_shpr_flg = 'TRUE')" ).append("\n"); 
		query.append("    #elseif (${keys} == 'bkg_no')" ).append("\n"); 
		query.append("          ,D.BKG_NO                                                                           AS BKG_NO" ).append("\n"); 
		query.append("    #elseif (${keys} == 'rev_vvd')" ).append("\n"); 
		query.append("          ,D.VSL_CD||D.SKD_VOY_NO||D.DIR_CD                                                   AS REV_VVD" ).append("\n"); 
		query.append("    #elseif (${keys} == 'bl_no')" ).append("\n"); 
		query.append("          ,D.BL_NO || D.BL_NO_TP || D.BL_NO_CHK BL_NO" ).append("\n"); 
		query.append("    #elseif (${keys} == 'slan_cd')" ).append("\n"); 
		query.append("          ,D.SLAN_CD                                                                          AS SLAN_CD" ).append("\n"); 
		query.append("    #elseif (${keys} == 'soc_flg' || ${keys} == 'spcl_dg_cgo_flg' || ${keys} == 'spcl_bb_cgo_flg' || ${keys} == 'spcl_awk_cgo_flg')" ).append("\n"); 
		query.append("          ,NVL(D.$keys, 'N') AS $keys" ).append("\n"); 
		query.append("    #elseif (${keys} == 'bkg_cgo_tp_cd_r')" ).append("\n"); 
		query.append("          ,DECODE(D.BKG_CGO_TP_CD, 'R', 'Y', 'N')                                             AS BKG_CGO_TP_CD_R" ).append("\n"); 
		query.append("    #elseif (${keys} == 'bkg_cgo_wgt')" ).append("\n"); 
		query.append("          ,D.BKG_CGO_WGT                                                                      AS BKG_CGO_WGT" ).append("\n"); 
		query.append("    #elseif (${keys} == 'sc_cust_cd')" ).append("\n"); 
		query.append("          ,D.AGMT_CNT_CD || TO_CHAR(lpad(DECODE(D.AGMT_CUST_SEQ,0,'',D.AGMT_CUST_SEQ),6,'0')) AS SC_CUST_CD" ).append("\n"); 
		query.append("    #elseif (${keys} == 'cmdt_desc')" ).append("\n"); 
		query.append("          ,K.CMDT_NM                                                                          AS CMDT_DESC" ).append("\n"); 
		query.append("    #elseif (${keys} == 'sc_cust_nm')" ).append("\n"); 
		query.append("          ,(SELECT CUST_LGL_ENG_NM" ).append("\n"); 
		query.append("              FROM MDM_CUSTOMER B1" ).append("\n"); 
		query.append("             WHERE D.AGMT_CNT_CD   = B1.CUST_CNT_CD(+)" ).append("\n"); 
		query.append("               AND D.AGMT_CUST_SEQ = B1.CUST_SEQ(+)" ).append("\n"); 
		query.append("           )                                          AS SC_CUST_NM" ).append("\n"); 
		query.append("    #elseif (${keys} == 'bkg_shpr_cd')" ).append("\n"); 
		query.append("          ,D.SHPR_CNT_CD || TO_CHAR(LPAD(DECODE(D.SHPR_CUST_SEQ,0,'',D.SHPR_CUST_SEQ),6,'0')) AS BKG_SHPR_CD" ).append("\n"); 
		query.append("    #elseif (${keys} == 'bkg_shpr_nm')" ).append("\n"); 
		query.append("          ,(SELECT CUST_LGL_ENG_NM" ).append("\n"); 
		query.append("              FROM MDM_CUSTOMER B1" ).append("\n"); 
		query.append("             WHERE D.SHPR_CNT_CD   = B1.CUST_CNT_CD(+)" ).append("\n"); 
		query.append("               AND D.SHPR_CUST_SEQ = B1.CUST_SEQ(+)" ).append("\n"); 
		query.append("           )                                          AS BKG_SHPR_NM" ).append("\n"); 
		query.append("    #elseif (${keys} == 'cnee_cd')" ).append("\n"); 
		query.append("          ,D.CNEE_CNT_CD || TO_CHAR(LPAD(DECODE(D.CNEE_CUST_SEQ,0,'',D.CNEE_CUST_SEQ),6,'0')) AS CNEE_CD" ).append("\n"); 
		query.append("    #elseif (${keys} == 'cnee_nm')" ).append("\n"); 
		query.append("          ,(SELECT CUST_LGL_ENG_NM" ).append("\n"); 
		query.append("              FROM MDM_CUSTOMER B1" ).append("\n"); 
		query.append("             WHERE D.CNEE_CNT_CD   = B1.CUST_CNT_CD(+)" ).append("\n"); 
		query.append("               AND D.CNEE_CUST_SEQ = B1.CUST_SEQ(+))                                          AS CNEE_NM" ).append("\n"); 
		query.append("    #elseif (${keys} == 'ntfy_cd')" ).append("\n"); 
		query.append("          ,D.NTFY_CNT_CD || TO_CHAR(LPAD(DECODE(D.NTFY_CUST_SEQ,0,'',D.NTFY_CUST_SEQ),6,'0')) AS NTFY_CD" ).append("\n"); 
		query.append("    #elseif (${keys} == 'ntfy_nm')" ).append("\n"); 
		query.append("          ,(SELECT CUST_LGL_ENG_NM" ).append("\n"); 
		query.append("              FROM MDM_CUSTOMER B1" ).append("\n"); 
		query.append("             WHERE D.NTFY_CNT_CD   = B1.CUST_CNT_CD(+)" ).append("\n"); 
		query.append("               AND D.NTFY_CUST_SEQ = B1.CUST_SEQ(+))                                          AS NTFY_NM" ).append("\n"); 
		query.append("    #elseif (${keys} == 'shpr_cd')" ).append("\n"); 
		query.append("          ,D.SHPR_CNT_CD || TO_CHAR(LPAD(DECODE(D.SHPR_CUST_SEQ,0,'',D.SHPR_CUST_SEQ),6,'0')) AS SHPR_CD" ).append("\n"); 
		query.append("    #elseif (${keys} == 'bl_shpr_cd')" ).append("\n"); 
		query.append("          ,D.SHPR_CNT_CD || TO_CHAR(LPAD(DECODE(D.SHPR_CUST_SEQ,0,'',D.SHPR_CUST_SEQ),6,'0')) AS BL_SHPR_CD" ).append("\n"); 
		query.append("	#elseif (${keys} == 'rev_pol_cd')" ).append("\n"); 
		query.append("          ,R.REV_POL_CD																		  AS REV_POL_CD" ).append("\n"); 
		query.append("	#elseif (${keys} == 'rev_pod_cd')" ).append("\n"); 
		query.append("          ,R.REV_POD_CD																		  AS REV_POD_CD" ).append("\n"); 
		query.append("	#elseif (${keys} == 'last_vvd')" ).append("\n"); 
		query.append("          ,SUBSTR(COALESCE(D.N4TH_FINC_VVD_CD,D.N3RD_FINC_VVD_CD,D.N2ND_FINC_VVD_CD,D.N1ST_FINC_VVD_CD),1,9) 	AS LAST_VVD" ).append("\n"); 
		query.append("	#elseif (${keys} == 'last_trade')" ).append("\n"); 
		query.append("          ,COALESCE(D.N4TH_TRD_CD,D.N3RD_TRD_CD,D.N2ND_TRD_CD,D.N1ST_TRD_CD) 						AS LAST_TRADE" ).append("\n"); 
		query.append("	#elseif (${keys} == 'last_lane')" ).append("\n"); 
		query.append("          ,COALESCE(D.N4TH_RLANE_CD,D.N3RD_RLANE_CD,D.N2ND_RLANE_CD,D.N1ST_RLANE_CD) 				AS LAST_LANE" ).append("\n"); 
		query.append("	#elseif (${keys} == 'mty_pkup_yd_cd')" ).append("\n"); 
		query.append("          ,R.MTY_PKUP_YD_CD																		 	AS MTY_PKUP_YD_CD" ).append("\n"); 
		query.append("	#elseif (${keys} == 'mty_rtn_yd_cd')" ).append("\n"); 
		query.append("          ,R.MTY_RTN_YD_CD																		 	AS MTY_RTN_YD_CD" ).append("\n"); 
		query.append("	#elseif (${keys} == 'n1st_sail_dt')" ).append("\n"); 
		query.append("          ,TO_CHAR(R.N1ST_SAIL_DT, 'YYYY-MM-DD HH24:MI:SS')																		 	AS N1ST_SAIL_DT" ).append("\n"); 
		query.append("	#elseif (${keys} == 'svc_scp_cd')" ).append("\n"); 
		query.append("          ,R.SVC_SCP_CD																		 		AS SVC_SCP_CD" ).append("\n"); 
		query.append("	#elseif (${keys} == 'cust_tp_cd_yn')" ).append("\n"); 
		query.append("          ,DECODE(d.cust_tp_cd,'N','Y','N')																		 		AS CUST_TP_CD_YN" ).append("\n"); 
		query.append("    #else" ).append("\n"); 
		query.append("          ,D.$keys AS $keys" ).append("\n"); 
		query.append("    #end" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("          ,DECODE('${wk_sts}',  'Y', D.COST_YRMON, '')                                                          AS COST_YRMON" ).append("\n"); 
		query.append("          ,DECODE('${wk_sts}',  'Y', D.SLS_YRMON, '')                                                           AS SLS_YRMON" ).append("\n"); 
		query.append("          ,DECODE('${wk_sts}',  'Y', D.COST_WK, '')                                                             AS COST_WK" ).append("\n"); 
		query.append("          ,DECODE('${dir_sts}', 'Y', D.DIR_CD,  '')                                                             AS DIR_CD2" ).append("\n"); 
		query.append("          ,D.SPCL_CNTR_TPSZ_CD                                          										AS TPSZ_CODE" ).append("\n"); 
		query.append("		  ,SUM(NVL(D.BKG_QTY,0))																				AS QUANTITY" ).append("\n"); 
		query.append("          ,SUM(DECODE(SUBSTR(D.SPCL_CNTR_TPSZ_CD,-1,1),'2', D.BKG_QTY, D.BKG_QTY*2)) 							AS TEU" ).append("\n"); 
		query.append("          ,SUM(NVL(D.BKG_REV,0)+NVL(D.BKG_OFT_REV,0))                                                              AS BKG_REV" ).append("\n"); 
		query.append("          ,SUM(NVL(D.BKG_MISC_REV,0)+NVL(D.SCR_CHG_REV,0))                                                         AS MISC_REV" ).append("\n"); 
		query.append("          ,SUM(NVL(D.PA_CM_COST_TTL_AMT, 0))     AS CM_COST_A	--SJH.20141121.ADD,MOD" ).append("\n"); 
		query.append("          ,SUM(NVL(D.PA_CM_COST_TTL_AMT2, 0))    AS CM_COST_B" ).append("\n"); 
		query.append("          ,SUM(D.DMDT_COM_AMT)                                                                                     AS DEM_DET" ).append("\n"); 
		query.append("		  ,SUM(NVL(D.BKG_QTY, 0)) AS CHARGE_LOAD" ).append("\n"); 
		query.append("          FROM" ).append("\n"); 
		query.append("#if(${period} =='M')" ).append("\n"); 
		query.append("                  COA_BKG_EXPN_DTL D" ).append("\n"); 
		query.append("#elseif (${period} =='W')" ).append("\n"); 
		query.append("                  COA_BKG_EXPN_DTL D" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("                  ,COA_OFC_LVL L" ).append("\n"); 
		query.append("                  ,MDM_COMMODITY    K" ).append("\n"); 
		query.append("				  ,COA_RGST_BKG R" ).append("\n"); 
		query.append("#if (${soc_sts} == 'Y')" ).append("\n"); 
		query.append("                  ,COA_BKG_REV_DTL H" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("#if (${cmdt_desc_flg} == 'TRUE')" ).append("\n"); 
		query.append("                  ,(SELECT REP_CMDT_CD AS REP_CMDT_CD" ).append("\n"); 
		query.append("                       , REP_CMDT_NM AS REP_CMDT_DESC" ).append("\n"); 
		query.append("                    FROM MDM_REP_CMDT" ).append("\n"); 
		query.append("                    WHERE NVL(DELT_FLG,'N') = 'N'" ).append("\n"); 
		query.append("                    ) F" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("#if (${sc_desc_flg} == 'TRUE')" ).append("\n"); 
		query.append("                  ,(SELECT CUST_CNT_CD     AS CUST_CNT_CD" ).append("\n"); 
		query.append("                          ,CUST_SEQ        AS CUST_SEQ" ).append("\n"); 
		query.append("                          ,CUST_LGL_ENG_NM AS SC_DESC" ).append("\n"); 
		query.append("						  ,(SELECT CUST_GRP_NM FROM MDM_CUST_PERF_GRP B WHERE A.CUST_GRP_ID = B.CUST_GRP_ID) CUST_GRP_NM" ).append("\n"); 
		query.append("						  ,(SELECT INTG_CD_VAL_DP_DESC FROM COM_INTG_CD_DTL B WHERE B.INTG_CD_ID = 'CD00694' AND A.NBS_CLSS_CD1 = B.INTG_CD_VAL_CTNT) NBS_CLSS_CD1" ).append("\n"); 
		query.append("						  ,(SELECT INTG_CD_VAL_DP_DESC FROM COM_INTG_CD_DTL B WHERE B.INTG_CD_ID = 'CD00694' AND A.NBS_CLSS_CD2 = B.INTG_CD_VAL_CTNT) NBS_CLSS_CD2" ).append("\n"); 
		query.append("						  ,(SELECT INTG_CD_VAL_DP_DESC FROM COM_INTG_CD_DTL B WHERE B.INTG_CD_ID = 'CD00694' AND A.NBS_CLSS_CD3 = B.INTG_CD_VAL_CTNT) NBS_CLSS_CD3" ).append("\n"); 
		query.append("                    FROM MDM_CUSTOMER A" ).append("\n"); 
		query.append("                   ) J" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("#if (${bl_shpr_flg} == 'TRUE')" ).append("\n"); 
		query.append("                  ,(SELECT CUST_CNT_CD     AS CUST_CNT_CD" ).append("\n"); 
		query.append("                          ,CUST_SEQ        AS CUST_SEQ" ).append("\n"); 
		query.append("                          ,CUST_LGL_ENG_NM AS BL_SHPR_NM" ).append("\n"); 
		query.append("                    FROM MDM_CUSTOMER" ).append("\n"); 
		query.append("                    ) H" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("#if (${key_acct_group} != '' && ${key_acct_group} != 'All' && ${key_acc} == '')" ).append("\n"); 
		query.append("                  ,MDM_CUSTOMER F" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("#if ((${mlt_trd_group} != '' && ${mlt_trd_group} != 'All') || ${mlt_trd_indvl} != '')" ).append("\n"); 
		query.append("                  ,MDM_CUSTOMER MA" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("#if (${tare_flg} == 'TRUE')" ).append("\n"); 
		query.append("				  ,MDM_CNTR_TP_SZ MC" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("           WHERE 1=1" ).append("\n"); 
		query.append("#if(${period} =='M')" ).append("\n"); 
		query.append("             AND D.COST_YRMON  BETWEEN '${year}'||'${fm_mon}' AND '${year}'||'${to_mon}'" ).append("\n"); 
		query.append("             AND D.COST_YRMON  BETWEEN L.OFC_APLY_FM_YRMON AND L.OFC_APLY_TO_YRMON" ).append("\n"); 
		query.append("			 AND D.BKG_NO = R.BKG_NO" ).append("\n"); 
		query.append("#elseif (${period} =='W')" ).append("\n"); 
		query.append("             AND SUBSTR(D.SLS_YRMON, 1, 4)||D.COST_WK BETWEEN '${year}'||'${fm_wk}' AND '${year}'||'${to_wk}'" ).append("\n"); 
		query.append("			 AND D.BKG_NO = R.BKG_NO" ).append("\n"); 
		query.append("#if ( ${sls_month} != '')" ).append("\n"); 
		query.append("             AND D.SLS_YRMON = '${year}'||'${fm_mon}'	" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("             AND D.SLS_YRMON  BETWEEN L.OFC_APLY_FM_YRMON AND L.OFC_APLY_TO_YRMON" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("#if(${ofc_vw} =='C')" ).append("\n"); 
		query.append("             AND D.AGMT_SGN_OFC_CD = L.OFC_CD" ).append("\n"); 
		query.append("#elseif (${ofc_vw} =='L')" ).append("\n"); 
		query.append("             AND D.SLS_OFC_CD = L.OFC_CD" ).append("\n"); 
		query.append("#else" ).append("\n"); 
		query.append("             AND 1 = 0" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("#if (${sc_desc_flg} == 'TRUE')" ).append("\n"); 
		query.append("             AND D.AGMT_CNT_CD   = J.CUST_CNT_CD(+)" ).append("\n"); 
		query.append("             AND D.AGMT_CUST_SEQ = J.CUST_SEQ(+)" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("#if (${bl_shpr_flg} == 'TRUE')" ).append("\n"); 
		query.append("             AND D.SHPR_CNT_CD   = H.CUST_CNT_CD(+)" ).append("\n"); 
		query.append("             AND D.SHPR_CUST_SEQ = H.CUST_SEQ(+)" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("#if (${cmdt_desc_flg} == 'TRUE')" ).append("\n"); 
		query.append("             AND D.REP_CMDT_CD = F.REP_CMDT_CD" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("             AND D.CMDT_CD                = K.CMDT_CD(+)" ).append("\n"); 
		query.append("             AND NVL(D.DELT_FLG,'N')    = 'N'" ).append("\n"); 
		query.append("             AND D.BL_NO_TP             IN ('M','0')" ).append("\n"); 
		query.append("             AND D.BKG_STS_CD           IN ('F','S',DECODE(NVL('${bkg_sts}','N'), 'Y', 'W'))" ).append("\n"); 
		query.append("             AND NVL(D.BKG_CGO_TP_CD,'*') <> 'P'" ).append("\n"); 
		query.append("#if (${key_acct_group} != '' && ${key_acct_group} != 'All' && ${key_acc} == '')" ).append("\n"); 
		query.append("             AND D.AGMT_CNT_CD   = F.CUST_CNT_CD" ).append("\n"); 
		query.append("             AND D.AGMT_CUST_SEQ = F.CUST_SEQ" ).append("\n"); 
		query.append("             AND F.KEY_ACCT_FLG  = 'Y'" ).append("\n"); 
		query.append("             AND F.CNTR_DIV_FLG  = 'Y'" ).append("\n"); 
		query.append("             AND F.DELT_FLG      = 'N'" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("#if ((${mlt_trd_group} != '' && ${mlt_trd_group} != 'All') || ${mlt_trd_indvl} != '')" ).append("\n"); 
		query.append("             AND D.AGMT_CNT_CD   = MA.CUST_CNT_CD" ).append("\n"); 
		query.append("             AND D.AGMT_CUST_SEQ = MA.CUST_SEQ" ).append("\n"); 
		query.append("             AND MA.MLT_TRD_ACCT_FLG = 'Y'" ).append("\n"); 
		query.append("             AND MA.CNTR_DIV_FLG  = 'Y'" ).append("\n"); 
		query.append("             AND MA.DELT_FLG      = 'N'" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("#if (${tare_flg} == 'TRUE')" ).append("\n"); 
		query.append("			 --AND D.CNTR_TPSZ_CD = MC.CNTR_TPSZ_CD : 20150702.MOD" ).append("\n"); 
		query.append("             AND DECODE(SUBSTR(D.CNTR_TPSZ_CD,1,2),'RD',SUBSTR(D.CNTR_TPSZ_CD,1,1)||SUBSTR(D.CNTR_TPSZ_CD,-1),D.CNTR_TPSZ_CD) = MC.CNTR_TPSZ_CD" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("#if (${trd_cd} != '')" ).append("\n"); 
		query.append("             AND D.TRD_CD = '${trd_cd}'" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("#if (${rlane_cd} != '')" ).append("\n"); 
		query.append("             AND D.RLANE_CD = '${rlane_cd}'" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("#if (${taa_no} != '')" ).append("\n"); 
		query.append("             AND D.TAA_NO = '${taa_no}'" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("#if (${dir_cd} != '')" ).append("\n"); 
		query.append("             AND D.DIR_CD = '${dir_cd}'" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("#if (${vsl_cd} != '')" ).append("\n"); 
		query.append("             AND D.VSL_CD = '${vsl_cd}'" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("#if (${skd_voy_no} != '')" ).append("\n"); 
		query.append("             AND D.SKD_VOY_NO = '${skd_voy_no}'" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("#if (${skd_dir_cd} != '')" ).append("\n"); 
		query.append("             AND D.DIR_CD = '${skd_dir_cd}'" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("#if (${bkg_por_cd} != '')" ).append("\n"); 
		query.append("             AND D.BKG_POR_CD LIKE '${bkg_por_cd}' ||'%'" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("#if (${rev_pol_cd} != '')" ).append("\n"); 
		query.append("             AND D.REV_POL_CD LIKE '${rev_pol_cd}' ||'%'" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("#if (${rev_pod_cd} != '')" ).append("\n"); 
		query.append("             AND D.REV_POD_CD LIKE '${rev_pod_cd}' ||'%'" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("#if (${bkg_del_cd} != '')" ).append("\n"); 
		query.append("             AND D.BKG_DEL_CD LIKE '${bkg_del_cd}' ||'%'" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("#if (${bkg_pol_cd} != '')" ).append("\n"); 
		query.append("             AND D.BKG_POL_CD LIKE '${bkg_pol_cd}' ||'%'" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("#if (${bkg_pod_cd} != '')" ).append("\n"); 
		query.append("             AND D.BKG_POD_CD LIKE '${bkg_pod_cd}' ||'%'" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("#if (${sc_no} != '')" ).append("\n"); 
		query.append("             AND D.SC_NO = '${sc_no}'" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("#if (${rfa_no} != '')" ).append("\n"); 
		query.append("             AND D.RFA_NO = '${rfa_no}'" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("#if (${shpr_cnt_cd} != '')" ).append("\n"); 
		query.append("             AND D.SHPR_CNT_CD || D.SHPR_CUST_SEQ = '${shpr_cnt_cd}'" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("#if (${cmdt_cd} != '')" ).append("\n"); 
		query.append("             AND D.REP_CMDT_CD = '${cmdt_cd}'" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("#if (${usa_bkg_mod_cd} != '')" ).append("\n"); 
		query.append("             AND D.USA_BKG_MOD_CD = '${usa_bkg_mod_cd}'" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("#if (${svc_scp_cd} != '')" ).append("\n"); 
		query.append("             AND R.SVC_SCP_CD = '${svc_scp_cd}'" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("#if (${bkg_no} != '')	" ).append("\n"); 
		query.append("	         AND D.BKG_NO IN (" ).append("\n"); 
		query.append("		        #foreach( $bkg_cd in ${bkg_no_list} )" ).append("\n"); 
		query.append("			        #if($velocityCount < $bkg_no_list.size()) '$bkg_cd', #else '$bkg_cd' #end" ).append("\n"); 
		query.append("		        #end" ).append("\n"); 
		query.append("		        )" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("#if (${cntr_tpsz_cd} != '' )" ).append("\n"); 
		query.append("             AND (" ).append("\n"); 
		query.append("    #foreach($field_id in ${cntr_tpsz_cd})" ).append("\n"); 
		query.append("        #if($velocityCount > 1)" ).append("\n"); 
		query.append("               OR #end      D.SPCL_CNTR_TPSZ_CD = '$field_id'" ).append("\n"); 
		query.append("        #end" ).append("\n"); 
		query.append("                 )" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("#if (${key_acct_group} != '' && ${key_acct_group} != 'All' && ${key_acc} == '')" ).append("\n"); 
		query.append("    #if (${key_acct_group1} != '')" ).append("\n"); 
		query.append("             AND F.CUST_GRP_ID = '${key_acct_group1}'" ).append("\n"); 
		query.append("    #end" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("#if (${key_acc1} != '')" ).append("\n"); 
		query.append("             AND D.AGMT_CNT_CD = '${key_acc1}'" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("#if (${key_acc2} != '')" ).append("\n"); 
		query.append("             AND D.AGMT_CUST_SEQ = '${key_acc2}'" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("#if (${key_acc3} != '')" ).append("\n"); 
		query.append("             AND D.CUST_KEY_AGMT_MGR_FLG = '${key_acc3}'" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("#if (${mlt_trd_group} != '' && ${mlt_trd_group} != 'All' && ${mlt_trd_indvl} == '')" ).append("\n"); 
		query.append("	#if (${mlt_trd_group1} != '')" ).append("\n"); 
		query.append("             AND MA.CUST_GRP_ID = '${mlt_trd_group1}'" ).append("\n"); 
		query.append("	#end" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("#if (${mlt_trd_acc1} != '')" ).append("\n"); 
		query.append("             AND D.AGMT_CNT_CD = '${mlt_trd_acc1}'" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("#if (${mlt_trd_acc2} != '')" ).append("\n"); 
		query.append("             AND D.AGMT_CUST_SEQ = '${mlt_trd_acc2}'" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("#if (${mlt_trd_acc3} != '')" ).append("\n"); 
		query.append("--             AND D.CUST_KEY_AGMT_MGR_FLG = '${mlt_trd_acc3}'" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("#if (${soc_sts} == 'Y')" ).append("\n"); 
		query.append("             AND D.BKG_NO       = H.BKG_NO" ).append("\n"); 
		query.append("             AND D.CNTR_TPSZ_CD = H.CNTR_TPSZ_CD" ).append("\n"); 
		query.append("             AND D.COST_ROUT_NO = H.COST_ROUT_NO" ).append("\n"); 
		query.append("             AND NVL(H.SOC_FLG,'N') = 'N'" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("#if(${sls_ofc_cd} !='')" ).append("\n"); 
		query.append("    #if(${excl_sts} =='')" ).append("\n"); 
		query.append("             AND DECODE('${ofc_lvl}','1',L.OFC_N1ST_LVL_CD,'2',L.OFC_N2ND_LVL_CD,'3',L.OFC_N3RD_LVL_CD,'4',L.OFC_N4TH_LVL_CD,'5',L.OFC_N5TH_LVL_CD" ).append("\n"); 
		query.append("              ,'6',L.OFC_N6TH_LVL_CD,'7',L.OFC_N7TH_LVL_CD) = '${ofc_cd}'" ).append("\n"); 
		query.append("    #else" ).append("\n"); 
		query.append("             AND L.OFC_CD = '${ofc_cd}'" ).append("\n"); 
		query.append("    #end" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("#if(${ofc_lvl}=='6' || ${ofc_lvl}=='7')" ).append("\n"); 
		query.append("             AND L.OFC_LVL = '${ofc_lvl}'" ).append("\n"); 
		query.append("#else" ).append("\n"); 
		query.append("             AND L.OFC_LVL < '9'" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("            GROUP BY 1" ).append("\n"); 
		query.append("            ,D.BKG_NO" ).append("\n"); 
		query.append("            ,D.SPCL_CNTR_TPSZ_CD" ).append("\n"); 
		query.append("#foreach(${keys} IN ${keyList3})" ).append("\n"); 
		query.append("    #if (${keys} == 'sc_desc'|| ${keys} == 'nbs_clss_cd1' || ${keys} == 'nbs_clss_cd2' || ${keys} == 'nbs_clss_cd3' || ${keys} == 'cust_grp_nm')" ).append("\n"); 
		query.append("                    ,J.$keys" ).append("\n"); 
		query.append("    #elseif (${keys} == 'rep_cmdt_desc')" ).append("\n"); 
		query.append("                    ,F.$keys" ).append("\n"); 
		query.append("    #elseif (${keys} == 'shpr_nm')" ).append("\n"); 
		query.append("                    ,H.BL_SHPR_NM" ).append("\n"); 
		query.append("    #elseif (${keys} == 'bkg_no')" ).append("\n"); 
		query.append("                    ,D.BKG_NO" ).append("\n"); 
		query.append("    #elseif (${keys} == 'rev_vvd')" ).append("\n"); 
		query.append("                    ,D.VSL_CD||D.SKD_VOY_NO||D.DIR_CD" ).append("\n"); 
		query.append("    #elseif (${keys} == 'bl_no')" ).append("\n"); 
		query.append("                    ,D.BL_NO || D.BL_NO_TP || D.BL_NO_CHK" ).append("\n"); 
		query.append("    #elseif (${keys} == 'slan_cd')" ).append("\n"); 
		query.append("                    ,D.SLAN_CD" ).append("\n"); 
		query.append("    #elseif (${keys} == 'soc_flg' || ${keys} == 'spcl_dg_cgo_flg' || ${keys} == 'spcl_bb_cgo_flg' || ${keys} == 'spcl_awk_cgo_flg')" ).append("\n"); 
		query.append("                    ,NVL(D.$keys, 'N')" ).append("\n"); 
		query.append("    #elseif (${keys} == 'bkg_cgo_tp_cd_r')" ).append("\n"); 
		query.append("                    ,DECODE(D.BKG_CGO_TP_CD, 'R', 'Y', 'N')" ).append("\n"); 
		query.append("    #elseif (${keys} == 'bkg_cgo_wgt')" ).append("\n"); 
		query.append("                    ,D.BKG_CGO_WGT" ).append("\n"); 
		query.append("    #elseif (${keys} == 'sc_cust_cd')" ).append("\n"); 
		query.append("                    ,D.AGMT_CNT_CD || TO_CHAR(LPAD(DECODE(D.AGMT_CUST_SEQ,0,'',D.AGMT_CUST_SEQ),6,'0'))" ).append("\n"); 
		query.append("    #elseif (${keys} == 'cmdt_desc')" ).append("\n"); 
		query.append("                    ,K.CMDT_NM" ).append("\n"); 
		query.append("    #elseif (${keys} == 'sc_cust_nm')" ).append("\n"); 
		query.append("                    ,D.AGMT_CNT_CD" ).append("\n"); 
		query.append("                    ,D.AGMT_CUST_SEQ" ).append("\n"); 
		query.append("    #elseif (${keys} == 'bkg_shpr_cd')" ).append("\n"); 
		query.append("                    ,D.SHPR_CNT_CD || TO_CHAR(LPAD(DECODE(D.SHPR_CUST_SEQ,0,'',D.SHPR_CUST_SEQ),6,'0'))" ).append("\n"); 
		query.append("    #elseif (${keys} == 'bkg_shpr_nm')" ).append("\n"); 
		query.append("                    ,D.SHPR_CNT_CD" ).append("\n"); 
		query.append("                    ,D.SHPR_CUST_SEQ" ).append("\n"); 
		query.append("    #elseif (${keys} == 'cnee_cd')" ).append("\n"); 
		query.append("                    ,D.CNEE_CNT_CD || TO_CHAR(LPAD(DECODE(D.CNEE_CUST_SEQ,0,'',D.CNEE_CUST_SEQ),6,'0'))" ).append("\n"); 
		query.append("    #elseif (${keys} == 'cnee_nm')" ).append("\n"); 
		query.append("                    ,D.CNEE_CNT_CD" ).append("\n"); 
		query.append("                    ,D.CNEE_CUST_SEQ" ).append("\n"); 
		query.append("    #elseif (${keys} == 'ntfy_cd')" ).append("\n"); 
		query.append("                    ,D.NTFY_CNT_CD || TO_CHAR(LPAD(DECODE(D.NTFY_CUST_SEQ,0,'',D.NTFY_CUST_SEQ),6,'0'))" ).append("\n"); 
		query.append("    #elseif (${keys} == 'ntfy_nm')" ).append("\n"); 
		query.append("                    ,D.NTFY_CNT_CD" ).append("\n"); 
		query.append("                    ,D.NTFY_CUST_SEQ" ).append("\n"); 
		query.append("    #elseif (${keys} == 'shpr_cd')" ).append("\n"); 
		query.append("                    ,D.SHPR_CNT_CD || TO_CHAR(LPAD(DECODE(D.SHPR_CUST_SEQ,0,'',D.SHPR_CUST_SEQ),6,'0'))" ).append("\n"); 
		query.append("    #elseif (${keys} == 'bl_shpr_cd')" ).append("\n"); 
		query.append("          			,D.SHPR_CNT_CD || TO_CHAR(LPAD(DECODE(D.SHPR_CUST_SEQ,0,'',D.SHPR_CUST_SEQ),6,'0'))" ).append("\n"); 
		query.append("	#elseif (${keys} == 'rev_pol_cd')" ).append("\n"); 
		query.append("          			,R.REV_POL_CD" ).append("\n"); 
		query.append("	#elseif (${keys} == 'rev_pod_cd')" ).append("\n"); 
		query.append("          			,R.REV_POD_CD" ).append("\n"); 
		query.append("	#elseif (${keys} == 'last_vvd')" ).append("\n"); 
		query.append("          ,SUBSTR(COALESCE(D.N4TH_FINC_VVD_CD,D.N3RD_FINC_VVD_CD,D.N2ND_FINC_VVD_CD,D.N1ST_FINC_VVD_CD),1,9)" ).append("\n"); 
		query.append("	#elseif (${keys} == 'last_trade')" ).append("\n"); 
		query.append("          ,COALESCE(D.N4TH_TRD_CD,D.N3RD_TRD_CD,D.N2ND_TRD_CD,D.N1ST_TRD_CD)" ).append("\n"); 
		query.append("	#elseif (${keys} == 'last_lane')" ).append("\n"); 
		query.append("          ,COALESCE(D.N4TH_RLANE_CD,D.N3RD_RLANE_CD,D.N2ND_RLANE_CD,D.N1ST_RLANE_CD)" ).append("\n"); 
		query.append("	#elseif (${keys} == 'mty_pkup_yd_cd')" ).append("\n"); 
		query.append("          ,R.MTY_PKUP_YD_CD" ).append("\n"); 
		query.append("	#elseif (${keys} == 'mty_rtn_yd_cd')" ).append("\n"); 
		query.append("          ,R.MTY_RTN_YD_CD" ).append("\n"); 
		query.append("	#elseif (${keys} == 'n1st_sail_dt')" ).append("\n"); 
		query.append("          ,R.N1ST_SAIL_DT" ).append("\n"); 
		query.append("	#elseif (${keys} == 'svc_scp_cd')" ).append("\n"); 
		query.append("          ,R.SVC_SCP_CD" ).append("\n"); 
		query.append("	#elseif (${keys} == 'cust_tp_cd_yn')" ).append("\n"); 
		query.append("          ,DECODE(d.cust_tp_cd,'N','Y','N')	" ).append("\n"); 
		query.append("    #elseif (${keys} == 'cntr_tpsz_tare_wgt')" ).append("\n"); 
		query.append("          ,NVL(D.BKG_QTY,0) * NVL(MC.CNTR_TPSZ_TARE_WGT,0)" ).append("\n"); 
		query.append("	#elseif (${keys} == 'tare_weight')" ).append("\n"); 
		query.append("          ,'KGS'		" ).append("\n"); 
		query.append("    #else" ).append("\n"); 
		query.append("                    ,D.$keys" ).append("\n"); 
		query.append("    #end" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("                    ,DECODE('${wk_sts}', 'Y', D.COST_YRMON, '')" ).append("\n"); 
		query.append("                    ,DECODE('${wk_sts}', 'Y', D.SLS_YRMON, '')" ).append("\n"); 
		query.append("                    ,DECODE('${wk_sts}', 'Y', D.COST_WK, '')" ).append("\n"); 
		query.append("                    ,DECODE('${dir_sts}', 'Y', D.DIR_CD, '')" ).append("\n"); 
		query.append("                    ,DECODE('${tpsz_sts}', 'BOX', D.SPCL_CNTR_TPSZ_CD, 'TEU','')" ).append("\n"); 
		query.append("      " ).append("\n"); 
		query.append("    )" ).append("\n"); 
		query.append("GROUP BY 1" ).append("\n"); 
		query.append("#foreach(${keys} IN ${keyList4})" ).append("\n"); 
		query.append("    #if (${keys} == 'obrd_dt' || ${keys} == 'cntr_rcv_dt' )" ).append("\n"); 
		query.append("        ,TO_CHAR($keys,'YYYY-MM-DD')" ).append("\n"); 
		query.append("    #else" ).append("\n"); 
		query.append("        ,$keys" ).append("\n"); 
		query.append("    #end" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("        ,COST_YRMON" ).append("\n"); 
		query.append("        ,SLS_YRMON" ).append("\n"); 
		query.append("        ,COST_WK" ).append("\n"); 
		query.append("        ,DIR_CD2" ).append("\n"); 
		query.append("        ,TPSZ_CODE" ).append("\n"); 

	}
}