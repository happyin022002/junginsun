<?xml version="1.0" encoding="UTF-8"?>
<sqls>
	<querys>
		<query name="DominicanManifestDownloadDBDAOsearchManifestBLRSQL">
			<desc><![CDATA[manifest bl 정보 조회]]></desc>
			<sql><![CDATA[
SELECT   
          BK.BL_NO
         , 'IG9016-C' BL_TYPE
         , 'IG9035-I' Transit_Type
         , BV.POD_CD Last_Port_Code
         , BV.POL_CD Loading_Port_Code
         , REPLACE(REPLACE((NVL(BBD.PCK_CMDT_DESC, '') || CHR(10) || NVL(BBD.CNTR_CMDT_DESC, '') || CHR(10) ||  NVL(BBMD.CMDT_DESC, '')),CHR(9),''),CHR(13),'') Goods_Name
         , BBD.PCK_TP_CD Package_Unit_Code
         , BBD.PCK_QTY Package_Qty
         , '' Gross_Weight
         , '' value

         ,( SELECT SUM(CHG_AMT) FROM BKG_CHG_RT WHERE BKG_NO = BK.BKG_NO AND CHG_CD = 'OFT') Flight_Charge
         , '' volume
         , 'IG1015-G' Express_Type
         
         , 'SA09-002' Consignor_Type
         , BCS.CUST_CNT_CD || BCS.CUST_SEQ AS Consignor_Code
         , BCS_C.PHN_NO Consignor_Tel
         , BCS.CUST_CNT_CD Consignor_Country_Code
         , BCS.CUST_NM Consignor_Name
         , 'SA13-RNC' Consignor_Document_Type
         , 'B0103_DGA' Consignor_Document_No
         , BCS.CUST_EML Consignor_Email
         , BCS.CUST_FAX_NO Consignee_Fax
         , BCS.CUST_ZIP_ID Consignor_Zip_Code
         , BCS.CUST_STE_CD  Consignor_Street
         , '' Consignor_Zone_Name
         , BCS.CUST_CTY_NM Consignor_City

         , 'SA09-002' Consignee_Type
         , BCC.CUST_CNT_CD || BCC.CUST_SEQ AS Consignee_Code
         , BCC_C.PHN_NO Consignee_Tel
         , BCC.CUST_CNT_CD Consignee_Country_Code
         , BCC.CUST_NM Consignee_Name
         , 'SA13-RNC' Consignee_Document_Type
         , 'B0103_DGA' Consignee_Document_No
         , BCC.CUST_EML Consignee_Email
         , BCC.CUST_FAX_NO Consignee_Fax
         , BCC.CUST_ZIP_ID Consignee_Zip_Code
         , BCC.CUST_STE_CD  Consignee_Street
         , '' Consignee_Zone_Name
         , BCC.CUST_CTY_NM Consignee_City

         , 'SA09-002' Notify_Type
         , BCN.CUST_CNT_CD || BCN.CUST_SEQ AS Notify_Code
         , BCN.CUST_CNT_CD Notify_Country_Code
         , 'SA13-RNC' Notify_Document_Type
         , 'B0103_DGA' Notify_Document_No
         , BCN.CUST_NM Notify_Name
         , BCN.CUST_EML Notify_Email
         , BCN_C.PHN_NO Notify_Tel
         , BCN.CUST_FAX_NO Notify_Fax
         , BCN.CUST_ZIP_ID Notify_Zip_Code
         , BCN.CUST_STE_CD  Notify_Street
         , '' Notify_Zone_Name
         , BCN.CUST_CTY_NM Notify_City
                                              
  FROM   
        BKG_VVD BV
        ,BKG_BOOKING BK                                                                               
        ,BKG_BL_ISS  BBI                                                                              
        ,BKG_BL_DOC  BBD                                                                              
        ,BKG_RATE    BR                                                                               
        ,BKG_CUSTOMER BCS                                                                             
        ,BKG_CUSTOMER BCC                                                                             
        ,BKG_CUSTOMER BCN                                                                             
        ,BKG_CUSTOMER BCF                                                                             
        ,BKG_CUSTOMER BCA                                                                             
        ,BKG_CUSTOMER BCE    
        
        , MDM_CUST_CNTC_PNT BCS_C
        , MDM_CUST_CNTC_PNT BCC_C
        , MDM_CUST_CNTC_PNT BCN_C
        
        ,BKG_BL_MK_DESC BBMD

        
        ,BKG_CSTMS_CMDT   CMD                                                                         
        ,MDM_LOCATION     LOC0                                                                        
        ,MDM_LOCATION     LOC1                                                                        
        ,MDM_LOCATION     LOC2                                                                        
        ,MDM_LOCATION     LOC3                                                                        
        ,MDM_LOCATION     LOC4                                                                        
        ,MDM_LOCATION     LOC5                                                                        
        ,MDM_ORGANIZATION OFC                                                                         
        ,MDM_COMMODITY    COM                                                                         
 WHERE BV.VSL_CD = SUBSTR(@[vvd], 1, 4)
   AND BV.SKD_VOY_NO = SUBSTR(@[vvd], 5, 4)
   AND BV.SKD_DIR_CD = SUBSTR(@[vvd], 9, 1)
   AND BV.POD_CD = @[pod_cd]
   
   AND   BK.BKG_NO          =   BV.BKG_NO
   AND   BK.BKG_NO          =   BBI.BKG_NO      (+)
   AND   BK.BKG_NO          =   BBD.BKG_NO      (+)
   AND   BK.BKG_NO          =   BR.BKG_NO       (+)
   AND   BK.BKG_NO          =   BCS.BKG_NO      (+)
   AND   BCS.BKG_CUST_TP_CD =   'S'
   AND   BK.BKG_NO          =   BCC.BKG_NO      (+)
   AND   BCC.BKG_CUST_TP_CD(+) =   'C'
   AND   BK.BKG_NO          =   BCN.BKG_NO      (+)
   AND   BCN.BKG_CUST_TP_CD(+) =   'N'
   AND   BK.BKG_NO          =   BCF.BKG_NO      (+)
   AND   BCF.BKG_CUST_TP_CD(+) =   'F'
   AND   BK.BKG_NO          =   BCA.BKG_NO      (+)
   AND   BCA.BKG_CUST_TP_CD(+) =   'A'
   AND   BK.BKG_NO          =   BCE.BKG_NO      (+)
   AND   BCE.BKG_CUST_TP_CD(+) =   'E'
   
   AND   LOC0.LOC_CD(+)     =  BV.POD_CD
   AND   BK.POR_CD         =   LOC3.LOC_CD  (+)
   AND   BK.POL_CD         =   LOC1.LOC_CD  (+)
   AND   BK.POD_CD         =   LOC2.LOC_CD  (+)
   AND   BK.DEL_CD         =   LOC4.LOC_CD  (+)
   AND   LOC5.LOC_CD(+)    = NVL(BK.PRE_RLY_PORT_CD,' ')
   AND   BBI.OBL_ISS_OFC_CD      = OFC.OFC_CD(+)
   AND   BK.CMDT_CD         = COM.CMDT_CD(+)
   AND   BK.CMDT_CD         = CMD.MF_CMDT_CD(+)
   
   AND   BK.BKG_NO = BBMD.BKG_NO (+)
   AND   BBMD.MK_SEQ(+) = 1
   
   AND   BCS.CUST_CNT_CD = BCS_C.CUST_CNT_CD(+)
   AND   BCS.CUST_SEQ    = BCS_C.CUST_SEQ(+)
   AND   BCC.CUST_CNT_CD = BCC_C.CUST_CNT_CD(+)
   AND   BCC.CUST_SEQ    = BCC_C.CUST_SEQ(+)
   AND   BCN.CUST_CNT_CD = BCN_C.CUST_CNT_CD(+)
   AND   BCN.CUST_SEQ    = BCN_C.CUST_SEQ(+)
   			]]></sql>
			<params>
				<param name="vvd" type="12" value="" out="N"/>
				<param name="pod_cd" type="12" value="" out="N"/>
			</params>
		</query>
	</querys>
</sqls>
