<?xml version="1.0" encoding="UTF-8"?>
<sqls>
	<querys>
		<query name="QtaAdjustmentDBDAOCreateCmcbAdjustUSQL">
			<desc><![CDATA[[CMCB adjust]을을 [생성] 합니다]]></desc>
			<sql><![CDATA[
MERGE INTO CSQ_CFM_QTA QTA                                               
USING CSQ_QTA_LANE_OFC_COST CST                                                                          
    ON (                                                                                   
                   QTA.BSE_TP_CD                  = CST.BSE_TP_CD
               AND QTA.BSE_YR                     = CST.BSE_YR
               AND QTA.BSE_QTR_CD                 = CST.BSE_QTR_CD
               AND QTA.OFC_VW_CD                  = CST.OFC_VW_CD
               AND QTA.TRD_CD                     = CST.TRD_CD
               AND QTA.RLANE_CD                   = CST.RLANE_CD
               AND QTA.DIR_CD                     = CST.DIR_CD
--               AND QTA.RHQ_CD                     = CST.RHQ_CD
               AND QTA.RGN_OFC_CD                 = CST.RGN_OFC_CD
               AND QTA.BSE_TP_CD                  = 'Q'
               AND QTA.BSE_YR                     = @[f_bse_yr]
               AND QTA.BSE_QTR_CD                 = @[f_bse_qtr_cd]
               AND QTA.OFC_VW_CD                  = @[f_ofc_vw_cd]
               AND QTA.QTA_TGT_CD                 = 'D'
               AND SUBSTR(QTA.QTA_RLSE_VER_NO,-2) = '02'
#if (${f_trd_cd} != '' && ${f_trd_cd} != 'All')
               AND QTA.TRD_CD                     = @[f_trd_cd]
#end 
#if (${f_rlane_cd} != '' && ${f_rlane_cd} != 'All')
               AND QTA.RLANE_CD                   = @[f_rlane_cd]
#end
#if (${f_dir_cd} != '' && ${f_dir_cd} != 'All')
               AND QTA.DIR_CD                     = @[f_dir_cd]
#end 
#if (${f_rhq_cd} != '' && ${f_rhq_cd} != 'All')
               AND QTA.RHQ_CD                     = @[f_rhq_cd]
#end 
#if (${f_rgn_ofc_cd} != '' && ${f_rgn_ofc_cd} != 'All')
               AND QTA.RGN_OFC_CD                 = @[f_rgn_ofc_cd]
#end
#if (${f_vsl_cd} != '')
               AND QTA.VSL_CD                     = @[f_vsl_cd]
#end
#if (${f_skd_voy_no} != '')
               AND QTA.SKD_VOY_NO                 = @[f_skd_voy_no]
#end
#if (${f_skd_dir_cd} != '')
               AND QTA.SKD_DIR_CD                 = @[f_skd_dir_cd]    
#end
       )                                                                                   
WHEN MATCHED THEN                                                                        
                 UPDATE SET  QTA.PA_CM_UC_AMT = CST.PA_CM_UC_AMT                    
                            ,QTA.RA_CM_UC_AMT = CST.RA_CM_UC_AMT                
                            ,QTA.UPD_USR_ID   = @[usr_id]                                  
                            ,QTA.UPD_DT       = SYSDATE			]]></sql>
			<params>
				<param name="f_bse_yr" type="12" value="" out="N"/>
				<param name="f_bse_qtr_cd" type="12" value="" out="N"/>
				<param name="f_ofc_vw_cd" type="12" value="" out="N"/>
				<param name="f_trd_cd" type="12" value="" out="N"/>
				<param name="f_rlane_cd" type="12" value="" out="N"/>
				<param name="f_dir_cd" type="12" value="" out="N"/>
				<param name="f_rhq_cd" type="12" value="" out="N"/>
				<param name="f_rgn_ofc_cd" type="12" value="" out="N"/>
				<param name="f_vsl_cd" type="12" value="" out="N"/>
				<param name="f_skd_voy_no" type="12" value="" out="N"/>
				<param name="f_skd_dir_cd" type="12" value="" out="N"/>
				<param name="usr_id" type="12" value="" out="N"/>
			</params>
		</query>
	</querys>
</sqls>
