<?xml version="1.0" encoding="UTF-8"?>
<sqls>
	<querys>
		<query name="WeeklyCMDBDAOSearchWeeklyTargetVVDListRSQL">
			<desc><![CDATA[SearchWeeklyTargetVVDList SELECT]]></desc>
			<sql><![CDATA[
SELECT
     DECODE(NVL(A.bsa_zr_flg,'N'),'N', '0', '1')                BSA_ZR_FLG
    ,A.COST_YRMON                                               COST_YRMON
    ,A.SLS_YRMON                                                SLS_YRMON
    ,A.COST_WK                                                  COST_WK
    ,A.TRD_CD                                                   TRD_CD
    ,A.SUB_TRD_CD                                               SUB_TRD_CD
    ,B.SLAN_CD                                                  SLAN_CD
    ,A.RLANE_CD                                                 RLANE_CD
    ,B.VSL_LANE_TP_CD                                           VSL_LANE_TP_CD
    ,A.VSL_CD                                                   VSL_CD
    ,A.SKD_VOY_NO                                               SKD_VOY_NO
    ,A.DIR_CD                                                   DIR_CD
    ,A.IOC_CD                                                   IOC_CD
    ,A.LST_LODG_PORT_CD                                         LST_LODG_PORT_CD
    ,TO_CHAR( A.LST_LODG_PORT_ETD_DT, 'YYYY-MM-DD HH24:MI:SS')  LST_LODG_PORT_ETD_DT
    ,TO_CHAR(A.N1ST_LODG_PORT_ETD_DT, 'YYYY-MM-DD HH24:MI:SS')  N1ST_LODG_PORT_ETD_DT
    ,CASE WHEN A.WKY_TGT_FLG = 'Y' THEN 'YES' ELSE 'NO' END     WKY_TGT_FLG
     --DECODE(A.wky_tgt_flg, 'N', 'NO', 'YES') wky_tgt_flg
    ,A.WKY_MNL_FLG                                              WKY_MNL_FLG
    ,DECODE(A.MON_TGT_FLG, 'N', 'NO', 'YES')                    MON_TGT_FLG
    ,A.DELT_FLG                                                 DELT_FLG
   FROM COA_MON_VVD A
      , (
           SELECT DISTINCT NVL(B.TRD_CD          , A.TRD_CD)         TRD_CD,
                  NVL(B.RLANE_CD        , A.RLANE_CD)       RLANE_CD,
                  NVL(B.DIR_CD          , A.DIR_CD)         DIR_CD,
                  NVL(B.IOC_CD          , A.IOC_CD)         IOC_CD,
                  NVL(B.VSL_LANE_TP_CD  , A.VSL_LANE_TP_CD) VSL_LANE_TP_CD,
                  NVL(B.LANE_APLY_FM_DT, '19000101') LANE_APLY_FOM_DT,
                  NVL(B.LANE_APLY_TO_DT , '99991231') LANE_APLY_TO_DT,
                  A.SLAN_CD,
                  A.SUB_TRD_CD
             FROM COA_LANE_RGST A 
                  FULL OUTER JOIN                                           
                  COA_LANE_TP_HIS B
               ON (    A.TRD_CD   = B.TRD_CD
                   AND A.RLANE_CD = B.RLANE_CD
                   AND A.DIR_CD   = B.DIR_CD
                   AND A.IOC_CD   = B.IOC_CD)
            WHERE NVL(A.DELT_FLG,'N')     = 'N'     
      ) B
  WHERE A.TRD_CD   = B.TRD_CD
    AND A.RLANE_CD = B.RLANE_CD
    AND A.IOC_CD   = B.IOC_CD
    AND A.DIR_CD   = B.DIR_CD
	AND NVL(TO_CHAR(A.N1ST_LODG_PORT_ETD_DT,'YYYYMMDD'),'19000101') BETWEEN NVL(B.LANE_APLY_FOM_DT,'19000101') AND NVL(B.LANE_APLY_TO_DT, '99991231')
    #if (${f_chkdel} == '')
    AND NVL(A.DELT_FLG,'N') = 'N'
    #else
    AND NVL(A.DELT_FLG,'N') = 'Y'
    #end
    #if (${f_seltrade} != '')
    AND A.TRD_CD = @[f_seltrade]
    #end
    #if (${f_selrlane} != '')
    AND A.RLANE_CD = @[f_selrlane]
    #end
    #if (${f_seldir} != '')
    AND A.DIR_CD = @[f_seldir]
    #end
    #if (${f_selioc} != '')
    AND A.IOC_CD = @[f_selioc]
    #end
    #if (${f_selslane} != '')
    AND A.SLAN_CD = @[f_selslane]
    #end
    #if (${f_vsl_cd} != '')
    AND A.VSL_CD = @[f_vsl_cd]
    #end
    #if (${f_skd_voy_no} != '')
    AND A.SKD_VOY_NO = @[f_skd_voy_no]
    #end
    #if (${f_dir_cd} != '')
    AND A.DIR_CD = @[f_dir_cd]
    #end
    #if (${f_chkprd} == 'M')
        #if (${f_fm_mon} != '')
    AND A.COST_YRMON BETWEEN @[f_year]||@[f_fm_mon] AND @[f_year]||@[f_to_mon]
        #else
    AND A.COST_YRMON like @[f_year] || '%'
        #end
    #elseif(${f_chkprd} == 'W')
    AND A.SLS_YRMON LIKE @[f_year] || '%'
        #if (${f_fm_wk} != '')
    AND A.COST_WK BETWEEN @[f_fm_wk] AND @[f_to_wk]
        #end
    #end
 ORDER BY A.COST_YRMON
        , A.COST_WK
        , A.TRD_CD
        , B.SUB_TRD_CD
        , B.SLAN_CD			]]></sql>
			<params>
				<param name="f_seltrade" type="12" value="" out="N"/>
				<param name="f_selrlane" type="12" value="" out="N"/>
				<param name="f_seldir" type="12" value="" out="N"/>
				<param name="f_selioc" type="12" value="" out="N"/>
				<param name="f_selslane" type="12" value="" out="N"/>
				<param name="f_vsl_cd" type="12" value="" out="N"/>
				<param name="f_skd_voy_no" type="12" value="" out="N"/>
				<param name="f_dir_cd" type="12" value="" out="N"/>
				<param name="f_year" type="12" value="" out="N"/>
				<param name="f_fm_mon" type="12" value="" out="N"/>
				<param name="f_to_mon" type="12" value="" out="N"/>
				<param name="f_fm_wk" type="12" value="" out="N"/>
				<param name="f_to_wk" type="12" value="" out="N"/>
			</params>
		</query>
	</querys>
</sqls>
