/*=========================================================
*Copyright(c) 2016 CyberLogitec
*@FileName : StatusReportDBDAOSearchCustVipReport1RSQL.java
*@FileTitle : 
*Open Issues :
*Change history :
*@LastModifyDate : 2016.07.26
*@LastModifier : 
*@LastVersion : 1.0
* 2016.07.26 
* 1.0 Creation
=========================================================*/
package com.clt.apps.opus.esm.bkg.bookingreport.statusreport.integration;

import java.util.HashMap;
import org.apache.log4j.Logger;
import com.clt.framework.support.db.ISQLTemplate;

/**
 *
 * @author 
 * @see DAO 참조
 * @since J2EE 1.6
 */

public class StatusReportDBDAOSearchCustVipReport1RSQL implements ISQLTemplate{

	private StringBuffer query = new StringBuffer();
	
	Logger log =Logger.getLogger(this.getClass());
	
	/** Parameters definition in params/param elements */
	private HashMap<String,String[]> params = null;
	
	/**
	  * <pre>
	  * StatusReportDBDAOSearchCustVipReport1RSQL
	  * 2010.09.10 김영철 [ ] VIP REPORT 부분 오류 수정 ( 반영일 : 2010.09.24 )
	  * 2010.09.29 김영철 [ ] VIP REPORT 부분 SQL문 오류인하여 수정함.
	  * 2011.06.16 변종건 [CHM-201111601-01] VIP Report -조회조건추가 (RFA#컬럼 )
	  * 2011.06.23 변종건 [CHM-201111602-01] VIP Report - Group Customer 기준 변경 (Contract Customer)
	  * 2013.02.06 김진주 [CHM-201322646] VIP Report Item 추가 요청 - Discharging at TS Port
	  * 2013.03.13 임재관 [CHM-201323518] VIP Report 보완 - Final destination name 로직 추가, Partial 선적의 Pick up yard 누락 보완
	  * </pre>
	  */
	public StatusReportDBDAOSearchCustVipReport1RSQL(){
		setQuery();
		params = new HashMap<String,String[]>();
		String tmp = null;
		String[] arrTmp = null;
		tmp = java.sql.Types.VARCHAR + ",N";
		arrTmp = tmp.split(",");
		if(arrTmp.length !=2){
			throw new IllegalArgumentException();
		}
		params.put("vps_eta_dt",new String[]{arrTmp[0],arrTmp[1]});

		tmp = java.sql.Types.VARCHAR + ",N";
		arrTmp = tmp.split(",");
		if(arrTmp.length !=2){
			throw new IllegalArgumentException();
		}
		params.put("taa_no",new String[]{arrTmp[0],arrTmp[1]});

		tmp = java.sql.Types.VARCHAR + ",N";
		arrTmp = tmp.split(",");
		if(arrTmp.length !=2){
			throw new IllegalArgumentException();
		}
		params.put("agmt_act_cnt_cd",new String[]{arrTmp[0],arrTmp[1]});

		tmp = java.sql.Types.VARCHAR + ",N";
		arrTmp = tmp.split(",");
		if(arrTmp.length !=2){
			throw new IllegalArgumentException();
		}
		params.put("cust_seq",new String[]{arrTmp[0],arrTmp[1]});

		tmp = java.sql.Types.VARCHAR + ",N";
		arrTmp = tmp.split(",");
		if(arrTmp.length !=2){
			throw new IllegalArgumentException();
		}
		params.put("pol_cd",new String[]{arrTmp[0],arrTmp[1]});

		tmp = java.sql.Types.VARCHAR + ",N";
		arrTmp = tmp.split(",");
		if(arrTmp.length !=2){
			throw new IllegalArgumentException();
		}
		params.put("sp_cargo_rf",new String[]{arrTmp[0],arrTmp[1]});

		tmp = java.sql.Types.VARCHAR + ",N";
		arrTmp = tmp.split(",");
		if(arrTmp.length !=2){
			throw new IllegalArgumentException();
		}
		params.put("cust_nm",new String[]{arrTmp[0],arrTmp[1]});

		tmp = java.sql.Types.VARCHAR + ",N";
		arrTmp = tmp.split(",");
		if(arrTmp.length !=2){
			throw new IllegalArgumentException();
		}
		params.put("pol_yard_cd",new String[]{arrTmp[0],arrTmp[1]});

		tmp = java.sql.Types.VARCHAR + ",N";
		arrTmp = tmp.split(",");
		if(arrTmp.length !=2){
			throw new IllegalArgumentException();
		}
		params.put("sp_cargo_bb",new String[]{arrTmp[0],arrTmp[1]});

		tmp = java.sql.Types.VARCHAR + ",N";
		arrTmp = tmp.split(",");
		if(arrTmp.length !=2){
			throw new IllegalArgumentException();
		}
		params.put("sp_cargo_dg",new String[]{arrTmp[0],arrTmp[1]});

		tmp = java.sql.Types.VARCHAR + ",N";
		arrTmp = tmp.split(",");
		if(arrTmp.length !=2){
			throw new IllegalArgumentException();
		}
		params.put("agmt_act_cust_seq",new String[]{arrTmp[0],arrTmp[1]});

		tmp = java.sql.Types.VARCHAR + ",N";
		arrTmp = tmp.split(",");
		if(arrTmp.length !=2){
			throw new IllegalArgumentException();
		}
		params.put("edi_id",new String[]{arrTmp[0],arrTmp[1]});

		tmp = java.sql.Types.VARCHAR + ",N";
		arrTmp = tmp.split(",");
		if(arrTmp.length !=2){
			throw new IllegalArgumentException();
		}
		params.put("curr_page",new String[]{arrTmp[0],arrTmp[1]});

		tmp = java.sql.Types.VARCHAR + ",N";
		arrTmp = tmp.split(",");
		if(arrTmp.length !=2){
			throw new IllegalArgumentException();
		}
		params.put("cust_cnt_cd",new String[]{arrTmp[0],arrTmp[1]});

		tmp = java.sql.Types.VARCHAR + ",N";
		arrTmp = tmp.split(",");
		if(arrTmp.length !=2){
			throw new IllegalArgumentException();
		}
		params.put("vvd_cd",new String[]{arrTmp[0],arrTmp[1]});

		tmp = java.sql.Types.VARCHAR + ",N";
		arrTmp = tmp.split(",");
		if(arrTmp.length !=2){
			throw new IllegalArgumentException();
		}
		params.put("gcust",new String[]{arrTmp[0],arrTmp[1]});

		tmp = java.sql.Types.VARCHAR + ",N";
		arrTmp = tmp.split(",");
		if(arrTmp.length !=2){
			throw new IllegalArgumentException();
		}
		params.put("rows_per_page",new String[]{arrTmp[0],arrTmp[1]});

		tmp = java.sql.Types.VARCHAR + ",N";
		arrTmp = tmp.split(",");
		if(arrTmp.length !=2){
			throw new IllegalArgumentException();
		}
		params.put("del_cd",new String[]{arrTmp[0],arrTmp[1]});

		tmp = java.sql.Types.VARCHAR + ",N";
		arrTmp = tmp.split(",");
		if(arrTmp.length !=2){
			throw new IllegalArgumentException();
		}
		params.put("por_cd",new String[]{arrTmp[0],arrTmp[1]});

		tmp = java.sql.Types.VARCHAR + ",N";
		arrTmp = tmp.split(",");
		if(arrTmp.length !=2){
			throw new IllegalArgumentException();
		}
		params.put("eq_ofc_cd",new String[]{arrTmp[0],arrTmp[1]});

		tmp = java.sql.Types.VARCHAR + ",N";
		arrTmp = tmp.split(",");
		if(arrTmp.length !=2){
			throw new IllegalArgumentException();
		}
		params.put("sp_cargo_ak",new String[]{arrTmp[0],arrTmp[1]});

		tmp = java.sql.Types.VARCHAR + ",N";
		arrTmp = tmp.split(",");
		if(arrTmp.length !=2){
			throw new IllegalArgumentException();
		}
		params.put("vps_etd_dt",new String[]{arrTmp[0],arrTmp[1]});

		tmp = java.sql.Types.VARCHAR + ",N";
		arrTmp = tmp.split(",");
		if(arrTmp.length !=2){
			throw new IllegalArgumentException();
		}
		params.put("sc_no",new String[]{arrTmp[0],arrTmp[1]});

		tmp = java.sql.Types.VARCHAR + ",N";
		arrTmp = tmp.split(",");
		if(arrTmp.length !=2){
			throw new IllegalArgumentException();
		}
		params.put("pod_cd",new String[]{arrTmp[0],arrTmp[1]});

		tmp = java.sql.Types.VARCHAR + ",N";
		arrTmp = tmp.split(",");
		if(arrTmp.length !=2){
			throw new IllegalArgumentException();
		}
		params.put("pod_yard_cd",new String[]{arrTmp[0],arrTmp[1]});

		tmp = java.sql.Types.VARCHAR + ",N";
		arrTmp = tmp.split(",");
		if(arrTmp.length !=2){
			throw new IllegalArgumentException();
		}
		params.put("rfa_no",new String[]{arrTmp[0],arrTmp[1]});

		query.append("/*").append("\n"); 
		query.append("Path : com.clt.apps.opus.esm.bkg.bookingreport.statusreport.integration").append("\n"); 
		query.append("FileName : StatusReportDBDAOSearchCustVipReport1RSQL").append("\n"); 
		query.append("*/").append("\n"); 
	}
	
	public String getSQL(){
		return query.toString();
	}
	
	public HashMap<String,String[]> getParams() {
		return params;
	}

	/**
	 * Query 생성
	 */
	public void setQuery(){
		query.append("SELECT YY.*" ).append("\n"); 
		query.append("FROM (" ).append("\n"); 
		query.append("SELECT XX.*, COUNT(ROWNUM) OVER() TOTAL_CNT, " ).append("\n"); 
		query.append("ROWNUM RNUM" ).append("\n"); 
		query.append("FROM (" ).append("\n"); 
		query.append("SELECT DISTINCT ${select_list}" ).append("\n"); 
		query.append("--     , COUNT(BKG_NO) OVER() TOTAL_CNT" ).append("\n"); 
		query.append("FROM (" ).append("\n"); 
		query.append("            SELECT " ).append("\n"); 
		query.append("            --  ROWNUM RNUM" ).append("\n"); 
		query.append("            --, COUNT(BKG_NO) OVER() TOTAL_CNT" ).append("\n"); 
		query.append("            --, " ).append("\n"); 
		query.append("			 (SELECT VSL_ENG_NM FROM MDM_VSL_CNTR WHERE VSL_CD = Y.VSL_CD) AS TRUNK_VESSEL" ).append("\n"); 
		query.append("            , Y.*" ).append("\n"); 
		query.append("            FROM (" ).append("\n"); 
		query.append("                    SELECT " ).append("\n"); 
		query.append("				 	X.BKG_NO," ).append("\n"); 
		query.append("				    X.CNTR_NO," ).append("\n"); 
		query.append("				    X.BKG_OFC_CD," ).append("\n"); 
		query.append("				    X.BL_NO," ).append("\n"); 
		query.append("				    X.TRUNK_VVD," ).append("\n"); 
		query.append("				    X.VSL_CD," ).append("\n"); 
		query.append("				    X.SKD_VOY_NO," ).append("\n"); 
		query.append("				    X.SKD_DIR_CD," ).append("\n"); 
		query.append("				    X.POR_CD," ).append("\n"); 
		query.append("				    X.POL_CD," ).append("\n"); 
		query.append("				    X.POD_CD," ).append("\n"); 
		query.append("				    X.DEL_CD," ).append("\n"); 
		query.append("				    X.PRE_RLY_PORT_CD," ).append("\n"); 
		query.append("				    X.PST_RLY_PORT_CD," ).append("\n"); 
		query.append("				    X.CMDT_CD," ).append("\n"); 
		query.append("				    X.PCT_QTY," ).append("\n"); 
		query.append("				    X.PCK_TP_CD," ).append("\n"); 
		query.append("				    X.REP_CMDT," ).append("\n"); 
		query.append("				    X.CUST_REF_NO," ).append("\n"); 
		query.append("				    X.ACT_WGT," ).append("\n"); 
		query.append("				    X.WGT_UT_CD," ).append("\n"); 
		query.append("				    X.RCV_TERM_CD," ).append("\n"); 
		query.append("				    X.DE_TERM_CD," ).append("\n"); 
		query.append("				    X.LANE_CD," ).append("\n"); 
		query.append("				    X.SCAC_CD," ).append("\n"); 
		query.append("				    X.OBL_ISS_DT," ).append("\n"); 
		query.append("				    X.BL_OBRD_DT," ).append("\n"); 
		query.append("					X.SVC_SCP_CD," ).append("\n"); 
		query.append("				    X.VSL_ENG_NM," ).append("\n"); 
		query.append("				    X.POR_NM," ).append("\n"); 
		query.append("				    X.POL_NM," ).append("\n"); 
		query.append("				    X.POD_NM," ).append("\n"); 
		query.append("				    X.DEL_NM," ).append("\n"); 
		query.append("				    X.SHPR_CODE," ).append("\n"); 
		query.append("				    X.SHPR_NAME," ).append("\n"); 
		query.append("				    X.CNEE_CODE," ).append("\n"); 
		query.append("				    X.CNEE_NAME," ).append("\n"); 
		query.append("				    X.NTFY_CODE," ).append("\n"); 
		query.append("				    X.NTFY_NAME," ).append("\n"); 
		query.append("				    X.SC_NO,   " ).append("\n"); 
		query.append("				    X.RFA_NO,         " ).append("\n"); 
		query.append("				    X.PPD_OFC,          " ).append("\n"); 
		query.append("				    X.CCT_OFC,          " ).append("\n"); 
		query.append("				    X.CSTMS_DESC,       " ).append("\n"); 
		query.append("				    X.USA_CSTMS_FILE_CD," ).append("\n"); 
		query.append("				    X.CND_CSTMS_FILE_CD," ).append("\n"); 
		query.append("				    X.CNTR_WGT,         " ).append("\n"); 
		query.append("				    X.CNTR_WGT_UT_CD," ).append("\n"); 
		query.append("				    X.SPC_CGO," ).append("\n"); 
		query.append("				    X.MEAS_QTY,      " ).append("\n"); 
		query.append("				    X.CNTR_MEAS_UT_CD,    " ).append("\n"); 
		query.append("				    X.CNTR_TPSZ_CD,  " ).append("\n"); 
		query.append("                    X.CNTR_VOL_QTY, " ).append("\n"); 
		query.append("				    X.PCK_QTY,       " ).append("\n"); 
		query.append("				    X.CNTR_PCK_TP_CD," ).append("\n"); 
		query.append("				    X.CNTR_PRT_FLG,  " ).append("\n"); 
		query.append("				    X.CNTR_PO_NO,    " ).append("\n"); 
		query.append("				    X.BDR_FLG,       " ).append("\n"); 
		query.append("				    X.POR_CNTY,      " ).append("\n"); 
		query.append("				    X.DEL_CNTY," ).append("\n"); 
		query.append("				    X.RMK," ).append("\n"); 
		query.append("				    X.CGO_RCV_DT," ).append("\n"); 
		query.append("				    X.SCAC," ).append("\n"); 
		query.append("				    X.CNTR_SIZE," ).append("\n"); 
		query.append("				    X.DUE_DATE," ).append("\n"); 
		query.append("				    X.OVERDUE," ).append("\n"); 
		query.append("				    X.CHG_AMT," ).append("\n"); 
		query.append("				    X.G_CUST_SHPR," ).append("\n"); 
		query.append("				    X.G_CUST_CNEE," ).append("\n"); 
		query.append("				    BKG_GET_TOKEN_FNC(X.CA_ITNO,1) AS CA_ITNO," ).append("\n"); 
		query.append("				    BKG_GET_TOKEN_FNC(X.CA_ITNO,2) AS CNRR_REF_NO," ).append("\n"); 
		query.append("				    X.ATD," ).append("\n"); 
		query.append("				    X.ATA," ).append("\n"); 
		query.append("				    X.ATA_T," ).append("\n"); 
		query.append("				    X.ATD_T," ).append("\n"); 
		query.append("				    X.F_POL_ETA," ).append("\n"); 
		query.append("				    X.F_POL_ETD," ).append("\n"); 
		query.append("				    X.F_POD_ETA," ).append("\n"); 
		query.append("				    X.F_POD_ETD," ).append("\n"); 
		query.append("				    X.T_POL_ETA," ).append("\n"); 
		query.append("				    X.T_POL_ETD," ).append("\n"); 
		query.append("				    X.T_POD_ETA," ).append("\n"); 
		query.append("				    X.T_POD_ETD," ).append("\n"); 
		query.append("				    X.PPD_Charge," ).append("\n"); 
		query.append("				    X.CCT_Charge," ).append("\n"); 
		query.append("				    X.AN_SEND_DT," ).append("\n"); 
		query.append("				    X.DEL_STATE," ).append("\n"); 
		query.append("				    X.CNTR_SEAL_NO," ).append("\n"); 
		query.append("				    X.BL_PO_NO," ).append("\n"); 
		query.append("				    X.POL_ETD," ).append("\n"); 
		query.append("				    X.POD_ETA," ).append("\n"); 
		query.append("                    X.POD_ETB," ).append("\n"); 
		query.append("                    X.ACT_CUST_CODE," ).append("\n"); 
		query.append("                    X.ACT_CUST_NAME," ).append("\n"); 
		query.append("				    X.EQ_CTRL_OFC," ).append("\n"); 
		query.append("				    BKG_GET_TOKEN_FNC(X.FREE_DT,1) AS FREE_DT," ).append("\n"); 
		query.append("				    BKG_GET_TOKEN_FNC(X.FREE_DT,2) AS PKUP_NO," ).append("\n"); 
		query.append("				    BKG_GET_TOKEN_FNC(X.FREE_DT,3) AS PKUP_NOD_CD," ).append("\n"); 
		query.append("				    BKG_GET_TOKEN_FNC(X.FREE_DT,4) AS AVAL_DT," ).append("\n"); 
		query.append("				    BKG_GET_TOKEN_FNC(X.IBD_TRSP_ISS_DT,1) AS IBD_TRSP_ISS_DT," ).append("\n"); 
		query.append("				    X.HUB_LOC_CD," ).append("\n"); 
		query.append("				    BKG_GET_TOKEN_FNC(X.IBD_TRSP_ISS_DT,2) AS IT_NO," ).append("\n"); 
		query.append("				    BKG_GET_TOKEN_FNC(X.FRT_CLT_FLG,1) AS FRT_CLT_FLG," ).append("\n"); 
		query.append("				    BKG_GET_TOKEN_FNC(X.FRT_CLT_FLG,2) AS OBL_RDEM_FLG," ).append("\n"); 
		query.append("				    BKG_GET_TOKEN_FNC(X.FRT_CLT_FLG,3) AS CUSTOMS_RLS_DT," ).append("\n"); 
		query.append("				    BKG_GET_TOKEN_FNC(X.FRT_CLT_FLG,4) AS CSTMS_CLR_CD," ).append("\n"); 
		query.append("				    X.CNTR_OC_DATE," ).append("\n"); 
		query.append("				    X.DCHG_TS_PORT_DT," ).append("\n"); 
		query.append("				    X.DSPO_CD," ).append("\n"); 
		query.append("				    X.CGO_STS_CD," ).append("\n"); 
		query.append("				    X.DEL_ATA," ).append("\n"); 
		query.append("				    X.DEL_DT," ).append("\n"); 
		query.append("				    X.MT_RETURN_DT," ).append("\n"); 
		query.append("				    X.DEL_ETA_DT," ).append("\n"); 
		query.append("				    X.EXPORT_REF_NO," ).append("\n"); 
		query.append("				    X.FIRMS_CODE," ).append("\n"); 
		query.append("				    X.CBKG_NO," ).append("\n"); 
		query.append("				    X.TOT_MEAS," ).append("\n"); 
		query.append("				    X.MEAS_UT_CD," ).append("\n"); 
		query.append("                    X.SHIP_ID," ).append("\n"); 
		query.append("                    X.PRT_NO," ).append("\n"); 
		query.append("                    X.BKG_RCT_SND_DT_FAX," ).append("\n"); 
		query.append("                    X.DBL_SND_DT_FAX," ).append("\n"); 
		query.append("                    X.WBL_SND_DT_FAX," ).append("\n"); 
		query.append("                    X.DBL_SND_DT_EDI," ).append("\n"); 
		query.append("                    X.BKG_RCT_SND_DT_EDI," ).append("\n"); 
		query.append("                    X.UVD_MAX_ACT_DT," ).append("\n"); 
		query.append("                    X.RLN_MAX_ACT_DT," ).append("\n"); 
		query.append("                    X.URN_MAX_ACT_DT," ).append("\n"); 
		query.append("                    X.OAN_MAX_ACT_DT," ).append("\n"); 
		query.append("                    X.D_MAX_ACT_DT," ).append("\n"); 
		query.append("                    X.WEB_PRT," ).append("\n"); 
		query.append("					'' CCT_EX_RT," ).append("\n"); 
		query.append("					'' PPD_EX_RT," ).append("\n"); 
		query.append("					X.POD1_ETD_DT," ).append("\n"); 
		query.append("					X.POD1_ETA_DT," ).append("\n"); 
		query.append("					X.POL1_ETD_DT," ).append("\n"); 
		query.append("					X.POL1_ETA_DT," ).append("\n"); 
		query.append("					X.FNL_DEST_NM FINAL_DEST_NM," ).append("\n"); 
		query.append("					X.POST_VVD," ).append("\n"); 
		query.append("					X.PRE_VVD," ).append("\n"); 
		query.append("					(CASE WHEN LENGTH(X.POST_VVD) > 4 " ).append("\n"); 
		query.append("					      THEN (SELECT VSL_ENG_NM||SUBSTR(X.POST_VVD,5)" ).append("\n"); 
		query.append("					              FROM MDM_VSL_CNTR M" ).append("\n"); 
		query.append("					             WHERE M.VSL_CD = SUBSTR(X.POST_VVD,1,4))" ).append("\n"); 
		query.append("					      ELSE NULL " ).append("\n"); 
		query.append("					  END) AS POST_VVD_NM," ).append("\n"); 
		query.append("					(CASE WHEN LENGTH(X.PRE_VVD) > 4 " ).append("\n"); 
		query.append("					      THEN (SELECT VSL_ENG_NM||SUBSTR(X.POST_VVD,5)" ).append("\n"); 
		query.append("					              FROM MDM_VSL_CNTR M" ).append("\n"); 
		query.append("					             WHERE M.VSL_CD = SUBSTR(X.PRE_VVD,1,4))" ).append("\n"); 
		query.append("					      ELSE NULL " ).append("\n"); 
		query.append("					  END) AS PRE_VVD_NM," ).append("\n"); 
		query.append("					X.G_CNEE_CODE," ).append("\n"); 
		query.append("					X.G_SHPR_CODE," ).append("\n"); 
		query.append("					X.FRD_CUST_CD AS FRD_CUST_CODE," ).append("\n"); 
		query.append("					X.FRD_CUST_NM," ).append("\n"); 
		query.append("					X.FRD_CUST_CD," ).append("\n"); 
		query.append("					CUST_SI_REF_NO," ).append("\n"); 
		query.append("					CUST_BKG_REF_NO," ).append("\n"); 
		query.append("					CUST_INV_NO," ).append("\n"); 
		query.append("					OBL_ISS_OFC_CD AS BL_ISS_OFC" ).append("\n"); 
		query.append("                    FROM (" ).append("\n"); 
		query.append("                                SELECT " ).append("\n"); 
		query.append("                                    B.BKG_NO      AS BKG_NO," ).append("\n"); 
		query.append("                                    CNTR.CNTR_NO  AS CNTR_NO," ).append("\n"); 
		query.append("                                    B.BKG_OFC_CD  AS BKG_OFC_CD," ).append("\n"); 
		query.append("                                    B.BL_NO       AS BL_NO," ).append("\n"); 
		query.append("                                    B.VSL_CD||B.SKD_VOY_NO||B.SKD_DIR_CD AS TRUNK_VVD," ).append("\n"); 
		query.append("                                    B.VSL_CD      AS VSL_CD, " ).append("\n"); 
		query.append("                                    B.SKD_VOY_NO  AS SKD_VOY_NO, " ).append("\n"); 
		query.append("                                    B.SKD_DIR_CD  AS SKD_DIR_CD, " ).append("\n"); 
		query.append("                                    B.POR_CD      AS POR_CD," ).append("\n"); 
		query.append("                                    B.POL_CD      AS POL_CD," ).append("\n"); 
		query.append("                                    B.POD_CD      AS POD_CD," ).append("\n"); 
		query.append("                                    B.DEL_CD      AS DEL_CD," ).append("\n"); 
		query.append("                                    B.PRE_RLY_PORT_CD AS PRE_RLY_PORT_CD," ).append("\n"); 
		query.append("                                    B.PST_RLY_PORT_CD AS PST_RLY_PORT_CD," ).append("\n"); 
		query.append("                                    B.CMDT_CD     AS CMDT_CD," ).append("\n"); 
		query.append("                                    D.PCK_QTY     AS PCT_QTY," ).append("\n"); 
		query.append("                                    D.PCK_TP_CD   AS PCK_TP_CD,   " ).append("\n"); 
		query.append("                                    D.MEAS_QTY    AS TOT_MEAS," ).append("\n"); 
		query.append("                                    D.MEAS_UT_CD  AS MEAS_UT_CD,   " ).append("\n"); 
		query.append("                                    L.REP_CMDT_NM AS REP_CMDT, " ).append("\n"); 
		query.append("                                    (SELECT CUST_REF_NO_CTNT " ).append("\n"); 
		query.append("                                     FROM BKG_REFERENCE R " ).append("\n"); 
		query.append("                                     WHERE R.BKG_NO = B.BKG_NO  " ).append("\n"); 
		query.append("                                       AND BKG_REF_TP_CD = 'EBRF'" ).append("\n"); 
		query.append("									   AND ROWNUM = 1 ) AS CUST_BKG_REF_NO, " ).append("\n"); 
		query.append("									(SELECT CUST_REF_NO_CTNT " ).append("\n"); 
		query.append("                                     FROM BKG_REFERENCE R " ).append("\n"); 
		query.append("                                     WHERE R.BKG_NO = B.BKG_NO  " ).append("\n"); 
		query.append("                                       AND BKG_REF_TP_CD = 'EBSH'" ).append("\n"); 
		query.append("									   AND ROWNUM = 1 ) AS CUST_REF_NO, 			" ).append("\n"); 
		query.append("                                    (SELECT CUST_REF_NO_CTNT " ).append("\n"); 
		query.append("                                     FROM BKG_REFERENCE R " ).append("\n"); 
		query.append("                                     WHERE R.BKG_NO = B.BKG_NO  " ).append("\n"); 
		query.append("                                       AND BKG_REF_TP_CD = 'ESRF'" ).append("\n"); 
		query.append("									   AND ROWNUM = 1 ) AS CUST_SI_REF_NO, " ).append("\n"); 
		query.append("                                    (SELECT CUST_REF_NO_CTNT " ).append("\n"); 
		query.append("                                     FROM BKG_REFERENCE R " ).append("\n"); 
		query.append("                                     WHERE R.BKG_NO = B.BKG_NO  " ).append("\n"); 
		query.append("                                       AND BKG_REF_TP_CD = 'FINV'" ).append("\n"); 
		query.append("									   AND ROWNUM = 1 ) AS CUST_INV_NO, " ).append("\n"); 
		query.append("                                    D.ACT_WGT     AS ACT_WGT, " ).append("\n"); 
		query.append("                                    D.WGT_UT_CD   AS WGT_UT_CD, " ).append("\n"); 
		query.append("                                    B.RCV_TERM_CD AS RCV_TERM_CD," ).append("\n"); 
		query.append("                                    B.DE_TERM_CD  AS DE_TERM_CD," ).append("\n"); 
		query.append("                                    B.SLAN_CD     AS LANE_CD," ).append("\n"); 
		query.append("                                    B.SCAC_CD     AS SCAC_CD," ).append("\n"); 
		query.append("									B.SVC_SCP_CD  AS SVC_SCP_CD," ).append("\n"); 
		query.append("                                    TO_CHAR(H.OBL_ISS_DT, 'YYYY-MM-DD')  AS OBL_ISS_DT," ).append("\n"); 
		query.append("                                    TO_CHAR(D.BL_OBRD_DT, 'YYYY-MM-DD')  AS BL_OBRD_DT," ).append("\n"); 
		query.append("                                    D.VSL_NM         AS VSL_ENG_NM," ).append("\n"); 
		query.append("                                    D.POR_NM         AS POR_NM," ).append("\n"); 
		query.append("                                    D.POL_NM         AS POL_NM," ).append("\n"); 
		query.append("                                    D.POD_NM         AS POD_NM," ).append("\n"); 
		query.append("                                    D.DEL_NM         AS DEL_NM," ).append("\n"); 
		query.append("                                    MAX(DECODE(C.BKG_CUST_TP_CD, 'S', C.CUST_CNT_CD, ''))||MAX(DECODE(C.BKG_CUST_TP_CD, 'S', LPAD(C.CUST_SEQ,6,'0'), '')) AS SHPR_CODE," ).append("\n"); 
		query.append("                                    REPLACE(MAX(DECODE(C.BKG_CUST_TP_CD,'S',C.CUST_NM,'')),chr(10),' ') AS SHPR_NAME," ).append("\n"); 
		query.append("                                    MAX(DECODE(C.BKG_CUST_TP_CD, 'C', C.CUST_CNT_CD, ''))||MAX(DECODE(C.BKG_CUST_TP_CD, 'C', LPAD(C.CUST_SEQ,6,'0'), '')) AS CNEE_CODE," ).append("\n"); 
		query.append("                                    REPLACE(MAX(DECODE(C.BKG_CUST_TP_CD,'C',C.CUST_NM,'')),chr(10),' ') AS CNEE_NAME," ).append("\n"); 
		query.append("                                    MAX(DECODE(C.BKG_CUST_TP_CD, 'N', C.CUST_CNT_CD, ''))||MAX(DECODE(C.BKG_CUST_TP_CD, 'N', LPAD(C.CUST_SEQ,6,'0'), '')) AS NTFY_CODE," ).append("\n"); 
		query.append("                                    REPLACE(MAX(DECODE(C.BKG_CUST_TP_CD,'N',C.CUST_NM,'')),chr(10),' ') AS NTFY_NAME," ).append("\n"); 
		query.append("									MAX(DECODE(C.BKG_CUST_TP_CD, 'F', C.CUST_CNT_CD, ''))||MAX(DECODE(C.BKG_CUST_TP_CD, 'F', LPAD(C.CUST_SEQ,6,'0'), '')) AS FRD_CUST_CD," ).append("\n"); 
		query.append("                                    REPLACE(MAX(DECODE(C.BKG_CUST_TP_CD,'F',C.CUST_NM,'')),chr(10),' ') AS FRD_CUST_NM," ).append("\n"); 
		query.append("                                    B.SC_NO             AS SC_NO," ).append("\n"); 
		query.append("                                    B.RFA_NO            AS RFA_NO," ).append("\n"); 
		query.append("                                    R.PPD_RCV_OFC_CD    AS PPD_OFC," ).append("\n"); 
		query.append("                                    R.CLT_OFC_CD        AS CCT_OFC," ).append("\n"); 
		query.append("                                    D.CSTMS_DESC        AS CSTMS_DESC," ).append("\n"); 
		query.append("                                    B.USA_CSTMS_FILE_CD AS USA_CSTMS_FILE_CD," ).append("\n"); 
		query.append("                                    B.CND_CSTMS_FILE_CD AS CND_CSTMS_FILE_CD,  " ).append("\n"); 
		query.append("                                    CNTR.CNTR_WGT       AS CNTR_WGT," ).append("\n"); 
		query.append("                                    CNTR.WGT_UT_CD      AS CNTR_WGT_UT_CD," ).append("\n"); 
		query.append("                                    DECODE(CNTR.DCGO_FLG, 'Y', 'DG', DECODE(CNTR.RC_FLG, 'Y', 'RF', " ).append("\n"); 
		query.append("                                                                           DECODE(CNTR.BB_CGO_FLG, 'Y', 'BB', " ).append("\n"); 
		query.append("                                                                            DECODE(CNTR.AWK_CGO_FLG, 'Y', 'AK', " ).append("\n"); 
		query.append("                                                                             DECODE(CNTR.RD_CGO_FLG, 'Y', 'RD', " ).append("\n"); 
		query.append("                                                                              DECODE(CNTR.SOC_FLG, 'Y', 'SOC', '')))))) AS SPC_CGO,   " ).append("\n"); 
		query.append("                                    CNTR.MEAS_QTY       AS MEAS_QTY," ).append("\n"); 
		query.append("                                    CNTR.MEAS_UT_CD     AS CNTR_MEAS_UT_CD," ).append("\n"); 
		query.append("                                    CNTR.CNTR_TPSZ_CD   AS CNTR_TPSZ_CD," ).append("\n"); 
		query.append("                                    CNTR.CNTR_VOL_QTY   AS CNTR_VOL_QTY, " ).append("\n"); 
		query.append("                                    CNTR.PCK_QTY        AS PCK_QTY," ).append("\n"); 
		query.append("                                    CNTR.PCK_TP_CD      AS CNTR_PCK_TP_CD," ).append("\n"); 
		query.append("                                    CNTR.CNTR_PRT_FLG   AS CNTR_PRT_FLG," ).append("\n"); 
		query.append("                                    ( SELECT CUST_REF_NO_CTNT " ).append("\n"); 
		query.append("                                       FROM BKG_REFERENCE A" ).append("\n"); 
		query.append("                                       WHERE A.BKG_NO = CNTR.BKG_NO" ).append("\n"); 
		query.append("                                       AND  A.CNTR_NO = CNTR.CNTR_NO" ).append("\n"); 
		query.append("									   AND A.BKG_REF_TP_CD = 'CTPO'" ).append("\n"); 
		query.append("									   AND ROWNUM = 1" ).append("\n"); 
		query.append("                                    ) AS CNTR_PO_NO," ).append("\n"); 
		query.append("                                    J.DE_NO SHIP_ID," ).append("\n"); 
		query.append("                                    J.PRT_NO," ).append("\n"); 
		query.append("                                    D.BDR_FLG           AS BDR_FLG," ).append("\n"); 
		query.append("                                    SUBSTR(B.POR_CD,1,2) AS POR_CNTY," ).append("\n"); 
		query.append("                                    SUBSTR(B.DEL_CD,1,2) AS DEL_CNTY," ).append("\n"); 
		query.append("                                    REPLACE(B.XTER_RMK,chr(10),' ')           AS RMK," ).append("\n"); 
		query.append("" ).append("\n"); 
		query.append("                                    TO_CHAR(R.CGO_RCV_DT,'YYYY-MM-DD') AS CGO_RCV_DT, " ).append("\n"); 
		query.append("                                    COM_ConstantMgr_PKG.COM_getScacCode_FNC()               AS SCAC," ).append("\n"); 
		query.append("                                    (SELECT U.RAT_UT_CD " ).append("\n"); 
		query.append("                                     FROM PRI_RAT_UT U, PRI_RAT_UT C" ).append("\n"); 
		query.append("                                     WHERE U.RAT_UT_CD IN ('20','40','45')" ).append("\n"); 
		query.append("                                     AND U.CNTR_SZ_CD = C.CNTR_SZ_CD" ).append("\n"); 
		query.append("                                     AND C.RAT_UT_CD = CNTR.CNTR_TPSZ_CD) CNTR_SIZE," ).append("\n"); 
		query.append("		                	       		                	       /* I/B */" ).append("\n"); 
		query.append("                                   TO_CHAR(TO_DATE(SUBSTR(MAX(E.VSL_PRE_PST_CD||E.VSL_SEQ||TO_CHAR(G.VPS_ETA_DT,'YYYYMMDD')),3),'YYYYMMDD') + nvl(null,0) , 'YYYY-MM-DD') AS DUE_DATE," ).append("\n"); 
		query.append("                                   ROUND(SYSDATE - (TO_DATE(SUBSTR(MAX(E.VSL_PRE_PST_CD||E.VSL_SEQ||TO_CHAR(G.VPS_ETA_DT,'YYYYMMDD')),3),'YYYYMMDD') + nvl(null,0)) ) AS OVERDUE,                        " ).append("\n"); 
		query.append("                                                                                               " ).append("\n"); 
		query.append("                                    (SELECT CHG_AMT " ).append("\n"); 
		query.append("                                      FROM BKG_CHG_RT A" ).append("\n"); 
		query.append("                                     WHERE A.BKG_NO = B.BKG_NO" ).append("\n"); 
		query.append("                                       AND A.RT_SEQ = (SELECT MAX(RT_SEQ)" ).append("\n"); 
		query.append("                                                       FROM BKG_CHG_RT C" ).append("\n"); 
		query.append("                                                       WHERE C.BKG_NO = B.BKG_NO)" ).append("\n"); 
		query.append("                                    ) AS CHG_AMT, " ).append("\n"); 
		query.append("" ).append("\n"); 
		query.append("                                    (SELECT CUST_GRP_ID " ).append("\n"); 
		query.append("                                       FROM MDM_CUSTOMER A, BKG_CUSTOMER SCUST" ).append("\n"); 
		query.append("                                      WHERE  A.CUST_CNT_CD = SCUST.CUST_CNT_CD" ).append("\n"); 
		query.append("                                        AND  A.CUST_SEQ = SCUST.CUST_SEQ " ).append("\n"); 
		query.append("                                        AND  SCUST.BKG_CUST_TP_CD ='S'" ).append("\n"); 
		query.append("                                        AND  SCUST.BKG_NO = B.BKG_NO" ).append("\n"); 
		query.append("                                    ) AS G_SHPR_CODE," ).append("\n"); 
		query.append("" ).append("\n"); 
		query.append("									(SELECT GRP.CUST_GRP_NM " ).append("\n"); 
		query.append("                                       FROM MDM_CUSTOMER A, BKG_CUSTOMER SCUST, MDM_CUST_PERF_GRP GRP" ).append("\n"); 
		query.append("                                      WHERE  A.CUST_CNT_CD = SCUST.CUST_CNT_CD" ).append("\n"); 
		query.append("                                        AND  A.CUST_SEQ = SCUST.CUST_SEQ " ).append("\n"); 
		query.append("                                        AND  SCUST.BKG_CUST_TP_CD ='S'" ).append("\n"); 
		query.append("                                        AND  SCUST.BKG_NO = B.BKG_NO" ).append("\n"); 
		query.append("                                        AND  GRP.CUST_GRP_ID = A.CUST_GRP_ID" ).append("\n"); 
		query.append("                                    ) AS G_CUST_SHPR," ).append("\n"); 
		query.append("" ).append("\n"); 
		query.append("                                    (SELECT CUST_GRP_ID " ).append("\n"); 
		query.append("                                       FROM MDM_CUSTOMER A, BKG_CUSTOMER SCUST" ).append("\n"); 
		query.append("                                      WHERE  A.CUST_CNT_CD = SCUST.CUST_CNT_CD" ).append("\n"); 
		query.append("                                        AND  A.CUST_SEQ = SCUST.CUST_SEQ " ).append("\n"); 
		query.append("                                        AND  SCUST.BKG_CUST_TP_CD ='C'" ).append("\n"); 
		query.append("                                        AND  SCUST.BKG_NO = B.BKG_NO" ).append("\n"); 
		query.append("                                    ) AS G_CNEE_CODE," ).append("\n"); 
		query.append("" ).append("\n"); 
		query.append("									(SELECT GRP.CUST_GRP_NM " ).append("\n"); 
		query.append("                                       FROM MDM_CUSTOMER A, BKG_CUSTOMER SCUST, MDM_CUST_PERF_GRP GRP" ).append("\n"); 
		query.append("                                      WHERE  A.CUST_CNT_CD = SCUST.CUST_CNT_CD" ).append("\n"); 
		query.append("                                        AND  A.CUST_SEQ = SCUST.CUST_SEQ " ).append("\n"); 
		query.append("                                        AND  SCUST.BKG_CUST_TP_CD ='C'" ).append("\n"); 
		query.append("                                        AND  SCUST.BKG_NO = B.BKG_NO" ).append("\n"); 
		query.append("                                        AND  GRP.CUST_GRP_ID = A.CUST_GRP_ID" ).append("\n"); 
		query.append("                                    ) AS G_CUST_CNEE," ).append("\n"); 
		query.append("" ).append("\n"); 
		query.append("                                    ( SELECT USA_IB_TRSP_NO||','||RAIL_CRR_REF_NO" ).append("\n"); 
		query.append("										FROM BKG_CSTMS_ADV_CNTR A" ).append("\n"); 
		query.append("										WHERE A.CNT_CD = 'CA'" ).append("\n"); 
		query.append("										AND B.BL_NO = A.BL_NO" ).append("\n"); 
		query.append("										AND CNTR.CNTR_NO = A.CNTR_NO" ).append("\n"); 
		query.append("									) AS CA_ITNO," ).append("\n"); 
		query.append("" ).append("\n"); 
		query.append("                                    ( SELECT TO_CHAR(S2.ACT_DT,'YYYY-MM-DD hh24:mi')   " ).append("\n"); 
		query.append("                                       FROM BKG_VVD S1, SCE_COP_DTL S2" ).append("\n"); 
		query.append("                                       WHERE S1.BKG_NO = B.BKG_NO  " ).append("\n"); 
		query.append("                                        AND S1.VSL_CD = S2.VSL_CD" ).append("\n"); 
		query.append("                                        AND S1.SKD_VOY_NO = S2.SKD_VOY_NO" ).append("\n"); 
		query.append("                                        AND S1.SKD_DIR_CD = S2.SKD_DIR_CD" ).append("\n"); 
		query.append("                                        AND S1.POL_CD = S2.VPS_PORT_CD" ).append("\n"); 
		query.append("                                        AND S1.VSL_PRE_PST_CD||S1.VSL_SEQ = (SELECT MIN(VSL_PRE_PST_CD||VSL_SEQ)" ).append("\n"); 
		query.append("                                                                             FROM bkg_vvd" ).append("\n"); 
		query.append("                                                                             WHERE BKG_NO = B.BKG_NO)" ).append("\n"); 
		query.append("                                                                             AND S2.COP_NO IN ( SELECT MAX(COP_NO)" ).append("\n"); 
		query.append("                                                                                                  FROM SCE_COP_HDR" ).append("\n"); 
		query.append("                                                                                                 WHERE BKG_NO = B.BKG_NO" ).append("\n"); 
		query.append("                                                                                                   AND COP_STS_CD != 'X' )" ).append("\n"); 
		query.append("                                        AND S2.ACT_CD LIKE 'F__MDO'" ).append("\n"); 
		query.append("                                    ) AS ATD," ).append("\n"); 
		query.append("" ).append("\n"); 
		query.append("                                        " ).append("\n"); 
		query.append("                                    ( SELECT TO_CHAR(S2.ACT_DT,'YYYY-MM-DD hh24:mi')   " ).append("\n"); 
		query.append("                                       FROM BKG_VVD S1, SCE_COP_DTL S2" ).append("\n"); 
		query.append("                                       WHERE S1.BKG_NO = B.BKG_NO  " ).append("\n"); 
		query.append("                                        AND S1.VSL_CD = S2.VSL_CD" ).append("\n"); 
		query.append("                                        AND S1.SKD_VOY_NO = S2.SKD_VOY_NO" ).append("\n"); 
		query.append("                                        AND S1.SKD_DIR_CD = S2.SKD_DIR_CD" ).append("\n"); 
		query.append("                                        AND S1.POL_CD = S2.VPS_PORT_CD" ).append("\n"); 
		query.append("                                        AND S1.VSL_PRE_PST_CD = 'T'" ).append("\n"); 
		query.append("                                        AND S1.VSL_SEQ = '0'" ).append("\n"); 
		query.append("                                        AND S2.COP_NO IN (SELECT MAX(COP_NO)" ).append("\n"); 
		query.append("                                                            FROM SCE_COP_HDR" ).append("\n"); 
		query.append("                                                           WHERE BKG_NO = B.BKG_NO" ).append("\n"); 
		query.append("                                                             AND COP_STS_CD != 'X' )" ).append("\n"); 
		query.append("                                        AND S2.ACT_CD LIKE 'F__MDO'" ).append("\n"); 
		query.append("                                    ) AS ATD_T, " ).append("\n"); 
		query.append("" ).append("\n"); 
		query.append("                                       " ).append("\n"); 
		query.append("                                    ( SELECT TO_CHAR(S2.ACT_DT,'YYYY-MM-DD hh24:mi')   " ).append("\n"); 
		query.append("                                       FROM BKG_VVD S1, SCE_COP_DTL S2" ).append("\n"); 
		query.append("                                       WHERE S1.BKG_NO = B.BKG_NO  " ).append("\n"); 
		query.append("                                        AND S1.VSL_CD = S2.VSL_CD" ).append("\n"); 
		query.append("                                        AND S1.SKD_VOY_NO = S2.SKD_VOY_NO" ).append("\n"); 
		query.append("                                        AND S1.SKD_DIR_CD = S2.SKD_DIR_CD" ).append("\n"); 
		query.append("                                        AND S1.POD_CD = S2.VPS_PORT_CD" ).append("\n"); 
		query.append("                                        AND S1.VSL_PRE_PST_CD||S1.VSL_SEQ = (SELECT MAX(VSL_PRE_PST_CD||VSL_SEQ)" ).append("\n"); 
		query.append("                                                                               FROM bkg_vvd" ).append("\n"); 
		query.append("                                                                              WHERE BKG_NO = B.BKG_NO)" ).append("\n"); 
		query.append("                                                                                AND S2.COP_NO IN ( SELECT MAX(COP_NO)" ).append("\n"); 
		query.append("                                                                                                     FROM SCE_COP_HDR" ).append("\n"); 
		query.append("                                                                                                    WHERE BKG_NO = B.BKG_NO" ).append("\n"); 
		query.append("                                                                                                      AND COP_STS_CD != 'X' )" ).append("\n"); 
		query.append("                                        AND S2.ACT_CD LIKE 'F__MAD'" ).append("\n"); 
		query.append("                                    )AS ATA," ).append("\n"); 
		query.append("" ).append("\n"); 
		query.append("                                     " ).append("\n"); 
		query.append("                                    ( SELECT TO_CHAR(S2.ACT_DT,'YYYY-MM-DD hh24:mi')   " ).append("\n"); 
		query.append("                                       FROM BKG_VVD S1, SCE_COP_DTL S2" ).append("\n"); 
		query.append("                                       WHERE S1.BKG_NO = B.BKG_NO  " ).append("\n"); 
		query.append("                                        AND S1.VSL_CD = S2.VSL_CD" ).append("\n"); 
		query.append("                                        AND S1.SKD_VOY_NO = S2.SKD_VOY_NO" ).append("\n"); 
		query.append("                                        AND S1.SKD_DIR_CD = S2.SKD_DIR_CD" ).append("\n"); 
		query.append("                                        AND S1.POD_CD = S2.VPS_PORT_CD" ).append("\n"); 
		query.append("                                        AND S1.VSL_PRE_PST_CD = 'T'" ).append("\n"); 
		query.append("                                        AND S1.VSL_SEQ = '0'" ).append("\n"); 
		query.append("                                        AND S2.COP_NO IN ( SELECT MAX(COP_NO)" ).append("\n"); 
		query.append("                                                             FROM SCE_COP_HDR" ).append("\n"); 
		query.append("                                                            WHERE BKG_NO = B.BKG_NO" ).append("\n"); 
		query.append("                                                              AND COP_STS_CD != 'X' )" ).append("\n"); 
		query.append("                                        AND S2.ACT_CD LIKE 'F__MAD'" ).append("\n"); 
		query.append("                                    )AS ATA_T," ).append("\n"); 
		query.append(" " ).append("\n"); 
		query.append("                                       " ).append("\n"); 
		query.append("									( " ).append("\n"); 
		query.append("									SELECT TO_CHAR(S2.VPS_ETA_DT, 'YYYY-MM-DD HH24:MI')" ).append("\n"); 
		query.append("                                      FROM BKG_VVD S1, VSK_VSL_PORT_SKD S2" ).append("\n"); 
		query.append("                                     WHERE S1.BKG_NO        = B.BKG_NO" ).append("\n"); 
		query.append("                                       AND S1.VSL_CD       = S2.VSL_CD" ).append("\n"); 
		query.append("                                       AND S1.SKD_VOY_NO = S2.SKD_VOY_NO" ).append("\n"); 
		query.append("                                       AND S1.SKD_DIR_CD    = S2.SKD_DIR_CD" ).append("\n"); 
		query.append("                                       AND S1.POL_CD       = S2.VPS_PORT_CD" ).append("\n"); 
		query.append("                                       AND S1.POL_CLPT_IND_SEQ = S2.CLPT_IND_SEQ" ).append("\n"); 
		query.append("									   AND ( S1.BKG_NO, S1.VSL_PRE_PST_CD, S1.VSL_SEQ ) IN (" ).append("\n"); 
		query.append("                                         SELECT BKG_NO, SUBSTR(MAX(VSL_PRE_PST_CD||VSL_SEQ),1,1), SUBSTR(MAX(VSL_PRE_PST_CD||VSL_SEQ),2,1) " ).append("\n"); 
		query.append("                                           FROM BKG_VVD" ).append("\n"); 
		query.append("                                          WHERE BKG_NO = S1.BKG_NO" ).append("\n"); 
		query.append("                                          GROUP BY BKG_NO ) " ).append("\n"); 
		query.append("                                    ) AS F_POL_ETA," ).append("\n"); 
		query.append("									(" ).append("\n"); 
		query.append("									SELECT TO_CHAR(S2.VPS_ETA_DT, 'YYYY-MM-DD HH24:MI')" ).append("\n"); 
		query.append("                                              FROM BKG_VVD S1, VSK_VSL_PORT_SKD S2" ).append("\n"); 
		query.append("                                             WHERE S1.BKG_NO        = B.BKG_NO" ).append("\n"); 
		query.append("                                               AND S1.VSL_CD       = S2.VSL_CD" ).append("\n"); 
		query.append("                                               AND S1.SKD_VOY_NO = S2.SKD_VOY_NO" ).append("\n"); 
		query.append("                                               AND S1.SKD_DIR_CD    = S2.SKD_DIR_CD" ).append("\n"); 
		query.append("                                               AND S1.POL_CD       = S2.VPS_PORT_CD" ).append("\n"); 
		query.append("                                               AND S1.POL_CLPT_IND_SEQ = S2.CLPT_IND_SEQ" ).append("\n"); 
		query.append("									           AND ( S1.BKG_NO, S1.VSL_PRE_PST_CD, S1.VSL_SEQ ) IN (" ).append("\n"); 
		query.append("                                                 SELECT BKG_NO, SUBSTR(MIN(VSL_PRE_PST_CD||VSL_SEQ),1,1), SUBSTR(MIN(VSL_PRE_PST_CD||VSL_SEQ),2,1) " ).append("\n"); 
		query.append("                                                   FROM BKG_VVD" ).append("\n"); 
		query.append("                                                  WHERE BKG_NO = S1.BKG_NO" ).append("\n"); 
		query.append("                                                  GROUP BY BKG_NO ) " ).append("\n"); 
		query.append("                                            ) AS POL1_ETA_DT,   " ).append("\n"); 
		query.append("                                            (" ).append("\n"); 
		query.append("								      SELECT TO_CHAR(S2.VPS_ETD_DT, 'YYYY-MM-DD HH24:MI')" ).append("\n"); 
		query.append("                                              FROM BKG_VVD S1, VSK_VSL_PORT_SKD S2" ).append("\n"); 
		query.append("                                             WHERE S1.BKG_NO        = B.BKG_NO" ).append("\n"); 
		query.append("                                               AND S1.VSL_CD        = S2.VSL_CD" ).append("\n"); 
		query.append("                                               AND S1.SKD_VOY_NO = S2.SKD_VOY_NO" ).append("\n"); 
		query.append("                                               AND S1.SKD_DIR_CD    = S2.SKD_DIR_CD" ).append("\n"); 
		query.append("                                               AND S1.POL_CD       = S2.VPS_PORT_CD" ).append("\n"); 
		query.append("                                               AND S1.POL_CLPT_IND_SEQ = S2.CLPT_IND_SEQ" ).append("\n"); 
		query.append("							           AND ( S1.BKG_NO, S1.VSL_PRE_PST_CD, S1.VSL_SEQ ) IN (" ).append("\n"); 
		query.append("                                                 SELECT BKG_NO, SUBSTR(MIN(VSL_PRE_PST_CD||VSL_SEQ),1,1), SUBSTR(MIN(VSL_PRE_PST_CD||VSL_SEQ),2,1) " ).append("\n"); 
		query.append("                                                   FROM BKG_VVD" ).append("\n"); 
		query.append("                                                  WHERE BKG_NO = S1.BKG_NO" ).append("\n"); 
		query.append("                                                  GROUP BY BKG_NO ) " ).append("\n"); 
		query.append("                                            ) AS POL1_ETD_DT," ).append("\n"); 
		query.append("                                            (" ).append("\n"); 
		query.append("									        SELECT TO_CHAR(S2.VPS_ETA_DT, 'YYYY-MM-DD HH24:MI')" ).append("\n"); 
		query.append("                                              FROM BKG_VVD S1, VSK_VSL_PORT_SKD S2" ).append("\n"); 
		query.append("                                             WHERE S1.BKG_NO        =  B.BKG_NO" ).append("\n"); 
		query.append("                                               AND S1.VSL_CD        = S2.VSL_CD" ).append("\n"); 
		query.append("                                               AND S1.SKD_VOY_NO = S2.SKD_VOY_NO" ).append("\n"); 
		query.append("                                               AND S1.SKD_DIR_CD    = S2.SKD_DIR_CD" ).append("\n"); 
		query.append("                                               AND S1.POD_CD       = S2.VPS_PORT_CD" ).append("\n"); 
		query.append("                                               AND S1.POD_CLPT_IND_SEQ = S2.CLPT_IND_SEQ" ).append("\n"); 
		query.append("									           AND ( S1.BKG_NO, S1.VSL_PRE_PST_CD, S1.VSL_SEQ ) IN (" ).append("\n"); 
		query.append("                                                 SELECT BKG_NO, SUBSTR(MIN(VSL_PRE_PST_CD||VSL_SEQ),1,1), SUBSTR(MIN(VSL_PRE_PST_CD||VSL_SEQ),2,1) " ).append("\n"); 
		query.append("                                                   FROM BKG_VVD" ).append("\n"); 
		query.append("                                                  WHERE BKG_NO = S1.BKG_NO" ).append("\n"); 
		query.append("                                                  GROUP BY BKG_NO ) " ).append("\n"); 
		query.append("                                            ) AS POD1_ETA_DT," ).append("\n"); 
		query.append("        " ).append("\n"); 
		query.append("                                            (" ).append("\n"); 
		query.append("									        SELECT TO_CHAR(S2.VPS_ETD_DT, 'YYYY-MM-DD HH24:MI')" ).append("\n"); 
		query.append("                                              FROM BKG_VVD S1, VSK_VSL_PORT_SKD S2" ).append("\n"); 
		query.append("                                             WHERE S1.BKG_NO        =  B.BKG_NO" ).append("\n"); 
		query.append("                                               AND S1.VSL_CD        = S2.VSL_CD" ).append("\n"); 
		query.append("                                               AND S1.SKD_VOY_NO = S2.SKD_VOY_NO" ).append("\n"); 
		query.append("                                               AND S1.SKD_DIR_CD    = S2.SKD_DIR_CD" ).append("\n"); 
		query.append("                                               AND S1.POD_CD       = S2.VPS_PORT_CD" ).append("\n"); 
		query.append("                                               AND S1.POD_CLPT_IND_SEQ = S2.CLPT_IND_SEQ" ).append("\n"); 
		query.append("          									   AND ( S1.BKG_NO, S1.VSL_PRE_PST_CD, S1.VSL_SEQ ) IN (" ).append("\n"); 
		query.append("                                                 SELECT BKG_NO, SUBSTR(MIN(VSL_PRE_PST_CD||VSL_SEQ),1,1), SUBSTR(MIN(VSL_PRE_PST_CD||VSL_SEQ),2,1) " ).append("\n"); 
		query.append("                                                   FROM BKG_VVD" ).append("\n"); 
		query.append("                                                  WHERE BKG_NO = S1.BKG_NO" ).append("\n"); 
		query.append("                                                  GROUP BY BKG_NO )       " ).append("\n"); 
		query.append("                                            ) AS POD1_ETD_DT,                                          " ).append("\n"); 
		query.append("                                    (" ).append("\n"); 
		query.append("									SELECT TO_CHAR(S2.VPS_ETD_DT, 'YYYY-MM-DD HH24:MI')" ).append("\n"); 
		query.append("                                      FROM BKG_VVD S1, VSK_VSL_PORT_SKD S2" ).append("\n"); 
		query.append("                                     WHERE S1.BKG_NO        = B.BKG_NO" ).append("\n"); 
		query.append("                                       AND S1.VSL_CD        = S2.VSL_CD" ).append("\n"); 
		query.append("                                       AND S1.SKD_VOY_NO = S2.SKD_VOY_NO" ).append("\n"); 
		query.append("                                       AND S1.SKD_DIR_CD    = S2.SKD_DIR_CD" ).append("\n"); 
		query.append("                                       AND S1.POL_CD       = S2.VPS_PORT_CD" ).append("\n"); 
		query.append("                                       AND S1.POL_CLPT_IND_SEQ = S2.CLPT_IND_SEQ" ).append("\n"); 
		query.append("									   AND ( S1.BKG_NO, S1.VSL_PRE_PST_CD, S1.VSL_SEQ ) IN (" ).append("\n"); 
		query.append("                                         SELECT BKG_NO, SUBSTR(MAX(VSL_PRE_PST_CD||VSL_SEQ),1,1), SUBSTR(MAX(VSL_PRE_PST_CD||VSL_SEQ),2,1) " ).append("\n"); 
		query.append("                                           FROM BKG_VVD" ).append("\n"); 
		query.append("                                          WHERE BKG_NO = S1.BKG_NO" ).append("\n"); 
		query.append("                                          GROUP BY BKG_NO ) " ).append("\n"); 
		query.append("                                    ) AS F_POL_ETD," ).append("\n"); 
		query.append("" ).append("\n"); 
		query.append("                                    (" ).append("\n"); 
		query.append("									SELECT TO_CHAR(S2.VPS_ETA_DT, 'YYYY-MM-DD HH24:MI')" ).append("\n"); 
		query.append("                                      FROM BKG_VVD S1, VSK_VSL_PORT_SKD S2" ).append("\n"); 
		query.append("                                     WHERE S1.BKG_NO        =  B.BKG_NO" ).append("\n"); 
		query.append("                                       AND S1.VSL_CD        = S2.VSL_CD" ).append("\n"); 
		query.append("                                       AND S1.SKD_VOY_NO = S2.SKD_VOY_NO" ).append("\n"); 
		query.append("                                       AND S1.SKD_DIR_CD    = S2.SKD_DIR_CD" ).append("\n"); 
		query.append("                                       AND S1.POD_CD       = S2.VPS_PORT_CD" ).append("\n"); 
		query.append("                                       AND S1.POD_CLPT_IND_SEQ = S2.CLPT_IND_SEQ" ).append("\n"); 
		query.append("									   AND ( S1.BKG_NO, S1.VSL_PRE_PST_CD, S1.VSL_SEQ ) IN (" ).append("\n"); 
		query.append("                                         SELECT BKG_NO, SUBSTR(MAX(VSL_PRE_PST_CD||VSL_SEQ),1,1), SUBSTR(MAX(VSL_PRE_PST_CD||VSL_SEQ),2,1) " ).append("\n"); 
		query.append("                                           FROM BKG_VVD" ).append("\n"); 
		query.append("                                          WHERE BKG_NO = S1.BKG_NO" ).append("\n"); 
		query.append("                                          GROUP BY BKG_NO ) " ).append("\n"); 
		query.append("                                    ) AS F_POD_ETA," ).append("\n"); 
		query.append("" ).append("\n"); 
		query.append("                                    (" ).append("\n"); 
		query.append("									SELECT TO_CHAR(S2.VPS_ETD_DT, 'YYYY-MM-DD HH24:MI')" ).append("\n"); 
		query.append("                                      FROM BKG_VVD S1, VSK_VSL_PORT_SKD S2" ).append("\n"); 
		query.append("                                     WHERE S1.BKG_NO        =  B.BKG_NO" ).append("\n"); 
		query.append("                                       AND S1.VSL_CD        = S2.VSL_CD" ).append("\n"); 
		query.append("                                       AND S1.SKD_VOY_NO = S2.SKD_VOY_NO" ).append("\n"); 
		query.append("                                       AND S1.SKD_DIR_CD    = S2.SKD_DIR_CD" ).append("\n"); 
		query.append("                                       AND S1.POD_CD       = S2.VPS_PORT_CD" ).append("\n"); 
		query.append("                                       AND S1.POD_CLPT_IND_SEQ = S2.CLPT_IND_SEQ" ).append("\n"); 
		query.append("									   AND ( S1.BKG_NO, S1.VSL_PRE_PST_CD, S1.VSL_SEQ ) IN (" ).append("\n"); 
		query.append("                                         SELECT BKG_NO, SUBSTR(MAX(VSL_PRE_PST_CD||VSL_SEQ),1,1), SUBSTR(MAX(VSL_PRE_PST_CD||VSL_SEQ),2,1) " ).append("\n"); 
		query.append("                                           FROM BKG_VVD" ).append("\n"); 
		query.append("                                          WHERE BKG_NO = S1.BKG_NO" ).append("\n"); 
		query.append("                                          GROUP BY BKG_NO )       " ).append("\n"); 
		query.append("                                    ) AS F_POD_ETD," ).append("\n"); 
		query.append("" ).append("\n"); 
		query.append("                                    ( SELECT TO_CHAR(MIN(MAX(S2.VPS_ETA_DT)), 'YYYY-MM-DD HH24:MI')" ).append("\n"); 
		query.append("                                      FROM BKG_VVD S1, VSK_VSL_PORT_SKD S2" ).append("\n"); 
		query.append("                                     WHERE S1.BKG_NO        = B.BKG_NO" ).append("\n"); 
		query.append("                                       AND S1.VSL_PRE_PST_CD        = 'T'" ).append("\n"); 
		query.append("                                       AND S1.VSL_CD        = S2.VSL_CD" ).append("\n"); 
		query.append("                                       AND S1.SKD_VOY_NO = S2.SKD_VOY_NO" ).append("\n"); 
		query.append("                                       AND S1.SKD_DIR_CD    = S2.SKD_DIR_CD" ).append("\n"); 
		query.append("                                       AND S1.POL_CD       = S2.VPS_PORT_CD" ).append("\n"); 
		query.append("                                       AND S1.POL_CLPT_IND_SEQ = S2.CLPT_IND_SEQ" ).append("\n"); 
		query.append("                                     GROUP BY S2.VSL_CD, S2.SKD_VOY_NO, S2.SKD_DIR_CD, S2.VPS_PORT_CD" ).append("\n"); 
		query.append("                                    ) AS T_POL_ETA," ).append("\n"); 
		query.append("" ).append("\n"); 
		query.append("                                     (SELECT TO_CHAR(MIN(MIN(S2.VPS_ETD_DT)), 'YYYY-MM-DD HH24:MI')" ).append("\n"); 
		query.append("                                      FROM BKG_VVD S1, VSK_VSL_PORT_SKD S2" ).append("\n"); 
		query.append("                                     WHERE S1.BKG_NO        =  B.BKG_NO" ).append("\n"); 
		query.append("                                       AND S1.VSL_PRE_PST_CD        = 'T'" ).append("\n"); 
		query.append("                                       AND S1.VSL_CD        = S2.VSL_CD" ).append("\n"); 
		query.append("                                       AND S1.SKD_VOY_NO = S2.SKD_VOY_NO" ).append("\n"); 
		query.append("                                       AND S1.SKD_DIR_CD    = S2.SKD_DIR_CD" ).append("\n"); 
		query.append("                                       AND S1.POL_CD      = S2.VPS_PORT_CD  " ).append("\n"); 
		query.append("                                       AND S1.POL_CLPT_IND_SEQ = S2.CLPT_IND_SEQ" ).append("\n"); 
		query.append("                                       GROUP BY S2.VSL_CD, S2.SKD_VOY_NO, S2.SKD_DIR_CD, S2.VPS_PORT_CD" ).append("\n"); 
		query.append("                                    ) AS T_POL_ETD," ).append("\n"); 
		query.append("" ).append("\n"); 
		query.append("                                    (SELECT TO_CHAR(MAX(MAX(S2.VPS_ETA_DT)), 'YYYY-MM-DD HH24:MI')" ).append("\n"); 
		query.append("                                     FROM BKG_VVD S1, VSK_VSL_PORT_SKD S2" ).append("\n"); 
		query.append("                                     WHERE S1.BKG_NO        =  B.BKG_NO" ).append("\n"); 
		query.append("                                       AND S1.VSL_PRE_PST_CD        = 'T'" ).append("\n"); 
		query.append("                                       AND S1.VSL_CD        = S2.VSL_CD" ).append("\n"); 
		query.append("                                       AND S1.SKD_VOY_NO = S2.SKD_VOY_NO" ).append("\n"); 
		query.append("                                       AND S1.SKD_DIR_CD    = S2.SKD_DIR_CD" ).append("\n"); 
		query.append("                                       AND S1.POD_CD       = S2.VPS_PORT_CD" ).append("\n"); 
		query.append("                                       AND S1.POD_CLPT_IND_SEQ = S2.CLPT_IND_SEQ" ).append("\n"); 
		query.append("                                     GROUP BY S2.VSL_CD, S2.SKD_VOY_NO, S2.SKD_DIR_CD, S2.VPS_PORT_CD" ).append("\n"); 
		query.append("                                    ) AS T_POD_ETA, " ).append("\n"); 
		query.append("" ).append("\n"); 
		query.append("                                    ( SELECT TO_CHAR(MAX(MIN(S2.VPS_ETD_DT)), 'YYYY-MM-DD HH24:MI')" ).append("\n"); 
		query.append("                                      FROM BKG_VVD S1, VSK_VSL_PORT_SKD S2" ).append("\n"); 
		query.append("                                     WHERE S1.BKG_NO        = B.BKG_NO" ).append("\n"); 
		query.append("                                       AND S1.VSL_PRE_PST_CD        = 'T'" ).append("\n"); 
		query.append("                                       AND S1.VSL_CD        = S2.VSL_CD" ).append("\n"); 
		query.append("                                       AND S1.SKD_VOY_NO = S2.SKD_VOY_NO" ).append("\n"); 
		query.append("                                       AND S1.SKD_DIR_CD    = S2.SKD_DIR_CD" ).append("\n"); 
		query.append("                                       AND S1.POD_CD       = S2.VPS_PORT_CD" ).append("\n"); 
		query.append("                                       AND S1.POD_CLPT_IND_SEQ = S2.CLPT_IND_SEQ" ).append("\n"); 
		query.append("                                     GROUP BY S2.VSL_CD, S2.SKD_VOY_NO, S2.SKD_DIR_CD, S2.VPS_PORT_CD" ).append("\n"); 
		query.append("                                    ) AS T_POD_ETD," ).append("\n"); 
		query.append("                                     " ).append("\n"); 
		query.append("                                    ( SELECT TRIM(TO_CHAR(SUM(CHG_AMT/USD_LOCL_XCH_RT) ,'99,999,999.99'))" ).append("\n"); 
		query.append("                                        FROM BKG_CHG_RT R," ).append("\n"); 
		query.append("                                          GL_MON_XCH_RT A" ).append("\n"); 
		query.append("                                        WHERE TO_CHAR(R.CRE_DT, 'YYYYMM') = A.ACCT_XCH_RT_YRMON" ).append("\n"); 
		query.append("                                          AND A.ACCT_XCH_RT_LVL = '1'" ).append("\n"); 
		query.append("                                          AND FRT_TERM_CD = 'P'" ).append("\n"); 
		query.append("                                          AND R.BKG_NO = B.BKG_NO" ).append("\n"); 
		query.append("										  AND R.CURR_CD = A.CURR_CD" ).append("\n"); 
		query.append("										  AND R.FRT_INCL_XCLD_DIV_CD ='N'" ).append("\n"); 
		query.append("                                    ) AS PPD_CHARGE," ).append("\n"); 
		query.append("                                          " ).append("\n"); 
		query.append("                                    ( SELECT TRIM(TO_CHAR(SUM(CHG_AMT/USD_LOCL_XCH_RT) ,'99,999,999.99'))" ).append("\n"); 
		query.append("                                        FROM BKG_CHG_RT R," ).append("\n"); 
		query.append("                                          GL_MON_XCH_RT A" ).append("\n"); 
		query.append("                                        WHERE TO_CHAR(R.CRE_DT, 'YYYYMM') = A.ACCT_XCH_RT_YRMON" ).append("\n"); 
		query.append("                                          AND A.ACCT_XCH_RT_LVL = '1'" ).append("\n"); 
		query.append("                                          AND FRT_TERM_CD = 'C'" ).append("\n"); 
		query.append("                                          AND R.BKG_NO = B.BKG_NO" ).append("\n"); 
		query.append("										  AND R.CURR_CD = A.CURR_CD" ).append("\n"); 
		query.append("										  AND R.FRT_INCL_XCLD_DIV_CD ='N'" ).append("\n"); 
		query.append("                                    ) AS CCT_CHARGE," ).append("\n"); 
		query.append("                                          " ).append("\n"); 
		query.append("                                    ( SELECT TO_CHAR(MAX(T.SND_DT), 'YYYY-MM-DD HH24:MI')" ).append("\n"); 
		query.append("                                        FROM BKG_NTC_HIS T" ).append("\n"); 
		query.append("                                        WHERE T.NTC_VIA_CD = 'F'" ).append("\n"); 
		query.append("                                          AND T.NTC_KND_CD ='AN'" ).append("\n"); 
		query.append("                                          AND T.BKG_NO = B.BKG_NO" ).append("\n"); 
		query.append("                                    ) AS AN_SEND_DT," ).append("\n"); 
		query.append("                                        " ).append("\n"); 
		query.append("                                    ( SELECT V.STE_NM " ).append("\n"); 
		query.append("                                      FROM MDM_location U, MDM_state V" ).append("\n"); 
		query.append("                                      WHERE U.STE_CD    = V.STE_CD(+)" ).append("\n"); 
		query.append("                                        AND U.cnt_cd       = V.cnt_cd" ).append("\n"); 
		query.append("                                        AND U.loc_cd       = B.DEL_CD" ).append("\n"); 
		query.append("                                    ) AS DEL_STATE," ).append("\n"); 
		query.append("                                     " ).append("\n"); 
		query.append("                                    BKG_JOIN_FNC(CURSOR(SELECT C.CNTR_SEAL_NO" ).append("\n"); 
		query.append("                                      FROM BKG_CNTR_SEAL_NO C" ).append("\n"); 
		query.append("                                      WHERE 1=1" ).append("\n"); 
		query.append("                                        AND C.CNTR_NO = CNTR.CNTR_NO" ).append("\n"); 
		query.append("                                        AND C.BKG_NO = B.BKG_NO                   " ).append("\n"); 
		query.append("                                    )) AS CNTR_SEAL_NO," ).append("\n"); 
		query.append("                                      " ).append("\n"); 
		query.append("                                    ( SELECT CUST_REF_NO_CTNT" ).append("\n"); 
		query.append("                                       FROM BKG_REFERENCE A" ).append("\n"); 
		query.append("                                       WHERE A.BKG_NO = B.BKG_NO" ).append("\n"); 
		query.append("									   AND A.BKG_REF_TP_CD = 'BKPO'" ).append("\n"); 
		query.append("									   AND ROWNUM = 1" ).append("\n"); 
		query.append("                                    ) AS BL_PO_NO," ).append("\n"); 
		query.append("                                       " ).append("\n"); 
		query.append("                                    ( SELECT TO_CHAR(MIN(MIN(S2.VPS_ETD_DT)), 'YYYY-MM-DD HH24:MI')" ).append("\n"); 
		query.append("                                        FROM BKG_VVD S1, VSK_VSL_PORT_SKD S2" ).append("\n"); 
		query.append("                                        WHERE S1.BKG_NO        = B.BKG_NO" ).append("\n"); 
		query.append("                                          AND S1.VSL_CD        = S2.VSL_CD" ).append("\n"); 
		query.append("                                          AND S1.SKD_VOY_NO = S2.SKD_VOY_NO" ).append("\n"); 
		query.append("                                          AND S1.SKD_DIR_CD    = S2.SKD_DIR_CD" ).append("\n"); 
		query.append("                                          AND S1.POL_CD       = S2.VPS_PORT_CD" ).append("\n"); 
		query.append("                                          AND S1.POL_CLPT_IND_SEQ = S2.CLPT_IND_SEQ" ).append("\n"); 
		query.append("                                          GROUP BY S2.VSL_CD, S2.SKD_VOY_NO, S2.SKD_DIR_CD, S2.VPS_PORT_CD" ).append("\n"); 
		query.append("                                    ) AS POL_ETD," ).append("\n"); 
		query.append("                                        " ).append("\n"); 
		query.append("                                     (SELECT TO_CHAR(MAX(MAX(S2.VPS_ETA_DT)), 'YYYY-MM-DD HH24:MI')" ).append("\n"); 
		query.append("                                       FROM BKG_VVD S1, VSK_VSL_PORT_SKD S2" ).append("\n"); 
		query.append("                                      WHERE S1.BKG_NO        = B.BKG_NO" ).append("\n"); 
		query.append("                                        AND S1.VSL_CD        = S2.VSL_CD" ).append("\n"); 
		query.append("                                        AND S1.SKD_VOY_NO = S2.SKD_VOY_NO" ).append("\n"); 
		query.append("                                        AND S1.SKD_DIR_CD    = S2.SKD_DIR_CD" ).append("\n"); 
		query.append("                                        AND S1.POD_CD       = S2.VPS_PORT_CD" ).append("\n"); 
		query.append("                                        AND S1.POD_CLPT_IND_SEQ = S2.CLPT_IND_SEQ" ).append("\n"); 
		query.append("                                        GROUP BY S2.VSL_CD, S2.SKD_VOY_NO, S2.SKD_DIR_CD, S2.VPS_PORT_CD" ).append("\n"); 
		query.append("                                    ) AS POD_ETA," ).append("\n"); 
		query.append("                                    " ).append("\n"); 
		query.append("                                    (SELECT TO_CHAR(MAX(MAX(S2.VPS_ETB_DT)), 'YYYY-MM-DD HH24:MI')" ).append("\n"); 
		query.append("                                       FROM BKG_VVD S1, VSK_VSL_PORT_SKD S2" ).append("\n"); 
		query.append("                                      WHERE S1.BKG_NO        = B.BKG_NO" ).append("\n"); 
		query.append("                                        AND S1.VSL_CD        = S2.VSL_CD" ).append("\n"); 
		query.append("                                        AND S1.SKD_VOY_NO = S2.SKD_VOY_NO" ).append("\n"); 
		query.append("                                        AND S1.SKD_DIR_CD    = S2.SKD_DIR_CD" ).append("\n"); 
		query.append("                                        AND S1.POD_CD       = S2.VPS_PORT_CD" ).append("\n"); 
		query.append("                                        AND S1.POD_CLPT_IND_SEQ = S2.CLPT_IND_SEQ" ).append("\n"); 
		query.append("                                        GROUP BY S2.VSL_CD, S2.SKD_VOY_NO, S2.SKD_DIR_CD, S2.VPS_PORT_CD" ).append("\n"); 
		query.append("                                    ) AS POD_ETB," ).append("\n"); 
		query.append("                                    " ).append("\n"); 
		query.append("                                    (SELECT B.AGMT_ACT_CNT_CD||LPAD(B.AGMT_ACT_CUST_SEQ,6,'0')" ).append("\n"); 
		query.append("                                   FROM MDM_CUSTOMER ACT_CUST" ).append("\n"); 
		query.append("                                   WHERE ACT_CUST.CUST_CNT_CD = B.AGMT_ACT_CNT_CD" ).append("\n"); 
		query.append("                                   AND ACT_CUST.CUST_SEQ = B.AGMT_ACT_CUST_SEQ) ACT_CUST_CODE," ).append("\n"); 
		query.append("                                   " ).append("\n"); 
		query.append("                                   (SELECT ACT_CUST.CUST_LGL_ENG_NM" ).append("\n"); 
		query.append("                                   FROM MDM_CUSTOMER ACT_CUST" ).append("\n"); 
		query.append("                                   WHERE ACT_CUST.CUST_CNT_CD = B.AGMT_ACT_CNT_CD" ).append("\n"); 
		query.append("                                   AND ACT_CUST.CUST_SEQ = B.AGMT_ACT_CUST_SEQ) ACT_CUST_NAME," ).append("\n"); 
		query.append("                                        " ).append("\n"); 
		query.append("                                    (SELECT EQ_CTRL_OFC_CD" ).append("\n"); 
		query.append("                                       FROM MDM_LOCATION U" ).append("\n"); 
		query.append("									 WHERE U.LOC_CD       = B.DEL_CD" ).append("\n"); 
		query.append("									) AS EQ_CTRL_OFC," ).append("\n"); 
		query.append("" ).append("\n"); 
		query.append("                                    (SELECT SO.LST_FREE_DT||','||SO.PKUP_NO||','||SO.PKUP_YD_CD||','||SO.PKUP_AVAL_DT" ).append("\n"); 
		query.append("										FROM BKG_PKUP_NTC_PKUP_NO SO, BKG_BOOKING C, MDM_LOCATION M, SCE_COP_HDR SCA, SCE_COP_HDR SCB" ).append("\n"); 
		query.append("										WHERE 1=1" ).append("\n"); 
		query.append("                    					AND SCA.BKG_NO = CNTR.BKG_NO" ).append("\n"); 
		query.append("                   						AND SCA.CNTR_NO = CNTR.CNTR_NO" ).append("\n"); 
		query.append("                    					AND SCB.COP_STS_CD <> 'X'" ).append("\n"); 
		query.append("                    					AND SCA.COP_STS_CD <> 'X'" ).append("\n"); 
		query.append("                    					AND SCA.MST_COP_NO = SCB.COP_NO" ).append("\n"); 
		query.append("                    					AND SCB.BKG_NO =  SO.BKG_NO" ).append("\n"); 
		query.append("                    					AND SCB.CNTR_NO = SO.CNTR_NO" ).append("\n"); 
		query.append("                    					AND C.BKG_NO = SO.BKG_NO" ).append("\n"); 
		query.append("                    					AND C.DEL_CD = M.LOC_CD" ).append("\n"); 
		query.append("                    					AND SO.OFC_CD = M.EQ_CTRL_OFC_CD" ).append("\n"); 
		query.append("									) AS FREE_DT," ).append("\n"); 
		query.append("" ).append("\n"); 
		query.append("                                    (SELECT IBD_TRSP_ISS_DT||','||IBD_TRSP_NO" ).append("\n"); 
		query.append("										FROM BKG_CSTMS_ADV_IBD A" ).append("\n"); 
		query.append("										WHERE A.BL_NO = B.BL_NO" ).append("\n"); 
		query.append("									) AS IBD_TRSP_ISS_DT," ).append("\n"); 
		query.append("" ).append("\n"); 
		query.append("                                    (SELECT HUB_LOC_CD" ).append("\n"); 
		query.append("                                       FROM BKG_CSTMS_ADV_BL A" ).append("\n"); 
		query.append("                                      WHERE A.BL_NO = B.BL_NO" ).append("\n"); 
		query.append("										AND A.CNT_CD ='US'" ).append("\n"); 
		query.append("                                    ) AS HUB_LOC_CD," ).append("\n"); 
		query.append("" ).append("\n"); 
		query.append("                                    (SELECT FRT_CLT_FLG||','||OBL_RDEM_FLG||','||TO_CHAR(CSTMS_CLR_LST_DT,'YYYY-MM-DD')||','||CSTMS_CLR_CD" ).append("\n"); 
		query.append("										FROM BKG_CGO_RLSE A" ).append("\n"); 
		query.append("										WHERE A.BL_NO = B.BL_NO" ).append("\n"); 
		query.append("									) AS FRT_CLT_FLG," ).append("\n"); 
		query.append("" ).append("\n"); 
		query.append("                                    ( SELECT TO_CHAR(MAX(ACT_DT),'YYYY-MM-DD HH24:MI')" ).append("\n"); 
		query.append("                                        FROM SCE_COP_DTL" ).append("\n"); 
		query.append("                                       WHERE COP_NO = ( SELECT MAX(COP_NO) FROM SCE_COP_HDR" ).append("\n"); 
		query.append("                                                                             WHERE BKG_NO = B.BKG_NO" ).append("\n"); 
		query.append("                                                                 AND CNTR_NO = CNTR.CNTR_NO" ).append("\n"); 
		query.append("                                                                 AND COP_STS_CD != 'X' )" ).append("\n"); 
		query.append("                                                                 AND ACT_STS_MAPG_CD = 'OC'" ).append("\n"); 
		query.append("                                                                                               ) AS CNTR_OC_DATE," ).append("\n"); 
		query.append("" ).append("\n"); 
		query.append("                                    ( SELECT TO_CHAR(MIN(ACT_DT),'YYYY-MM-DD HH24:MI')" ).append("\n"); 
		query.append("                                        FROM SCE_COP_DTL" ).append("\n"); 
		query.append("                                       WHERE COP_NO = ( SELECT MAX(COP_NO) " ).append("\n"); 
		query.append("                                                        FROM SCE_COP_HDR" ).append("\n"); 
		query.append("                                                        WHERE BKG_NO = B.BKG_NO" ).append("\n"); 
		query.append("                                                        AND CNTR_NO = CNTR.CNTR_NO" ).append("\n"); 
		query.append("                                                        AND COP_STS_CD != 'X' )" ).append("\n"); 
		query.append("                                        AND ACT_CD IN ('FTVMUD','FTWMUD')) AS DCHG_TS_PORT_DT," ).append("\n"); 
		query.append("                                                                                               " ).append("\n"); 
		query.append("                                    (SELECT DSPO_CD " ).append("\n"); 
		query.append("                                       FROM BKG_CSTMS_ADV_RSLT A" ).append("\n"); 
		query.append("                                      WHERE A.CNT_CD ='US'" ).append("\n"); 
		query.append("                                        AND A.BL_NO = B.BL_NO" ).append("\n"); 
		query.append("                                        AND A.CSTMS_SEQ = (SELECT MAX(CSTMS_SEQ)" ).append("\n"); 
		query.append("                                                             FROM BKG_CSTMS_ADV_RSLT C" ).append("\n"); 
		query.append("                                                            WHERE C.CNT_CD ='US'" ).append("\n"); 
		query.append("                                                              AND C.BL_NO = B.BL_NO) " ).append("\n"); 
		query.append("                                    ) AS DSPO_CD," ).append("\n"); 
		query.append("" ).append("\n"); 
		query.append("                                    (SELECT CNMV_STS_CD " ).append("\n"); 
		query.append("                                       FROM MST_CONTAINER A" ).append("\n"); 
		query.append("                                      WHERE A.CNTR_NO = CNTR.CNTR_NO" ).append("\n"); 
		query.append("                                    )AS CGO_STS_CD,  " ).append("\n"); 
		query.append("" ).append("\n"); 
		query.append("                                    (SELECT MIN(MV_IC.CNMV_EVNT_DT)" ).append("\n"); 
		query.append("                                      FROM CTM_MOVEMENT MV_IC" ).append("\n"); 
		query.append("                                      WHERE MV_IC.CNTR_NO        = CNTR.CNTR_NO" ).append("\n"); 
		query.append("                                        AND MV_IC.CRNT_VSL_CD         = B.VSL_CD" ).append("\n"); 
		query.append("                                        AND MV_IC.CRNT_SKD_VOY_NO  = B.SKD_VOY_NO" ).append("\n"); 
		query.append("                                        AND MV_IC.CRNT_SKD_DIR_CD     = B.SKD_DIR_CD" ).append("\n"); 
		query.append("                                        AND MV_IC.MVMT_STS_CD        = 'IC'" ).append("\n"); 
		query.append("                                        AND MV_IC.ORG_YD_CD      LIKE B.POD_CD||'%'" ).append("\n"); 
		query.append("                                        AND MV_IC.CNMV_EVNT_DT     BETWEEN (SELECT MAX(VPS_ETA_DT)" ).append("\n"); 
		query.append("                                                              FROM BKG_VVD VVD, VSK_VSL_PORT_SKD VPS" ).append("\n"); 
		query.append("                                                              WHERE VVD.VSL_CD = VPS.VSL_CD" ).append("\n"); 
		query.append("                                                              AND   VVD.SKD_VOY_NO = VPS.SKD_VOY_NO" ).append("\n"); 
		query.append("                                                              AND   VVD.SKD_DIR_CD = VPS.SKD_DIR_CD " ).append("\n"); 
		query.append("                                                              AND   B.BKG_NO  = VVD.BKG_NO) - 10" ).append("\n"); 
		query.append("                                                    AND (SELECT MIN(VPS_ETA_DT)" ).append("\n"); 
		query.append("                                                              FROM BKG_VVD VVD, VSK_VSL_PORT_SKD VPS" ).append("\n"); 
		query.append("                                                              WHERE VVD.VSL_CD = VPS.VSL_CD" ).append("\n"); 
		query.append("                                                              AND   VVD.SKD_VOY_NO = VPS.SKD_VOY_NO" ).append("\n"); 
		query.append("                                                              AND   VVD.SKD_DIR_CD = VPS.SKD_DIR_CD " ).append("\n"); 
		query.append("                                                              AND   B.BKG_NO  = VVD.BKG_NO) + 120" ).append("\n"); 
		query.append("                                    ) AS DEL_ATA," ).append("\n"); 
		query.append("									" ).append("\n"); 
		query.append("									(SELECT MIN(TO_CHAR(CNMV_EVNT_DT,'YYYY-MM-DD HH24:MI'))" ).append("\n"); 
		query.append("									 FROM 	CTM_MOVEMENT" ).append("\n"); 
		query.append("									 WHERE	BKG_NO IS NOT NULL" ).append("\n"); 
		query.append("										AND CNTR_NO	= CNTR.CNTR_NO" ).append("\n"); 
		query.append("										AND CNMV_CYC_NO = ( SELECT MAX(CNMV_CYC_NO) " ).append("\n"); 
		query.append("                                							FROM BKG_CONTAINER" ).append("\n"); 
		query.append("                                  							WHERE BKG_NO = CNTR.BKG_NO" ).append("\n"); 
		query.append("                                  							AND CNTR_NO =  CNTR.CNTR_NO )" ).append("\n"); 
		query.append("										AND MVMT_STS_CD = 'ID' ) DEL_DT," ).append("\n"); 
		query.append("" ).append("\n"); 
		query.append("									( SELECT MIN(TO_CHAR(CNMV_EVNT_DT,'YYYY-MM-DD HH24:MI'))" ).append("\n"); 
		query.append("										FROM CTM_MOVEMENT" ).append("\n"); 
		query.append("									   WHERE BKG_NO IS NOT NULL" ).append("\n"); 
		query.append("										AND CNTR_NO	= CNTR.CNTR_NO" ).append("\n"); 
		query.append("										AND CNMV_CYC_NO = ( SELECT MAX(CNMV_CYC_NO) " ).append("\n"); 
		query.append("                                							FROM BKG_CONTAINER" ).append("\n"); 
		query.append("                                  							WHERE BKG_NO = CNTR.BKG_NO" ).append("\n"); 
		query.append("                                  							AND CNTR_NO =  CNTR.CNTR_NO )" ).append("\n"); 
		query.append("										AND MVMT_STS_CD = 'MT'" ).append("\n"); 
		query.append("									) MT_RETURN_DT," ).append("\n"); 
		query.append("" ).append("\n"); 
		query.append("                                    (SELECT NVL(DEL_ARR_DT,POD_ARR_DT)" ).append("\n"); 
		query.append("                                       FROM BKG_ARR_NTC A" ).append("\n"); 
		query.append("                                       WHERE A.BKG_NO = B.BKG_NO" ).append("\n"); 
		query.append("                                    ) AS DEL_ETA_DT," ).append("\n"); 
		query.append("                                       " ).append("\n"); 
		query.append("                                    ( SELECT REF_NO" ).append("\n"); 
		query.append("                                       FROM BKG_CUSTOMER A" ).append("\n"); 
		query.append("                                       WHERE A.BKG_NO = B.BKG_NO" ).append("\n"); 
		query.append("                                       AND A.BKG_CUST_TP_CD ='E'" ).append("\n"); 
		query.append("                                    ) AS EXPORT_REF_NO," ).append("\n"); 
		query.append("" ).append("\n"); 
		query.append("                                    (SELECT S2.YD_CSTMS_NO" ).append("\n"); 
		query.append("                                       FROM BKG_BOOKING S1, MDM_YARD S2" ).append("\n"); 
		query.append("                                      WHERE S1.BKG_NO        = B.BKG_NO   " ).append("\n"); 
		query.append("                                        AND S1.POD_NOD_CD  = S2.YD_CD(+)" ).append("\n"); 
		query.append("                                    ) AS FIRMS_CODE,  " ).append("\n"); 
		query.append("                                     CNTR.BKG_NO   AS CBKG_NO," ).append("\n"); 
		query.append("                                    (" ).append("\n"); 
		query.append("                                        SELECT TO_CHAR(MAX(" ).append("\n"); 
		query.append("                                                           DECODE(NTC_VIA_CD,'F',NVL((SELECT XPT_DT FROM COM_FAX_SND_INFO WHERE FAX_SND_NO = SND_ID),NVL((SELECT UPD_DT FROM COM_FAX_SND_INFO WHERE FAX_SND_NO = SND_ID),SND_RQST_DT))" ).append("\n"); 
		query.append("                                                                                ,NVL((SELECT EML_DT FROM COM_EML_SND_INFO WHERE EML_SND_NO = SND_ID),SND_RQST_DT)" ).append("\n"); 
		query.append("                                                                 )" ).append("\n"); 
		query.append("                                                          ),'YYYY-MM-DD HH24:MI')" ).append("\n"); 
		query.append("                                        FROM   BKG_NTC_HIS" ).append("\n"); 
		query.append("                                        WHERE  NTC_VIA_CD IN ('F','M')" ).append("\n"); 
		query.append("                                        AND    NTC_KND_CD = 'BK'" ).append("\n"); 
		query.append("                                        AND    BKG_NO = B.BKG_NO" ).append("\n"); 
		query.append("                                    ) AS BKG_RCT_SND_DT_FAX," ).append("\n"); 
		query.append("								    (" ).append("\n"); 
		query.append("                                        SELECT TO_CHAR(MAX(" ).append("\n"); 
		query.append("                                                           DECODE(NTC_VIA_CD,'F',NVL((SELECT XPT_DT FROM COM_FAX_SND_INFO WHERE FAX_SND_NO = SND_ID),NVL((SELECT UPD_DT FROM COM_FAX_SND_INFO WHERE FAX_SND_NO = SND_ID),SND_RQST_DT))" ).append("\n"); 
		query.append("                                                                                ,NVL((SELECT EML_DT FROM COM_EML_SND_INFO WHERE EML_SND_NO = SND_ID),SND_RQST_DT)" ).append("\n"); 
		query.append("                                                                 )" ).append("\n"); 
		query.append("                                                          ),'YYYY-MM-DD HH24:MI')" ).append("\n"); 
		query.append("                                        FROM   BKG_NTC_HIS" ).append("\n"); 
		query.append("                                        WHERE  NTC_VIA_CD IN ('F','M')" ).append("\n"); 
		query.append("                                        AND    NTC_KND_CD = 'BL'" ).append("\n"); 
		query.append("                                        AND    BKG_NO = B.BKG_NO" ).append("\n"); 
		query.append("                                    ) AS DBL_SND_DT_FAX," ).append("\n"); 
		query.append("                                    (" ).append("\n"); 
		query.append("                                        SELECT TO_CHAR(MAX(" ).append("\n"); 
		query.append("                                                           DECODE(NTC_VIA_CD,'F',NVL((SELECT XPT_DT FROM COM_FAX_SND_INFO WHERE FAX_SND_NO = SND_ID),NVL((SELECT UPD_DT FROM COM_FAX_SND_INFO WHERE FAX_SND_NO = SND_ID),SND_RQST_DT))" ).append("\n"); 
		query.append("                                                                                ,NVL((SELECT EML_DT FROM COM_EML_SND_INFO WHERE EML_SND_NO = SND_ID),SND_RQST_DT)" ).append("\n"); 
		query.append("                                                                 )" ).append("\n"); 
		query.append("                                                          ),'YYYY-MM-DD HH24:MI')" ).append("\n"); 
		query.append("                                        FROM   BKG_NTC_HIS" ).append("\n"); 
		query.append("                                        WHERE  NTC_VIA_CD IN ('F','M')" ).append("\n"); 
		query.append("                                        AND    NTC_KND_CD = 'WB'" ).append("\n"); 
		query.append("                                        AND    BKG_NO = B.BKG_NO" ).append("\n"); 
		query.append("                                    ) AS WBL_SND_DT_FAX," ).append("\n"); 
		query.append("                                    (" ).append("\n"); 
		query.append("                                        SELECT TO_CHAR(MAX(SND_RQST_DT), 'YYYY-MM-DD HH24:MI')" ).append("\n"); 
		query.append("                                        FROM   BKG_NTC_HIS" ).append("\n"); 
		query.append("                                        WHERE  NTC_VIA_CD = 'E'" ).append("\n"); 
		query.append("                                        AND    NTC_KND_CD = 'BL'" ).append("\n"); 
		query.append("                                        AND    BKG_NO = B.BKG_NO" ).append("\n"); 
		query.append("                                    ) AS DBL_SND_DT_EDI," ).append("\n"); 
		query.append("                                    (" ).append("\n"); 
		query.append("                                        SELECT TO_CHAR(MAX(SND_RQST_DT), 'YYYY-MM-DD HH24:MI')" ).append("\n"); 
		query.append("                                        FROM   BKG_NTC_HIS" ).append("\n"); 
		query.append("                                        WHERE  NTC_VIA_CD = 'E'" ).append("\n"); 
		query.append("                                        AND    NTC_KND_CD = 'BK'" ).append("\n"); 
		query.append("                                        AND    BKG_NO = B.BKG_NO" ).append("\n"); 
		query.append("                                    ) AS BKG_RCT_SND_DT_EDI," ).append("\n"); 
		query.append("									(" ).append("\n"); 
		query.append("										SELECT TO_CHAR(MAX(ACT_DT),'YYYY-MM-DD hh24:mi')" ).append("\n"); 
		query.append("										FROM SCE_EDI_SND_RSLT A" ).append("\n"); 
		query.append("										WHERE EDI_STS_CD = 'UVD'" ).append("\n"); 
		query.append("  										AND A.BKG_NO = B.BKG_NO" ).append("\n"); 
		query.append("  										AND A.CNTR_NO = CNTR.CNTR_NO" ).append("\n"); 
		query.append("									) AS UVD_MAX_ACT_DT," ).append("\n"); 
		query.append("									(" ).append("\n"); 
		query.append("										SELECT TO_CHAR(MAX(ACT_DT),'YYYY-MM-DD hh24:mi')" ).append("\n"); 
		query.append("										FROM SCE_EDI_SND_RSLT A" ).append("\n"); 
		query.append("										WHERE EDI_STS_CD = 'RLN'" ).append("\n"); 
		query.append("  										AND A.BKG_NO = B.BKG_NO" ).append("\n"); 
		query.append("  										AND A.CNTR_NO = CNTR.CNTR_NO" ).append("\n"); 
		query.append("									) AS RLN_MAX_ACT_DT," ).append("\n"); 
		query.append("									(" ).append("\n"); 
		query.append("										SELECT TO_CHAR(MAX(ACT_DT),'YYYY-MM-DD hh24:mi')" ).append("\n"); 
		query.append("										FROM SCE_EDI_SND_RSLT A" ).append("\n"); 
		query.append("										WHERE EDI_STS_CD = 'URN'" ).append("\n"); 
		query.append("  										AND A.BKG_NO = B.BKG_NO" ).append("\n"); 
		query.append("  										AND A.CNTR_NO = CNTR.CNTR_NO" ).append("\n"); 
		query.append("									) AS URN_MAX_ACT_DT," ).append("\n"); 
		query.append("									(" ).append("\n"); 
		query.append("										SELECT TO_CHAR(MAX(ACT_DT),'YYYY-MM-DD hh24:mi')" ).append("\n"); 
		query.append("										FROM SCE_EDI_SND_RSLT A " ).append("\n"); 
		query.append("										WHERE EDI_STS_CD = 'OAN'" ).append("\n"); 
		query.append("  										AND A.BKG_NO = B.BKG_NO" ).append("\n"); 
		query.append("  										AND A.CNTR_NO = CNTR.CNTR_NO" ).append("\n"); 
		query.append("									) AS OAN_MAX_ACT_DT," ).append("\n"); 
		query.append("									(" ).append("\n"); 
		query.append("										SELECT TO_CHAR(MAX(ACT_DT),'YYYY-MM-DD hh24:mi')" ).append("\n"); 
		query.append("										FROM SCE_EDI_SND_RSLT A " ).append("\n"); 
		query.append("										WHERE EDI_STS_CD = 'D'" ).append("\n"); 
		query.append("  										AND A.BKG_NO = B.BKG_NO" ).append("\n"); 
		query.append("  										AND A.CNTR_NO = CNTR.CNTR_NO" ).append("\n"); 
		query.append("									) AS D_MAX_ACT_DT," ).append("\n"); 
		query.append("									NVL((" ).append("\n"); 
		query.append("										SELECT 'Y' " ).append("\n"); 
		query.append("          								FROM BKG_INET_BL_PRN_AUTH A" ).append("\n"); 
		query.append("          								WHERE BKG_NO = B.BKG_NO" ).append("\n"); 
		query.append("          								AND DELT_FLG ='N' " ).append("\n"); 
		query.append("          								AND N1ST_PRN_DT IS NOT NULL" ).append("\n"); 
		query.append("          								AND AUTH_DT = (SELECT MAX(AUTH_DT) FROM  BKG_INET_BL_PRN_AUTH WHERE BKG_NO = A.BKG_NO AND DELT_FLG ='N' AND N1ST_PRN_DT IS NOT NULL )  " ).append("\n"); 
		query.append("        							),'N') AS WEB_PRT" ).append("\n"); 
		query.append("									, D.FNL_DEST_NM" ).append("\n"); 
		query.append("                                    , H.OBL_ISS_OFC_CD" ).append("\n"); 
		query.append("                                    , (SELECT T2.VSL_CD||T2.SKD_VOY_NO||T2.SKD_DIR_CD" ).append("\n"); 
		query.append("                                          FROM (SELECT BKG_NO" ).append("\n"); 
		query.append("                                                      ,VSL_PRE_PST_CD" ).append("\n"); 
		query.append("                                                      ,LAG(VSL_SEQ, 1, 0) OVER (PARTITION BY BKG_NO ORDER BY VSL_PRE_PST_CD, VSL_SEQ) AS VSL_SEQ" ).append("\n"); 
		query.append("                                                  FROM BKG_VVD" ).append("\n"); 
		query.append("                                                 ) T1" ).append("\n"); 
		query.append("                                              ,BKG_VVD T2 " ).append("\n"); 
		query.append("                                         WHERE T1.VSL_PRE_PST_CD = 'T'" ).append("\n"); 
		query.append("                                           AND T1.BKG_NO = B.BKG_NO" ).append("\n"); 
		query.append("                                           AND T1.BKG_NO = T2.BKG_NO" ).append("\n"); 
		query.append("                                           AND 'S' = T2.VSL_PRE_PST_CD" ).append("\n"); 
		query.append("                                           AND T1.VSL_SEQ = T2.VSL_SEQ" ).append("\n"); 
		query.append("                                      ) AS PRE_VVD" ).append("\n"); 
		query.append("                                    , (SELECT T2.VSL_CD||T2.SKD_VOY_NO||T2.SKD_DIR_CD" ).append("\n"); 
		query.append("                                          FROM (SELECT BKG_NO" ).append("\n"); 
		query.append("                                                      ,VSL_PRE_PST_CD" ).append("\n"); 
		query.append("                                                      ,LEAD(VSL_SEQ, 1, 0) OVER (PARTITION BY BKG_NO ORDER BY VSL_PRE_PST_CD, VSL_SEQ) AS VSL_SEQ" ).append("\n"); 
		query.append("                                                  FROM BKG_VVD" ).append("\n"); 
		query.append("                                                 ) T1" ).append("\n"); 
		query.append("                                              ,BKG_VVD T2 " ).append("\n"); 
		query.append("                                         WHERE T1.VSL_PRE_PST_CD = 'T'" ).append("\n"); 
		query.append("                                           AND T1.BKG_NO = B.BKG_NO" ).append("\n"); 
		query.append("                                           AND T1.BKG_NO = T2.BKG_NO" ).append("\n"); 
		query.append("                                           AND 'U' = T2.VSL_PRE_PST_CD" ).append("\n"); 
		query.append("                                           AND T1.VSL_SEQ = T2.VSL_SEQ" ).append("\n"); 
		query.append("                                      ) AS POST_VVD" ).append("\n"); 
		query.append("" ).append("\n"); 
		query.append("" ).append("\n"); 
		query.append("                                     FROM BKG_BOOKING B, BKG_CONTAINER CNTR, MDM_COMMODITY K, BKG_BL_DOC D, BKG_RATE R," ).append("\n"); 
		query.append("                                          BKG_VVD E, VSK_VSL_PORT_SKD F, VSK_VSL_PORT_SKD G, BKG_BL_ISS H, MDM_REP_CMDT L, BKG_REF_DTL J," ).append("\n"); 
		query.append("                                          BKG_CUSTOMER C" ).append("\n"); 
		query.append("#if( ${gcust} != '')" ).append("\n"); 
		query.append("                                           /* GCUST*/" ).append("\n"); 
		query.append("                                         ,(  SELECT BKG_NO" ).append("\n"); 
		query.append("                                             FROM   BKG_BOOKING" ).append("\n"); 
		query.append("                                             WHERE  RFA_NO IN (  SELECT RFA_NO" ).append("\n"); 
		query.append("                                                                 FROM   PRI_RP_HDR" ).append("\n"); 
		query.append("                                                                 WHERE  PROP_NO IN (" ).append("\n"); 
		query.append("                                                                                      SELECT DISTINCT PROP_NO" ).append("\n"); 
		query.append("                                                                                      FROM   PRI_RP_MN" ).append("\n"); 
		query.append("                                                                                      WHERE  (CTRT_CUST_CNT_CD,CTRT_CUST_SEQ ) IN (  SELECT DISTINCT CUST_CNT_CD,CUST_SEQ " ).append("\n"); 
		query.append("                                                                                                                                     FROM   MDM_CUSTOMER" ).append("\n"); 
		query.append("                                                                                                                                     WHERE  CUST_GRP_ID = @[gcust]" ).append("\n"); 
		query.append("                                                                                                                                  )" ).append("\n"); 
		query.append("" ).append("\n"); 
		query.append("                                                                                      AND    PROP_STS_CD = 'A'" ).append("\n"); 
		query.append("                                                                                   )" ).append("\n"); 
		query.append("                                                              )" ).append("\n"); 
		query.append("                                             UNION" ).append("\n"); 
		query.append("                                             SELECT BKG_NO" ).append("\n"); 
		query.append("                                             FROM   BKG_BOOKING" ).append("\n"); 
		query.append("                                             WHERE  TAA_NO IN (  SELECT TAA_NO" ).append("\n"); 
		query.append("                                                                 FROM   PRI_TAA_HDR" ).append("\n"); 
		query.append("                                                                 WHERE  TAA_PROP_NO IN (" ).append("\n"); 
		query.append("                                                                                          SELECT DISTINCT TAA_PROP_NO" ).append("\n"); 
		query.append("                                                                                          FROM   PRI_TAA_MN" ).append("\n"); 
		query.append("                                                                                          WHERE  (CTRT_CUST_CNT_CD,CTRT_CUST_SEQ ) IN (  SELECT DISTINCT CUST_CNT_CD,CUST_SEQ " ).append("\n"); 
		query.append("                                                                                                                                         FROM   MDM_CUSTOMER" ).append("\n"); 
		query.append("                                                                                                                                         WHERE  CUST_GRP_ID = @[gcust]" ).append("\n"); 
		query.append("                                                                                                                                      )" ).append("\n"); 
		query.append("                                                                                          AND    CFM_FLG = 'Y'" ).append("\n"); 
		query.append("                                                                                       )" ).append("\n"); 
		query.append("                                                              )" ).append("\n"); 
		query.append("                                             UNION" ).append("\n"); 
		query.append("                                             SELECT BKG_NO" ).append("\n"); 
		query.append("                                             FROM   BKG_BOOKING" ).append("\n"); 
		query.append("                                             WHERE  SC_NO IN (  SELECT SC_NO" ).append("\n"); 
		query.append("                                                                FROM   PRI_SP_HDR" ).append("\n"); 
		query.append("                                                                WHERE  PROP_NO IN (" ).append("\n"); 
		query.append("                                                                                     SELECT DISTINCT PROP_NO" ).append("\n"); 
		query.append("                                                                                     FROM   PRI_SP_MN" ).append("\n"); 
		query.append("                                                                                     WHERE  PROP_NO IN (" ).append("\n"); 
		query.append("                                                                                                          SELECT DISTINCT PROP_NO" ).append("\n"); 
		query.append("                                                                                                          FROM   PRI_SP_CTRT_PTY" ).append("\n"); 
		query.append("                                                                                                          WHERE  (CUST_CNT_CD,CUST_SEQ ) IN (  SELECT DISTINCT CUST_CNT_CD,CUST_SEQ " ).append("\n"); 
		query.append("                                                                                                                                                 FROM   MDM_CUSTOMER" ).append("\n"); 
		query.append("                                                                                                                                                WHERE  CUST_GRP_ID = @[gcust]" ).append("\n"); 
		query.append("                                                                                                                                                      )" ).append("\n"); 
		query.append("                                                                                                          AND    PRC_CTRT_PTY_TP_CD = 'C'" ).append("\n"); 
		query.append("                                                                                                       )" ).append("\n"); 
		query.append("                                                                                     AND PROP_STS_CD = 'F'" ).append("\n"); 
		query.append("                                                                                  )" ).append("\n"); 
		query.append("                                                             )" ).append("\n"); 
		query.append("                                           ) GRP_CUST" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("" ).append("\n"); 
		query.append("                                     WHERE B.BKG_STS_CD <>'X'" ).append("\n"); 
		query.append("                                       AND B.BKG_CGO_TP_CD <>'P'" ).append("\n"); 
		query.append("                                       AND B.BKG_NO = CNTR.BKG_NO" ).append("\n"); 
		query.append("#if( ${gcust} != '')" ).append("\n"); 
		query.append("                                       AND B.BKG_NO = GRP_CUST.BKG_NO" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("" ).append("\n"); 
		query.append("                                       AND B.BKG_NO = D.BKG_NO" ).append("\n"); 
		query.append("                                       AND B.BKG_NO = R.BKG_NO" ).append("\n"); 
		query.append("                                       AND B.BKG_NO = E.BKG_NO" ).append("\n"); 
		query.append("                                       AND B.BKG_NO = C.BKG_NO" ).append("\n"); 
		query.append("                                       AND B.BKG_NO = H.BKG_NO(+)" ).append("\n"); 
		query.append("                                       AND B.BKG_NO = J.BKG_NO(+)" ).append("\n"); 
		query.append("                                       AND B.CMDT_CD = K.CMDT_CD" ).append("\n"); 
		query.append("                                       AND B.REP_CMDT_CD = L.REP_CMDT_CD" ).append("\n"); 
		query.append("                                       AND C.BKG_CUST_TP_CD IN ('S','C','E','N','F')" ).append("\n"); 
		query.append("                                       AND F.VSL_CD(+) = E.VSL_CD" ).append("\n"); 
		query.append("                                       AND F.SKD_VOY_NO(+) = E.SKD_VOY_NO" ).append("\n"); 
		query.append("                                       AND F.SKD_DIR_CD(+) = E.SKD_DIR_CD" ).append("\n"); 
		query.append("                                       AND G.VSL_CD(+) = E.VSL_CD" ).append("\n"); 
		query.append("                                       AND G.SKD_VOY_NO(+) = E.SKD_VOY_NO" ).append("\n"); 
		query.append("                                       AND G.SKD_DIR_CD(+) = E.SKD_DIR_CD" ).append("\n"); 
		query.append("                                           " ).append("\n"); 
		query.append("                                       /* I/B O/B VPS_ETD_DT*/" ).append("\n"); 
		query.append("			                	       #if( ${in_out_cd} == 'IN')" ).append("\n"); 
		query.append("			                	         /* I/B VPS_ETD_DT*/" ).append("\n"); 
		query.append("				                         #if( ${vps_eta_dt} != '')" ).append("\n"); 
		query.append("										 AND B.POD_CD = E.POD_CD" ).append("\n"); 
		query.append("										 AND G.VPS_PORT_CD(+) = E.POD_CD  " ).append("\n"); 
		query.append("			                	         AND G.CLPT_IND_SEQ(+) = E.POD_CLPT_IND_SEQ " ).append("\n"); 
		query.append("   				                         AND G.VPS_ETA_DT >= TO_DATE(@[vps_eta_dt],'YYYY-MM-DD')" ).append("\n"); 
		query.append("				                		 #end" ).append("\n"); 
		query.append("					                	 #if( ${vps_etd_dt} != '')" ).append("\n"); 
		query.append("				                         AND G.VPS_ETA_DT <= TO_DATE(@[vps_etd_dt],'YYYY-MM-DD') +0.99999" ).append("\n"); 
		query.append("					                	 #end" ).append("\n"); 
		query.append("                                       #else" ).append("\n"); 
		query.append("                                         /* O/B VPS_ETD_DT*/" ).append("\n"); 
		query.append("				                         #if( ${vps_eta_dt} != '')" ).append("\n"); 
		query.append("										 AND B.POL_CD = E.POL_CD" ).append("\n"); 
		query.append("										 AND F.VPS_PORT_CD(+) = E.POL_CD  " ).append("\n"); 
		query.append("			                	         AND F.CLPT_IND_SEQ(+) = E.POL_CLPT_IND_SEQ " ).append("\n"); 
		query.append("   				                         AND F.VPS_ETD_DT >= TO_DATE(@[vps_eta_dt],'YYYY-MM-DD')" ).append("\n"); 
		query.append("					                     #end" ).append("\n"); 
		query.append("						                 #if( ${vps_etd_dt} != '')" ).append("\n"); 
		query.append("				                         AND F.VPS_ETD_DT <= TO_DATE(@[vps_etd_dt],'YYYY-MM-DD') +0.99999" ).append("\n"); 
		query.append("						                 #end" ).append("\n"); 
		query.append("                                       #end" ).append("\n"); 
		query.append("" ).append("\n"); 
		query.append("" ).append("\n"); 
		query.append("" ).append("\n"); 
		query.append("                                                                  " ).append("\n"); 
		query.append("                                       /* VVD_CD CRWI0142E AEF58888*/" ).append("\n"); 
		query.append("				                       #if( ${vvd_cd} != '')" ).append("\n"); 
		query.append("                                       AND B.VSL_CD     = SUBSTR(@[vvd_cd], 1, 4)" ).append("\n"); 
		query.append("                                       AND B.SKD_VOY_NO = SUBSTR(@[vvd_cd], 5, 4)" ).append("\n"); 
		query.append("                                       AND B.SKD_DIR_CD = SUBSTR(@[vvd_cd], 9, 1)       " ).append("\n"); 
		query.append("				                       #end" ).append("\n"); 
		query.append("                                                         " ).append("\n"); 
		query.append("                                         " ).append("\n"); 
		query.append("                                       /* POL_CD*/" ).append("\n"); 
		query.append("                				       #if( ${pol_cd} != '')" ).append("\n"); 
		query.append("                                       AND B.POL_CD =@[pol_cd]" ).append("\n"); 
		query.append("				                       #end" ).append("\n"); 
		query.append("                                       " ).append("\n"); 
		query.append("                                       /* POL_YARD_CD */" ).append("\n"); 
		query.append("                				       #if( ${pol_yard_cd} != '')" ).append("\n"); 
		query.append("                                       AND SUBSTR(B.POL_NOD_CD, -2) = @[pol_yard_cd]" ).append("\n"); 
		query.append("                				       #end" ).append("\n"); 
		query.append("                                        " ).append("\n"); 
		query.append("                                       /* POD_CD*/" ).append("\n"); 
		query.append("				                       #if( ${pod_cd} != '')" ).append("\n"); 
		query.append("                                       AND B.POD_CD = @[pod_cd]" ).append("\n"); 
		query.append("                				       #end" ).append("\n"); 
		query.append("                                                       " ).append("\n"); 
		query.append("                                       /* POD_YARD_CD */" ).append("\n"); 
		query.append("                				       #if( ${pod_yard_cd} != '')" ).append("\n"); 
		query.append("                                       AND SUBSTR(B.POD_NOD_CD, -2) = @[pod_yard_cd]" ).append("\n"); 
		query.append("                				       #end" ).append("\n"); 
		query.append("                                        " ).append("\n"); 
		query.append("                                       /* POR_CD*/" ).append("\n"); 
		query.append("                				       #if( ${por_cd} != '')" ).append("\n"); 
		query.append("                                       AND B.POR_CD = @[por_cd]" ).append("\n"); 
		query.append("                                       #end" ).append("\n"); 
		query.append("" ).append("\n"); 
		query.append("                                       /* DEL_CD*/" ).append("\n"); 
		query.append("				                       #if( ${del_cd} != '')" ).append("\n"); 
		query.append("                                       AND B.DEL_CD = @[del_cd]" ).append("\n"); 
		query.append("                				       #end" ).append("\n"); 
		query.append("                                       " ).append("\n"); 
		query.append("                                       #if( ${sc_no} != '' || ${rfa_no} != '' || ${taa_no} != '' )" ).append("\n"); 
		query.append("                                       AND (     1 = 0" ).append("\n"); 
		query.append("                                             /* SC_NO*/" ).append("\n"); 
		query.append("                                             #if( ${sc_no} != '')" ).append("\n"); 
		query.append("                                             OR  B.SC_NO = @[sc_no]" ).append("\n"); 
		query.append("                                             #end" ).append("\n"); 
		query.append("                                               " ).append("\n"); 
		query.append("                                             /* RFA_NO*/" ).append("\n"); 
		query.append("                                             #if( ${rfa_no} != '')" ).append("\n"); 
		query.append("                                             OR  B.RFA_NO = @[rfa_no]" ).append("\n"); 
		query.append("                                             #end" ).append("\n"); 
		query.append("                                               " ).append("\n"); 
		query.append("                                             /* TAA_NO*/" ).append("\n"); 
		query.append("                                             #if( ${taa_no} != '')" ).append("\n"); 
		query.append("                                             OR  B.TAA_NO = @[taa_no]" ).append("\n"); 
		query.append("                                             #end" ).append("\n"); 
		query.append("                                       " ).append("\n"); 
		query.append("                                           )" ).append("\n"); 
		query.append("                                       #end" ).append("\n"); 
		query.append("" ).append("\n"); 
		query.append("       " ).append("\n"); 
		query.append("                                       /* CUST_TP_CD*/" ).append("\n"); 
		query.append("                				       #if( ${cust_tp_cd} != '')" ).append("\n"); 
		query.append("                				       AND C.BKG_CUST_TP_CD IN (${cust_tp_cd})" ).append("\n"); 
		query.append("				                       #end" ).append("\n"); 
		query.append("" ).append("\n"); 
		query.append("				                       /* CUST_CNT_CD */" ).append("\n"); 
		query.append("				                       #if( ${cust_cnt_cd} != '')" ).append("\n"); 
		query.append("                                       AND C.CUST_CNT_CD = @[cust_cnt_cd]" ).append("\n"); 
		query.append("				                       #end" ).append("\n"); 
		query.append("" ).append("\n"); 
		query.append("                                       /* CUST_SEQ */" ).append("\n"); 
		query.append("				                       #if( ${cust_seq} != '')" ).append("\n"); 
		query.append("                                       AND C.CUST_SEQ = @[cust_seq]" ).append("\n"); 
		query.append("				                       #end" ).append("\n"); 
		query.append("" ).append("\n"); 
		query.append("                                       /* CUST_NM */" ).append("\n"); 
		query.append("				                       #if( ${cust_nm} != '')" ).append("\n"); 
		query.append("                                       AND C.CUST_NM LIKE '%'||@[cust_nm]||'%'" ).append("\n"); 
		query.append("				                       #end" ).append("\n"); 
		query.append("" ).append("\n"); 
		query.append("				                       /* EDI ID */" ).append("\n"); 
		query.append("				                       #if( ${edi_id} != '')" ).append("\n"); 
		query.append("										AND EXISTS ( SELECT 'Y'" ).append("\n"); 
		query.append("                                                 FROM EDI_GROUP AA, EDI_GRP_CUST BB" ).append("\n"); 
		query.append("                                                WHERE AA.EDI_GRP_CD = BB.EDI_GRP_CD" ).append("\n"); 
		query.append("                                                  AND AA.DELT_FLG ='N'" ).append("\n"); 
		query.append("                                                  AND AA.EDI_GRP_CD = @[edi_id]" ).append("\n"); 
		query.append("                                                  AND AA.CO_DIV_CD = BB.CO_DIV_CD" ).append("\n"); 
		query.append("                                                  AND AA.CO_DIV_CD ='COM'" ).append("\n"); 
		query.append("                                                  AND ( DECODE(BB.BKG_CTRT_DIV_CD,'1',SC_NO)  IN (B.SC_NO,B.RFA_NO)" ).append("\n"); 
		query.append("                                                        OR DECODE(BB.BKG_CTRT_DIV_CD,'1',NULL,BB.CUST_CNT_CD||BB.CUST_SEQ )  = C.CUST_CNT_CD||C.CUST_SEQ " ).append("\n"); 
		query.append("                                                      )" ).append("\n"); 
		query.append("                                                  )" ).append("\n"); 
		query.append("				                       #end" ).append("\n"); 
		query.append("                                       " ).append("\n"); 
		query.append("                                       /* A/Customer */" ).append("\n"); 
		query.append("				                       #if( ${agmt_act_cnt_cd} != '' )" ).append("\n"); 
		query.append("                                        AND B.AGMT_ACT_CNT_CD = @[agmt_act_cnt_cd]" ).append("\n"); 
		query.append("                                       #end" ).append("\n"); 
		query.append("                                       #if( ${agmt_act_cust_seq} != '' )" ).append("\n"); 
		query.append("                                        AND B.AGMT_ACT_CUST_SEQ = TO_NUMBER(@[agmt_act_cust_seq])" ).append("\n"); 
		query.append("                                       #end" ).append("\n"); 
		query.append("                                    " ).append("\n"); 
		query.append("                                   GROUP BY   B.BKG_NO," ).append("\n"); 
		query.append("                                    CNTR.CNTR_NO,    " ).append("\n"); 
		query.append("                                    B.BKG_OFC_CD," ).append("\n"); 
		query.append("                                    B.BL_NO," ).append("\n"); 
		query.append("                                    B.VSL_CD ," ).append("\n"); 
		query.append("                                    B.SKD_VOY_NO ," ).append("\n"); 
		query.append("                                    B.SKD_DIR_CD ," ).append("\n"); 
		query.append("                                    B.VSL_CD||B.SKD_VOY_NO||B.SKD_DIR_CD," ).append("\n"); 
		query.append("                                    B.POR_CD," ).append("\n"); 
		query.append("                                    B.POL_CD," ).append("\n"); 
		query.append("                                    B.POD_CD," ).append("\n"); 
		query.append("                                    B.DEL_CD," ).append("\n"); 
		query.append("                                    B.XTER_RMK," ).append("\n"); 
		query.append("                                    B.PRE_RLY_PORT_CD," ).append("\n"); 
		query.append("                                    B.PST_RLY_PORT_CD," ).append("\n"); 
		query.append("                                    B.CMDT_CD," ).append("\n"); 
		query.append("                                    D.PCK_QTY," ).append("\n"); 
		query.append("                                    D.PCK_TP_CD,    " ).append("\n"); 
		query.append("                                    B.REP_CMDT_CD," ).append("\n"); 
		query.append("                                    L.REP_CMDT_NM, " ).append("\n"); 
		query.append("                                    D.ACT_WGT,   " ).append("\n"); 
		query.append("                                    D.MEAS_QTY,  " ).append("\n"); 
		query.append("                                    B.RCV_TERM_CD," ).append("\n"); 
		query.append("                                    B.DE_TERM_CD," ).append("\n"); 
		query.append("                                    B.SLAN_CD," ).append("\n"); 
		query.append("                                    B.SCAC_CD," ).append("\n"); 
		query.append("                                    H.OBL_ISS_OFC_CD, " ).append("\n"); 
		query.append("                                    H.OBL_ISS_DT," ).append("\n"); 
		query.append("                                    D.BL_OBRD_DT," ).append("\n"); 
		query.append("									B.SVC_SCP_CD," ).append("\n"); 
		query.append("                                    D.VSL_NM," ).append("\n"); 
		query.append("                                    D.POR_NM," ).append("\n"); 
		query.append("                                    D.POL_NM," ).append("\n"); 
		query.append("                                    D.POD_NM," ).append("\n"); 
		query.append("                                    D.DEL_NM," ).append("\n"); 
		query.append("                                    B.SC_NO," ).append("\n"); 
		query.append("                                    R.PPD_RCV_OFC_CD,  " ).append("\n"); 
		query.append("                                    R.CLT_OFC_CD," ).append("\n"); 
		query.append("                                    D.CSTMS_DESC," ).append("\n"); 
		query.append("                                    B.USA_CSTMS_FILE_CD," ).append("\n"); 
		query.append("                                    B.CND_CSTMS_FILE_CD,  " ).append("\n"); 
		query.append("                                    CNTR.CNTR_WGT," ).append("\n"); 
		query.append("                                    CNTR.WGT_UT_CD," ).append("\n"); 
		query.append("                                    CNTR.MEAS_QTY," ).append("\n"); 
		query.append("                                    CNTR.MEAS_UT_CD," ).append("\n"); 
		query.append("                                    CNTR.CNTR_TPSZ_CD," ).append("\n"); 
		query.append("                                    CNTR.CNTR_VOL_QTY," ).append("\n"); 
		query.append("                                    CNTR.DCGO_FLG," ).append("\n"); 
		query.append("                                    CNTR.BB_CGO_FLG," ).append("\n"); 
		query.append("                                    CNTR.AWK_CGO_FLG," ).append("\n"); 
		query.append("                                    CNTR.RC_FLG," ).append("\n"); 
		query.append("                                    CNTR.RD_CGO_FLG," ).append("\n"); 
		query.append("                                    CNTR.SOC_FLG," ).append("\n"); 
		query.append("                                    CNTR.PCK_QTY," ).append("\n"); 
		query.append("                                    CNTR.PCK_TP_CD," ).append("\n"); 
		query.append("                                    CNTR.CNTR_PRT_FLG," ).append("\n"); 
		query.append("                                    CNTR.PO_NO," ).append("\n"); 
		query.append("                                    J.DE_NO," ).append("\n"); 
		query.append("                                    J.PRT_NO," ).append("\n"); 
		query.append("                                    D.BDR_FLG," ).append("\n"); 
		query.append("                                    B.POR_CD," ).append("\n"); 
		query.append("                                    B.DEL_CD," ).append("\n"); 
		query.append("                                    R.CGO_RCV_DT," ).append("\n"); 
		query.append("                                    B.AGMT_ACT_CNT_CD," ).append("\n"); 
		query.append("                                    B.AGMT_ACT_CUST_SEQ," ).append("\n"); 
		query.append("									CNTR.BKG_NO, D.MEAS_QTY, D.MEAS_UT_CD, D.WGT_UT_CD, B.RFA_NO" ).append("\n"); 
		query.append("									,D.FNL_DEST_NM" ).append("\n"); 
		query.append("                            ) X" ).append("\n"); 
		query.append("                    WHERE 1=1" ).append("\n"); 
		query.append("                    /* EQ Office*/ " ).append("\n"); 
		query.append("                    #if( ${eq_ofc_cd} != '')" ).append("\n"); 
		query.append("                    AND X.EQ_CTRL_OFC = @[eq_ofc_cd]" ).append("\n"); 
		query.append("                    #end" ).append("\n"); 
		query.append("                    " ).append("\n"); 
		query.append("                    #if (${sp_cargo_rf} != '' || ${sp_cargo_dg} != '' || ${sp_cargo_ak} != '' || ${sp_cargo_bb} != '' )" ).append("\n"); 
		query.append("					AND X.SPC_CGO IN (@[sp_cargo_rf], @[sp_cargo_dg], @[sp_cargo_ak], @[sp_cargo_bb])					" ).append("\n"); 
		query.append("				    #end" ).append("\n"); 
		query.append(" " ).append("\n"); 
		query.append("" ).append("\n"); 
		query.append("                  ) Y" ).append("\n"); 
		query.append("ORDER BY BKG_NO" ).append("\n"); 
		query.append("       ) Z" ).append("\n"); 
		query.append(") XX" ).append("\n"); 
		query.append(") YY" ).append("\n"); 
		query.append("WHERE RNUM BETWEEN NVL(@[rows_per_page],50) * (NVL(@[curr_page],1) - 1) + 1" ).append("\n"); 
		query.append("           AND     NVL(@[rows_per_page],50) *  NVL(@[curr_page],1)" ).append("\n"); 

	}
}