<?xml version="1.0" encoding="UTF-8"?>
<sqls>
	<querys>
		<query name="CommonDBDAOSearchSaqMonthlyQuotaCurrentReleaseYearMonthRSQL">
			<desc><![CDATA[연간 Multi account 생성 가능 여부 확인]]></desc>
			<sql><![CDATA[
SELECT
  CASE WHEN YR_MON ='Q' THEN
  	TO_CHAR(SYSDATE,'YYYY')||RPAD(DECODE(MOD(TO_CHAR(TO_DATE(SYSDATE),'Q')+1,4),0,4,MOD(TO_CHAR(TO_DATE(SYSDATE),'Q')+1,4)),2,'Q') 	--데이터 존재하지 않을 경우 현재 Quarter+1 셋팅
  ELSE
  	YR_MON
  END CODE_CD,
  CASE WHEN YR_MON ='Q' THEN
  	TO_CHAR(SYSDATE,'YYYY')||RPAD(DECODE(MOD(TO_CHAR(TO_DATE(SYSDATE),'Q')+1,4),0,4,MOD(TO_CHAR(TO_DATE(SYSDATE),'Q')+1,4)),2,'Q')
  ELSE
  	YR_MON
  END CODE_NM
FROM
  (
      SELECT
         DECODE(MON,'4',TO_NUMBER(YR)+1||'1Q',YR||TO_NUMBER(MON)+1)||'Q' YR_MON
      FROM
      (

          SELECT
             SUBSTR(MAX(BSE_YR||SUBSTR(BSE_QTR_CD,1,1)),1,4) YR,
             SUBSTR(MAX(BSE_YR||SUBSTR(BSE_QTR_CD,1,1)),5,2) MON
          FROM  SAQ_MON_QTA_RLSE
          WHERE QTA_RLSE_STS_CD = 'R'

      )
  )
			]]></sql>
			<params>
			</params>
		</query>
	</querys>
</sqls>
