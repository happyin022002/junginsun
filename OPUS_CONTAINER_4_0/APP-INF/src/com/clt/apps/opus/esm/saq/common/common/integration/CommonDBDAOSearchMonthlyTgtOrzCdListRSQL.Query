<?xml version="1.0" encoding="UTF-8"?>
<sqls>
	<querys>
		<query name="CommonDBDAOSearchMonthlyTgtOrzCdListRSQL">
			<desc><![CDATA[]]></desc>
			<sql><![CDATA[
SELECT  CODE  
         , @[stageText] || '|' || INTG_CD_VAL_DP_DESC ||  '|' || GDT AS TEXT 
FROM (   
 	SELECT  DAT_CRE_STEP_CD || '-' || TGT_ORZ_CD AS CODE  
         ,A.TGT_ORZ_CD || A.DAT_CRE_STEP_CD AS JOIN_CODE  
         , MAX(TO_CHAR(GLOBALDATE_PKG.TIME_CONV_OFC_FNC('GMT', SMRY_CRE_GDT, @[tgt_ofc_cd1] ), 'YYYY-MM-DD HH24:MI')) AS GDT 
 	FROM SAQ_MON_QTA_ADJ_SMRY_HDR A   
 	WHERE  A.SAQ_TGT_GRP_CD LIKE @[targetGrp] || '%'  
        AND A.TGT_ORZ_CD = @[tgt_orz_cd]  
        AND A.BSE_YR = @[year]  
        AND A.BSE_QTR_CD = @[bse_qtr_cd]  
#if (${qta_mst_ver_no} != '')
        AND A.QTA_MST_VER_NO = @[qta_mst_ver_no]  
#end  
		#if (${stage} == 'SQ' )
			AND DAT_CRE_STEP_CD < '08' 	
		#else
			AND DAT_CRE_STEP_CD = '08' 	
		#end				
        AND ( A.TGT_OFC_CD='000000' OR A.TGT_OFC_CD=@[tgt_ofc_cd1] OR A.TGT_OFC_CD=@[tgt_ofc_cd2]  OR DECODE(@[tgt_orz_cd],'B',1,0) =1 )   
 	GROUP BY  DAT_CRE_STEP_CD || '-' || TGT_ORZ_CD	,A.TGT_ORZ_CD || A.DAT_CRE_STEP_CD 			  
)  HDR 
,COM_INTG_CD_DTL COM  				
WHERE   COM.INTG_CD_ID = 'CD01322' AND COM.INTG_CD_VAL_CTNT = JOIN_CODE 
ORDER BY CODE			]]></sql>
			<params>
				<param name="stageText" type="12" value="" out="N"/>
				<param name="tgt_ofc_cd1" type="12" value="" out="N"/>
				<param name="targetGrp" type="12" value="" out="N"/>
				<param name="tgt_orz_cd" type="12" value="" out="N"/>
				<param name="year" type="12" value="" out="N"/>
				<param name="bse_qtr_cd" type="12" value="" out="N"/>
				<param name="qta_mst_ver_no" type="12" value="" out="N"/>
				<param name="tgt_ofc_cd2" type="12" value="" out="N"/>
			</params>
		</query>
	</querys>
</sqls>
