<?xml version="1.0" encoding="UTF-8"?>
<sqls>
	<querys>
		<query name="UsaInbondTransmissionDBDAOmodifyClearanceTypebyScUSQL">
			<desc><![CDATA[modifyClearanceTypebySc]]></desc>
			<sql><![CDATA[
MERGE INTO BKG_CSTMS_ADV_CLR_TP CT
USING ( 
    SELECT SUBSTR(@[cust_cd],1,2) AS CUST_CNT_CD, 
           SUBSTR(@[cust_cd],3)   AS CUST_SEQ,  
                        @[pod_cd] AS POD_CD,  
                        @[del_cd] AS DEL_CD
    FROM DUAL 
) TM
ON ( 
	CT.CUST_CNT_CD = TM.CUST_CNT_CD AND 
    CT.CUST_SEQ    = TM.CUST_SEQ    AND 
    CT.POD_CD      = TM.POD_CD      AND 
    CT.DEL_CD      = TM.DEL_CD
)
WHEN MATCHED THEN
        UPDATE     
        SET 	 SC_NO           = @[sc_no]
		,        CMDT_CD 		 = @[cmdt_cd]
        ,        CSTMS_CLR_TP_CD = @[etr_tp]
        ,        FREE_TRD_ZN_FLG = @[ftz_flg]
        ,        CNTR_TP_CD      = @[cntr_tp_cd]
        ,        DELT_FLG        = @[delt_flg]
		#if (${delt_flg} == 'Y')
        ,        DELT_USR_ID     = @[delt_usr_id]
        ,        DELT_DT         = TO_DATE(@[delt_dt],'YYYYMMDDHH24MISS')
		#end
		,        UPD_OFC_CD      = @[upd_ofc_cd]
        ,        UPD_USR_ID      = @[upd_usr_id]
        ,        UPD_DT          = TO_DATE(@[upd_dt],'YYYYMMDDHH24MISS')
        ,        HUB_LOC_CD      = @[hub_loc_cd]
        ,        IBD_TRSP_TP_CD  = @[it_tp]
		,        CSTMS_LOC_CD    = @[cstms_loc_cd]
WHEN NOT MATCHED THEN
        INSERT ( CUST_CNT_CD
        		,CUST_SEQ
        		,POD_CD
        		,DEL_CD
				,CLR_TP_SEQ
        		,CMDT_CD
        		,SC_NO
        		,CSTMS_CLR_TP_CD
        		,FREE_TRD_ZN_FLG
        		,CNTR_TP_CD
        		,DELT_FLG
				,CRE_OFC_CD
        		,CRE_USR_ID
        		,CRE_DT
				,UPD_OFC_CD
        		,UPD_USR_ID
        		,UPD_DT 
        		,HUB_LOC_CD
				,IBD_TRSP_TP_CD
				,CSTMS_LOC_CD
		)
		VALUES ( SUBSTR(@[cust_cd],1,2)
        		,SUBSTR(@[cust_cd],3)
        		,@[pod_cd]
        		,@[del_cd]
				,NVL((SELECT /*+ index_desc(A XPKBKG_CSTMS_ADV_CLR_TP)  */   
						     CLR_TP_SEQ
 					  FROM   BKG_CSTMS_ADV_CLR_TP A
					  WHERE  1=1
					  AND	 CUST_CNT_CD  = SUBSTR(@[cust_cd],1,2)  
					  AND    CUST_SEQ     = SUBSTR(@[cust_cd],3)
					  AND    POD_CD 	  = @[pod_cd] 
					  AND    DEL_CD 	  = @[del_cd] 
					  AND    ROWNUM 	  = 1   
				),0)+1
        		,@[cmdt_cd]
        		,@[sc_no]
        		,@[etr_tp]
        		,NVL(@[ftz_flg],'N')
        		,@[cntr_tp_cd]
        		,@[delt_flg]
        		,@[cre_ofc_cd]
        		,@[cre_usr_id]
        		,TO_DATE(@[cre_dt],'YYYYMMDDHH24MISS')
        		,@[upd_ofc_cd]
        		,@[upd_usr_id]
        		,TO_DATE(@[upd_dt],'YYYYMMDDHH24MISS') 
        		,@[hub_loc_cd]
				,@[it_tp]
        		,@[cstms_loc_cd]
		)			]]></sql>
			<params>
				<param name="cust_cd" type="12" value="" out="N"/>
				<param name="pod_cd" type="12" value="" out="N"/>
				<param name="del_cd" type="12" value="" out="N"/>
				<param name="sc_no" type="12" value="" out="N"/>
				<param name="cmdt_cd" type="12" value="" out="N"/>
				<param name="etr_tp" type="12" value="" out="N"/>
				<param name="ftz_flg" type="12" value="" out="N"/>
				<param name="cntr_tp_cd" type="12" value="" out="N"/>
				<param name="delt_flg" type="12" value="" out="N"/>
				<param name="delt_usr_id" type="12" value="" out="N"/>
				<param name="delt_dt" type="12" value="" out="N"/>
				<param name="upd_ofc_cd" type="12" value="" out="N"/>
				<param name="upd_usr_id" type="12" value="" out="N"/>
				<param name="upd_dt" type="12" value="" out="N"/>
				<param name="hub_loc_cd" type="12" value="" out="N"/>
				<param name="it_tp" type="12" value="" out="N"/>
				<param name="cstms_loc_cd" type="12" value="" out="N"/>
				<param name="cre_ofc_cd" type="12" value="" out="N"/>
				<param name="cre_usr_id" type="12" value="" out="N"/>
				<param name="cre_dt" type="12" value="" out="N"/>
			</params>
		</query>
	</querys>
</sqls>
