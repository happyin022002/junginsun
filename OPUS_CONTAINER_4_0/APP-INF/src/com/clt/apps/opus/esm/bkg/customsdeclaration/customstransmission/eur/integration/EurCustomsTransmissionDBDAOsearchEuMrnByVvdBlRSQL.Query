<?xml version="1.0" encoding="UTF-8"?>
<sqls>
	<querys>
		<query name="EurCustomsTransmissionDBDAOsearchEuMrnByVvdBlRSQL">
			<desc><![CDATA[1. 2011.01.11 이수진 [CHM-201007774] EUR 24HR 관련 구주 세관 시스템 MRN 정보 추가 요청
   : EU MRN 정보를 조회한다.

2. 2011.01.31 이수진 [CHM-201007774] EUR 24HR 관련 구주 세관 시스템 MRN 정보 추가 요청
   : EU MRN 정보에 EU MRN DATE 정보 추가]]></desc>
			<sql><![CDATA[
SELECT ROWNUM EU_MRN_NO, XX.*
FROM ( SELECT EU_MRN_VALUE, MAX(EU_PORT) AS EU_PORT, MAX(EU_MRN_DATE) AS EU_MRN_DATE, EU_MRN_SOURCE
         FROM (
                SELECT BL.MVMT_REF_NO EU_MRN_VALUE, BL.CSTMS_PORT_CD EU_PORT, TO_CHAR(SND.SND_DT,'YYYYMMDDHH24MI') EU_MRN_DATE, 'ENS' AS EU_MRN_SOURCE
                  FROM BKG_CSTMS_EUR_BL BL
                     , BKG_CSTMS_ADV_EUR_SND SND
                 WHERE BL.MSG_SND_NO = SND.MSG_SND_NO(+)
                   AND BL.BL_NO = @[bl_no]
                   
                UNION ALL

                SELECT BL.MVMT_REF_NO EU_MRN_VALUE, BL.CSTMS_PORT_CD EU_PORT, TO_CHAR(SND.SND_DT,'YYYYMMDDHH24MI') EU_MRN_DATE, 'EXS' AS EU_MRN_SOURCE
                  FROM BKG_CSTMS_EUR_IO_BL BL
                     , BKG_CSTMS_EUR_IO_SND SND
                 WHERE BL.MSG_SND_NO = SND.MSG_SND_NO(+)
                   AND BL.BL_NO = @[bl_no]
              ) 
        GROUP BY EU_MRN_VALUE, EU_MRN_SOURCE
        ORDER BY EU_MRN_DATE
     ) XX			]]></sql>
			<params>
				<param name="bl_no" type="12" value="" out="N"/>
			</params>
		</query>
	</querys>
</sqls>
