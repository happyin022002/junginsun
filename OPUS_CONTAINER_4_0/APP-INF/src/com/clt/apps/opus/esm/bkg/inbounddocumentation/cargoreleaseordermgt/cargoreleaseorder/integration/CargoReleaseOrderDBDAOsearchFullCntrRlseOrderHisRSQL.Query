<?xml version="1.0" encoding="UTF-8"?>
<sqls>
	<querys>
		<query name="CargoReleaseOrderDBDAOsearchFullCntrRlseOrderHisRSQL">
			<desc><![CDATA[searchFullCntrRlseOrderHis]]></desc>
			<sql><![CDATA[
SELECT BL_NO, BKG_NO, CNTR_NO, CNTR_TP_SZ_CD, CUST_NM, YD_CD, VVD, POL_CD, POD_CD,
       DO_NO, DO_ISS_DT, TRSP_MOD, PKUP_DT, CXL_FLG, DE_TERM_CD, RMK, OFC_CD, USR_NM, 
       RLSE_DT, MZD , CO_BDG_ID, CGO_CRR_ID, RLSE_EXP_DT, PIN_NO, VEH_RGST_ID, ROAD_HLG_ID, UQ_VSL_ID_NO,
       CNTR_SLT_NO, CSTMS_VOY_NO, MTY_RTN_YD_CD
  FROM (
         SELECT BKG.BL_NO                                            BL_NO
	     , BKG.BKG_NO                                           BKG_NO
	     , BORD.CNTR_NO                                         CNTR_NO
	     , BCNTR.CNTR_TPSZ_CD                                   CNTR_TP_SZ_CD
	     , REPLACE(BORD.CUST_NM, CHR(10), ' ')                  CUST_NM
	     , BORD.YD_CD                                           YD_CD
	     , BVVD.VSL_CD||BVVD.SKD_VOY_NO || BVVD.SKD_DIR_CD      VVD
	     , BKG.POL_CD                                           POL_CD
	     , BORD.POD_CD                                          POD_CD
	     , BORD.DO_NO ||BORD.DO_NO_SPLIT                        DO_NO
	     , TO_CHAR(BORD.DO_ISS_DT, 'YYYY-MM-DD HH:MI')          DO_ISS_DT
--	     , DECODE(BORD.BKG_TRSP_MOD_CD,'B','Barge'
--	                                  ,'F','Feeder'
--	                                  ,'R','Rail'
--	                                  ,'T','Truck'
--	                                  ,'' )                     TRSP_MOD	--TPJT_INBOUND
         , TMCD.INTG_CD_VAL_DP_DESC                             TRSP_MOD
	     , TO_CHAR(BORD.CGO_PKUP_DT, 'YYYY-MM-DD HH:MI')        PKUP_DT
	     , BORD.CXL_FLG                                         CXL_FLG
	     , BKG.DE_TERM_CD                                       DE_TERM_CD
	     , BORD.DIFF_RMK                                        RMK
	     , BORD.RLSE_OFC_CD                                     OFC_CD
	     , NVL(USR.USR_NM,BORD.RLSE_USR_ID)                     USR_NM
		 , TO_CHAR(BORD.RLSE_CRE_DT, 'YYYY-MM-DD HH:MI')        RLSE_DT
	     , BORD.CGOR_MZD_CD                                     MZD

		 , BORD.CO_BDG_ID										CO_BDG_ID
		 , BORD.CGO_CRR_ID										CGO_CRR_ID
		 , TO_CHAR(BORD.RLSE_EXP_DT, 'YYYY-MM-DD HH24:MI') 		RLSE_EXP_DT
		 , BORD.PIN_NO										    PIN_NO
		 , BORD.VEH_RGST_ID										VEH_RGST_ID
		 , BORD.ROAD_HLG_ID										ROAD_HLG_ID
		 , BORD.UQ_VSL_ID_NO									UQ_VSL_ID_NO
         , BORD.CNTR_SLT_NO                                     CNTR_SLT_NO
         , BORD.CSTMS_VOY_NO                                    CSTMS_VOY_NO
         , BORD.MTY_RTN_YD_CD                                   MTY_RTN_YD_CD
	  FROM BKG_BOOKING             BKG        
	     , BKG_FULL_CGO_RLSE_ORD   BORD        
	     , COM_USER                USR        
	     , BKG_CONTAINER           BCNTR            
	     , BKG_VVD                 BVVD 
		 , (SELECT INTG_CD_VAL_CTNT, INTG_CD_VAL_DP_DESC FROM COM_INTG_CD_DTL WHERE INTG_CD_ID = 'CD01662') TMCD       
	 WHERE 'Released Date'      = @[f_rad]
	  

	   AND BORD.RLSE_CRE_DT BETWEEN TO_DATE(REPLACE(@[in_cre_dt_from], '-', ''), 'YYYYMMDD') 
	       AND TO_DATE(REPLACE(@[in_cre_dt_to], '-', ''), 'YYYYMMDD') + 0.9999  -- DURATION (OPTIONAL 2)
	   AND BORD.CNTR_NO        LIKE @[in_cntr_no] || '%'
	   AND BKG.BKG_NO           = BORD.BKG_NO      
	   AND BKG.BKG_STS_CD       <> 'X'        
	   AND BCNTR.BKG_NO         = BORD.BKG_NO        
	   AND BCNTR.CNTR_NO        = BORD.CNTR_NO        
	   AND USR.USR_ID(+)        = BORD.RLSE_USR_ID  
	   AND BVVD.BKG_NO          = BKG.BKG_NO        
	   AND BVVD.VSL_CD          = BKG.VSL_CD        
	   AND BVVD.SKD_VOY_NO      = BKG.SKD_VOY_NO        
	   AND BVVD.SKD_DIR_CD      = BKG.SKD_DIR_CD        
	   AND BVVD.VSL_PRE_PST_CD  = 'T'
	   AND BORD.YD_CD LIKE @[in_yd_cd] || '%'
	   AND BORD.BKG_TRSP_MOD_CD = TMCD.INTG_CD_VAL_CTNT(+)
	       

	UNION ALL
	
	SELECT BKG.BL_NO                                            BL_NO
	     , BKG.BKG_NO                                           BKG_NO
	     , BORD.CNTR_NO                                         CNTR_NO
	     , BCNTR.CNTR_TPSZ_CD                                   CNTR_TP_SZ_CD
	     , REPLACE(BORD.CUST_NM, CHR(10), ' ')                  CUST_NM
	     , BORD.YD_CD                                           YD_CD
	     , BVVD.VSL_CD||BVVD.SKD_VOY_NO || BVVD.SKD_DIR_CD      VVD
	     , BKG.POL_CD                                           POL_CD
	     , BORD.POD_CD                                          POD_CD
	     , BORD.DO_NO ||BORD.DO_NO_SPLIT                        DO_NO
	     , TO_CHAR(BORD.DO_ISS_DT, 'YYYY-MM-DD HH:MI')          DO_ISS_DT
--	     , DECODE(BORD.BKG_TRSP_MOD_CD,'B','Barge'
--	                                  ,'F','Feeder'
--	                                  ,'R','Rail'
--	                                  ,'T','Truck'
--	                                  ,'' )                     TRSP_MOD	--TPJT_INBOUND
         , TMCD.INTG_CD_VAL_DP_DESC                             TRSP_MOD
	     , TO_CHAR(BORD.CGO_PKUP_DT, 'YYYY-MM-DD HH:MI')        PKUP_DT
	     , BORD.CXL_FLG                                         CXL_FLG
	     , BKG.DE_TERM_CD                                       DE_TERM_CD
	     , BORD.DIFF_RMK                                        RMK
	     , BORD.RLSE_OFC_CD                                     OFC_CD
	     , NVL(USR.USR_NM,BORD.RLSE_USR_ID)                     USR_NM
		 , TO_CHAR(BORD.RLSE_CRE_DT, 'YYYY-MM-DD HH:MI')        RLSE_DT
	     , BORD.CGOR_MZD_CD                                     MZD

		 , BORD.CO_BDG_ID										CO_BDG_ID
		 , BORD.CGO_CRR_ID										CGO_CRR_ID
		 , TO_CHAR(BORD.RLSE_EXP_DT, 'YYYY-MM-DD HH24:MI') 		RLSE_EXP_DT
		 , BORD.PIN_NO										    PIN_NO
		 , BORD.VEH_RGST_ID										VEH_RGST_ID
		 , BORD.ROAD_HLG_ID										ROAD_HLG_ID
		 , BORD.UQ_VSL_ID_NO									UQ_VSL_ID_NO
         , BORD.CNTR_SLT_NO                                     CNTR_SLT_NO
         , BORD.CSTMS_VOY_NO                                    CSTMS_VOY_NO
         , BORD.MTY_RTN_YD_CD                                   MTY_RTN_YD_CD
	  FROM BKG_BOOKING             BKG        
	     , BKG_FULL_CGO_RLSE_ORD   BORD        
	     , COM_USER                USR        
	     , BKG_CONTAINER           BCNTR            
	     , BKG_VVD                 BVVD
   		 , (SELECT INTG_CD_VAL_CTNT, INTG_CD_VAL_DP_DESC FROM COM_INTG_CD_DTL WHERE INTG_CD_ID = 'CD01662') TMCD               
	 WHERE 'BL'                = @[f_rad]
	   AND BKG.BL_NO            = @[in_bl_no]--'PUSE41695103'        
	   AND BKG.BKG_STS_CD      <> 'X'      
       AND BCNTR.BKG_NO         = BKG.BKG_NO      
	   AND BORD.BKG_NO          = BKG.BKG_NO        
	   AND BORD.CNTR_NO        LIKE @[in_cntr_no] || '%'	     
	   AND BORD.CNTR_NO         = BCNTR.CNTR_NO 
	   AND USR.USR_ID(+)        = BORD.RLSE_USR_ID 
	   AND BVVD.BKG_NO          = BKG.BKG_NO        
	   AND BVVD.VSL_CD          = BKG.VSL_CD        
	   AND BVVD.SKD_VOY_NO      = BKG.SKD_VOY_NO        
	   AND BVVD.SKD_DIR_CD      = BKG.SKD_DIR_CD        
	   AND BVVD.VSL_PRE_PST_CD  = 'T'
	   AND BORD.YD_CD LIKE @[in_yd_cd] || '%'
 	   AND BORD.BKG_TRSP_MOD_CD = TMCD.INTG_CD_VAL_CTNT(+)
	
	UNION ALL
	SELECT BKG.BL_NO                                            BL_NO         
	     , BKG.BKG_NO                                           BKG_NO         
	     , BORD.CNTR_NO                                         CNTR_NO         
	     , BCNTR.CNTR_TPSZ_CD                                   CNTR_TP_SZ_CD        
	     , REPLACE(BORD.CUST_NM, CHR(10), ' ')                  CUST_NM        
	     , BORD.YD_CD                                           YD_CD       
	     , BVVD.VSL_CD||BVVD.SKD_VOY_NO || BVVD.SKD_DIR_CD      VVD        
	     , BKG.POL_CD                                          POL_CD        
	     , BORD.POD_CD                                          POD_CD 
	     , BORD.DO_NO ||BORD.DO_NO_SPLIT                        DO_NO  
	     , TO_CHAR(BORD.DO_ISS_DT, 'YYYY-MM-DD HH:MI')          DO_ISS_DT
--	     , DECODE(BORD.BKG_TRSP_MOD_CD,'B','Barge'    
--	                                  ,'F','Feeder'
--	                                  ,'R','Rail'
--	                                  ,'T','Truck'    
--	                                  ,'' )                     TRSP_MOD        --TPJT_INBOUND
         , TMCD.INTG_CD_VAL_DP_DESC                             TRSP_MOD
	     , TO_CHAR(BORD.CGO_PKUP_DT, 'YYYY-MM-DD HH:MI')        PKUP_DT
	     , BORD.CXL_FLG                                         CXL_FLG        
	     , BKG.DE_TERM_CD                                       DE_TERM_CD        
	     , BORD.DIFF_RMK                                        RMK        
	     , BORD.RLSE_OFC_CD                                     OFC_CD        
	     , NVL(USR.USR_NM,BORD.RLSE_USR_ID)                     USR_NM        
	     , TO_CHAR(BORD.RLSE_CRE_DT, 'YYYY-MM-DD HH:MI')        RLSE_DT
	     , BORD.CGOR_MZD_CD                                     MZD       

		 , BORD.CO_BDG_ID										CO_BDG_ID
		 , BORD.CGO_CRR_ID										CGO_CRR_ID
		 , TO_CHAR(BORD.RLSE_EXP_DT, 'YYYY-MM-DD HH24:MI') 		RLSE_EXP_DT
		 , BORD.PIN_NO										    PIN_NO
		 , BORD.VEH_RGST_ID										VEH_RGST_ID
		 , BORD.ROAD_HLG_ID										ROAD_HLG_ID
		 , BORD.UQ_VSL_ID_NO									UQ_VSL_ID_NO
         , BORD.CNTR_SLT_NO                                     CNTR_SLT_NO
         , BORD.CSTMS_VOY_NO                                    CSTMS_VOY_NO
         , BORD.MTY_RTN_YD_CD                                   MTY_RTN_YD_CD
	  FROM BKG_BOOKING             BKG
	     , BKG_FULL_CGO_RLSE_ORD   BORD
	     , COM_USER                USR       
	     , BKG_CONTAINER           BCNTR       
	     , BKG_VVD                 BVVD
   		 , (SELECT INTG_CD_VAL_CTNT, INTG_CD_VAL_DP_DESC FROM COM_INTG_CD_DTL WHERE INTG_CD_ID = 'CD01662') TMCD       
	 WHERE 'VVD'                = @[f_rad]
	   AND BVVD.VSL_CD          = SUBSTR(@[in_vvd], 1, 4)
	   AND BVVD.SKD_VOY_NO      = SUBSTR(@[in_vvd], 5, 4)
	   AND BVVD.SKD_DIR_CD      = SUBSTR(@[in_vvd], 9, 1)
	   AND BVVD.VSL_PRE_PST_CD  = 'T'
	   AND BKG.BKG_NO           = BVVD.BKG_NO
	   AND BKG.VSL_CD           = BVVD.VSL_CD
	   AND BKG.SKD_VOY_NO       = BVVD.SKD_VOY_NO
	   AND BKG.SKD_DIR_CD       = BVVD.SKD_DIR_CD
	   AND BKG.BKG_STS_CD      <> 'X'
	   AND BCNTR.BKG_NO         = BKG.BKG_NO
	   AND BCNTR.CNTR_NO        = BORD.CNTR_NO
	   AND BORD.POD_CD          = @[in_pod_cd]
	   AND BORD.BKG_NO          = BKG.BKG_NO
	   AND BORD.RLSE_USR_ID     = USR.USR_ID(+)
 	   AND BORD.BKG_TRSP_MOD_CD = TMCD.INTG_CD_VAL_CTNT(+)	
) WHERE 1=1
ORDER BY BKG_NO, RLSE_DT desc			]]></sql>
			<params>
				<param name="f_rad" type="12" value="" out="N"/>
				<param name="in_cre_dt_from" type="12" value="" out="N"/>
				<param name="in_cre_dt_to" type="12" value="" out="N"/>
				<param name="in_cntr_no" type="12" value="" out="N"/>
				<param name="in_yd_cd" type="12" value="" out="N"/>
				<param name="in_bl_no" type="12" value="" out="N"/>
				<param name="in_vvd" type="12" value="" out="N"/>
				<param name="in_pod_cd" type="12" value="" out="N"/>
			</params>
		</query>
	</querys>
</sqls>
